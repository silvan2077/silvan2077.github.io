<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Silvan&#39;s Blog🐳</title>
  
  <subtitle>true</subtitle>
  <link href="https://silvan2077.github.io/atom.xml" rel="self"/>
  
  <link href="https://silvan2077.github.io/"/>
  <updated>2025-10-10T15:18:12.916Z</updated>
  <id>https://silvan2077.github.io/</id>
  
  <author>
    <name>Silvan🐳</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Spring(黑马)</title>
    <link href="https://silvan2077.github.io/2025/10/05/Spring-Spring-%E9%BB%91%E9%A9%AC/"/>
    <id>https://silvan2077.github.io/2025/10/05/Spring-Spring-%E9%BB%91%E9%A9%AC/</id>
    <published>2025-10-05T10:25:11.761Z</published>
    <updated>2025-10-10T15:18:12.916Z</updated>
    
    <content type="html"><![CDATA[<h1>课程介绍</h1><div class="note info no-icon flat"><p>Spring是一款功能强大的框架，主要优势是<code>简化开发</code>和<code>框架整合</code></p></div><ul><li><code>简化开发</code>：Spring框架中提供了两个大的核心技术，分别是:<ul><li>IOC</li><li>AOP<ul><li>事务处理</li></ul></li><li>IoC和AOP是Spring的重要知识点，事务处理可以简化项目中的事务管理，也是一大亮点</li></ul></li><li><code>框架整合</code>：Spring整合了市面几乎所有主流框架，如Hibernate、MyBatis、Struts2等</li></ul><div class="note danger no-icon flat"><p>综上，对Spring的学习，主要学习四块内容：</p><ol><li>IOC</li><li>整合Mybatis(IOC的具体应用)</li><li>AOP</li><li>声明式事务(AOP的具体应用)</li></ol></div><h1>Spring相关概念</h1><h2 id="Spring发展史">Spring发展史</h2><p>Spring发展至今早已形成了一种开发的生态圈，提供了若干个项目，这些项目组合起来便被称为<code>Spring全家桶</code></p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251006114234.png"/></div></div><p>可以到<a href="https://spring.io/projects">Spring官方网站</a>查看具体图标的含义，这里重点关注<code>Spring Framework</code>、<code>SpringBoot</code>和<code>SpringCloud</code>:</p><ul><li><strong>Spring Framework</strong>：Spring框架，是Spring中最早最核心的技术，也是所有其他技术的基础。</li><li><strong>SpringBoot</strong>：Spring是来简化开发，而SpringBoot是来帮助Spring在简化的基础上能更快速进行开发。</li><li><strong>SpringCloud</strong>：这个是用来做分布式之微服务架构的相关开发。</li></ul><div class="note info no-icon flat"><p>除了这三个，还有还有很多其他的技术，也比较流行，如<code>SpringData</code>，<code>SpringSecurity</code>等，这里学习的Spring其实指的是<code>Spring Framework</code>。</p></div><p>接下来介绍Spring Framework是怎么来的：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251006133152.png"/></div></div><ul><li>IBM(IT公司-国际商业机器公司)在1997年提出了EJB思想,早期的JAVAEE开发大都基于该思想。</li><li>Rod Johnson(Java和J2EE开发领域的专家)在2002年出版的<code>Expert One-on-One J2EE Design and Development</code>,书中有阐述在开发中使用EJB该如何做。</li><li>Rod Johnson在2004年出版的<code>Expert One-on-One J2EE Development without EJB</code>,书中提出了比EJB思想更高效的实现方案，并且在同年将方案进行了具体的落地实现，这个实现就是Spring1.0。</li><li>随着时间推移，版本不断更新维护，目前最新的是Spring5<ul><li>Spring1.0是纯配置文件开发</li><li>Spring2.0为了简化开发引入了注解开发，此时是配置文件加注解的开发方式</li><li>Spring3.0已经可以进行纯注解开发，使开发效率大幅提升，我们的课程会以注解开发为主</li><li>Spring4.0根据JDK的版本升级对个别API进行了调整</li><li>Spring5.0已经全面支持JDK8，所以学习期间最好用JDK8版本</li></ul></li><li>本节介绍了Spring家族与Spring的发展史，需要我们重点掌握的是:<ul><li>Spring其实是Spring家族中的Spring Framework</li><li>Spring Framework是Spring家族中其他框架的底层基础，学好Spring可以为其他Spring框架的学习打好基础</li></ul></li></ul><h2 id="Spring系统架构">Spring系统架构</h2><ul><li>SpringFramework是Spring其他项目的根基。</li><li>Spring Framework的发展也经历了很多版本的变更，每个版本都有相应的调整</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://pic.imgdb.cn/item/630c2c6e16f2c2beb1ee0194.jpg"/></div></div><ul><li>Spring Framework的5版本目前没有最新的架构图，而最新的是4版本，所以接下来主要研究的是4的架构图</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251006133515.png"/></div></div><ol><li>核心层<ul><li>Core Container：核心容器，这个模块是Spring最核心的模块，其他的都需要依赖该模块</li></ul></li><li>AOP层<ul><li>AOP(Aspect Oriented Programming)：面向切面编程，它依赖核心层容器，目的是在不改变原有代码的前提下对其进行功能增强</li><li>Aspects：AOP是思想，Aspects是对AOP思想的具体实现</li></ul></li><li>数据层<ul><li>Data Access：数据访问，Spring全家桶中有对数据访问的具体实现技术</li><li>Data Integration：数据集成，Spring支持整合其他的数据层解决方案，比如Mybatis</li><li>Transactions：事务，Spring中事务管理是Spring AOP的一个具体实现，也是后期学习的重点内容</li></ul></li><li>Web层<ul><li>这一层的内容将在SpringMVC框架具体学习</li></ul></li><li>Test层<ul><li>Spring主要整合了Junit来完成单元测试和集成测试</li></ul></li></ol><h2 id="Spring学习路线">Spring学习路线</h2><ol><li>Spring的IOC/DI</li><li>Spring的AOP</li><li>AOP的具体应用,事务管理</li><li>IOC/DI的具体应用,整合Mybatis</li></ol><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251006134142.png"/></div></div><h2 id="Spring核心概念">Spring核心概念</h2><p>这部分主要包括<code>IOC/DI</code>、<code>IOC容器</code>和<code>Bean</code></p><h3 id="目前的问题">目前的问题</h3><p>分析代码在编写中的问题：</p><ol><li>业务层需要调用数据层的方法，就需要在业务层new数据层的对象</li><li>如果数据层的实现类发生变化，那么业务层的代码也需要跟着改变，发生变更后，都需要进行编译打包和重部署</li></ol><div class="note info no-icon flat"><p>编写代码存在的问题：耦合度偏高，一个类发生变化，其他类也要跟着修改</p></div><div class="tabs" id="问题提出"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#问题提出-1">业务层实现</button></li><li class="tab"><button type="button" data-href="#问题提出-2">数据层实现</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="问题提出-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServlet</span> <span class="keyword">extends</span> <span class="title class_">BookServlet</span> &#123;</span><br><span class="line">    <span class="comment">//这个地方是写死了的</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BookDaoImpl</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="问题提出-2"><p>假如BookDaoImpl2比BookDaoImpl1好用，我们想更换数据层实现类，那么业务层的代码也得跟着变，耦合度太高了</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl1</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ... 1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl2</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ... 2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>主要耦合度高的原因是在业务层中直接new了数据层的实现类，如果我们不new对象，只声明一下，数据层跟业务层不就解耦了吗？<ul><li>答案显然不行，因为不new对象此时BookDao是一个空引用，强行调用save()方法会报<code>空指针异常</code>,所以现在主要问题是如何做到我们不创建对象，但运行时数据层对象被创建，且被赋值给业务层，这该如何实现？</li></ul></li><li>针对该问题，Spring提出的解决方案：<ul><li>使用对象时，程序中不再主动new对象，而让Spring为我们提供并管理这个对象</li></ul></li></ul><h3 id="IOC、IOC容器、Bean、DI">IOC、IOC容器、Bean、DI</h3><ul><li><strong>IOC(Inversion of Control)控制反转</strong><ul><li><strong>什么是控制反转？</strong><ul><li>使用对象时，由主动new产生对象转换为由<code>外部</code>提供对象，此过程中对象创建控制权由程序转移到外部，此思想称为<code>控制反转</code></li></ul></li><li><strong>Spring和IOC之间的关系是什么呢?</strong><ul><li>Spring技术对IOC思想进行了实现</li><li>Spring提供了一个容器，称为<code>IOC容器</code>，用来充当IOC思想中的”外部”</li><li>IOC思想中的<code>别人[外部]</code>指的就是<code>Spring的IOC容器</code></li></ul></li><li><strong>IOC容器的作用以及内部存放的是什么?</strong><ul><li>IOC容器负责对象的创建、初始化等一系列工作，其中包含了数据层和业务层的类对象</li><li>被创建或被管理的对象在IOC容器中统称为<code>Bean</code></li></ul></li><li><strong>当IOC容器中创建好service和dao对象后，程序就能正确执行了吗?</strong><ul><li>不行，因为service运行需要依赖dao对象</li><li>IOC容器中虽然有service和dao对象,但此时service对象和dao对象是两个单独的类，没有任何关系，需要把dao对象交给service,也就是说要绑定service和dao对象之间的关系才行</li><li>像这种在容器中建立对象与对象之间的绑定关系就要用到<code>DI(Dependency Injection)依赖注入</code>.</li></ul></li></ul></li><li><strong>DI(Dependency Injection)依赖注入</strong><ul><li><strong>什么是依赖注入?</strong><ul><li>在容器中建立bean与bean之间的依赖关系的整个过程，称为<code>依赖注入</code><ul><li>业务层要用数据层的类对象，以前是自己<code>new</code>的</li><li>现在自己不new了，靠<code>别人[外部其实指的就是IOC容器]</code>来给注入进来</li></ul></li></ul></li><li><strong>IOC容器中哪些bean之间要建立依赖关系呢?</strong><ul><li>这个需要程序员根据业务需求提前建立好关系，如业务层需要依赖数据层，service就要和dao建立依赖关系</li></ul></li><li>我们会发现Spring容器中IOC和AOP这两个概念的最终目标就是:充分解耦，具体实现靠:<ul><li>使用IOC容器管理bean(IOC)</li><li>在IOC容器内将有依赖关系的bean进行关系绑定（DI）</li><li>最终结果为:使用对象时不仅可以直接从IOC容器中获取，并且获取到的bean已经绑定了所有的依赖关系。</li></ul></li></ul></li></ul><h3 id="核心概念小结">核心概念小结</h3><ol><li><strong>什么是IOC/DI思想？</strong><ul><li>IOC:控制反转，控制反转的是对象的创建权</li><li>DI:依赖注入，绑定对象与对象之间的依赖关系</li></ul></li><li><strong>什么是IOC容器?</strong><ul><li>Spring创建了一个容器用来存放所创建的对象，这个容器就叫IOC容器</li></ul></li><li><strong>什么是Bean?</strong><ul><li>容器中所存放的一个个对象就叫Bean</li></ul></li></ol><h1>入门案例</h1><h2 id="IOC入门案例">IOC入门案例</h2><div class="note info no-icon flat"><p>需求：将BookServiceImpl和BookDaoImpl交给Spring管理，并从容器中获取对应的bean对象调用其方法</p></div><ol><li>创建Maven项目</li><li>添加Spring需要的依赖</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>创建BookDao，BookDaoImpl，BookService和BookServiceImpl四个类</li></ol><div class="tabs" id="ioc入门案例"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ioc入门案例-1">BookDao</button></li><li class="tab"><button type="button" data-href="#ioc入门案例-2">BookDaoImpl</button></li><li class="tab"><button type="button" data-href="#ioc入门案例-3">BookService</button></li><li class="tab"><button type="button" data-href="#ioc入门案例-4">BookServiceImpl</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ioc入门案例-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ioc入门案例-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ioc入门案例-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ioc入门案例-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="comment">// 这里不考虑依赖注入，仅仅学习IOC相关内容，所以手动new了一个BookDaoImpl对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BookDaoImpl</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ol start="4"><li>创建Spring配置文件</li></ol><blockquote><p>在resource目录下新建-&gt;XML配置文件-&gt;Spring配置</p></blockquote><ol start="5"><li>在配置文件中完成Bean的配置</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">      id属性标示给bean起名字</span></span><br><span class="line"><span class="comment">      class属性写类的全路径，得是具体的实现类而不是接口，要靠这个造对象</span></span><br><span class="line"><span class="comment">      还可以写name属性，作用和id一样，可以用来给对象起别名</span></span><br><span class="line"><span class="comment">      --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>Bean定义时，id属性和class属性是必须的，其他属性都是可选的，比如name属性<br>Bean的id属性在同一个配置文件不能重复</p></div><ol start="6"><li>获取IOC容器<br>使用Spring提供的接口完成IoC容器的获取</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="7"><li>从容器中获取对象并调用方法</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BookService</span> <span class="variable">bookService</span> <span class="operator">=</span> (BookService) context.getBean(<span class="string">&quot;bookService&quot;</span>);</span><br><span class="line">        bookService.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="8"><li>运行程序<br>测试结果：</li></ol><blockquote><p>book service save …<br>book dao save …</p></blockquote><div class="note info no-icon flat"><p>对Ioc的入门案例已经完成，但在上文BookServiceImpl中的bookDao对象是手动new的，耦合度依旧较高，解决这个问题便需要下面的<code>DI(依赖注入)</code></p></div><h2 id="DI入门案例">DI入门案例</h2><div class="note info no-icon flat"><p>需求：基于IOC入门案例，建立好service和dao之间的依赖关系，使用DI完成Dao层的注入</p></div><ol><li>删除service层中的new对象</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="comment">//private BookDao bookDao = new BookDaoImpl();</span></span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在业务层提供需要注入的属性的set方法</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBookDao</span><span class="params">(BookDao bookDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bookDao = bookDao;</span><br><span class="line">        <span class="comment">// 添加该语句检验set方法是否被调用</span></span><br><span class="line">        System.out.println(<span class="string">&quot;set方法被调用啦&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>在配置文件中添加依赖注入的配置</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--主要变化在这里--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置server与dao的关系--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            property标签表示配置当前bean的属性</span></span><br><span class="line"><span class="comment">            name属性表示配置哪一个具体的属性(这里是配置bookService的bookDao属性)</span></span><br><span class="line"><span class="comment">            ref属性表示参照哪一个bean(需要当前配置文件中配置的bean的id)</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>在property标签中使用了两个bookDao</p><ul><li><strong>name=“bookDao”，这里是Service层中的属性名</strong>，用是让Spring的IOC容器在获取到名称后，将首字母大写，前面加set找对应的setBookDao()方法进行对象注入</li><li><strong>ref=“bookDao”，这里是Dao层中的bean的id</strong>，用来参照当前配置文件中配置的bean的id，将其注入到Service层的bookDao属性中</li></ul></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251006205842.png"/></div></div><ol start="4"><li>运行程序<br>测试结果：</li></ol><blockquote><p>set方法被调用啦<br>book service save …<br>book dao save …</p></blockquote><h1>IOC相关内容</h1><h2 id="Bean基础配置">Bean基础配置</h2><ul><li>接下来主要说明<code>Bean基础配置</code>，<code>Bean别名配置</code>以及<code>Bean的作用范围配置</code></li></ul><h3 id="id和class">id和class</h3><p>bean标签的功能、使用方式以及id和class属性的作用，我们通过下面这张图简单描述</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251006210426.png"/></div></div><div class="note danger no-icon flat"><p>id和class属性都是必须的，id属性是bean的标识符，class属性是bean的类全路径</p></div><h3 id="name">name</h3><p>name属性的作用和id属性一样，可以用来给bean起别名，name属性也可以省略</p><ol><li>配置别名</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--别名可以有多个，使用逗号，分号，空格进行分隔都可以--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">name</span>=<span class="string">&quot;service1 service2 service3&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>根据名称来获取Bean对象</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//此处根据bean标签的id属性和name属性的任意一个值来获取bean对象</span></span><br><span class="line">        <span class="type">BookService</span> <span class="variable">bookService</span> <span class="operator">=</span> (BookService) context.getBean(<span class="string">&quot;service2&quot;</span>);</span><br><span class="line">        bookService.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>运行程序<br>测试结果：</li></ol><blockquote><p>set方法被调用啦<br>book service save …<br>book dao save …</p></blockquote><div class="note warning no-icon flat"><ul><li>Bean依赖注入的ref属性的值也可以是name里的别名，但是<strong>建议使用Id值来注入</strong></li><li>在调用getBean方法时，传入一个不存在的名称，就会报错<code>NoSuchBeanDefinitionException</code>，此时就要检查是哪一边的名称写错了</li></ul></div><h3 id="scope">scope</h3><p>关于bean的作用范围是bean属性配置的一个重点内容。<br>bean的scope有两个取值：</p><ul><li>singleton：单例（默认）</li><li>prototype：非单例</li></ul><h4 id="验证对象是否为单例">验证对象是否为单例</h4><div class="note info no-icon flat"><p>验证思路：获取同一个Bean两次，打印这两次的地址，如果地址相同则说明是单例</p></div><p>代码实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//我这里使用了别名，其实还是同一个bean</span></span><br><span class="line">        <span class="type">BookService</span> <span class="variable">bookService2</span> <span class="operator">=</span> (BookService) context.getBean(<span class="string">&quot;service2&quot;</span>);</span><br><span class="line">        <span class="type">BookService</span> <span class="variable">bookService3</span> <span class="operator">=</span> (BookService) context.getBean(<span class="string">&quot;service3&quot;</span>);</span><br><span class="line">        System.out.println(bookService2);</span><br><span class="line">        System.out.println(bookService3);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果发现地址值一样，则证明默认创建的为单例对象</p><blockquote><p>com.blog.service.impl.BookServiceImpl@25bbe1b6<br>com.blog.service.impl.BookServiceImpl@25bbe1b6</p></blockquote><h4 id="配置Bean为非单例">配置Bean为非单例</h4><p>正常情况下，Spring为我们创建的对象都是单例的，如果想要创建非单例的对象，需要我们在配置文件中配置scope属性</p><ul><li>在Spring的配置文件中，修改<code>&lt;bean&gt;</code>的scope属性</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">name</span>=<span class="string">&quot;service1 service2 service3&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>此时重新验证，便会发现地址值不一致。</p><h4 id="Scope总结">Scope总结</h4><ul><li><strong>为什么Spring创建Bean默认为单例？</strong><ul><li>Bean默认是单例意味着Spring的IOC容器只会存有该类的一个对象</li><li>对象只有一个有效避免了对象的频繁创建和销毁，达到了Bean对象的复用，性能更高<br>*** Bean对象是单例的，是否会产生线程安全问题？**</li><li>如果对象是有状态对象，即该对象有成员变量可以用来存储数据的，因为所有请求线程共用一个bean对象，所以会存在线程安全问题。</li><li>如果对象是无状态对象，即该对象没有成员变量没有进行数据存储的，因方法中的局部变量在方法调用完成后会被销毁，所以不会存在线程安全问题。</li></ul></li><li><strong>哪些bean对象适合交给容器进行管理?</strong><ul><li>表现层对象（controller）</li><li>业务层对象（service）</li><li>数据层对象（dao）</li><li>工具对象（util）</li></ul></li><li><strong>哪些bean对象不适合交给容器进行管理?</strong><ul><li><code>封装实例的域对象（domain，pojo）</code>，因为会引发线程安全问题，所以不适合。</li></ul></li></ul><h2 id="Bean的实例化">Bean的实例化</h2><ul><li>我们了解了通过配置文件来实例化Bean对象，但是容器是如何为我们创建对象的呢？<ul><li>这需要研究一下<code>Bean的实例化过程</code>，这部分主要解决两部分内容<ul><li>Bean是如何创建的</li><li>实例化Bean的三种方式，构造方法，静态工厂和实例工厂</li></ul></li></ul></li></ul><div class="note warning no-icon flat"><p>需要明确的事，Bean本质上就是一个对象，对象在new的时候是使用构造方法来创建的，所以创建Bean也是使用构造方法完成的</p></div><h3 id="构造方法实例化">构造方法实例化</h3><ul><li>在之前的Dao实现类中为无参构造添加一句话，方便观察结果。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookDaoImpl</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao constructor is running ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果：</p><blockquote><p>book dao constructor is running …<br>com.blog.service.impl.BookServiceImpl@25bbe1b6</p></blockquote><ul><li>将构造器私有化后，继续进行测试</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">BookDaoImpl</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao constructor is running ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行程序，发现将构造器私有化，仍然能访问到构造方法来实例化Bean，这说明Spring底层通过反射调用构造方法来实例化Bean对象</p><blockquote><p>book dao constructor is running …<br>com.blog.service.impl.BookServiceImpl@25bbe1b6</p></blockquote><h3 id="静态工厂实例化">静态工厂实例化</h3><ul><li>创建一个工厂类，在工厂类中提供一个静态方法，用来创建Bean对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoFactory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BookDao <span class="title function_">getBookDao</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BookDaoImpl</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>修改App运行类，通过工厂来获得对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//通过静态工厂创建对象</span></span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> BookDaoFactory.getBookDaoImpl();</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><blockquote><p>book dao save …</p></blockquote><ul><li>这样只是通过静态工厂创建对象，但没有将对象交给Spring容器进行管理，如何交给Spring容器管理呢？</li></ul><p>具体实现步骤如下：</p><ol><li>在Spring配置文件中修改BookDao的Bean</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.factory.BookDaoFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getBookDaoImpl&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>将class改为工厂类的全类名<br>添加factory-method属性，指定工厂创建类的方法名</p></blockquote><ol start="2"><li>在App运行类，像之前一样从IOC容器中获得对象</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao) context.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>这样就能正常运行了，运行结果和之前一样，反而更加麻烦了，哪这样做的意义是什么呢？</li></ol><blockquote><p>book dao save …</p></blockquote><ol start="4"><li>在工厂的静态方法中，除了创建对象我们还可以在这里进行其他的业务操作</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoFactory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BookDao <span class="title function_">getBookDaoImpl</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao factory setup ...&quot;</span>);<span class="comment">//模拟必要的业务操作</span></span><br><span class="line">        <span class="comment">//这里可以加一大堆业务逻辑</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BookDaoImpl</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>这是静态工厂实例化，这种方式一般用来兼容早期老系统，目前使用较少，<code>了解为主</code></p></div><h3 id="实例工厂和FactoryBean">实例工厂和FactoryBean</h3><p>修改BookDaoFactory类,这里和静态工厂的工厂类不同的是此处不是静态方法，而是普通方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoFactory</span> &#123;</span><br><span class="line">    <span class="comment">//唯一的区别就是去掉的static</span></span><br><span class="line">    <span class="keyword">public</span> BookDao <span class="title function_">getBookDaoImpl</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao factory setup ...&quot;</span>);<span class="comment">//模拟必要的业务操作</span></span><br><span class="line">        <span class="comment">//这里还可以加一大堆业务逻辑</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BookDaoImpl</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改App运行类，通过工厂来获得对象</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//因为不是静态方法了，所以需要实例工厂创建对象</span></span><br><span class="line">        <span class="type">BookDaoFactory</span> <span class="variable">bookDaoFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BookDaoFactory</span>();</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> bookDaoFactory.getBookDaoImpl();</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><blockquote><p>book dao factory setup … 这个是模拟业务逻辑的输出，无视掉就行<br>book dao save …</p></blockquote><p>将实例工厂交给Spring管理：</p><ol><li>在Spring配置文件中修改bookDao的bean</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDaoFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.factory.BookDaoFactory&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">factory-bean</span>=<span class="string">&quot;bookDaoFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getBookDaoImpl&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>实例化工厂运行的顺序是:</p><ul><li>创建实例化工厂对象,对应的是第一行配置</li><li>调用对象中的方法来创建bean，对应的是第二行配置<ul><li>factory-bean:工厂的实例对象</li><li>factory-method:工厂对象中的具体创建对象的方法名</li></ul></li></ul></div><ul><li>配置后便可以在App中从Ioc容器中获取Bean对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao) context.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>实例工厂的配置过程还是比较复杂的，且耦合度较高，所以Spring为了简化这种配置方式，提供了一种叫<code>FactoryBean</code>的接口来简化开发。</p></div><p><code>FactoryBean</code>具体使用步骤：</p><ol><li>创建一个BookDaoFactoryBean类，实现FactoryBean接口，并重写其中的方法<br>该接口是一个泛型接口，泛型参数为该工厂创建的Bean对象的类型</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoFactoryBean</span> <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;BookDao&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> BookDao <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BookDaoImpl</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> BookDao.class;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在Spring的配置文件修改bookDao的bean，修改class属性为工厂的全类名</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.factory.BookDaoFactoryBean&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>App运行类不用做任何修改，直接运行，结果如下</li></ol><blockquote><p>book dao save …</p></blockquote><div class="note danger no-icon flat"><p>这种方式在Spring整合其他框架时会用到，所以需要理解并掌握。</p></div><ul><li>查看源码会发现，FactoryBean接口提供了三个方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 该方法用于创建Bean对象并返回</span></span><br><span class="line">T <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 该方法用于返回Bean对象的类型</span></span><br><span class="line">Class&lt;?&gt; getObjectType();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 该方法用于设置Bean对象是否为单例，默认为单例</span></span><br><span class="line"><span class="keyword">default</span> <span class="type">boolean</span> <span class="title function_">isSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>其中方法一和方法二必须重写，方法三因为有默认值，所以可以不重写</li></ul><h3 id="Bean的实例化小结">Bean的实例化小结</h3><ul><li>Bean如何被创建<ul><li>Spring通过反射机制调用构造方法</li></ul></li><li>Spring的Ioc实例化对象的三种方式：<ul><li>无参构造方法(常用)</li><li>静态工厂(了解)</li><li>实例工厂(了解)<ul><li>FactoryBean(实用)</li></ul></li></ul></li></ul><div class="note warning no-icon flat"><p>无参构造方法系统默认会提供，但一旦重写了构造方法，系统就不会再提供默认的无参构造方法，因此在使用时需要注意，如果重写了构造方法，一定要把无参构造方法也写出来。</p></div><h2 id="Bean的生命周期">Bean的生命周期</h2><p>对于Bean的生命周期，主要围绕<code>Bean生命周期控制</code>来学习</p><ul><li>什么是Bean的生命周期？<ul><li>Bean对象从创建到销毁的整个过程</li></ul></li><li>Bean生命周期控制是什么？<ul><li>Bean创建后到销毁前做的事情</li></ul></li><li>我们研究的是如何在Bean创建之后和销毁之前将我们需要执行的操作添加进去</li></ul><h3 id="生命周期设置">生命周期设置</h3><p>具体的两个控制阶段</p><ul><li>Bean创建之后，如果想要添加内容，比如用来初始化需要用到的资源</li><li>Bean销毁之前，如果想要添加内容，比如用来释放资源</li></ul><ol><li>添加初始化和销毁操作</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在类中添加两个方法，方法名不唯一</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;init ... &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;destroy ... &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在配置文件中添加初始化和销毁方法</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>init-method：指定初始化方法<br>destroy-method：指定销毁方法</p></div><ol start="3"><li>运行程序</li></ol><blockquote><p>init …<br>book dao save …</p></blockquote><p>从运行结果来看，init方法成功执行了，但destroy方法并没有执行，这是为什么？</p><ul><li>Spring的IOC容器是运行在JVM中</li><li>运行main方法后,JVM启动,Spring加载配置文件生成IOC容器,从容器获取bean对象，然后调方法执行</li><li>main方法执行完后，JVM退出，这个时候IOC容器中的bean还没有来得及销毁就已经结束了</li><li>所以没有调用对应的destroy方法</li></ul><p>知道出现问题的原因，该如何解决这个问题呢？接着往下看</p><h3 id="Close关闭容器">Close关闭容器</h3><ul><li>ApplicationContext中没有close方法，他的子类提供了close方法，所以需要将ApplicationContext更换为ClassPathXmlApplicationContext，然后调用close方法关闭容器</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//ApplicationContext context = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);</span></span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao) context.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>此时运行程序就能看到destroy正常输出</li></ul><blockquote><p>init …<br>book dao save …<br>destroy …</p></blockquote><h3 id="注册钩子关闭容器">注册钩子关闭容器</h3><ul><li>在容器未关闭之前，提前设置好回调函数，让JVM在退出之前回调此函数来关闭容器</li><li>调用context的registerShutdownHook()方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao) context.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">        context.registerShutdownHook();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>注意：registerShutdownHook和close方法一样，在ApplicationContext中也没有</p></div><ul><li>运行后，查询打印结果</li></ul><blockquote><p>init …<br>book dao save …<br>destroy …</p></blockquote><ul><li><strong>close和registerShutdownHook该选哪个?</strong><ul><li>相同点:这两种都能用来关闭容器</li><li>不同点:close()是在调用的时候关闭，registerShutdownHook()是在JVM退出前调用关闭。</li><li>那么registerShutdownHook()方法可以在任意位置调用，下面的代码中将其放在了第二行，仍能正常输出，但要是将其换成close()方法，则会报错BeanFactory not initialized or already closed，这里就是already closed</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        context.registerShutdownHook();</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao) context.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>开发中用哪个？</strong><ul><li>答案是两个都不用</li><li>该方式添加初始化和销毁方法即需要更改配置文件还需要编码，实现步骤较复杂，不建议使用</li><li>Spring提供了两个接口来实现生命周期的控制，好处是不需要再配置<code>init-method</code>和<code>destroy-method</code></li></ul></li></ul><h3 id="Spring提供的接口">Spring提供的接口</h3><div class="note info no-icon flat"><p>需求：修改BookDaoImpl类，完成初始化和销毁方法的添加</p></div><div class="tabs" id="配置生命周期"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#配置生命周期-1">实现接口</button></li><li class="tab"><button type="button" data-href="#配置生命周期-2">Bean配置</button></li><li class="tab"><button type="button" data-href="#配置生命周期-3">运行结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="配置生命周期-1"><p>修改BookServiceImpl类，添加两个接口InitializingBean， DisposableBean并实现接口中的两个方法afterPropertiesSet和destroy</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span>, InitializingBean, DisposableBean &#123;</span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBookDao</span><span class="params">(BookDao bookDao)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;set ... &quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.bookDao = bookDao;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// 销毁方法，在容器关闭时调用</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;service destroy ... &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// 在属性注入完成后调用，即初始化方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;service init ... &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="配置生命周期-2"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="配置生命周期-3"><ul><li>init 是BookDao的初始化方法输出的</li><li>service init 是BookServiceImpl的初始化方法输出的</li><li>book dao save …是BookDao的保存方法输出的</li><li>service destroy 是BookServiceImpl的销毁方法输出的</li><li>destroy 是BookDao的销毁方法输出的</li></ul><blockquote><p>init …<br>service init …<br>book dao save …<br>service destroy …<br>destroy …</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>小细节<ul><li>对于InitializingBean接口中的afterPropertiesSet方法，翻译过来为属性设置之后。</li><li>对于BookServiceImpl来说，bookDao是它的一个属性，所以会先注入bookDao属性再初始化BookServiceImpl</li></ul></li></ul><div class="note info no-icon flat"><p>没有调用bookService为什么输出结果中还会有service呢？<br>解惑：所有Ioc容器中的Bean的初始化和销毁都会运行，所以Service也会运行</p></div><h3 id="生命周期小结">生命周期小结</h3><ul><li><p>Spring为Bean的生命周期控制提供了两种方式：</p><ul><li>配置文件中添加<code>init-method</code>和<code>destroy-method</code>属性</li><li>类实现<code>InitializingBean</code>和<code>DisposableBean</code>接口</li></ul></li><li><p>Bean的生命周期：</p><ul><li>初始化容器<ol><li>创建对象</li><li>执行构造方法</li><li>执行属性注入（set …）</li><li>执行Bean的初始化方法（service init …）</li></ol></li><li>使用Bean<ul><li>执行Bean的业务方法（book dao save …）</li></ul></li><li>销毁容器<ul><li>执行Bean的销毁方法（service destroy …）</li></ul></li></ul></li><li><p>关闭容器的两种方法：</p><ul><li>通过配置文件添加初始化和销毁方法需要设置关闭容器，否则destroy方法不会正常执行</li><li>ConfigurableApplicationContext是ApplicationContext的子类，子类才有下面两种方法：<ul><li>close()</li><li>registerShutdownHook()</li></ul></li></ul></li></ul><h1>DI相关内容</h1><p><code>DI(依赖注入)通常</code>用来为对象添加属性</p><ul><li><strong>向类中传递数据的方式有哪些？</strong><ul><li>构造方法</li><li>Set方法</li></ul></li><li><strong>Spring为我们提供了两种属性注入方式：</strong><ul><li><code>构造器注入</code><ul><li>简单类型</li><li>引用类型</li></ul></li><li><code>Setter方法注入</code><ul><li>简单类型</li><li>引用类型</li></ul></li></ul></li></ul><h2 id="Set注入">Set注入</h2><ul><li>前面就用到了set注入，快速回顾一下</li><li>在Bean中定义引用类型的属性，并提供set方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBookDao</span><span class="params">(BookDao bookDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bookDao = bookDao;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>在配置文件中使用property标签为属性赋值</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>回顾两个bookDao的含义：</p><ul><li>name后的作用是让Spring的Ioc容器获取名称后，根据获取到的名称推测对应的set方法，使用此set方法为属性赋值</li><li>ref后的作用是让Spring在Ioc容器找到id为bookDao的Bean，并赋给bookDao属性</li></ul></div><h3 id="注入引用数据类型">注入引用数据类型</h3><div class="note info no-icon flat"><p>需求：使用依赖注入为BookServiceImpl类中的BookDao属性赋值</p></div><div class="tabs" id="依赖注入1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#依赖注入1-1">BookDao</button></li><li class="tab"><button type="button" data-href="#依赖注入1-2">BookDaoImpl</button></li><li class="tab"><button type="button" data-href="#依赖注入1-3">BookService</button></li><li class="tab"><button type="button" data-href="#依赖注入1-4">BookServiceImpl</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="依赖注入1-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="依赖注入1-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="依赖注入1-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="依赖注入1-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBookDao</span><span class="params">(BookDao bookDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bookDao = bookDao;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>配置文件如下：</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>运行App类，加载Ioc容器并获取service对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BookService</span> <span class="variable">bookService</span> <span class="operator">=</span> (BookService) context.getBean(<span class="string">&quot;bookService&quot;</span>);</span><br><span class="line">        bookService.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="注入简单数据类型">注入简单数据类型</h3><div class="note info no-icon flat"><p>需求：为BookDaoImpl注入一些简单数据。</p></div><p><strong>思考：</strong></p><ul><li><p>引用类型使用的是<code>&lt;property name=&quot;&quot; ref=&quot;&quot;/&gt;</code>,简单数据类型还是使用ref吗?</p></li><li><p>ref是指向Spring的IOC容器中的另一个bean对象的，对于简单数据类型，没有对应的bean对象，该如何配置呢?使用value来配置<code>&lt;property name=&quot;&quot; value=&quot;&quot;/&gt;</code></p></li><li><p>步骤一：定义属性并提供set方法</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String dataBaseName;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> connectionCount;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDataBaseName</span><span class="params">(String dataBaseName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.dataBaseName = dataBaseName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setConnectionCount</span><span class="params">(<span class="type">int</span> connectionCount)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.connectionCount = connectionCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span> + dataBaseName + <span class="string">&quot;,&quot;</span> + connectionCount);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>步骤二：在配置文件中注入配置</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataBaseName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;connectionCount&quot;</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>value:后面跟的是简单数据类型，对于参数类型，Spring在注入的时候会自动转换，但是不能写一个错误的类型，例如<code>connectionCount</code>是<code>int</code>类型，你却给他传一个abc，这样的话，spring在将abc转换成int类型的时候就会报错。</p></div><ul><li>步骤三：运行程序，查看结果</li></ul><blockquote><p>book service save …<br>book dao save …mysql,100<br>user dao save …</p></blockquote><h2 id="构造器注入">构造器注入</h2><h3 id="环境准备">环境准备</h3><ul><li>修改BookDao、BookDaoImpl、UserDao、UserDaoImpl、BookService和BookServiceImpl类</li></ul><div class="tabs" id="构造器注入"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#构造器注入-1">BookDao</button></li><li class="tab"><button type="button" data-href="#构造器注入-2">UserDao</button></li><li class="tab"><button type="button" data-href="#构造器注入-3">UserDaoImpl</button></li><li class="tab"><button type="button" data-href="#构造器注入-4">BookService</button></li><li class="tab"><button type="button" data-href="#构造器注入-5">BookServiceImpl</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="构造器注入-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><!-- enatab --><!-- tab BookDaoImpl --><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String databaseName;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> connectionNum;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="构造器注入-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="构造器注入-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="构造器注入-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="构造器注入-5"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBookDao</span><span class="params">(BookDao bookDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bookDao = bookDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>配置文件：</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>运行类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BookService</span> <span class="variable">bookService</span> <span class="operator">=</span> (BookService) ctx.getBean(<span class="string">&quot;bookService&quot;</span>);</span><br><span class="line">        bookService.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="构造器注入引用类型">构造器注入引用类型</h3><div class="note info no-icon flat"><p>需求：将BookServiceImpl类中的bookDao修改成使用构造器的方式注入。</p><ol><li>将bookDao的setter方法删除掉</li><li>添加带有bookDao参数的构造方法</li><li>在applicationContext.xml中配置</li></ol></div><ul><li>步骤一：删除setter方法并提供构造方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookServiceImpl</span><span class="params">(BookDao bookDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bookDao = bookDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>步骤二：配置文件中进行配置构造方式注入</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>说明：在标签<code>&lt;constructor-arg&gt;</code>中</p><ul><li>name属性对应的值为构造函数中方法<code>形参的参数名</code>，必须要保持一致。</li><li>ref属性指向的是spring的IOC容器中其他bean对象。</li></ul></div><ul><li>步骤三：运行程序，查看结果<br>运行结果：</li></ul><blockquote><p>book service save …<br>book dao save …mysql,100</p></blockquote><h3 id="构造器注入多个参数">构造器注入多个参数</h3><div class="note info no-icon flat"><p>需求:在<code>BookDaoImpl</code>中，使用构造函数注入<code>databaseName</code>和<code>connectionNum</code>两个参数。<br>参考引用数据类型的注入，我们可以推出具体的步骤为:</p><ol><li>提供一个包含这两个参数的构造方法</li><li>在applicationContext.xml中进行注入配置</li></ol></div><ul><li>步骤一：添加多个简单属性并提供构造方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String databaseName;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> connectionNum;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookDaoImpl</span><span class="params">(String databaseName, <span class="type">int</span> connectionNum)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.databaseName = databaseName;</span><br><span class="line">        <span class="built_in">this</span>.connectionNum = connectionNum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span> + databaseName + <span class="string">&quot;,&quot;</span> + connectionNum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>步骤二：修复该配置文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.UserDaoImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;databaseName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;connectionNum&quot;</span> <span class="attr">value</span>=<span class="string">&quot;100&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>步骤三：运行程序：</li></ul><blockquote><p>book service save …<br>book dao save …mysql,9421<br>user dao save …</p></blockquote><h3 id="存在的问题">存在的问题</h3><ul><li><code>&lt;constructor-arg&gt;</code>标签内的name，必须与构造函数中的参数名一致，这两块存在紧耦合。</li><li>解决该问题，需要提前说明一点，即这个参数名发生变化的情况并不多，所以上面的还是比较主流的配置方式，下面介绍的配置方式了解为主。</li><li>方式一：删除name属性，添加type属性，根据类型注入<ul><li>这种方式可以解决构造函数形参名发生变化带来的耦合问题</li><li>但是如果构造方法参数中有类型相同的参数，这种方式就不太好实现了</li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;int&quot;</span> <span class="attr">value</span>=<span class="string">&quot;9421&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>方式二：删除type属性，添加index属性，根据索引下标注入，下标从0开始<ul><li>该方式能解决参数类型重复和参数名称问题</li><li>但这又要求参数的顺序不能变，带来了另外的耦合问题</li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;9421&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>如何选择使用哪种注入方式？</strong></p><ol><li>强制依赖时，使用构造器注入，使用set注入有概率不进行注入导致null对象出现<ul><li>强制依赖指对象创建时必须要注入参数</li></ul></li><li>可选依赖使用set注入，灵活性强<ul><li>可选依赖指对象创建时，不一定需要注入参数</li></ul></li><li>Spring倡导使用构造器注入，第三方框架也大多采用构造器注入，因为这种方法较严谨</li><li>如果有必要，可以同时使用两种注入方法，强制依赖时使用构造器注入，可选依赖时使用set注入</li><li>实际开发需要根据实际情况来，如果是第三方程序没有提供set方法则只能使用构造器注入</li><li><span class='p red'>自己开发模块时推荐使用set注入</span></li></ol><h3 id="构造器注入小结">构造器注入小结</h3><ul><li><strong>Set注入</strong><ul><li>简单类型</li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">...</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>引用类型</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">...</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><strong>构造器注入</strong><ul><li>简单类型</li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">...</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">index</span>=<span class="string">&quot;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>引用类型</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">...</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">index</span>=<span class="string">&quot;&quot;</span> <span class="attr">type</span>=<span class="string">&quot;&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>根据类型注入</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;int&quot;</span> <span class="attr">value</span>=<span class="string">&quot;9421&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>根据索引下标注入</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;9421&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><strong>依赖注入的方式选择</strong><ul><li>自己开发模块时推荐使用set注入</li><li>第三方技术根据实际情况选择</li></ul></li></ul><h2 id="自动配置">自动配置</h2><ul><li>无论构造器注入还是set注入，都需要修改配置文件，相对还是很麻烦，对此Spring为我们提供了<code>自动配置</code>功能</li><li>Ioc容器根据Bean所依赖的资源在容器中自动查找并注入到Bean的过程称为自动装配</li><li>自动装配的方式：<ul><li>按类型</li><li>按名称</li><li>按构造方法</li><li>不启用自动装配（忽略）</li></ul></li></ul><h3 id="环境准备-2">环境准备</h3><p>修改<code>BookDao</code>、<code>BookDaoImpl</code>、<code>BookService</code>和<code>BookServiceImpl</code>类</p><div class="tabs" id="自动装配1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#自动装配1-1">BookDao</button></li><li class="tab"><button type="button" data-href="#自动装配1-2">BookDaoImpl</button></li><li class="tab"><button type="button" data-href="#自动装配1-3">bookService</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="自动装配1-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="自动装配1-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String databaseName;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> connectionNum;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="自动装配1-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>配置文件：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;bookDao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>运行类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BookService</span> <span class="variable">bookService</span> <span class="operator">=</span> (BookService) ctx.getBean(<span class="string">&quot;bookService&quot;</span>);</span><br><span class="line">        bookService.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="启用自动装配">启用自动装配</h3><ul><li>启用自动装配仅仅需要修改配置文件即可<ul><li>将手动装配的<code>&lt;property&gt;</code>标签删除</li><li>在<code>&lt;bean&gt;</code>标签中添加autowire属性</li><li>通过更改autowire属性为byName或者byType来控制根据名称装配还是根据类型装配</li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    &lt;bean id=&quot;bookDao&quot; class=&quot;com.blog.dao.impl.BookDaoImpl&quot;/&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    既然是按类型注入了，那么id写不写都无所谓了--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.service.impl.BookServiceImpl&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>再次运行程序，结果如下，说明自动装配成功</li></ul><blockquote><p>book service save …<br>book dao save …</p></blockquote><div class="note warning no-icon flat"><p>注意事项：</p><ul><li>在Spring中，自动装配默认使用<code>根据类型</code>的<code>set注入</code>，因此注入属性的类中对应的set方法必须存在</li><li>被注入的对象需要在Spring的Ioc容器管理</li><li>根据类型注入，如果Ioc中找到多个类就会报<code>NoUniqueBeanDefinitionException</code>异常</li></ul></div><h3 id="自动装配小结">自动装配小结</h3><ul><li>如果按照名称去找对应的bean对象，找不到则注入Null</li><li>当某一个类型在IOC容器中有多个对象，按照名称注入只找其指定名称对应的bean对象，不会报错</li><li>两种方式介绍完后，以后用的更多的是<code>按照类型</code>注入。</li><li>对于依赖注入，需要注意一些其他的配置特征:<ol><li>自动装配用于引用类型依赖注入，不能对简单类型进行操作</li><li>使用按类型装配时（byType）必须保障容器中相同类型的bean唯一，推荐使用</li><li>使用按名称装配时（byName）必须保障容器中具有指定名称的bean，因变量名与配置耦合，不推荐使用</li><li><strong>自动装配优先级低于setter注入与构造器注入，同时出现时自动装配配置失效</strong></li></ol></li></ul><h2 id="集合注入">集合注入</h2><p>集合中既可以装简单数据类型也可以装引用数据类型，对于集合，在Spring中该如何注入呢?</p><ul><li>常见的集合类型<ul><li>数组</li><li>List</li><li>Set</li><li>Map</li><li>Properties</li></ul></li></ul><h3 id="环境准备-3">环境准备</h3><ul><li>修改BookDaoImpl类</li></ul><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">BookDao</button></li><li class="tab"><button type="button" data-href="#-2">BookDaoImpl</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[] array;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; set;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; map;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Properties properties;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;遍历数组:&quot;</span> + Arrays.toString(array));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;遍历List&quot;</span> + list);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;遍历Set&quot;</span> + set);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;遍历Map&quot;</span> + map);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;遍历Properties&quot;</span> + properties);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setArray</span><span class="params">(<span class="type">int</span>[] array)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.array = array;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setList</span><span class="params">(List&lt;String&gt; list)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.list = list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSet</span><span class="params">(Set&lt;String&gt; set)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.set = set;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMap</span><span class="params">(Map&lt;String, String&gt; map)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.map = map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setProperties</span><span class="params">(Properties properties)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.properties = properties;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>修改配置文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>修改App运行类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">( String[] args )</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao) ctx.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>接下来学习集合注入均在上面环境基础上完成，都是在bookDao的<code>&lt;bean&gt;</code>标签上使用<code>&lt;property</code>进行注入</li></ul><h3 id="注入数组类型">注入数组类型</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;array&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>100<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>200<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>300<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注入List类型">注入List类型</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>ABC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>123<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注入Set类型">注入Set类型</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;set&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>100<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>200<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>ABC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>ABC<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注入Map类型">注入Map类型</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;探路者&quot;</span> <span class="attr">value</span>=<span class="string">&quot;马文&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;次元游记兵&quot;</span> <span class="attr">value</span>=<span class="string">&quot;恶灵&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;易位窃贼&quot;</span> <span class="attr">value</span>=<span class="string">&quot;罗芭&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注入Properties类型">注入Properties类型</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;暴雷&quot;</span>&gt;</span>沃尔特·菲茨罗伊<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;寻血猎犬&quot;</span>&gt;</span>布洛特·亨德尔<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;命脉&quot;</span>&gt;</span>阿杰·切<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>说明：</p><ul><li>property标签使用set方式注入，构造方式注入<code>constructor-arg</code>标签内部也可以写<code>&lt;array&gt;</code>、<code>&lt;List&gt;</code>、<code>Set</code>、<code>Map</code>、<code>Props</code>标签</li><li>List底层也是使用数组实现的，所以<code>list</code>和<code>array</code>标签可以混用</li><li>集合中添加引用类型，只需要把<code>&lt;value&gt;</code>标签改为<code>&lt;ref&gt;</code>标签即可，但这种方式使用较少</li></ul></div><h1>Ioc/DI管理第三方Bean</h1><ul><li>前面的内容都是管理自己写的类，现在学习如何管理第三方的类</li></ul><h2 id="案例：数据源对象管理">案例：数据源对象管理</h2><div class="note info no-icon flat"><p>该案例使用<code>Druid</code>数据源来配置学习</p></div><h3 id="环境准备-4">环境准备</h3><ol><li>创建Maven项目</li><li>添加需要的依赖</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>resources目录下新建spring的配置文件</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>编写运行类</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="实现Druid管理">实现Druid管理</h3><div class="note info no-icon flat"><p>需求分析：使用Spring的Ioc容器管理Druid连接池对象</p><ol><li>使用第三方技术，需要先在pom.xml文件添加依赖</li><li>在配置文件中将第三方类做成一个bean，让Ioc容器管理</li><li>数据库连接四要素：驱动、连接、用户名和密码，需要为这些属性赋值</li><li>从Ioc容器中获取bean对象，打印到控制台</li></ol></div><ol><li>导入<code>Druid</code>依赖</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>配置第三方bean<br>此时第三方bean使用set注入还是构造器注入便需要根据第三方类为我们提供的内容来判断<br>通过查看源码发现DruidDataSource只提供了两个构造器，显然不能使用构造方法注入</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">DruidDataSource</span><span class="params">()</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">DruidDataSource</span><span class="params">(<span class="type">boolean</span> fairLock)</span> </span><br></pre></td></tr></table></figure><p>确定使用set注入后，在配置文件中添加<code>DruidDataSource</code>的配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--管理DruidDataSource对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:13306/spring_db&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;yourPassword&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>从Ioc容器中获取bean对象</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">       <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">       <span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> context.getBean(DruidDataSource.class);</span><br><span class="line">       System.out.println(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>运行程序<br>打印以下结果说明第三方Bean成功交给Ioc容器管理</li></ol><blockquote><p>{<br>CreateTime:”2022-09-01 10:15:19”,<br>ActiveCount:0,<br>PoolingCount:0,<br>CreateCount:0,<br>DestroyCount:0,<br>CloseCount:0,<br>ConnectCount:0,<br>Connections:[<br>]<br>}</p></blockquote><h2 id="加载properties文件">加载properties文件</h2><ul><li>我们完成Druid数据源配置后又发现一些问题：<ul><li>数据源中用到一些固定的常量（如数据库连接四要素），而将这些值直接放到Spring的配置文件中不利于后期维护</li><li>选择将这些固定的常量提取到外部的properties配置文件中</li><li>提取到properties文件的数据如何在Spring框架中读取这是接下来要解决的问题</li></ul></li></ul><h3 id="Druid属性优化">Druid属性优化</h3><div class="note info no-icon flat"><p>需求：将数据库连接四要素数据提取到properties配置文件，Spring加载文件中的配置信息并根据信息完成属性注入</p><ol><li>新建properties文件</li><li>将数据库连接需要的信息配置到文件中</li><li>在Spring配置文件中加载properties文件</li><li>使用加载到的值实现属性注入</li></ol></div><ol><li>准备properties配置文件<br>新建jdbc.properties文件并添加对应的属性键值对</li></ol><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbc.driverClass</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:13306/spring_db</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">password</span></span><br></pre></td></tr></table></figure><ol start="2"><li>开启<code>context</code>命名空间<br>修改Spring配置文件，开启<code>context</code>命名空间</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        &quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>加载properties文件<br>在配置文件中使用以下标签来加载文件</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>完成属性注入<br>使用<code>$&#123;&#125;</code>占位符来引用properties文件中的值</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        &quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driverClass&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>此时就已经将properties文件中的值成功注入到了DruidDataSource对象中</li></ul><p><code>注意事项：</code></p><ul><li>问题一：键值对的key为<code>username</code>等系统内置属性引发问题<ul><li>在properties中配置键值对的时候，如果key设置为<code>username</code>时，在运行后控制台打印该值发现打印的不是<code>root</code>，而是自己电脑的用户名</li><li>原因：<code>&lt;context:property-placeholder/&gt;</code>标签会加载系统的环境变量，且环境变量会优先加载，下面的代码可以输出系统环境变量</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    Map&lt;String, String&gt; env = System.getenv();</span><br><span class="line">    System.out.println(env);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>打印的结果是USERNAME=XXX[自己电脑用户名]</li><li>解决方案：将ystem-properties-mode设置为NEVER，表示不加载系统环境变量，这样就可以解决上面的问题了，当然还有一个解决方案就是给属性加上前缀，避免使用username作为属性的key。</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties&quot;</span> <span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><ul><li>问题二：多个properties文件加载,该如何配置？<ul><li>修改applicationContext.xml</li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--方式一 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;jdbc.properties,jdbc2.properties&quot;</span> <span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--方式二--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;*.properties&quot;</span> <span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--方式三 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:*.properties&quot;</span> <span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--方式四--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath*:*.properties&quot;</span> <span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><ul><li>说明：<ul><li>方式一：可以实现，如果配置文件多的话，每个都需要配置</li><li>方式二：<code>*.properties</code>代表所有以properties结尾的文件都会被加载，可以解决方式一的问题，但是不标准</li><li>方式三：标准的写法，<code>classpath:</code>代表的是从根路径下开始查找，但是只能查询当前项目的根路径</li><li>方式四：不仅可以加载当前项目还可以加载当前项目所依赖的所有项目的根路径下的properties配置文件</li></ul></li></ul></div><h3 id="小结">小结</h3><ul><li>如何开启<code>context</code>命名空间</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        &quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>如何加载properties配置文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;&quot;</span> <span class="attr">system-properties-mode</span>=<span class="string">&quot;NEVER&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><ul><li>如何在applicationContext.xml引入properties配置文件中的值<ul><li>使用占位符：<code>$&#123;key&#125;</code></li></ul></li></ul><h1>核心容器</h1><p>此处学习的核心容器，可以简单的理解为<code>ApplicationContext</code>，即前面App应用类创建的对象，接下来从结果问题来入手学习该容器的内容：</p><ul><li>如何创建容器</li><li>创建好容器如何获得Bean对象</li><li>容器类的层次结构是什么</li><li>BeanFactory是什么</li></ul><h2 id="环境准备-5">环境准备</h2><ul><li>创建Maven项目</li><li>添加Spring的依赖</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>新建Spring配置文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        &quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>添加BookDao和BookDaoImpl类</li></ul><div class="tabs" id="核心容器"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#核心容器-1">BookDao</button></li><li class="tab"><button type="button" data-href="#核心容器-2">BookDaoImpl</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="核心容器-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="核心容器-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>创建运行类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao) ctx.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="容器">容器</h2><h3 id="容器的创建方式">容器的创建方式</h3><ul><li>案例中创建<code>ApplicationContext</code>方式如下</li><li>这种方式翻译为：类路径下的XML配置文件</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>Spring还提供了一种绝对路径的创建方式</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileSystemXmlApplicationContext</span>(<span class="string">&quot;D:\xxx/xxx\applicationContext.xml&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>这种方式能实现，但项目位置一旦发生变化代码就要跟着改，增加耦合度，所以不推荐使用</li></ul><h3 id="获取Bean的三种方式">获取Bean的三种方式</h3><ul><li>方式一：获得bean后强转</li><li>该方式存在的问题在于每次获取Bean后需要进行强转操作</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao) ctx.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>方式二：指定获取Bean的类型</li><li>该方式在调用方法时需要指定Bean的类型，避免了强转操作</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> ctx.getBean(<span class="string">&quot;bookDao&quot;</span>, BookDao.class);</span><br></pre></td></tr></table></figure><ul><li>方式三：直接传Bean的类型</li><li>该方式类似按类型注入。必须确保Ioc容器中该类型对应的Bean对象只能有一个</li></ul><h3 id="BeanFactory">BeanFactory</h3><p>容器的最上级父接口就是<code>BeanFactory</code>，使用<code>BeanFactory</code>也可以创建Ioc容器</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppForBeanFactory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Resource</span> <span class="variable">resources</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathResource</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BeanFactory</span> <span class="variable">bf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XmlBeanFactory</span>(resources);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> bf.getBean(BookDao.class);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为了更好的看出<code>BeanFactory</code>和<code>ApplicationContext</code>之间的区别，在BookDaoImpl添加如下构造函数</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookDaoImpl</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;constructor&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果不去获取bean对象，打印会发现：</p><ul><li>BeanFactory是延迟加载，只有在获取bean对象的时候才会去创建</li><li>ApplicationContext是立即加载，容器加载的时候就会创建bean对象</li><li>ApplicationContext要想成为延迟加载，只需要将lazy-init设为true</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>  <span class="attr">lazy-init</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="核心容器总结">核心容器总结</h2><h3 id="容器相关">容器相关</h3><ul><li><code>BeanFactory</code>是IoC容器的顶层接口，初始化BeanFactory对象时，加载的bean延迟加载</li><li>ApplicationContext接口是Spring容器的核心接口，初始化时bean立即加载</li><li>ApplicationContext接口提供基础的bean操作相关方法，通过其他接口扩展其功能</li><li>ApplicationContext接口常用初始化类<ul><li>ClassPathXmlApplicationContext(常用)</li><li>FileSystemXmlApplicationContext</li></ul></li></ul><h3 id="bean相关">bean相关</h3><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251007191225.png"/></div></div><h3 id="依赖注入">依赖注入</h3><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251007191317.png"/></div></div><h1>Ioc/DI注解开发</h1><p>Spring的Ioc/DI对应的使用配置文件开发使用起来还是比较复杂的，所以Spring为我们提供了注解开发，Spring对注解支持的版本历程：</p><ul><li>2.0版开始支持注解</li><li>2.5版注解功能趋于完善</li><li>3.0版支持纯注解开发<br>关于注解开发，主要学习两部分内容<code>注解开发定义Bean</code>和<code>纯注解开发</code>。<br>注解开发定义bean用的是2.5版提供的注解，纯注解开发用的是3.0版提供的注解。</li></ul><h2 id="环境准备-6">环境准备</h2><ul><li>创建一个Maven项目</li><li>添加Spring的依赖</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>新建Spring配置文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>添加BookDao和BookDaoImpl类</li></ul><div class="tabs" id="核心容器"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#核心容器-1">BookDao</button></li><li class="tab"><button type="button" data-href="#核心容器-2">BookDaoImpl</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="核心容器-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="核心容器-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>创建运行类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao) ctx.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="注解开发定义Bean">注解开发定义Bean</h2><ol><li>删除原有的XML配置<br>将配置文件中的<code>&lt;bean&gt;</code>标签删除掉</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bookDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.blog.dao.impl.BookDaoImpl&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>在Dao上添加注解<br>在BookDaoImpl类上添加<code>@Component</code>注解</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;bookDao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p><strong>注意：@Component注解不可以添加在接口上，因为接口是无法创建对象的。</strong></p></div><ol start="3"><li>配置Spring的注解包扫描<br>仅仅在类上添加@Component注解是不够的，还需要配置Spring的注解包扫描，否则Spring容器不会扫描到该类,Spring没有扫描到自然不会添加到Ioc容器中管理。</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        &quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.blog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>说明：component-scan</p><ul><li>component:组件,Spring将管理的bean视作自己的一个组件</li><li>scan:扫描</li><li>base-package指定Spring框架扫描的包路径，它会扫描指定包及其子包中的所有类上的注解。</li><li>包路径越多如:com.blog.dao.impl，扫描的范围越小速度越快</li><li>包路径越少如:com.blog,扫描的范围越大速度越慢</li><li>一般扫描到项目的组织名称即Maven的<code>groupId</code>下如:com.blog即可。</li></ul></div><ol start="4"><li>运行程序</li></ol><blockquote><p>book dao save …</p></blockquote><ol start="5"><li>service上添加注解<br>在BookServiceImpl类上也添加<code>@Component</code>交给Spring框架管理</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="6"><li>运行程序<br>在App类中从IOC容器中获取BookServiceImpl对应的bean对象</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ClassPathXmlApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//按照名称获取bean</span></span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao) context.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">        <span class="comment">//按照类型获取bean</span></span><br><span class="line">        <span class="type">BookService</span> <span class="variable">bookService</span> <span class="operator">=</span> context.getBean(BookService.class);</span><br><span class="line">        bookDao.save();</span><br><span class="line">        bookService.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><blockquote><p>book dao save …<br>book service save …</p></blockquote><div class="note info no-icon flat"><p>说明:</p><ul><li>BookServiceImpl类没有起名称，所以在App中是按照类型来获取bean对象</li><li><code>@Component</code>注解如果不起名称，会有一个默认值就是当前类名首字母小写，所以也可以按照名称获取，如</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BookService</span> <span class="variable">bookService</span> <span class="operator">=</span> (BookService) context.getBean(<span class="string">&quot;bookServiceImpl&quot;</span>);</span><br></pre></td></tr></table></figure><p>对于<code>@Component</code>注解，还衍生出了其他三个注解<code>@Controller</code>、<code>@Service</code>、<code>@Repository</code><br>通过查看源码会发现：这三个注解和@Component注解的作用是一样的，为什么要衍生出这三个呢?<br>这是方便我们后期在编写类的时候能很好的区分出这个类是属于表现层、业务层还是数据层的类。</p></div><h2 id="纯注解开发">纯注解开发</h2><p>上面已经可以使用注解来配置Bean，但仍然需要使用配置文件并添加包扫描，Spring在3.0版本推出了纯注解开发，使用Java类来代替配置文件。</p><h3 id="实现步骤">实现步骤</h3><ol><li>创建配置类<br>创建SpringConfig专门用作配置类</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>标识该类为配置类<br>在配置类上添加<code>@Configuration</code>注解，标识为配置类，用来替代<code>applicationContext.xml</code></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>使用包扫描注解<br>原本配置文件中就需要添加包扫描，现在使用注解<code>@ComponentScan</code>替换<code>&lt;context:component-scan base-package=&quot;&quot;/&gt;</code></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.blog&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>创建运行类并执行</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppForAnnotation</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> (BookDao) context.getBean(<span class="string">&quot;bookDao&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">        <span class="type">BookService</span> <span class="variable">bookService</span> <span class="operator">=</span> context.getBean(BookService.class);</span><br><span class="line">        bookService.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>执行结果<br>可以看到两个对象可以被成功获取</li></ol><blockquote><p>book dao save …<br>book service save …</p></blockquote><h3 id="小结-2">小结</h3><p>纯注解开发的主要内容包括：</p><ul><li>@Configuration注解用于设定当前类为配置类</li><li>@ComponentScan注解用于设定扫描路径，该注解只能添加一次，多个数据需要使用数组格式</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan(&#123;com.blog.service&quot;,&quot;com.blog.dao&quot;&#125;)</span></span><br></pre></td></tr></table></figure><ul><li>读取Spring核心配置文件初始化容器对象切换为Java配置类初始化容器对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">AnnotationConfigApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br></pre></td></tr></table></figure><div class="tabs" id="纯注解开发小结"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#纯注解开发小结-1"><i class="Configuration" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#纯注解开发小结-2"><i class="ComponentScan" style="text-align: center;"></i></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="纯注解开发小结-1"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@Configuration</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">类注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">类定义上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">设置该类为spring配置类</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">value（默认）：定义bean的id</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="纯注解开发小结-2"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@ComponentScan</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">类注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">类定义上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">设置spring配置类扫描路径，用于加载使用注解格式定义的bean</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">value（默认）：扫描路径，此路径可以逐层向下扫描</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info no-icon flat"><ul><li>记住<code>@Component</code>、<code>@Controller</code>、<code>@Service</code>、<code>@Repository</code>这四个注解</li><li>applicationContext.xml中<code>&lt;context:component-san/&gt;</code>的作用是指定扫描包路径，注解为<code>@ComponentScan</code></li><li><code>@Configuration</code>标识该类为配置类，使用类替换<code>applicationContext.xml</code>文件</li><li><code>ClassPathXmlApplicationContext</code>是加载XML配置文件</li><li><code>AnnotationConfigApplicationContext</code>是加载配置类</li></ul></div><h2 id="注解开发Bean的作用范围和生命周期">注解开发Bean的作用范围和生命周期</h2><ul><li>使用注解能够实现Bean的管理，根据前面学习的内容，将<code>Bean作用范围(Scope)</code>和<code>Bean生命周期(init和destroy)</code>也替换为注解实现</li></ul><h3 id="Bean的作用范围">Bean的作用范围</h3><ul><li>前面提到Spring为我们创建的Bean默认是单例，使用注解创建也不例外，如果想创建多例Bean，只需要在类上添加<code>@scope</code>注解即可</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;bookDao&quot;)</span></span><br><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>知识点：<code>@scope</code></p><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@Scope</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">类注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">类定义上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">设置该类创建对象的作用范围，可用于设置创建出的bean是否为单例对象</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">value（默认）：定义bean作用范围，默认值singleton（单例），可选值prototype（非单例）</td></tr></tbody></table><h3 id="Bean的生命周期-2">Bean的生命周期</h3><ul><li>在BookDaoImpl中添加两个方法，init和destroy(方法名任意)</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;bookDao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookDaoImpl</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;construct ... &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;init ... &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;destroy ... &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>使用注解来标注初始化方法和销毁方法只需要在对应的方法上添加<code>@PostConstruct</code>和<code>@PreDestroy</code>注解</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;bookDao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookDaoImpl</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;construct ... &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span>  <span class="comment">// 在构造方法之后执行，替换 init-method</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;init ... &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PreDestroy</span> <span class="comment">// 在销毁方法之前执行,替换 destroy-method</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;destroy ... &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>需要注意的是<code>destroy</code>依旧只有在容器关闭时才执行，所以需要手动调用<code>close方法</code>或<code>registerShutdownHook方法</code>来关闭容器</p></div><div class="note danger no-icon flat"><p>DK8版本以上，如果找不到<code>@PostConstruct</code>和<code>@PreDestroy</code>注解，需要导入下面的jar包</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.annotation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.annotation-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>找不到的原因是，从JDK9以后jdk中的javax.annotation包被移除了，这两个注解刚好就在这个包中。</p></div><div class="tabs" id="bean的生命周期注解"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#bean的生命周期注解-1"><i class="PostConstruct" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#bean的生命周期注解-2"><i class="PreDestroy" style="text-align: center;"></i></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="bean的生命周期注解-1"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@PostConstruct</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">方法注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">方法上</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">设置该方法为初始化方法</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">无</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="bean的生命周期注解-2"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@PreDestroy</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">方法注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">方法上</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">设置该方法为销毁方法</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">无</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="小结-3">小结</h3><div class="note info no-icon flat"><p>配置文件中的bean标签中的</p><ul><li><code>id</code>对应<code>@Component(&quot;&quot;)</code>，<code>@Controller(&quot;&quot;)</code>，<code>@Service(&quot;&quot;)</code>，<code>@Repository(&quot;&quot;)</code></li><li><code>scope</code>对应<code>@scope()</code></li><li><code>init-method</code>对应<code>@PostConstruct</code></li><li><code>destroy-method</code>对应<code>@PreDestroy</code></li></ul></div><h2 id="注解开发依赖注入">注解开发依赖注入</h2><p>Spring为了使用注解简化开发，并没有提供构造函数注入、setter注入对应的注解，只提供了自动装配的注解实现。</p><h3 id="环境准备-7">环境准备</h3><ul><li>创建Maven项目</li><li>添加Spring依赖</li><li>添加配置类<code>SpringConfig</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.blog&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>添加BookDao、BookDaoImpl、BookService、BookServiceImpl类</li></ul><div class="tabs" id="注解开发依赖注入"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#注解开发依赖注入-1">BookDao</button></li><li class="tab"><button type="button" data-href="#注解开发依赖注入-2">BookDaoImpl</button></li><li class="tab"><button type="button" data-href="#注解开发依赖注入-3">BookService</button></li><li class="tab"><button type="button" data-href="#注解开发依赖注入-4">BookServiceImpl</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="注解开发依赖注入-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="注解开发依赖注入-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="注解开发依赖注入-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="注解开发依赖注入-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBookDao</span><span class="params">(BookDao bookDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.bookDao = bookDao;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>创建运行类App</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">        <span class="type">BookService</span> <span class="variable">bookService</span> <span class="operator">=</span> ctx.getBean(BookService.class);</span><br><span class="line">        bookService.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>此时这些环境准备好后，直接运行依旧会爆出异常，因为还没有提供配置为BookService中的BookDao赋值，所以BookDao对象为null</p></div><h3 id="按类型注入-注解">按类型注入(注解)</h3><ul><li>在BookServiceImpl类的bookDao属性上添加@Autowired注解</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    public void setBookDao(BookDao bookDao) &#123;</span></span><br><span class="line"><span class="comment">//        this.bookDao = bookDao;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>注意：</p><ul><li>@Autowired可以写在属性上，也可也写在setter方法上，<strong>最简单的处理方式是写在属性上并将setter方法删除掉</strong></li><li>为什么setter方法可以删除呢?<ul><li>自动装配基于反射设计创建对象并通过<code>暴力反射</code>为私有属性进行设值</li><li>普通反射只能获取public修饰的内容,暴力反射除了获取public修饰的内容还可以获取private修改的内容，所以此处无需提供setter方法</li></ul></li></ul></div><ul><li><code>Autowired</code>按照类型注入，当对应BookDao接口有多个实现类时，比如添加BookDaoImpl2</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl2</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>此时再次运行App，就会报错<code>NoUniqueBeanDefinitionException</code>。</li><li>根据之前的学习，此时应当按照名称注入</li><li>先给两个Dao类分别起个名称</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository(&quot;bookDao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Repository(&quot;bookDao2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl2</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...2&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>突然发现此时就能注入成功，这是为什么?</li></ul><div class="note danger no-icon flat"><p>关键点：<code>@Autowired</code>的装配规则</p><ol><li><strong>先按类型（byType）装配</strong><br>Spring 会查找容器中所有实现了 <code>BookDao</code> 接口的 Bean。</li><li><strong>如果找到多个候选 Bean（类型相同）</strong><br>此时 Spring 会进入第二步——<strong>按名称（byName）匹配</strong>。<ul><li>Spring 会拿被注入属性的名称（这里是 <code>userServiceImplB</code>）</li><li>去和 Bean 的 <strong>id / name</strong> 进行匹配。</li></ul></li><li><strong>匹配成功则注入成功</strong><br>如果有一个 Bean 的名字和属性名一致，就会被选中注入。</li><li><strong>如果还是没有匹配成功</strong><br>则会抛出异常：<code>NoUniqueBeanDefinitionException</code></li></ol></div><h3 id="按名称注入-注解">按名称注入(注解)</h3><p>当根据类型在容器中找到多个bean,注入参数的属性名又和容器中bean的名称不一致，这个时候该如何解决，就需要使用到<code>@Qualifier</code>来指定注入哪个名称的bean对象。<code>@Qualifier</code>注解后的值就是需要注入的bean的名称。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;bookDao1&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> BookDao bookDao;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book service save ...&quot;</span>);</span><br><span class="line">        bookDao.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>注意:@Qualifier不能独立使用，必须和@Autowired一起使用</p></div><h3 id="简单类型注入">简单类型注入</h3><ul><li>Spring提供的自动装配只能对引用类型进行装配，不过Spring也为我们提供了简单类型装配的注解——<code>@Value</code>。</li><li>使用<code>@Value</code>注解为name属性赋值</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;Stephen&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>看到这个注解的使用方式，可以会有疑问，都直接在属性上标了那为什么不直接赋值呢？因为可以在注解中使用占位符读取外部的properties配置文件</li></ul><h3 id="读取properties配置文件">读取properties配置文件</h3><p><code>@Value</code>一般会被用在从properties配置文件中读取内容进行使用，具体如何实现?</p><ul><li><code>步骤一：</code>准备一个properties文件</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name</span>=<span class="string">Stephen</span></span><br></pre></td></tr></table></figure><ul><li><code>步骤二：</code>使用注解加载properties配置文件<br>在配置类上添加<code>@PropertySource</code>注解</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.blog&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;jdbc.properties&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤三：</code>使用@Value读取配置文件中的内容</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤四：</code>运行程序<br>运行App类，查看运行结果，说明配置文件中的内容已经被加载</li></ul><blockquote><p>book service save …<br>book dao save …Stephen</p></blockquote><div class="note warning no-icon flat"><p><strong>注意:</strong></p><ul><li>如果读取的properties配置文件有多个，可以使用<code>@PropertySource</code>来指定多个</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PropertySource(&#123;&quot;jdbc.properties&quot;,&quot;xxx.properties&quot;&#125;)</span></span><br></pre></td></tr></table></figure><p><code>@PropertySource</code>注解属性中不支持使用通配符<code>*</code>,运行会报错</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PropertySource(&#123;&quot;*.properties&quot;&#125;)</span></span><br></pre></td></tr></table></figure><p><code>@PropertySource</code>注解属性中可以把<code>classpath:</code>加上,代表从当前项目的根路径找文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PropertySource(&#123;&quot;classpath:jdbc.properties&quot;&#125;)</span></span><br></pre></td></tr></table></figure></div><div class="tabs" id="开发依赖注入"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#开发依赖注入-1"><i class="Autowired" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#开发依赖注入-2"><i class="Qualifier" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#开发依赖注入-3"><i class="Value" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#开发依赖注入-4"><i class="PropertySource" style="text-align: center;"></i></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="开发依赖注入-1"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@Autowired</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">属性注解 或 方法注解（了解） 或 方法形参注解（了解）</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">属性定义上方 或 标准set方法上方 或 类set方法上方 或 方法形参前面</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">为引用类型属性设置值</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">required：true/false，定义该属性是否允许为null</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="开发依赖注入-2"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@Qualifier</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">属性注解 或 方法注解（了解）</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">属性定义上方 或 标准set方法上方 或 类set方法上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">为引用类型属性指定注入的beanId</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">value（默认）：设置注入的beanId</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="开发依赖注入-3"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@Value</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">属性注解 或 方法注解（了解）</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">属性定义上方 或 标准set方法上方 或 类set方法上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">为 基本数据类型 或 字符串类型 属性设置值</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">value（默认）：要注入的属性值</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="开发依赖注入-4"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@PropertySource</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">类注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">类定义上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">加载properties文件中的属性值</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">value（默认）：设置加载的properties文件对应的文件名或文件名组成的数组</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>IOC/DI使用注解管理第三方Bean</h1><ul><li>自己开发的类可以通过添加注解快速管理，但第三方类我们无法在类中添加注解，此时该如何解决？此时Spring为我们提供了一个全新的注解——<code>@Bean</code></li></ul><h2 id="环境准备-8">环境准备</h2><ul><li>创建Maven项目</li><li>添加Spring依赖</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>添加配置类<code>SpringConfig</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>添加BookDao、BookDaoImpl类</li></ul><div class="tabs" id="注解管理"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#注解管理-1">BookDao</button></li><li class="tab"><button type="button" data-href="#注解管理-2">BookDaoImpl</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="注解管理-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="注解管理-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>创建运行类App</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="管理第三方Bean">管理第三方Bean</h2><div class="note info no-icon flat"><p>在上述搭建的环境中，完成对<code>Druid</code>数据源的管理</p></div><ul><li><code>步骤一：</code>导入对应的jar包</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>步骤二：</code>在配置类中添加一个方法<br>注意该方法的返回值就是要创建的Bean对象类型</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql://localhost:13306/spring_db&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;PASSWORD&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤三：</code>在方法上添加<code>@Bean</code>注解<br><code>@Bean</code>注解的作用是将方法的返回值作为一个Spring管理的bean对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql://localhost:13306/spring_db&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;PASSWORD&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤四：</code>从IOC容器中获取对象并打印</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">        <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> ctx.getBean(DataSource.class);</span><br><span class="line">        System.out.println(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出如下</p><blockquote><p>{<br>CreateTime:”2022-09-02 10:36:33”,<br>ActiveCount:0,<br>PoolingCount:0,<br>CreateCount:0,<br>DestroyCount:0,<br>CloseCount:0,<br>ConnectCount:0,<br>Connections:[<br>]<br>}</p></blockquote><ul><li>至此使用<code>@Bean</code>来管理第三方bean的案例就已经完成。</li><li>如果有多个bean要被Spring管理，直接在配置类中多写几个方法，方法上添加@Bean注解即可。</li></ul><h2 id="引入外部配置类">引入外部配置类</h2><p>如果把所有的第三方bean都配置到Spring的配置类<code>SpringConfig</code>中，虽然可以，但是不利于代码阅读和分类管理，所有我们就想能不能按照类别将这些bean配置到不同的配置类中?</p><p>那么对于数据源的bean，我们可以把它的配置单独放倒一个<code>JdbcConfig</code>类中</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql://localhost:13306/spring_db&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;PASSWORD&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那现在又有了一个新问题，这些配置类如何能被Spring配置类加载到，并创建DataSource对象在IOC容器中?<br>针对这个问题，有两个解决方案：</p><h3 id="使用包扫描引入">使用包扫描引入</h3><ul><li><code>步骤一：</code>在Spring的配置类上添加包扫描<br>注意要将JdbcConfig类放在包扫描的地址下</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.blog.config&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤二：</code>在JdbcConfig上添加<code>@Configuration</code>注解<br>JdbcConfig类要放入到<code>com.blog.config</code>包下，这样才能被Spring的配置类扫描到</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        ds.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        ds.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/spring_db&quot;</span>);</span><br><span class="line">        ds.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        ds.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤三：</code>运行程序<br>仍然可以获取到bean对象并输出到控制台</li></ul><blockquote><p>{<br>CreateTime:”2022-09-02 10:52:50”,<br>ActiveCount:0,<br>PoolingCount:0,<br>CreateCount:0,<br>DestroyCount:0,<br>CloseCount:0,<br>ConnectCount:0,<br>Connections:[<br>]<br>}</p></blockquote><p>这种方式虽然能够扫描到，但是不能很快的知晓都引入了哪些配置类(因为把包下的所有配置类都扫描了)，所以这种方式不推荐使用。</p><h3 id="使用-Import引入">使用@Import引入</h3><p>方案一实现起来有点小复杂，Spring早就想到了这一点，于是又给我们提供了第二种方案。<br>这种方案可以不用加<code>@Configuration</code>注解，但是必须在Spring配置类上使用<code>@Import</code>注解手动引入需要加载的配置类</p><ul><li><code>步骤一：</code>去除JdbcConfig类上的注解</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql://localhost:13306/spring_db&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;PASSWORD&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤二：</code>在Spring配置类中引入</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Import(JdbcConfig.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p><strong>注意:</strong></p><ul><li>扫描注解可以移除</li><li>@Import参数需要的是一个数组，可以引入多个配置类。</li><li>@Import注解在配置类中只能写一次</li></ul></div><ul><li><code>步骤三：</code>运行程序<br>依然能获取到bean对象并打印控制台</li></ul><blockquote><p>{<br>CreateTime:”2022-09-02 11:02:12”,<br>ActiveCount:0,<br>PoolingCount:0,<br>CreateCount:0,<br>DestroyCount:0,<br>CloseCount:0,<br>ConnectCount:0,<br>Connections:[<br>]<br>}</p></blockquote><div class="tabs" id="import"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#import-1"><i class="Bean" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#import-2"><i class="Import" style="text-align: center;"></i></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="import-1"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@Bean</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">方法注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">方法定义上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">设置该方法的返回值作为spring管理的bean</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">value（默认）：定义bean的id</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="import-2"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@Import</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">类注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">类定义上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">导入配置类</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">value（默认）：定义导入的配置类类名， 当配置类有多个时使用数组格式一次性导入多个配置类</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="为第三方Bean注入资源">为第三方Bean注入资源</h3><p>前面学习到使用<code>@Value</code>搭配<code>$&#123;&#125;</code>来注入<code>简单数据</code>,以及使用<code>@Autowired</code>来注入<code>引用数据</code>，对于第三方bean，如何为它注入属性呢?</p><h4 id="简单数据类型">简单数据类型</h4><ul><li>注入简单数据类型的方法跟自己定义的bean一样，使用<code>@Value</code>搭配<code>$&#123;&#125;</code>来注入即可</li></ul><div class="tabs" id="第三方注入简单数据类型"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#第三方注入简单数据类型-1">配置文件</button></li><li class="tab"><button type="button" data-href="#第三方注入简单数据类型-2">JdbcConfig</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="第三方注入简单数据类型-1"><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbc.driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:13306/spring_db</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">PASSWORD.</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="第三方注入简单数据类型-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PropertySource(&quot;jdbc.properties&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.driver&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String driver;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.username&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.password&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        dataSource.setDriverClassName(driver);</span><br><span class="line">        dataSource.setUrl(url);</span><br><span class="line">        dataSource.setUsername(username);</span><br><span class="line">        dataSource.setPassword(password);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="引用数据类型">引用数据类型</h4><div class="note info no-icon flat"><p>需求：假设在构建DataSource对象时，需要用到BookDao对象，该如何注入BookDao对象呢?</p></div><ul><li>对第三方注入引用数据类型的对象则更加方便，只需要为方法添加需要注入的Bean作为参数即可，容器会<code>根据类型</code>自动装配</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">(BookDao bookDao)</span> &#123;</span><br><span class="line">    bookDao.save();</span><br><span class="line">    <span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">    dataSource.setDriverClassName(driver);</span><br><span class="line">    dataSource.setUrl(url);</span><br><span class="line">    dataSource.setUsername(username);</span><br><span class="line">    dataSource.setPassword(password);</span><br><span class="line">    <span class="keyword">return</span> dataSource;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="注解开发总结">注解开发总结</h4><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251009153205.png"/></div></div><h1>Spring整合</h1><h2 id="Spring整合MyBatis">Spring整合MyBatis</h2><h3 id="准备环境">准备环境</h3><ul><li><code>步骤一：</code>准备数据库表<br>MyBatis是用来操作数据库表的，所以先来创建库和表</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create database spring_db character set utf8;</span><br><span class="line">use spring_db;</span><br><span class="line">create table <span class="title function_">tbl_account</span><span class="params">(</span></span><br><span class="line"><span class="params">    id <span class="type">int</span> primary key auto_increment,</span></span><br><span class="line"><span class="params">    name varchar(<span class="number">35</span>)</span>,</span><br><span class="line">    money <span class="type">double</span></span><br><span class="line">);  </span><br><span class="line">INSERT INTO <span class="title function_">tbl_account</span><span class="params">(`name`,money)</span> VALUES</span><br><span class="line">(<span class="string">&#x27;Tom&#x27;</span>,<span class="number">2800</span>),</span><br><span class="line">(<span class="string">&#x27;Jerry&#x27;</span>,<span class="number">3000</span>),</span><br><span class="line">(<span class="string">&#x27;Jhon&#x27;</span>,<span class="number">3100</span>);</span><br></pre></td></tr></table></figure><ul><li><code>步骤二：</code>创建项目导入依赖</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.46<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>步骤三：</code><br>根据表创建模型类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Account</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Account</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Account</span><span class="params">(Integer id, String name, <span class="type">double</span> money)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.money = money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getMoney</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMoney</span><span class="params">(<span class="type">double</span> money)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.money = money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Account&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, money=&quot;</span> + money +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤四：</code>创建Dao接口（在之前是Mapper接口，且要配置一个对应的xml文件，不过这里没涉及到复杂的sql语句，所以没配置xml文件，采用注解开发）</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into tbl_account(name, money) VALUES (#&#123;name&#125;, #&#123;money&#125;)&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Delete(&quot;delete from tbl_account where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update(&quot;update tbl_account set `name` = #&#123;name&#125;, money = #&#123;money&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select * from tbl_account&quot;)</span></span><br><span class="line">    List&lt;Account&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select * from tbl_account where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    Account <span class="title function_">findById</span><span class="params">(Integer id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><code>步骤五：</code>创建Service接口和实现类</p></li><li><p>AccountService</p></li></ul><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">AccountService</button></li><li class="tab"><button type="button" data-href="#-2">AccountServiceImpl</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Account account)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;Account&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    Account <span class="title function_">findById</span><span class="params">(Integer id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Account account)</span> &#123;</span><br><span class="line">        accountDao.save(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        accountDao.delete(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Account account)</span> &#123;</span><br><span class="line">        accountDao.update(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Account&gt; <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.findAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Account <span class="title function_">findById</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> accountDao.findById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li><code>步骤六：</code>添加jdbc.properties文件</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbc.driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:13306/spring_db</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">PASSWORD.</span></span><br></pre></td></tr></table></figure><ul><li><code>步骤七：</code>添加Mybatis核心配置文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--读取外部properties配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbc.properties&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--别名扫描的包路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.blog.domain&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--数据源--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--映射文件扫描包路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.blog.dao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>步骤八：</code>编写应用程序</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 1. 创建SqlSessionFactoryBuilder对象</span></span><br><span class="line">        <span class="type">SqlSessionFactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line">        <span class="comment">// 2. 加载mybatis-config.xml配置文件</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">        <span class="comment">// 3. 创建SqlSessionFactory对象</span></span><br><span class="line">        <span class="type">SqlSessionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> sqlSessionFactoryBuilder.build(inputStream);</span><br><span class="line">        <span class="comment">// 4. 获取SqlSession</span></span><br><span class="line">        <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> factory.openSession();</span><br><span class="line">        <span class="comment">// 5. 获取mapper</span></span><br><span class="line">        <span class="type">AccountDao</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(AccountDao.class);</span><br><span class="line">        <span class="comment">//6. 执行方法进行查询</span></span><br><span class="line">        <span class="type">Account</span> <span class="variable">account</span> <span class="operator">=</span> mapper.findById(<span class="number">2</span>);</span><br><span class="line">        System.out.println(account);</span><br><span class="line">        <span class="comment">//7. 释放资源</span></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤九：</code>运行程序，结果如下</li></ul><blockquote><p>Account{id=2, name=’Jerry’, money=3000.0}</p></blockquote><h3 id="思路分析">思路分析</h3><p>Mybatis的基础环境我们已经准备好了，接下来就得分析在上述的内容中，哪些对象可以交给Spring来管理?</p><ul><li>Mybatis程序核心对象分析<br>从图中可以获取到，真正需要交给Spring管理的是SqlSessionFactory</li></ul> <div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251009154522.png"/></div></div><ul><li>整合Mybatis，就是将Mybatis用到的内容交给Spring管理，分析下配置文件</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251009154638.png"/></div></div><div class="note info no-icon flat"><p>说明:</p><ul><li>第一部分读取外部properties配置文件，Spring有提供具体的解决方案<code>@PropertySource</code>,需要交给Spring</li><li>第二部分起别名包扫描，为SqlSessionFactory服务的，需要交给Spring</li><li>第三部分主要用于做连接池，Spring之前我们已经整合了Druid连接池，这块也需要交给Spring</li><li>前面三部分一起都是为了创建SqlSession对象用的，那么用Spring管理SqlSession对象吗?回忆下SqlSession是由SqlSessionFactory创建出来的，所以只需要将SqlSessionFactory交给Spring管理即可。</li><li>第四部分是Mapper接口和映射文件[如果使用注解就没有该映射文件]，这个是在获取到SqlSession以后执行具体操作的时候用，所以它和SqlSessionFactory创建的时机都不在同一个时间，可能需要单独管理。</li></ul></div><h3 id="整合步骤">整合步骤</h3><p>整合Spring与Mybatis大体需要做两件事，</p><ul><li>第一件：Spring要管理MyBatis中的SqlSessionFactory</li><li>第二件：Spring要管理Mapper接口的扫描</li></ul><p>那我们下面就开始来整合</p><ul><li><code>步骤一：</code>项目中导入整合需要的jar包</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>步骤二：</code>创建Spring的主配置类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//配置类注解</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//包扫描，主要扫描的是项目中的AccountServiceImpl类</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.blog&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤三：</code><br>创建数据源的配置类<br>在配置类中完成数据源的创建</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.driver&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String driver;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.username&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;jdbc.password&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        dataSource.setDriverClassName(driver);</span><br><span class="line">        dataSource.setUrl(url);</span><br><span class="line">        dataSource.setUsername(username);</span><br><span class="line">        dataSource.setPassword(password);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤四：</code>主配置类中读properties并引入数据源配置类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.blog&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(JdbcConfig.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤五：</code>创建Mybatis配置类并配置SqlSessionFactory</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyBatisConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SqlSessionFactoryBean <span class="title function_">sqlSessionFactory</span><span class="params">(DataSource dataSource)</span> &#123;</span><br><span class="line">        <span class="comment">//定义bean，SqlSessionFactoryBean，用于产生SqlSessionFactory对象</span></span><br><span class="line">        <span class="type">SqlSessionFactoryBean</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBean</span>();</span><br><span class="line">        <span class="comment">//设置模型类的别名扫描</span></span><br><span class="line">        sqlSessionFactory.setTypeAliasesPackage(<span class="string">&quot;com.blog.domain&quot;</span>);</span><br><span class="line">        <span class="comment">//设置数据源</span></span><br><span class="line">        sqlSessionFactory.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactory;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//定义bean，返回MapperScannerConfigurer对象</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MapperScannerConfigurer <span class="title function_">mapperScannerConfigurer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MapperScannerConfigurer</span> <span class="variable">msc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MapperScannerConfigurer</span>();</span><br><span class="line">        msc.setBasePackage(<span class="string">&quot;com.blog.dao&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> msc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>说明：</p><ul><li><p>使用SqlSessionFactoryBean封装SqlSessionFactory需要的环境信息<br><a href="https://pic.imgdb.cn/item/6314160016f2c2beb1d5ae4f.jpg"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"></a></p></li><li><p>SqlSessionFactoryBean是前面我们讲解FactoryBean的一个子类，在该类中将SqlSessionFactory的创建进行了封装，简化对象的创建，我们只需要将其需要的内容设置即可。</p></li><li><p>方法中有一个参数为dataSource,当前Spring容器中已经创建了Druid数据源，类型刚好是DataSource类型，此时在初始化SqlSessionFactoryBean这个对象的时候，发现需要使用DataSource对象，而容器中刚好有这么一个对象，就自动加载了DruidDataSource对象。</p></li><li><p><code>sqlSessionFactory.setTypeAliasesPackage(&quot;com.blog.domain&quot;);</code>，替换掉配置文件中的</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.blog.domain&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>sqlSessionFactory.setDataSource(dataSource);</code>，替换掉配置文件中的</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>使用MapperScannerConfigurer加载Dao接口，创建代理对象保存到IOC容器中<br><a href="https://pic.imgdb.cn/item/631416a116f2c2beb1d64489.jpg"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"></a></p></li><li><p>这个MapperScannerConfigurer对象也是MyBatis提供的专用于整合的jar包中的类，用来处理原始配置文件中的mappers相关配置，加载数据层的Mapper接口类</p></li><li><p>MapperScannerConfigurer有一个核心属性basePackage，就是用来设置所扫描的包路径</p></li><li><p><code>步骤六：</code>主配置类中引入Mybatis配置类</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.blog&quot;)</span></span><br><span class="line"><span class="meta">@PropertySource(&quot;jdbc.properties&quot;)</span></span><br><span class="line"><span class="meta">@Import(&#123;JdbcConfig.class, MyBatisConfig.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤七：</code>编写运行类<br>在运行类中，从IOC容器中获取Service对象，调用方法获取结果</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> context.getBean(AccountService.class);</span><br><span class="line">        <span class="type">Account</span> <span class="variable">account</span> <span class="operator">=</span> accountService.findById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(account);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><code>步骤八：</code>运行程序</p><blockquote><p>Account{id=1, name=’Tom’, money=2800.0}</p></blockquote></li></ul><p>至此，Spring与Mybatis的整合就已经完成了，其中主要用到的两个类分别是:</p><ul><li>SqlSessionFactoryBean</li><li>MapperScannerConfigurer</li></ul><h3 id="Spring整合JUnit">Spring整合JUnit</h3><ul><li><code>步骤一：</code>引入依赖</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>步骤二：</code>编写测试类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置类运行器</span></span><br><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class="line"><span class="comment">//设置Spring环境对应的配置类</span></span><br><span class="line"><span class="meta">@ContextConfiguration(classes = &#123;SpringConfig.class&#125;)</span><span class="comment">//加载配置类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountServiceTest</span> &#123;</span><br><span class="line">    <span class="comment">//支持自动装配注入bean</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AccountService accountService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Account</span> <span class="variable">account</span> <span class="operator">=</span> accountService.findById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">selectAll</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;Account&gt; accounts = accountService.findAll();</span><br><span class="line">        System.out.println(accounts);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>注意:</strong></p><ul><li>单元测试，如果测试的是注解配置类，则使用<code>@ContextConfiguration(classes = 配置类.class)</code></li><li>单元测试，如果测试的是配置文件，则使用<code>@ContextConfiguration(locations=&#123;配置文件名,...&#125;)</code></li><li>Junit运行后是基于Spring环境运行的，所以Spring提供了一个专用的类运行器，这个务必要设置，这个类运行器就在Spring的测试专用包中提供的，导入的坐标就是这个东西<code>SpringJUnit4ClassRunner</code></li><li>上面两个配置都是固定格式，当需要测试哪个bean时，使用自动装配加载对应的对象，下面的工作就和以前做Junit单元测试完全一样了</li></ul><p>知识点1：<code>@RunWith</code></p><h1>AOP简介</h1><p>Spring有两个核心的概念，一个是<code>IOC/DI</code>，一个是<code>AOP</code>。</p><ul><li>前面学习的<code>IOC\DI</code>主要的内容是将对象的创建和管理交给了Spring容器，而<code>AOP</code>则是在不改变原有代码的基础上添加新的功能。</li></ul><h2 id="什么是AOP？">什么是AOP？</h2><ul><li><code>AOP(Aspect Oriented Programming)</code>面向切面编程，是一种编程范式，指导开发者如何组织程序结构</li></ul><h2 id="AOP核心概念">AOP核心概念</h2><ul><li>前面编写的BookDaoImpl类，设置了最简单的几个执行业务逻辑的代码，没有其他功能，现在体验一下使用AOP对代码进行升级</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//记录程序当前执行执行（开始时间）</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">//业务执行万次</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;<span class="number">10000</span>;i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//记录程序当前执行时间（结束时间）</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">//计算时间差</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">totalTime</span> <span class="operator">=</span> endTime-startTime;</span><br><span class="line">        <span class="comment">//输出信息</span></span><br><span class="line">        System.out.println(<span class="string">&quot;执行万次消耗时间：&quot;</span> + totalTime + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao update ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao delete ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">select</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao select ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码的内容很简单，就是测试一下万次执行的耗时<br>当在App类中从容器中获取bookDao对象后，分别执行其save,delete,update和select方法后会有如下的打印结果</p><div class="tabs" id="aop核心概念"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#aop核心概念-1">save</button></li><li class="tab"><button type="button" data-href="#aop核心概念-2">delete</button></li><li class="tab"><button type="button" data-href="#aop核心概念-3">update</button></li><li class="tab"><button type="button" data-href="#aop核心概念-4">select</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="aop核心概念-1"><blockquote><p>book dao save …<br>book dao save …<br>book dao save …<br>book dao save …<br>book dao save …<br>book dao save …<br>执行万次消耗时间:79ms</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="aop核心概念-2"><p>book dao delete …<br>book dao delete …<br>book dao delete …<br>book dao delete …<br>book dao delete …<br>book dao delete …<br>执行万次消耗时间:81ms</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="aop核心概念-3"><blockquote><p>book dao update …<br>book dao update …<br>book dao update …<br>book dao update …<br>book dao update …<br>book dao update …<br>执行万次消耗时间:63ms</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="aop核心概念-4"><blockquote><p>book dao select …</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info no-icon flat"><p>疑问</p><ul><li>对于计算万次执行消耗的时间只有save方法有，为什么delete和update方法也会有呢?</li><li>delete和update方法有，那为什么select方法为什么又没有呢?</li></ul></div><p>这个案例中使用的AOP使得在不改动原代码的前提下，增强了原代码的功能，这就是AOP<br>Spring是如何实现AOP的呢？</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://pic.imgdb.cn/item/63155fb516f2c2beb109d12c.jpg"/></div></div><ul><li><code>连接点(JoinPoint)</code>：程序执行过程中的任意位置，粒度为执行方法、抛出异常、设置变量等<ul><li>在SpringAOP中，理解为能够被增强的方法</li></ul></li><li><code>切入点(Pointcut):</code>真正要被增强的连接点<ul><li>在SpringAOP中，一个切入点可以描述一个具体方法，也可也匹配多个方法<ul><li>一个具体的方法:如com.blog.dao包下的BookDao接口中的无形参无返回值的save方法</li><li>匹配多个方法:所有的save方法/所有的get开头的方法/所有以Dao结尾的接口中的任意方法/所有带有一个参数的方法</li></ul></li><li>连接点范围比切入点范围大，是切入点的方法也一定是连接点，但是是连接点的方法不一定要被增强，所以可能不是切入点。</li></ul></li><li><code>通知(Advice):</code>在切入点处执行的操作，也就是要增加的共性功能<ul><li>在SpringAOP中，功能最终以方法的形式呈现</li></ul></li><li><code>通知类</code>：定义通知的类</li><li><code>切面(Aspect):</code>描述通知与切入点的对应关系。可以理解为切入点+通知</li></ul><h1>AOP入门案例</h1><div class="note info no-icon flat"><p>需求：在每个方法执行前添加一个功能：输出当前系统时间</p></div><h2 id="环境准备-9">环境准备</h2><ul><li>创建Maven项目，并导入Spring依赖</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>添加BookDao和BookDaoImpl类</li></ul><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">BookDao</button></li><li class="tab"><button type="button" data-href="#-2">BookDaoImpl</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookDao</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(System.currentTimeMillis());</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao save ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;book dao update ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>创建Spring依赖类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.blog&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>编写App运行类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> context.getBean(BookDao.class);</span><br><span class="line">        bookDao.update();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="AOP实现步骤">AOP实现步骤</h2><div class="note info no-icon flat"><p>需求分析：</p><ul><li>目前调用save方法，方法中能够输出当前系统时间，现在的目的是更新update方法，实现不改变update方法，添加打印时间的功能<br>思路分析：</li><li>导入坐标</li><li>制作连接点（原始操作，Dao接口和实现类）</li><li>制作共性功能（通知类和通知方法）</li><li>定义切入点</li><li>绑定切入点和通知的关系（切面）</li></ul></div><ul><li><code>步骤一：</code>添加依赖<br><code>spring-context</code>中已经导入了<code>spring-aop</code>,所以不需要再单独导入<code>spring-aop</code><br>导入<code>AspectJ</code>的jar包,AspectJ是AOP思想的一个具体实现，Spring有自己的AOP实现，但是相比于AspectJ来说比较麻烦，所以直接采用Spring整合ApsectJ的方式进行AOP开发。</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p><code>步骤二：</code>定义接口和实现类<br>准备环境的时候已经完成了</p></li><li><p><code>步骤三：</code>定义通知类和通知<br>通知就是将共性功能抽取出来后形成的方法，共性功能指的就是当前系统时间的打印。<br>类名和方法名没有要求，可以任意。</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(System.currentTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤四：</code>定义切入点<br>BookDaoImpl中有两个方法，分别是<code>update()</code>和<code>save()</code>，我们要增强的是update方法，那么该如何定义呢？</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(void com.blog.dao.impl.BookDaoImpl.update())&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(System.currentTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p><strong>说明:</strong></p><ul><li>切入点定义依托一个不具有实际意义的方法进行，即无参数、无返回值、方法体无实际逻辑。</li><li>execution及后面编写的内容，之后我们会专门去学习。</li></ul></div><ul><li><code>步骤五：</code>制作切面<br>切面是用来描述通知和切入点之间的关系，如何进行关系的绑定?</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(void com.blog.dao.BookDao.update())&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(System.currentTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>绑定切入点与通知关系，并指定通知添加到原始连接点的具体执行<code>位置</code></p><p><strong>说明:</strong><code>@Before</code>翻译过来是之前，也就是说通知会在切入点方法执行之前执行，除此之前还有其他四种类型，后面会讲。<br>那这里就会在执行update()之前，来执行我们的method()，输出当前毫秒值</p><ul><li><code>步骤六：</code>将通知类配给容器并标识其为切面类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(void com.blog.dao.impl.BookDaoImpl.update())&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(System.currentTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤七：</code>开启注解格式AOP功能<br>使用<code>@EnableAspectJAutoProxy</code>注解</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.blog&quot;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤八：</code>运行程序<br>这次我们再来调用update()</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> context.getBean(BookDao.class);</span><br><span class="line">        bookDao.update();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>控制台成功输出了当前毫秒值</p><blockquote><p>1662367945787<br>book dao update …</p></blockquote><div class="tabs" id="aop注解1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#aop注解1-1"><i class="EnableAspectJAutoProxy" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#aop注解1-2"><i class="Aspect" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#aop注解1-3"><i class="Before" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#aop注解1-4"><i class="Pointcut" style="text-align: center;"></i></button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="aop注解1-1"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@EnableAspectJAutoProxy</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">配置类注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">配置类定义上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">开启注解格式AOP功能</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="aop注解1-2"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@Aspect</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">类注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">切面类定义上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">设置当前类为AOP切面类</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="aop注解1-3"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@Before</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">方法注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">通知方法定义上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">设置当前通知方法与切入点之间的绑定关系，当前通知方法在原始切入点方法前运行</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="aop注解1-4"><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">@Pointcut</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">方法注解</td></tr><tr><td style="text-align:center">位置</td><td style="text-align:center">切入点方法定义上方</td></tr><tr><td style="text-align:center">作用</td><td style="text-align:center">设置切入点方法</td></tr><tr><td style="text-align:center">属性</td><td style="text-align:center">value（默认）：切入点表达式</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>AOP工作流程</h1><p>这一节我们主要讲解两个知识点:<code>AOP工作流程</code>和<code>AOP核心概念</code>。其中核心概念是对前面核心概念的补充。</p><h2 id="工作流程">工作流程</h2><p>AOP是基于Spring容器管理的bean做的增强，所以整个工作过程需要从Spring加载bean说起</p><ul><li><p>流程一：Spring容器启动</p><ul><li>容器启动就需要去加载bean,哪些类需要被加载呢?</li><li>需要被增强的类，如:BookServiceImpl</li><li>通知类，如:MyAdvice</li><li>注意此时bean对象还没有创建成功</li></ul></li><li><p>流程二：读取所有切面配置中的切入点</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(void com.blog.dao.impl.BookDaoImpl.save())&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">ptx</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(void com.blog.dao.impl.BookDaoImpl.update())&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(System.currentTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面这个例子中有两个切入点的配置，但是第一个<code>ptx()</code>并没有被使用(该切入点没有被任何通知使用)，所以不会被读取。</p><ul><li>流程三：初始化bean，判定bean对应的类中的方法是否匹配到任意切入点<ul><li>注意第一步在容器启动的时候，bean对象还没有被创建成功。</li><li>要被实例化bean对象的类中的方法和切入点进行匹配</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://pic.imgdb.cn/item/6315bf8416f2c2beb16ede79.jpg"/></div></div><ul><li><p>匹配失败，创建原始对象，如<code>UserDao</code></p><ul><li>匹配失败说明不需要增强，直接调用原始对象的方法即可。</li></ul></li><li><p>匹配成功，创建原始对象（<code>目标对象</code>）的<code>代理</code>对象，如:<code>BookDao</code></p><ul><li>匹配成功说明需要对其进行增强</li><li>对哪个类做增强，这个类对应的对象就叫做<code>目标对象</code></li><li>因为要对目标对象进行功能增强，而采用的技术是<code>动态代理</code>，所以会为其创建一个代理对象</li><li>最终运行的是代理对象的方法，在该方法中会对原始方法进行功能增强</li></ul></li><li><p>流程四：获取bean执行方法</p><ul><li>获取的bean是原始对象时，调用方法并执行，完成操作</li><li>获取的bean是代理对象时，根据代理对象的运行模式运行原始方法与增强的内容，完成操作</li></ul></li><li><p>下面我们来验证一下容器中是否为代理对象</p><ul><li>如果目标对象中的方法<code>会被增强</code>，那么容器中将存入的是目标对象的<code>代理对象</code></li><li>如果目标对象中的方法<code>不被增强</code>，那么容器中将存入的是目标<code>对象本身</code></li></ul></li><li><p><code>步骤一：</code>修改App运行类，获取类的类型并输出</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(SpringConfig.class);</span><br><span class="line">        <span class="type">BookDao</span> <span class="variable">bookDao</span> <span class="operator">=</span> context.getBean(BookDao.class);</span><br><span class="line">        System.out.println(bookDao);</span><br><span class="line">        System.out.println(bookDao.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤二：</code>修改MyAdvice类，改为不增强<br>将定义的切入点改为<code>updatexxx</code>，而BookDaoImpl类中不存在该方法，所以BookDao中的update方法在执行的时候，就不会被增强<br>所以此时容器中的对象应该是目标对象本身。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(void com.blog.dao.impl.BookDaoImpl.updatexxx())&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(System.currentTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><code>步骤三：</code>运行程序<br>输出结果如下，确实是目标对象本身，符合我们的预期</p><blockquote><p>com.blog.dao.impl.BookDaoImpl@bcec361<br>class com.blog.dao.impl.BookDaoImpl</p></blockquote></li><li><p><code>步骤四：</code>修改MyAdvice类，改为增强<br>将定义的切入点改为<code>update</code>，那么BookDao中的update方法在执行的时候，就会被增强<br>所以容器中的对象应该是目标对象的代理对象</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAdvice</span> &#123;</span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(void com.blog.dao.impl.BookDaoImpl.update())&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(System.currentTimeMillis());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>步骤五：</code>运行程序<br>结果如下</li></ul><blockquote><p>com.blog.dao.impl.BookDaoImpl@3d34d211<br>class com.sun.proxy.$Proxy19</p></blockquote><div class="note warning no-icon flat"><p><strong>注意</strong><br>不能直接打印对象，从上面两次结果中可以看出，直接打印对象走的是对象的toString方法，不管是不是代理对象，打印的结果都是一样的，原因是内部对toString方法进行了重写。</p></div><h2 id="AOP核心概念-2">AOP核心概念</h2><p>在上面介绍AOP的工作流程中，我们提到了两个核心概念，分别是:</p><ul><li><code>目标对象(Target)</code>：原始功能去掉共性功能对应的类产生的对象，这种对象是无法直接完成最终工作的</li><li><code>代理(Proxy)</code>：目标对象无法直接完成工作，需要对其进行功能回填，通过原始对象的代理对象实现</li></ul><p>简单来说,目标对象就是要增强的类<code>如:BookServiceImpl类</code>对应的对象，也叫原始对象，不能说它不能运行，只能说它在运行的过程中对于要增强的内容是缺失的。</p><p>SpringAOP是在不改变原有设计(代码)的前提下对其进行增强的，它的底层采用的是<code>代理模式</code>实现的，所以要对原始对象进行增强，就需要对原始对象创建代理对象，在代理对象中的方法把通知<code>如:MyAdvice中的method方法</code>内容加进去，就实现了增强，这就是我们所说的代理(Proxy)。</p><h1>AOP配置管理</h1><h2 id="AOP切入点表达式">AOP切入点表达式</h2><ul><li>在入门案例就已经用过切入点表达式了，此处具体学习</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;execution(void com.blog.dao.impl.BookDaoImpl.update())&quot;)</span></span><br></pre></td></tr></table></figure><p>对于AOP中切入点表达式，我们总共会学习三个内容，分别是<code>语法格式</code>、<code>通配符</code>和书写技巧。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;课程介绍&lt;/h1&gt;
&lt;div class=&quot;note info no-icon flat&quot;&gt;&lt;p&gt;Spring是一款功能强大的框架，主要优势是&lt;code&gt;简化开发&lt;/code&gt;和&lt;code&gt;框架整合&lt;/code&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;简化开</summary>
      
    
    
    
    
    <category term="Spring" scheme="https://silvan2077.github.io/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>Spring(3)</title>
    <link href="https://silvan2077.github.io/2025/10/03/Spring-Spring-3/"/>
    <id>https://silvan2077.github.io/2025/10/03/Spring-Spring-3/</id>
    <published>2025-10-03T06:58:27.256Z</published>
    <updated>2025-10-05T07:45:00.383Z</updated>
    
    <content type="html"><![CDATA[<h1>Spring Ioc注解式开发</h1><h2 id="回顾注解">回顾注解</h2><div class="note danger no-icon flat"><p>注解的存在主要是为了简化XML配置，方便开发。<strong>Spring6倡导全注解开发</strong></p></div><h3 id="注解怎么定义？注解的属性怎么定义？">注解怎么定义？注解的属性怎么定义？</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(value = &#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(value = RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Component &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>以上就是自定义了一个简单注解：<code>Component</code></li><li>该注解上修饰的注解包括：<code>Target注解</code>和<code>Retention注解</code>，这两个注解又称为<code>元注解</code>。<ul><li>Target注解来设置Component注解可以出现的位置，以上设置表示Component注解只能修饰类和接口上</li><li>Retention注解来设置Component注解的保留位置，以上设置表示Component注解保留在运行时，<br>可以通过反射读取到该注解。<ul><li>注解的属性怎么定义？</li></ul></li></ul></li><li>value是Component注解中的一个属性，该属性类型为String，属性名是value。</li></ul><h3 id="注解怎么使用？">注解怎么使用？</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(value = &quot;userBean&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注解用法简单，直接放在修饰的符号上<br>userBean为什么使用双引号括起来，因为value属性是String类型，字符串。<br>另外如果属性名是value，则在使用的时候可以省略属性名，例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Component(value = &quot;userBean&quot;)</span></span><br><span class="line"><span class="meta">@Component(&quot;userBean&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="怎么通过反射读取注解？">怎么通过反射读取注解？</h3><ul><li>写一段程序完成该功能：当Bean类上Component注解时，实例化Bean对象，如果没有则不实例化对象</li></ul><div class="tabs" id="通过反射读取注解"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#通过反射读取注解-1">有注解的Bean</button></li><li class="tab"><button type="button" data-href="#通过反射读取注解-2">无注解的Bean</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="通过反射读取注解-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;userBean&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="通过反射读取注解-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Vip</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>假设当前只知道包名，包下有多少个Bean类，哪些Bean有注解，哪些Bean没有注解都不知道。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 存放Bean的Map集合。key存储beanId。value存储Bean。</span></span><br><span class="line">        Map&lt;String,Object&gt; beanMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">packageName</span> <span class="operator">=</span> <span class="string">&quot;com.powernode.bean&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> packageName.replaceAll(<span class="string">&quot;\\.&quot;</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> ClassLoader.getSystemClassLoader().getResource(path);</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(url.getPath());</span><br><span class="line">        File[] files = file.listFiles();</span><br><span class="line">        Arrays.stream(files).forEach(f -&gt; &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> packageName + <span class="string">&quot;.&quot;</span> + f.getName().split(<span class="string">&quot;\\.&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Class&lt;?&gt; clazz = Class.forName(className);</span><br><span class="line">                <span class="keyword">if</span> (clazz.isAnnotationPresent(Component.class)) &#123;</span><br><span class="line">                    <span class="type">Component</span> <span class="variable">component</span> <span class="operator">=</span> clazz.getAnnotation(Component.class);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">beanId</span> <span class="operator">=</span> component.value();</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">bean</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">                    beanMap.put(beanId, bean);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        System.out.println(beanMap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="声明Bean的注解">声明Bean的注解</h2><p>负责声明Bean的注解，常见的包括四个：</p><ul><li>@Component</li><li>@Controller</li><li>@Service</li><li>@Repository</li></ul><div class="tabs" id="声明bean的注解"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#声明bean的注解-1">Component</button></li><li class="tab"><button type="button" data-href="#声明bean的注解-2">Contorller</button></li><li class="tab"><button type="button" data-href="#声明bean的注解-3">Service</button></li><li class="tab"><button type="button" data-href="#声明bean的注解-4">Repository</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="声明bean的注解-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(value = &#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(value = RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Component &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="声明bean的注解-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.springframework.stereotype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Documented;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.AliasFor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Controller &#123;</span><br><span class="line">    <span class="meta">@AliasFor(</span></span><br><span class="line"><span class="meta">        annotation = Component.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="声明bean的注解-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.springframework.stereotype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Documented;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.AliasFor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Service &#123;</span><br><span class="line">    <span class="meta">@AliasFor(</span></span><br><span class="line"><span class="meta">        annotation = Component.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="声明bean的注解-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.springframework.stereotype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Documented;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.AliasFor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Repository &#123;</span><br><span class="line">    <span class="meta">@AliasFor(</span></span><br><span class="line"><span class="meta">        annotation = Component.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note danger no-icon flat"><ul><li>从源码可以看到，<code>@Controller</code>、<code>@Service</code>、<code>@Repository</code>这三个注解都是<code>@Component</code>注解的别名，也就是这几个注解功能一样，用哪个都可以。</li><li>为了增强程序可读性，建议：<ul><li>控制器上使用<code>@Controller</code>注解</li><li>服务层上使用<code>@Service</code>注解</li><li>数据访问层上使用<code>@Repository</code>注解</li></ul></li><li>这几个注解都只有一个value属性，该属性值就是Bean的id,也就是Bean的名字。</li></ul></div><h2 id="Spring注解的使用">Spring注解的使用</h2><ul><li>如何使用前面的这几个注解呢？<ul><li>第一步：加入aop的依赖</li><li>第二步：在配置文件中添加context命名空间</li><li>第三步：在配置文件中指定扫描的包</li><li>第四步：在Bean类上使用注解</li></ul></li></ul><p><strong>第一步：加入aop的依赖</strong></p><p>当加入spring-context依赖之后，会关联加入aop的依赖。所以这一步不用做。</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003200001.png"/></div></div><p><strong>第二步：在配置文件中添加context命名空间</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>第三步：在配置文件中指定要扫描的包</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.powernode.spring6.bean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>第四步：在Bean类上使用注解</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(value = &quot;userBean&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="tabs" id="annotationtest"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#annotationtest-1">测试程序</button></li><li class="tab"><button type="button" data-href="#annotationtest-2">执行结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="annotationtest-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBean</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">userBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br><span class="line">        System.out.println(userBean);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="annotationtest-2"><p>执行结果：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003200138.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p><strong>如果注解的属性名是value，那么value是可以省略的。</strong></p><div class="tabs" id="示例"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#示例-1">示例1</button></li><li class="tab"><button type="button" data-href="#示例-2">示例2</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="示例-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(&quot;vipBean&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Vip</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="示例-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBean</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">        <span class="type">Vip</span> <span class="variable">vipBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;vipBean&quot;</span>, Vip.class);</span><br><span class="line">        System.out.println(vipBean);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note danger no-icon flat"><p><strong>如果把value属性彻底去掉，spring会被Bean自动取名吗？会的。并且默认名字的规律是：Bean类名首字母小写。</strong></p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BankDao</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>也就是说，这个BankDao的bean的名字为：bankDao<br>测试一下</p><div class="tabs" id="默认bean的名字"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#默认bean的名字-1">测试程序</button></li><li class="tab"><button type="button" data-href="#默认bean的名字-2">执行结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="默认bean的名字-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBean</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">        <span class="type">BankDao</span> <span class="variable">bankDao</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;bankDao&quot;</span>, BankDao.class);</span><br><span class="line">        System.out.println(bankDao);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="默认bean的名字-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003200244.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p><strong>如果是多个包怎么办？有两种解决方案：</strong></p><ul><li><strong>第一种：在配置文件中指定多个包，用逗号隔开。</strong></li><li><strong>第二种：指定多个包的共同父包。</strong></li></ul><p>先来测试一下逗号（英文）的方式：</p><div class="tabs" id="多个包"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#多个包-1">定义新的Bean类</button></li><li class="tab"><button type="button" data-href="#多个包-2">修改配置文件</button></li><li class="tab"><button type="button" data-href="#多个包-3">测试程序</button></li><li class="tab"><button type="button" data-href="#多个包-4">执行结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="多个包-1"><p>创建一个新的包：bean2，定义一个Bean类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Order</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="多个包-2"><p>配置文件修改：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.powernode.spring6.bean,com.powernode.spring6.bean2&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="多个包-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.powernode.spring6.bean.BankDao;</span><br><span class="line"><span class="keyword">import</span> com.powernode.spring6.bean2.Order;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBean</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line">        <span class="type">BankDao</span> <span class="variable">bankDao</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;bankDao&quot;</span>, BankDao.class);</span><br><span class="line">        System.out.println(bankDao);</span><br><span class="line">        <span class="type">Order</span> <span class="variable">order</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;order&quot;</span>, Order.class);</span><br><span class="line">        System.out.println(order);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="多个包-4"><p>执行结果：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003200334.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p><strong>指定共同的父包：</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.powernode.spring6&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>执行测试程序：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003200411.png"/></div></div><h2 id="选择性实例化Bean">选择性实例化Bean</h2><div class="note info no-icon flat"><p>假设在某个包下有许多Bean，有的Bean上标注了Component，有的标注了Controller，有的标注了Service，有的标注了Repository，现在由于某种特殊业务的需要，只允许其中所有的Controller参与Bean管理，其他的都不实例化。这应该怎么办呢？</p></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">A</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;A的无参数构造方法执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">B</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;B的无参数构造方法执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">C</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;C的无参数构造方法执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">D</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;D的无参数构造方法执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">E</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">E</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;E的无参数构造方法执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">F</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">F</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;F的无参数构造方法执行&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>想仅仅实例化Conroller层，应修改配置文件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.powernode.spring6.bean3&quot;</span> <span class="attr">use-default-filters</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><ul><li><code>use-default-filters=&quot;true&quot;</code> 表示：使用spring默认的规则，只要有Component、Controller、Service、Repository中的任意一个注解标注，则进行实例化。</li><li><code>use-default-filters=&quot;false&quot;</code> 表示：不再spring默认实例化规则，即使有Component、Controller、Service、Repository这些注解标注，也不再实例化。</li><li>&lt;context:include-filter type=“annotation” expression=“org.springframework.stereotype.Controller”/&gt; 表示只有Controller进行实例化。</li></ul></div><div class="tabs" id="选择性实例化bean"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#选择性实例化bean-1">测试程序</button></li><li class="tab"><button type="button" data-href="#选择性实例化bean-2">执行结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="选择性实例化bean-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testChoose</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-choose.xml&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="选择性实例化bean-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003200513.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>该方法是设置只有Controller进行实例化，也可以继续保持默认全部实例化，而将不需要的注解排除。</li></ul><div class="tabs" id="选择性实例化bean1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#选择性实例化bean1-1">配置文件</button></li><li class="tab"><button type="button" data-href="#选择性实例化bean1-2">测试结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="选择性实例化bean1-1"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.powernode.spring6.bean3&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Repository&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Service&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="选择性实例化bean1-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003200601.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="负责注入的注解">负责注入的注解</h2><p><code>@Component</code> <code>@Controller</code> <code>@Service</code> <code>@Repository</code>这四个注解是用来声明Bean的，声明后这些Bean将被实例化。而给Bean属性赋值需要用到这些注解：</p><ul><li><code>@Value</code></li><li><code>@Autowired</code></li><li><code>@Qualifier</code></li><li><code>@Resource</code></li></ul><h3 id="Value">@Value</h3><p>当属性的类型是简单类型时，可以直接使用<code>@Value</code>注解进行注入。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@Value(value = &quot;zhangsan&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Value(&quot;20&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><details class="folding-tag" cyan><summary> 开启包扫描 </summary>              <div class='content'>              <ul><li>使用注解声明Bean时必须要被Spring扫描到才能被Spring管理，因此<strong>必须在配置中写上包扫描</strong></li><li>属性注入时，只要是已经交给Spring管理的Bean就可以注入属性，<strong>不需要单独开启包扫描</strong></li><li><strong>严格来说，包扫描时为了找到并注册Bean，和@Value无关</strong></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.powernode.spring6.bean4&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>              </div>            </details><div class="tabs" id="@value"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#@value-1">测试程序</button></li><li class="tab"><button type="button" data-href="#@value-2">执行结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="@value-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testValue</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-injection.xml&quot;</span>);</span><br><span class="line">    <span class="type">Object</span> <span class="variable">user</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@value-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003200650.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>通过以上代码可以发现，即使没给属性提供<code>setter</code>方法，但仍然可以完成属性赋值。</p><p>如果提供setter方法，并且在setter方法上添加@Value注解，可以完成注入吗？尝试一下：</p><div class="tabs" id="@value1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#@value1-1">测试程序</button></li><li class="tab"><button type="button" data-href="#@value1-2">执行结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="@value1-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;李四&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;30&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@value1-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003200738.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>通过测试可以得知，@Value注解可以直接使用在属性上，也可以使用在setter方法上。都可以完成属性的赋值。</li><li>为了简化代码，以后我们一般不提供setter方法，直接在属性上使用@Value注解完成属性赋值。</li><li>出于好奇，我们再来测试一下，是否能够通过构造方法完成注入：</li></ul><div class="tabs" id="@value2"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#@value2-1">测试程序</button></li><li class="tab"><button type="button" data-href="#@value2-2">执行结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="@value2-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(<span class="meta">@Value(&quot;隔壁老王&quot;)</span> String name, <span class="meta">@Value(&quot;33&quot;)</span> <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@value2-2"><p>执行结果：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003200828.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note danger no-icon flat"><p><strong>通过测试得知：@Value注解可以出现在属性上、setter方法上、以及构造方法的形参上。可见Spring给我们提供了多样化的注入。</strong></p></div><h3 id="Autowired与-Qualifier">@Autowired与@Qualifier</h3><p>前面提到<code>@Value</code>可以注入<strong>简单类型</strong>，而<code>@Autowired</code>注解可以用来注入<strong>非简单类型</strong>。被翻译为：自动连线的，或者自动装配。单独使用<code>@Autowired</code>注解，<strong>默认根据类型装配</strong>。【默认是byType】</p><p>看一下它的源码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.CONSTRUCTOR, ElementType.METHOD, ElementType.PARAMETER, ElementType.FIELD, ElementType.ANNOTATION_TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Autowired &#123;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>源码中有两处需要注意：</p><ul><li>第一处：该注解可以标注在哪里？<ul><li>构造方法上</li><li>方法上</li><li>形参上</li><li>属性上</li><li>注解上</li></ul></li><li>第二处：该注解有一个required属性，默认值是true，表示**在注入的时候要求被注入的Bean必须是存在的，如果不存在则报错。**如果required属性设置为false，表示注入的Bean存在或者不存在都没关系，存在的话就注入，不存在的话，也不报错。</li></ul><p><strong>我们先在属性上使用@Autowired注解：</strong></p><div class="tabs" id="@autowired"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#@autowired-1">UserDao接口</button></li><li class="tab"><button type="button" data-href="#@autowired-2">UserDao实现类</button></li><li class="tab"><button type="button" data-href="#@autowired-3">配置文件</button></li><li class="tab"><button type="button" data-href="#@autowired-4">测试程序</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="@autowired-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@autowired-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span> <span class="comment">//纳入bean管理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoForMySQL</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;正在向mysql数据库插入User数据&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><!-- tab UserService --><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span> <span class="comment">// 纳入bean管理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span> <span class="comment">// 在属性上注入</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 没有提供构造方法和setter方法。</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@autowired-3"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.powernode.spring6.dao,com.powernode.spring6.service&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@autowired-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAutowired</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-injection.xml&quot;</span>);</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">    userService.save();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>以上构造方法和setter方法都没有提供，经过测试，仍然可以注入成功。</p><div class="note info no-icon flat"><p>在构造方法，set方法，形参上使用的验证方法一致，此处省略</p></div><ul><li>此时我们已经清楚<code>@Autowired注解</code>可以出现在哪些位置了。</li><li>@Autowired注解默认是<code>byType</code>进行注入的，也就是说根据类型注入的，如果以上程序中，UserDao接口还有另外一个实现类，会出现问题吗？</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span> <span class="comment">//纳入bean管理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoForOracle</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;正在向Oracle数据库插入User数据&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当写完这个新的实现类之后，此时IDEA工具已经提示错误信息了：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003200904.png"/></div></div><p>错误信息中说：不能装配，UserDao这个Bean的数量大于1.</p><p>怎么解决这个问题呢？<strong>这时候就要根据名称进行装配了。</strong></p><p><code>@Autowired注解</code>和<code>@Qualifier注解</code>联合起来才可以根据名称进行装配，在@Qualifier注解中指定Bean名称。</p><div class="tabs" id="@autowired与@qualifier"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#@autowired与@qualifier-1">UserService实现类</button></li><li class="tab"><button type="button" data-href="#@autowired与@qualifier-2">UserService</button></li><li class="tab"><button type="button" data-href="#@autowired与@qualifier-3">执行结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="@autowired与@qualifier-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span> <span class="comment">// 这里没有给bean起名，默认名字是：userDaoForOracle</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoForOracle</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;正在向Oracle数据库插入User数据&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@autowired与@qualifier-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;userDaoForOracle&quot;)</span> <span class="comment">// 这个是bean的名字。</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@autowired与@qualifier-3"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665564055076-ffda3ad0-f957-4216-bf6c-957d62724d5f.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_14%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10%2Fformat%2Cwebp"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note danger no-icon flat"><p><strong>- <code>@Autowired</code>注解可以出现在：属性上、构造方法上、构造方法的参数上、setter方法上。</strong><br><strong>- 当带参数的构造方法只有一个，<code>@Autowired</code>注解可以省略。</strong><br><strong>- <code>@Autowired</code>默认根据类型注入。如果要根据名称注入的话，需要配合<code>@Qualifier</code>一起使用。</strong></p></div><h2 id="Resource">@Resource</h2><p>@Resource注解也可以完成非简单类型注入。它和@Autowired注解有什么区别？</p><ul><li><strong>@Resource注解是JDK扩展包中的，也就是说属于JDK的一部分</strong>。所以该注解是标准注解，更加具有通用性。(JSR-250标准中制定的注解类型。JSR是Java规范提案。)</li><li><strong>@Autowired注解是Spring框架自己的。</strong></li><li><strong>@Resource注解默认根据名称装配byName，未指定name时，使用属性名作为name。</strong> 通过name找不到的话会自动启动通过类型byType装配。</li><li><strong>@Autowired注解默认根据类型装配byType</strong>。如果想根据名称装配，需要配合@Qualifier注解一起用。</li><li>@Resource注解用在属性上、setter方法上。</li><li>@Autowired注解用在属性上、setter方法上、构造方法上、构造方法参数上。</li><li></li></ul><div class="note info no-icon flat"><ul><li>@Resource注解属于JDK扩展包，所以不在JDK当中，需要额外引入以下依赖：【<strong>如果是JDK8的话不需要额外引入依赖。高于JDK11或低于JDK8需要引入以下依赖。</strong>】</li><li>需要注意的是，如果使用的是<code>Spring6</code>，要知道<code>Spring6</code>不再支持<code>JavaEE</code>，它支持的是<code>JakartaEE9</code>。（Oracle把JavaEE贡献给Apache了，Apache把JavaEE的名字改成JakartaEE了，大家之前所接触的所有的  javax.*  包名统一修改为  jakarta.*包名了。）</li></ul></div><div class="tabs" id="@resource"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#@resource-1">Spring6及以上版本使用此依赖</button></li><li class="tab"><button type="button" data-href="#@resource-2">Spring5及以下版本使用此依赖</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="@resource-1"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jakarta.annotation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.annotation-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@resource-2"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.annotation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.annotation-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>@Resource注解的源码如下：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003201345.png"/></div></div><details class="folding-tag" yellow><summary> 测试是否为根据Bean的Id进行装配 </summary>              <div class='content'>              <div class="tabs" id="@resource1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#@resource1-1">将该类名称改为xyz</button></li><li class="tab"><button type="button" data-href="#@resource1-2">按名称装配</button></li><li class="tab"><button type="button" data-href="#@resource1-3">测试结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="@resource1-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository(&quot;xyz&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoForOracle</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;正在向Oracle数据库插入User数据&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@resource1-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource(name = &quot;xyz&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@resource1-3"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003201531.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>              </div>            </details><details class="folding-tag" cyan><summary> 测试@Resource注解没有指定name时，如何查找 </summary>              <div class='content'>              <p><strong>把UserDaoForOracle的名字xyz修改为userDao，让这个Bean的名字和UserService类中的UserDao属性名一致：</strong></p><div class="tabs" id="@resource2"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#@resource2-1">UserDaoForOracle</button></li><li class="tab"><button type="button" data-href="#@resource2-2">UserService</button></li><li class="tab"><button type="button" data-href="#@resource2-3">测试结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="@resource2-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository(&quot;userDao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoForOracle</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;正在向Oracle数据库插入User数据&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@resource2-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="@resource2-3"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003201610.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note danger no-icon flat"><p>通过测试得知，当@Resource注解使用时没有指定name的时候，还是根据name进行查找，这个name是属性名。</p></div>              </div>            </details><p>接下来把UserService类中的属性名修改一下重新测试：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        userDao2.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003201703.png"/></div></div><p>根据异常信息得知：显然当通过name找不到的时候，自然会启动byType进行注入。以上的错误是因为UserDao接口下有两个实现类导致的。所以根据类型注入就会报错。</p><details class="folding-tag" red><summary> 测试@Resource注解使用在Setter方法上 </summary>              <div class='content'>              <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        userDao.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意这个setter方法的方法名，setUserDao去掉set之后，将首字母变小写userDao，userDao就是name</p><p>执行结果：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003202030.png"/></div></div>              </div>            </details><div class="note danger no-icon flat"><p><strong>一句话总结@Resource注解：默认<code>byName</code>注入，没有指定name时把属性名当做name，根据name找不到时，才会<code>byType</code>注入。byType注入时，某种类型的Bean只能有一个。</strong></p></div><h2 id="全注解式开发">全注解式开发</h2><p><strong>全注解开发就是不再使用spring配置文件了。写一个配置类来代替配置文件。</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.powernode.spring6.dao&quot;, &quot;com.powernode.spring6.service&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Spring6Configuration</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>不再使用配置文件，因此编写测试程序时，不再需要<code>new ClassPathXmlApplicationContext()</code>对象了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testNoXml</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(Spring6Configuration.class);</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">    userService.save();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>GoF之代理模式</h1><h2 id="对代理模式的理解">对代理模式的理解</h2><details class="folding-tag" yellow><summary> 举例 </summary>              <div class='content'>              <ul><li><strong>生活场景1</strong>：牛村的牛二看上了隔壁村小花，牛二不好意思直接找小花，于是牛二找来了媒婆王妈妈。这里面就有一个非常典型的代理模式。牛二不能和小花直接对接，只能找一个中间人。其中王妈妈是代理类，牛二是目标类。王妈妈代替牛二和小花先见个面。（现实生活中的婚介所）【在程序中，对象A和对象B无法直接交互时。】</li><li><strong>生活场景2</strong>：你刚到北京，要租房子，可以自己找，也可以找链家帮你找。其中链家是代理类，你是目标类。你们两个都有共同的行为：找房子。不过链家除了满足你找房子，另外会收取一些费用的。(现实生活中的房产中介)【在程序中，功能需要增强时。】</li><li><strong>西游记场景</strong>：八戒和高小姐的故事。八戒要强抢民女高翠兰。悟空得知此事之后怎么做的？悟空幻化成高小姐的模样。代替高小姐与八戒会面。其中八戒是客户端程序。悟空是代理类。高小姐是目标类。那天夜里，在八戒眼里，眼前的就是高小姐，对于八戒来说，他是不知道眼前的高小姐是悟空幻化的，在他内心里这就是高小姐。所以悟空代替高小姐和八戒亲了嘴儿。这是非常典型的代理模式实现的保护机制。</li></ul>              </div>            </details><p><strong>代理模式中有一个非常重要的特点：对于客户端程序来说，使用代理对象时就像在使用目标对象一样。</strong></p><p>代理模式是GoF23种设计模式之一。属于结构型设计模式。</p><p>代理模式的作用是：为其他对象提供一种代理以控制对这个对象的访问。在某些情况下，一个客户不想或者不能直接引用一个对象，此时可以通过一个称之为<code>代理</code>的第三者来实现间接引用。代理对象可以在客户端和目标对象之间起到中介的作用，并且可以通过代理对象去掉客户不应该看到的内容和服务或者添加客户需要的额外服务。 通过引入一个新的对象来实现对真实对象的操作或者将新的对象作为真实对象的一个替身，这种实现机制即为<code>代理模式</code>，通过引入代理对象来间接访问一个对象，这就是代理模式的模式动机。</p><p>代理模式中的角色：</p><ul><li><strong>代理类</strong></li><li><strong>目标类</strong></li><li><strong>代理类和目标类的公共接口</strong>：客户端在使用代理类时就像在使用目标类，不被客户端所察觉，所以代理类和目标类要有共同的行为，也就是<code>实现共同的接口</code>。</li></ul><p>代理模式的类图：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251005141658.png"/></div></div><div class="note info no-icon flat"><p>代理模式在代码实现上，包括两种形式：</p><ul><li>静态代理</li><li>动态代理</li></ul></div><h2 id="静态代理">静态代理</h2><p>现在有这样一个接口和实现类：</p><div class="tabs" id="静态代理"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#静态代理-1">接口</button></li><li class="tab"><button type="button" data-href="#静态代理-2">实现类</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="静态代理-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成订单</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查看订单详情</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">detail</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改订单</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">modify</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="静态代理-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1234</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单已生成&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">detail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">2541</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单信息如下：******&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modify</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1010</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单已修改&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>其中Thread.sleep()方法的调用是为了模拟操作耗时。</p><p>项目已上线，并且运行正常，但是客户反馈系统有一些地方运行较慢，要求项目组对系统进行优化。于是项目负责人就下达了这个需求。首先需要搞清楚是哪些业务方法耗时较长，于是让我们统计每个业务方法所耗费的时长。如果是你，你该怎么做呢？</p><details class="folding-tag" blue><summary> 第一种方案：直接修改Java源代码 </summary>              <div class='content'>              <ul><li>直接在每个业务方法中添加统计时间的逻辑</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1234</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单已生成&quot;</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗费时长&quot;</span>+(end - begin)+<span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">detail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">2541</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单信息如下：******&quot;</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗费时长&quot;</span>+(end - begin)+<span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modify</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1010</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单已修改&quot;</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗费时长&quot;</span>+(end - begin)+<span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>需求可以满足，但这样显然违背了OCP开闭原则。这种方案不可取。</p>              </div>            </details><details class="folding-tag" yellow><summary> 第二种方案：编写一个子类继承 </summary>              <div class='content'>              <ul><li>第二种方案：编写一个子类继承OrderServiceImpl，在子类中重写每个方法，代码如下：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceImplSub</span> <span class="keyword">extends</span> <span class="title class_">OrderServiceImpl</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="built_in">super</span>.generate();</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗时&quot;</span>+(end - begin)+<span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">detail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="built_in">super</span>.detail();</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗时&quot;</span>+(end - begin)+<span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modify</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="built_in">super</span>.modify();</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗时&quot;</span>+(end - begin)+<span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>这种方式可以解决，但是存在两个问题：</p><ul><li>第一个问题：假设系统中有100个这样的业务类，需要提供100个子类，并且之前写好的创建Service对象的代码，都要修改为创建子类对象。</li><li>第二个问题：由于采用了继承的方式，导致代码之间的耦合度较高。</li></ul></div>这种方案也不可取。              </div>            </details><ul><li>第三种方案：使用代理模式（采用静态代理）</li></ul><p>可以为OrderService接口提供一个代理类。</p><div class="tabs" id="静态代理1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#静态代理1-1">静态代理类</button></li><li class="tab"><button type="button" data-href="#静态代理1-2">客户端程序</button></li><li class="tab"><button type="button" data-href="#静态代理1-3">运行结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="静态代理1-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceProxy</span> <span class="keyword">implements</span> <span class="title class_">OrderService</span>&#123; <span class="comment">// 代理对象</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 目标对象</span></span><br><span class="line">    <span class="keyword">private</span> OrderService orderService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过构造方法将目标对象传递给代理对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">OrderServiceProxy</span><span class="params">(OrderService orderService)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.orderService = orderService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// 执行目标对象的目标方法</span></span><br><span class="line">        orderService.generate();</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗时&quot;</span>+(end - begin)+<span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">detail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// 执行目标对象的目标方法</span></span><br><span class="line">        orderService.detail();</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗时&quot;</span>+(end - begin)+<span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modify</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// 执行目标对象的目标方法</span></span><br><span class="line">        orderService.modify();</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗时&quot;</span>+(end - begin)+<span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="静态代理1-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 创建目标对象</span></span><br><span class="line">        <span class="type">OrderService</span> <span class="variable">target</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderServiceImpl</span>();</span><br><span class="line">        <span class="comment">// 创建代理对象</span></span><br><span class="line">        <span class="type">OrderService</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderServiceProxy</span>(target);</span><br><span class="line">        <span class="comment">// 调用代理对象的代理方法</span></span><br><span class="line">        proxy.generate();</span><br><span class="line">        proxy.modify();</span><br><span class="line">        proxy.detail();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="静态代理1-3"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251005143228.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info no-icon flat"><p>这种方式的优点：符合OCP开闭原则，同时采用的是关联关系，所以程序的耦合度较低。所以这种方案是被推荐的。</p></div><p>以上就是代理模式中的静态代理，其中<code>OrderService接口</code>是代理类和目标类的<code>共同接口</code>。OrderServiceImpl是目标类。OrderServiceProxy是代理类。</p><div class="note danger no-icon flat"><p>静态代理适合较小项目使用，如果项目较大，系统中业务接口很多，一个接口对应一个代理类，使用静态代理便需要创建很多代理类，造成<code>类爆炸</code>。而接下来的动态代理就可以解决该问题。</p></div><h2 id="动态代理">动态代理</h2><p>在程序运行阶段，在内存中动态生成代理类的字节码，被称为<code>动态代理</code>。<strong>动态代理能帮助我们减少代理类的数量。解决代码复用的问题</strong>。</p><p>在内存当中动态生成类的技术常见的包括：</p><ul><li><code>JDK动态代理技术</code>：<strong>只能代理接口。</strong></li><li><code>CGLIB动态代理技术</code>：CGLIB(Code Generation Library)是一个开源项目。是一个强大的，高性能，高质量的Code生成类库，它可以在运行期扩展Java类与实现Java接口。<strong>既可以代理接口，又可以代理类</strong>，<strong>底层是通过继承的方式实现的</strong>。性能比JDK动态代理要好。<strong>（底层有一个小而快的字节码处理框架ASM。）</strong></li><li>Javassist动态代理技术：Javassist是一个开源的分析、编辑和创建Java字节码的类库。是由东京工业大学的数学和计算机科学系的 Shigeru Chiba （千叶 滋）所创建的。它已加入了开放源代码JBoss 应用服务器项目，通过使用Javassist对字节码操作为JBoss实现动态&quot;AOP&quot;框架。</li></ul><h3 id="JDK动态代理">JDK动态代理</h3><p>还是使用静态代理中的例子：一个接口和一个实现类。</p><div class="tabs" id="jdk动态代理1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#jdk动态代理1-1">接口</button></li><li class="tab"><button type="button" data-href="#jdk动态代理1-2">实现类</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="jdk动态代理1-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成订单</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查看订单详情</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">detail</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改订单</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">modify</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="jdk动态代理1-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1234</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单已生成&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">detail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">2541</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单信息如下：******&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modify</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1010</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单已修改&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>在静态代理时，除了以上一个接口和一个实现类之外，要需要写一个代理类UserServiceProxy，而在动态代理中UserServiceProxy代理类可以动态生成。所以这个类不需要写。我们直接写客户端程序即可：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 第一步：创建目标对象</span></span><br><span class="line">        <span class="type">OrderService</span> <span class="variable">target</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderServiceImpl</span>();</span><br><span class="line">        <span class="comment">// 第二步：创建代理对象</span></span><br><span class="line">        <span class="type">OrderService</span> <span class="variable">orderServiceProxy</span> <span class="operator">=</span> Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(), 调用处理器对象);</span><br><span class="line">        <span class="comment">// 第三步：调用代理对象的代理方法</span></span><br><span class="line">        orderServiceProxy.detail();</span><br><span class="line">        orderServiceProxy.modify();</span><br><span class="line">        orderServiceProxy.generate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>OrderService orderServiceProxy = Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(), 调用处理器对象)</code>这行代码做了两件事：</p><ul><li>第一件事：在内存中生成了代理类的字节码</li><li>第二件事：创建代理对象</li></ul><p>Proxy类全名：java.lang.reflect.Proxy。这是JDK提供的一个类（所以称为JDK动态代理）。主要是通过这个类在内存中生成代理类的字节码。</p><p>其中newProxyInstance()方法有三个参数：</p><ul><li><strong>第一个参数：类加载器</strong>。在内存中生成了字节码，要想执行这个字节码，也是需要先把这个字节码加载到内存当中的。所以要指定使用哪个类加载器加载。</li><li><strong>第二个参数：接口类型</strong>。代理类和目标类实现相同的接口，所以要通过这个参数告诉JDK动态代理生成的类要实现哪些接口。</li><li><strong>第三个参数：调用处理器</strong>。这是一个JDK动态代理规定的接口，接口全名：java.lang.reflect.InvocationHandler。显然这是一个回调接口，也就是说调用这个接口中方法的程序已经写好了，就差这个接口的实现类了。</li></ul><p>所以接下来我们要写一下java.lang.reflect.InvocationHandler接口的实现类，并且实现接口中的方法，代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TimerInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>InvocationHandler接口中有一个方法invoke，这个invoke方法上有三个参数：</p><ul><li><strong>第一个参数：Object proxy。代理对象</strong>。设计这个参数只是为了后期的方便，如果想在invoke方法中使用代理对象的话，尽管通过这个参数来使用。</li><li><strong>第二个参数：Method method。目标方法</strong>。</li><li><strong>第三个参数：Object[] args。目标方法调用时要传的参数</strong>。</li></ul><p>我们想要调用目标对象的目标方法，首先需要有目标对象的存在，所以我们通过给TimerInvocationHandler类添加一个构造方法，将目标对象传给TimerInvocationHandler类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TimerInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line">    <span class="comment">// 目标对象</span></span><br><span class="line">    <span class="keyword">private</span> Object target;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过构造方法来传目标对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TimerInvocationHandler</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>有了目标对象我们就可以在invoke()方法中调用目标方法了。代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TimerInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line">    <span class="comment">// 目标对象</span></span><br><span class="line">    <span class="keyword">private</span> Object target;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通过构造方法来传目标对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TimerInvocationHandler</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">// 目标执行之前增强。</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// 调用目标对象的目标方法</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">retValue</span> <span class="operator">=</span> method.invoke(target, args);</span><br><span class="line">        <span class="comment">// 目标执行之后增强。</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗时&quot;</span>+(end - begin)+<span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">        <span class="comment">// 一定要记得返回哦。</span></span><br><span class="line">        <span class="keyword">return</span> retValue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>到此为止，调用处理器就完成了。接下来继续完善Client程序：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 创建目标对象</span></span><br><span class="line">        <span class="type">OrderService</span> <span class="variable">target</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderServiceImpl</span>();</span><br><span class="line">        <span class="comment">// 创建代理对象</span></span><br><span class="line">        <span class="type">OrderService</span> <span class="variable">orderServiceProxy</span> <span class="operator">=</span> (OrderService) Proxy.newProxyInstance(target.getClass().getClassLoader(),</span><br><span class="line">                                                                                target.getClass().getInterfaces(),</span><br><span class="line">                                                                                <span class="keyword">new</span> <span class="title class_">TimerInvocationHandler</span>(target));</span><br><span class="line">        <span class="comment">// 调用代理对象的代理方法</span></span><br><span class="line">        orderServiceProxy.detail();</span><br><span class="line">        orderServiceProxy.modify();</span><br><span class="line">        orderServiceProxy.generate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><ul><li>这样我们需要的几个类都写完了，但是发现这几个类都没有调用invoke方法，这是为什么？<ul><li>当我们调用代理对象的代理方法时，invoke方法就会被系统调用。</li></ul></li></ul></div><ul><li>折腾半天，这不还是要写接口的实现类，也没省什么劲呀，那还用什么动态代理呢？<ul><li>使用动态代理后无论多少Service接口，多少业务类，实现一个代理功能只需要写一次TimerInvocationHandler接口，使代码得到了复用，且防止类爆炸。</li></ul></li></ul><p>下面这段看上去很繁琐，可以提供一个工具类，封装一下下面的方法</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251005151907.png"/></div></div><p>我们可以提供一个工具类：ProxyUtil，封装一个方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyUtil</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">newProxyInstance</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(target.getClass().getClassLoader(), </span><br><span class="line">                target.getClass().getInterfaces(), </span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">TimerInvocationHandler</span>(target));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此时客户端代码就不需要写那么繁琐了：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 创建目标对象</span></span><br><span class="line">        <span class="type">OrderService</span> <span class="variable">target</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderServiceImpl</span>();</span><br><span class="line">        <span class="comment">// 创建代理对象</span></span><br><span class="line">        <span class="type">OrderService</span> <span class="variable">orderServiceProxy</span> <span class="operator">=</span> (OrderService) ProxyUtil.newProxyInstance(target);</span><br><span class="line">        <span class="comment">// 调用代理对象的代理方法</span></span><br><span class="line">        orderServiceProxy.detail();</span><br><span class="line">        orderServiceProxy.modify();</span><br><span class="line">        orderServiceProxy.generate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="CGLIB动态代理">CGLIB动态代理</h3><p>**CGLIB既可以代理接口，又可以代理类。**底层采用<code>继承</code>的方式实现。所以被代理的目标类不能使用final修饰。</p><p>使用CGLIB，需要引入它的依赖：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>准备一个没有实现接口的类，如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">login</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;用户正在登录系统....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logout</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;用户正在退出系统....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用CGLIB在内存中为UserService类生成代理类，并创建对象：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 创建字节码增强器</span></span><br><span class="line">        <span class="type">Enhancer</span> <span class="variable">enhancer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Enhancer</span>();</span><br><span class="line">        <span class="comment">// 告诉cglib要继承哪个类</span></span><br><span class="line">        enhancer.setSuperclass(UserService.class);</span><br><span class="line">        <span class="comment">// 设置回调接口</span></span><br><span class="line">        enhancer.setCallback(方法拦截器对象);</span><br><span class="line">        <span class="comment">// 生成源码，编译class，加载到JVM，并创建代理对象</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userServiceProxy</span> <span class="operator">=</span> (UserService)enhancer.create();</span><br><span class="line"></span><br><span class="line">        userServiceProxy.login();</span><br><span class="line">        userServiceProxy.logout();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>和<code>JDK动态代理</code>原理差不多，在<code>CGLIB</code>中需要提供的不是<code>InvocationHandler</code>，而是：<code>net.sf.cglib.proxy.MethodInterceptor</code></p><p>编写<code>MethodInterceptor</code>接口实现类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TimerMethodInterceptor</span> <span class="keyword">implements</span> <span class="title class_">MethodInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Object target, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>MethodInterceptor接口中有一个方法intercept()，该方法有4个参数：</p><ul><li>第一个参数：目标对象</li><li>第二个参数：目标方法</li><li>第三个参数：目标方法调用时的实参</li><li>第四个参数：代理方法</li></ul><p>在MethodInterceptor的intercept()方法中调用目标以及添加增强：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TimerMethodInterceptor</span> <span class="keyword">implements</span> <span class="title class_">MethodInterceptor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Object target, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">// 前增强</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">// 调用目标</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">retValue</span> <span class="operator">=</span> methodProxy.invokeSuper(target, objects);</span><br><span class="line">        <span class="comment">// 后增强</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗时&quot;</span> + (end - begin) + <span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">        <span class="comment">// 一定要返回</span></span><br><span class="line">        <span class="keyword">return</span> retValue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>写完回调后接下来修改客户端</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 创建字节码增强器</span></span><br><span class="line">        <span class="type">Enhancer</span> <span class="variable">enhancer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Enhancer</span>();</span><br><span class="line">        <span class="comment">// 告诉cglib要继承哪个类</span></span><br><span class="line">        enhancer.setSuperclass(UserService.class);</span><br><span class="line">        <span class="comment">// 设置回调接口</span></span><br><span class="line">        enhancer.setCallback(<span class="keyword">new</span> <span class="title class_">TimerMethodInterceptor</span>());</span><br><span class="line">        <span class="comment">// 生成源码，编译class，加载到JVM，并创建代理对象</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userServiceProxy</span> <span class="operator">=</span> (UserService)enhancer.create();</span><br><span class="line"></span><br><span class="line">        userServiceProxy.login();</span><br><span class="line">        userServiceProxy.logout();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于高版本的JDK，如果使用CGLIB，需要在启动项中添加两个启动参数：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251005152343.png"/></div></div><ul><li>–add-opens java.base/java.lang=ALL-UNNAMED</li><li>–add-opens java.base/sun.net.util=ALL-UNNAMED</li></ul><h1>面向切面编程AOP</h1><ul><li><code>AOP（Aspect Oriented Programming）</code>：面向切面编程，面向方</li><li>AOP是对OOP的补充延伸。</li><li>AOP底层使用的就是动态代理来实现的。</li></ul><div class="note info no-icon flat"><p>IoC使软件组件松耦合。AOP让你能够捕捉系统中经常使用的功能，把它转化成组件。</p></div><p>Spring的AOP使用的动态代理是：<code>JDK动态代理</code> + <code>CGLIB动态代理</code>。Spring在这两种动态代理中灵活切换，如果是代理接口，会默认使用JDK动态代理，如果要代理某个类，这个类没有实现接口，就会切换使用CGLIB。当然，你也可以强制通过一些配置让Spring只使用CGLIB。</p><h2 id="AOP介绍">AOP介绍</h2><p>一般一个系统当中都会有一些系统服务，例如：日志、事务管理、安全等。这些系统服务被称为：<strong><code>交叉业务</code></strong></p><p>这些<strong>交叉业务</strong>几乎是通用的，不管是做银行账户转账，还是删除用户数据。日志、事务管理、安全，这些都是需要做的。</p><p>如果每一个业务处理过程中，都需要掺杂这些交叉业务代码进去的话，存在两方面问题：</p><ul><li>第一：交叉业务代码在多个业务流程中反复出现，代码没有得到复用，且修改业务代码需要多处修改</li><li>第二：程序员无法专注核心业务代码的编写，在编写核心业务代码的同时还需要处理这些交叉业务。</li></ul><p>使用AOP可以很轻松的解决以上问题。</p><p>快速理解AOP的思想：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251003211132.png"/></div></div><p><strong>用一句话总结AOP：将与核心业务无关的代码独立的抽取出来，形成一个独立的组件，然后以横向交叉的方式应用到业务流程当中的过程被称为AOP。</strong></p><div class="note danger no-icon flat"><p><strong>AOP的优点：</strong></p><ul><li><strong>第一：代码复用性增强。</strong></li><li><strong>第二：代码易维护。</strong></li><li><strong>第三：使开发者更关注业务逻辑。</strong></li></ul></div><h2 id="AOP的七大术语">AOP的七大术语</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span>&#123;</span><br><span class="line">     <span class="comment">//连接点 Joinpoint</span></span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">do1</span><span class="params">()</span>&#123;   <span class="comment">//切点 Pointcut</span></span><br><span class="line">        System.out.println(<span class="string">&quot;do 1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">do2</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;do 2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">do3</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;do 3&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">do4</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;do 4&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">do5</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;do 5&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 核心业务方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">()</span>&#123;</span><br><span class="line">        do1();</span><br><span class="line">        do2();</span><br><span class="line">        do3();</span><br><span class="line">        do5();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>连接点 Joinpoint</strong><ul><li>在程序的整个执行流程中，<strong>可以织入</strong>切面的位置。方法的执行前后，异常抛出之后等位置。</li></ul></li><li><strong>切点 Pointcut</strong><ul><li>在程序执行流程中，<strong>真正织入</strong>切面的方法。（一个切点对应多个连接点）</li></ul></li><li><strong>通知 Advice</strong><ul><li>通知又叫增强，就是具体你要织入的代码。</li><li>通知包括：<ul><li>前置通知</li><li>后置通知</li><li>环绕通知</li><li>异常通知</li><li>最终通知</li></ul></li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251005152720.png"/></div></div><ul><li><p><strong>切面 Aspect</strong></p><ul><li><strong>切点 + 通知就是切面。</strong></li></ul></li><li><p>织入 Weaving</p><ul><li>把通知应用到目标对象上的过程。</li></ul></li><li><p>代理对象 Proxy</p><ul><li>一个目标对象被织入通知后产生的新对象。</li></ul></li><li><p>目标对象 Target</p><ul><li>被织入通知的对象。</li></ul></li></ul><p>通过下图，大家可以很好的理解AOP的相关术语：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20251005152825.png"/></div></div><h2 id="切点表达式">切点表达式</h2><p>切点表达式用来定义<code>通知（Advice）</code>往哪些方法上切入。</p><p>切入点表达式语法格式：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution([访问控制权限修饰符] 返回值类型 [全限定类名]方法名(形式参数列表) [异常])</span><br></pre></td></tr></table></figure><p>访问控制权限修饰符：</p><ul><li>可选项。</li><li>没写，就是4个权限都包括。</li><li>写public就表示只包括公开的方法。</li></ul><p>返回值类型：</p><ul><li>必填项。</li><li>* 表示返回值类型任意。</li></ul><p>全限定类名：</p><ul><li>可选项。</li><li>两个点“…”代表当前包以及子包下的所有类。</li><li>省略时表示所有的类。</li></ul><p>方法名：</p><ul><li>必填项。</li><li>*表示所有方法。</li><li>set*表示所有的set方法。</li></ul><p>形式参数列表：</p><ul><li>必填项</li><li>() 表示没有参数的方法</li><li>(…) 参数类型和个数随意的方法</li><li>(*) 只有一个参数的方法</li><li>(*, String) 第一个参数类型随意，第二个参数是String的。</li></ul><p>异常：</p><ul><li>可选项。</li><li>省略时表示任意异常类型。</li></ul><p>理解以下的切点表达式：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// service包下所有的类中以delete开始的所有方法</span></span><br><span class="line">execution(<span class="keyword">public</span> * com.powernode.mall.service.*.delete*(..))</span><br><span class="line"><span class="comment">// mall包下所有的类的所有的方法</span></span><br><span class="line">execution(* com.powernode.mall..*(..))</span><br><span class="line"><span class="comment">// 所有类的所有方法</span></span><br><span class="line">execution(* *(..))</span><br></pre></td></tr></table></figure><h2 id="使用Spring的AOP">使用Spring的AOP</h2><p>Spring对AOP的实现包括以下3种方式：</p><ul><li><strong>第一种方式：Spring框架结合AspectJ框架实现的AOP，基于注解方式。</strong></li><li><strong>第二种方式：Spring框架结合AspectJ框架实现的AOP，基于XML方式。</strong></li><li>第三种方式：Spring框架自己实现的AOP，基于XML配置方式。</li></ul><p>实际开发中，都是<code>Spring+AspectJ</code>来实现AOP。所以重点学习第一种和第二种方式。</p><div class="note info no-icon flat"><ul><li>什么是AspectJ？<ul><li>AspectJ是一个支持AOP的框架。AspectJ框架是独立于Spring框架之外一个框架。</li></ul></li></ul></div><h3 id="准备工作">准备工作</h3><p>使用Spring+AspectJ的AOP需要引入的依赖如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--spring context依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.0-M2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--spring aop依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.0-M2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--spring aspects依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.0-M2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Spring配置文件中添加context命名空间和aop命名空间</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="基于AspectJ的AOP注解式开发">基于AspectJ的AOP注解式开发</h3><h4 id="实现步骤">实现步骤</h4><p>第一步：定义目标类以及目标方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 目标类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="comment">// 目标方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单已生成！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第二步：定义切面类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 切面类</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第三步：目标类和切面类都纳入spring bean管理<br>在目标类OrderService上添加 <strong>@Component</strong>注解。<br>在切面类MyAspect类上添加 <strong>@Component</strong>注解。</p><p>第四步：在spring配置文件中添加组建扫描</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--开启组件扫描--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.powernode.spring6.service&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>第五步：在切面类中添加通知</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 切面类</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line">    <span class="comment">// 这就是需要增强的代码（通知）</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">advice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;我是一个通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第六步：在通知上添加切点表达式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 切面类</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 切点表达式</span></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="comment">// 这就是需要增强的代码（通知）</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">advice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;我是一个通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>注解@Before表示前置通知。</strong></p><p>第七步：在spring配置文件中启用自动代理</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--开启组件扫描--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.powernode.spring6.service&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--开启自动代理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span> <span class="attr">proxy-target-class</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&lt;aop:aspectj-autoproxy  proxy-target-class=“true”/&gt; 开启自动代理之后，凡事带有@Aspect注解的bean都会生成代理对象。</p><div class="note info no-icon flat"><p>proxy-target-class=“true” 表示采用cglib动态代理。<br>proxy-target-class=“false” 表示采用jdk动态代理。默认值是false。即使写成false，当没有接口的时候，也会自动选择cglib生成代理类。</p></div><p>测试程序：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.test;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AOPTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAOP</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-aspectj-aop-annotation.xml&quot;</span>);</span><br><span class="line">        <span class="type">OrderService</span> <span class="variable">orderService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;orderService&quot;</span>, OrderService.class);</span><br><span class="line">        orderService.generate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><p><img src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665843923087-e1116f09-2470-46cb-b21a-1526f62cab50.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_15%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p><h4 id="通知类型">通知类型</h4><p>通知类型包括：</p><ul><li>前置通知：@Before 目标方法执行之前的通知</li><li>后置通知：@AfterReturning 目标方法执行之后的通知</li><li>环绕通知：@Around 目标方法之前添加通知，同时目标方法执行之后添加通知。</li><li>异常通知：@AfterThrowing 发生异常之后执行的通知</li><li>最终通知：@After 放在finally语句块中的通知</li></ul><p>接下来，编写程序来测试这几个通知的执行顺序：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 切面类</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕通知开始&quot;</span>);</span><br><span class="line">        <span class="comment">// 执行目标方法。</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕通知结束&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;前置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturningAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;后置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowingAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;异常通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;最终通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">package</span> com.powernode.spring6.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 目标类</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="comment">// 目标方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单已生成！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">package</span> com.powernode.spring6.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.powernode.spring6.service.OrderService;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AOPTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAOP</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-aspectj-aop-annotation.xml&quot;</span>);</span><br><span class="line">        <span class="type">OrderService</span> <span class="variable">orderService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;orderService&quot;</span>, OrderService.class);</span><br><span class="line">        orderService.generate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><p><img src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665892617792-22cc74a2-6876-4cd1-bb17-87d3b5211cae.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_19%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p><p>通过上面的执行结果就可以判断他们的执行顺序了，这里不再赘述。</p><p>结果中没有异常通知，这是因为目标程序执行过程中没有发生异常。我们尝试让目标方法发生异常：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 目标类</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="comment">// 目标方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;订单已生成！&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;模拟异常发生&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再次执行测试程序，结果如下：</p><p><img src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665892847715-75045cd0-63b1-47f9-a77e-05911dc72339.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_24%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p><p>通过测试得知，当发生异常之后，最终通知也会执行，因为最终通知@After会出现在finally语句块中。</p><p>出现异常之后，<strong>后置通知</strong>和<strong>环绕通知的结束部分</strong>不会执行。</p><h4 id="切面的先后顺序">切面的先后顺序</h4><p>我们知道，业务流程当中不一定只有一个切面，可能有的切面控制事务，有的记录日志，有的进行安全控制，如果多个切面的话，顺序如何控制：<strong>可以使用@Order注解来标识切面类，为@Order注解的value指定一个整数型的数字，数字越小，优先级越高</strong>。</p><p>再定义一个切面类，如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.Order;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Order(1)</span> <span class="comment">//设置优先级</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">YourAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspect环绕通知开始&quot;</span>);</span><br><span class="line">        <span class="comment">// 执行目标方法。</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspect环绕通知结束&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspect前置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturningAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspect后置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowingAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspect异常通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;YourAspect最终通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">package</span> com.powernode.spring6.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.Order;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 切面类</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Order(2)</span> <span class="comment">//设置优先级</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕通知开始&quot;</span>);</span><br><span class="line">        <span class="comment">// 执行目标方法。</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕通知结束&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;前置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturningAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;后置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowingAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;异常通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;最终通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行测试程序：</p><p><img src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665893738167-b3c55a19-6129-4615-813f-9b8dc0f17f40.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_28%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p><p>通过修改@Order注解的整数值来切换顺序，执行测试程序：</p><p><img src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665893833282-2cbc59cc-15a5-44c4-bb20-cbdac65a750d.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_28%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p><h4 id="优化使用切点表达式">优化使用切点表达式</h4><p>观看以下代码中的切点表达式：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.Order;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 切面类</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Order(2)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕通知开始&quot;</span>);</span><br><span class="line">        <span class="comment">// 执行目标方法。</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕通知结束&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;前置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturningAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;后置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowingAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;异常通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;最终通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>缺点是：</p><ul><li>第一：切点表达式重复写了多次，没有得到复用。</li><li>第二：如果要修改切点表达式，需要修改多处，难维护。</li></ul><p>可以这样做：将切点表达式单独的定义出来，在需要的位置引入即可。如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.annotation.Order;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 切面类</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Order(2)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.powernode.spring6.service.OrderService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointcut</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕通知开始&quot;</span>);</span><br><span class="line">        <span class="comment">// 执行目标方法。</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕通知结束&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;前置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturningAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;后置通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowingAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;异常通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterAdvice</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;最终通知&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用@Pointcut注解来定义独立的切点表达式。</p><p>注意这个@Pointcut注解标注的方法随意，只是起到一个能够让@Pointcut注解编写的位置。</p><p>执行测试程序：</p><p><img src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665893833282-2cbc59cc-15a5-44c4-bb20-cbdac65a750d.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_28%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p><h4 id="全注解式开发AOP">全注解式开发AOP</h4><p>就是编写一个类，在这个类上面使用大量注解来代替spring的配置文件，spring配置文件消失了，如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.EnableAspectJAutoProxy;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.powernode.spring6.service&quot;)</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy(proxyTargetClass = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Spring6Configuration</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试程序也变化了：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAOPWithAllAnnotation</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(Spring6Configuration.class);</span><br><span class="line">    <span class="type">OrderService</span> <span class="variable">orderService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;orderService&quot;</span>, OrderService.class);</span><br><span class="line">    orderService.generate();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果如下：</p><p><img src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665893833282-2cbc59cc-15a5-44c4-bb20-cbdac65a750d.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_28%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p><h3 id="15-4-3-基于XML配置方式的AOP（了解）">15.4.3 基于XML配置方式的AOP（了解）</h3><p>第一步：编写目标类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.service;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 目标类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VipService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;保存vip信息。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第二步：编写切面类，并且编写通知</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 负责计时的切面类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TimerAspect</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">time</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="comment">//执行目标</span></span><br><span class="line">        proceedingJoinPoint.proceed();</span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;耗时&quot;</span>+(end - begin)+<span class="string">&quot;毫秒&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第三步：编写spring配置文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--纳入spring bean管理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;vipService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.service.VipService&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;timerAspect&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.service.TimerAspect&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--aop配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--切点表达式--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;p&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* com.powernode.spring6.service.VipService.*(..))&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--切面--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;timerAspect&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--切面=通知 + 切点--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">&quot;time&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;p&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>测试程序：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.powernode.spring6.service.VipService;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AOPTest3</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testAOPXml</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring-aop-xml.xml&quot;</span>);</span><br><span class="line">        <span class="type">VipService</span> <span class="variable">vipService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;vipService&quot;</span>, VipService.class);</span><br><span class="line">        vipService.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><p><img src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665902800121-49540c48-d6c2-4909-874d-e1a485e67ea5.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_23%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p><h2 id="15-5-AOP的实际案例：事务处理">15.5 AOP的实际案例：事务处理</h2><p>项目中的事务控制是在所难免的。在一个业务流程当中，可能需要多条DML语句共同完成，为了保证数据的安全，这多条DML语句要么同时成功，要么同时失败。这就需要添加事务控制的代码。例如以下伪代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">class 业务类<span class="number">1</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 业务方法<span class="number">1</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 开启事务</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 执行核心业务逻辑</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 提交事务</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// 回滚事务</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 业务方法<span class="number">2</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 开启事务</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 执行核心业务逻辑</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 提交事务</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// 回滚事务</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 业务方法<span class="number">3</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 开启事务</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 执行核心业务逻辑</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 提交事务</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// 回滚事务</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class 业务类<span class="number">2</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 业务方法<span class="number">1</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 开启事务</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 执行核心业务逻辑</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 提交事务</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// 回滚事务</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 业务方法<span class="number">2</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 开启事务</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 执行核心业务逻辑</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 提交事务</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// 回滚事务</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 业务方法<span class="number">3</span>()&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">// 开启事务</span></span><br><span class="line">            startTransaction();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 执行核心业务逻辑</span></span><br><span class="line">            step1();</span><br><span class="line">            step2();</span><br><span class="line">            step3();</span><br><span class="line">            ....</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 提交事务</span></span><br><span class="line">            commitTransaction();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">// 回滚事务</span></span><br><span class="line">            rollbackTransaction();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//......</span></span><br></pre></td></tr></table></figure><p>可以看到，这些业务类中的每一个业务方法都是需要控制事务的，而控制事务的代码又是固定的格式，都是：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="comment">// 开启事务</span></span><br><span class="line">    startTransaction();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行核心业务逻辑</span></span><br><span class="line">    <span class="comment">//......</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提交事务</span></span><br><span class="line">    commitTransaction();</span><br><span class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">    <span class="comment">// 回滚事务</span></span><br><span class="line">    rollbackTransaction();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个控制事务的代码就是和业务逻辑没有关系的“<strong>交叉业务</strong>”。以上伪代码当中可以看到这些交叉业务的代码没有得到复用，并且如果这些交叉业务代码需要修改，那必然需要修改多处，难维护，怎么解决？可以采用AOP思想解决。可以把以上控制事务的代码作为环绕通知，切入到目标类的方法当中。接下来我们做一下这件事，有两个业务类，如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.biz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="comment">// 业务类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountService</span> &#123;</span><br><span class="line">    <span class="comment">// 转账业务方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transfer</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;正在进行银行账户转账&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 取款业务方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">withdraw</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;正在进行取款操作&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">package</span> com.powernode.spring6.biz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="comment">// 业务类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="comment">// 生成订单</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">generate</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;正在生成订单&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 取消订单</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cancel</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;正在取消订单&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意，以上两个业务类已经纳入spring bean的管理，因为都添加了@Component注解。</p><p>接下来我们给以上两个业务类的4个方法添加事务控制代码，使用AOP来完成：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.biz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="comment">// 事务切面类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TransactionAspect</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.powernode.spring6.biz..*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;开启事务&quot;</span>);</span><br><span class="line">            <span class="comment">// 执行目标</span></span><br><span class="line">            proceedingJoinPoint.proceed();</span><br><span class="line">            System.out.println(<span class="string">&quot;提交事务&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;回滚事务&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>你看，这个事务控制代码是不是只需要写一次就行了，并且修改起来也没有成本。编写测试程序：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.powernode.spring6.biz.AccountService;</span><br><span class="line"><span class="keyword">import</span> com.powernode.spring6.biz.OrderService;</span><br><span class="line"><span class="keyword">import</span> com.powernode.spring6.service.Spring6Configuration;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AOPTest2</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testTransaction</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(Spring6Configuration.class);</span><br><span class="line">        <span class="type">OrderService</span> <span class="variable">orderService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;orderService&quot;</span>, OrderService.class);</span><br><span class="line">        <span class="type">AccountService</span> <span class="variable">accountService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;accountService&quot;</span>, AccountService.class);</span><br><span class="line">        <span class="comment">// 生成订单</span></span><br><span class="line">        orderService.generate();</span><br><span class="line">        <span class="comment">// 取消订单</span></span><br><span class="line">        orderService.cancel();</span><br><span class="line">        <span class="comment">// 转账</span></span><br><span class="line">        accountService.transfer();</span><br><span class="line">        <span class="comment">// 取款</span></span><br><span class="line">        accountService.withdraw();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><p><img src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665899075177-6660d491-06d4-4296-b69a-b54716179c9d.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_24%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="img"></p><p>通过测试可以看到，所有的业务方法都添加了事务控制的代码。</p><h2 id="15-6-AOP的实际案例：安全日志">15.6 AOP的实际案例：安全日志</h2><p>需求是这样的：项目开发结束了，已经上线了。运行正常。客户提出了新的需求：凡事在系统中进行修改操作的，删除操作的，新增操作的，都要把这个人记录下来。因为这几个操作是属于危险行为。例如有业务类和业务方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.biz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="comment">//用户业务</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;获取用户信息&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;保存用户&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteUser</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;删除用户&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modifyUser</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;修改用户&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.biz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 商品业务类</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProductService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getProduct</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;获取商品信息&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveProduct</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;保存商品&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteProduct</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;删除商品&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modifyProduct</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;修改商品&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意：已经添加了@Component注解。</p><p>接下来我们使用aop来解决上面的需求：编写一个负责安全的切面类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.biz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SecurityAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.powernode.spring6.biz..save*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">savePointcut</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.powernode.spring6.biz..delete*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deletePointcut</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.powernode.spring6.biz..modify*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modifyPointcut</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;savePointcut() || deletePointcut() || modifyPointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeAdivce</span><span class="params">(JoinPoint joinpoint)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;XXX操作员正在操作&quot;</span>+joinpoint.getSignature().getName()+<span class="string">&quot;方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSecurity</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(Spring6Configuration.class);</span><br><span class="line">    <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">    <span class="type">ProductService</span> <span class="variable">productService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;productService&quot;</span>, ProductService.class);</span><br><span class="line">    userService.getUser();</span><br><span class="line">    userService.saveUser();</span><br><span class="line">    userService.deleteUser();</span><br><span class="line">    userService.modifyUser();</span><br><span class="line">    productService.getProduct();</span><br><span class="line">    productService.saveProduct();</span><br><span class="line">    productService.deleteProduct();</span><br><span class="line">    productService.modifyProduct();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Spring Ioc注解式开发&lt;/h1&gt;
&lt;h2 id=&quot;回顾注解&quot;&gt;回顾注解&lt;/h2&gt;
&lt;div class=&quot;note danger no-icon flat&quot;&gt;&lt;p&gt;注解的存在主要是为了简化XML配置，方便开发。&lt;strong&gt;Spring6倡导全注解开发&lt;/str</summary>
      
    
    
    
    
    <category term="Java" scheme="https://silvan2077.github.io/tags/Java/"/>
    
    <category term="Spring" scheme="https://silvan2077.github.io/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot核心机制</title>
    <link href="https://silvan2077.github.io/2025/10/02/Springboot-SpringBoot%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6/"/>
    <id>https://silvan2077.github.io/2025/10/02/Springboot-SpringBoot%E6%A0%B8%E5%BF%83%E6%9C%BA%E5%88%B6/</id>
    <published>2025-10-02T03:50:41.221Z</published>
    <updated>2025-10-03T05:53:13.379Z</updated>
    
    <content type="html"><![CDATA[<h1>为什么以继承的方式引入SpringBoot</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="作为父项目和作为依赖的区别：">作为父项目和作为依赖的区别：</h2><p><strong>继承父工程的优势:</strong></p><ul><li><code>依赖管理</code>：可以在父工程中定义依赖的版本，子模块可以直接引用而不必指定版本号。</li><li><code>插件管理</code>：可以在父工程中配置常用的插件及其版本，子模块可以直接使用这些配置。</li><li><code>属性设置</code>：可以在父工程中定义一些通用的属性，如项目编码、Java 版本等。</li><li><code>统一配置</code>：可以统一多个子模块的构建配置，确保一致性。</li></ul><p><strong>直接引入依赖的局限性</strong>（如果你不使用继承父工程的方式，而是通过直接引入依赖的方式来管理项目，那么你将失去上述的一些优势）</p><ul><li><code>依赖版本管理</code>：每个子模块都需要单独指定依赖的版本，这会导致大量的重复配置，并且难以维护。</li><li><code>插件配置</code>：每个子模块都需要单独配置插件及其版本，无法共享父工程中的插件配置。</li><li><code>属性设置</code>：每个子模块都需要单独设置通用的属性，如项目编码、Java 版本等。</li><li><code>构建配置</code>：每个子模块的构建配置需要单独维护，难以保证一致性。</li></ul><div class="note info no-icon flat"><p><strong>总结：选择哪种方式取决于你的具体需求。</strong></p><ul><li><strong>如果你希望多个项目之间共享构建配置，那么使用父项目是一个好的选择；</strong></li><li><strong>如果你只是想在项目之间共享代码，那么应该使用依赖关系。</strong></li></ul></div><p><strong>Spring Boot预先对开发中需要用到的依赖进行了版本的统一管理。我们需要和SpringBoot框架共享这个构建配置。因此官方推荐使用继承的方式引入SpringBoot框架。</strong></p><h2 id="依赖统一管理的好处">依赖统一管理的好处</h2><p>Spring Boot 框架的一个重要特性就是<code>简化项目依赖管理</code>。它通过提供一个叫做<code>依赖管理</code>的功能来帮助开发者更容易地管理和使用第三方库和其他Spring组件。具体来说，SpringBoot 提供了一个包含多个Spring和其他常用库的依赖版本配置文件（通常是在 <code>spring-boot-dependencies</code> 文件中），这使得开<strong>发者不需要在自己的项目中显式指定这些依赖的版本号</strong>。</p><p>这样做有以下几个好处：</p><ul><li><strong>简化依赖声明</strong>：<br>开发者只需要在 <code>pom.xml</code> 文件中声明需要的依赖而不需要指定其版本号，因为 Spring Boot 已经为这些依赖指定了版本。例如，如果你需要使用mysql驱动，你只需要添加相应的依赖声明而不需要关心版本。</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><strong>避免版本冲突</strong>：<br>当多个库之间存在依赖关系的时候，如果手动管理版本可能会导致版本之间的冲突（即“依赖地狱”）。Spring Boot 提供的统一版本管理可以减少这种冲突的可能性。</li><li><strong>易于升级</strong>：<br>当 Spring Boot 发布新版本时，通常会更新其依赖库到最新稳定版。因此，当你升级 Spring Boot 版本时，它所管理的所有依赖也会随之更新到兼容的版本。</li><li><strong>减少配置错误</strong>：<br>由于 Spring Boot 自动处理了依赖的版本，减少了手动输入版本号可能引入的拼写或格式错误。</li><li><strong>提高开发效率</strong>：<br>开发者可以专注于业务逻辑的编写，而不是花费时间在解决依赖问题上。</li></ul><div class="note danger no-icon flat"><ul><li>总的来说，Spring Boot 的依赖管理功能使得开发者可以更加专注于业务逻辑的实现，同时减少了因依赖版本不一致而引发的问题，提高了项目的可维护性和开发效率。</li><li>如果在项目中需要更改某个依赖的版本号，不想使用SpringBoot框架指定的版本号，只需要在引入依赖时强行执行版本号即可，maven支持就近原则</li></ul></div><h1>Starter-启动器</h1><p>在SpringBoot中，<code>启动器（Starter）</code>本质上是一个简化依赖管理的概念。<br>Spring Boot 的启动器本质上就是一组预定义的依赖集合，它们被组织成一个个Maven的依赖，以方便开发者快速集成特定的功能模块。<br>如果你想做web开发，只需要引入web启动器。web启动器会自动引入web开发所需要的子依赖。</p><h2 id="启动器实现原理">启动器实现原理</h2><ol><li><strong>依赖聚合</strong>：<br>每个启动器通常对应一个特定的功能集或者一个完整的应用模块，如 <code>spring-boot-starter-web</code> 就包含了构建 Web 应用所需的所有基本依赖项，如 Spring MVC, Tomcat 嵌入式容器等。</li><li><strong>依赖传递</strong>：<br>当你在项目中引入一个启动器时，它不仅会把自身作为依赖加入到你的项目中，还会把它的所有直接依赖项（transitive dependencies）也加入进来。这意味着你不需要单独声明这些依赖项，它们会自动成为项目的一部分。</li><li><strong>版本管理</strong>：<br>启动器内部已经指定了所有依赖项的具体版本，这些版本信息存储在一个公共的 BOM（Bill of Materials，物料清单）文件中，通常是 <code>spring-boot-dependencies</code>。当引入启动器时，实际上也间接引用了这个 BOM，从而确保了所有依赖项版本的一致性。</li><li><strong>自动配置</strong>：<br>许多启动器还提供了<code>自动配置</code>（Auto-configuration），这是一种机制，允许 SpringBoot 根据类路径上的可用组件自动设置你的应用程序。例如，如果类路径上有 Spring MVC 和嵌入式 Tomcat，则 Spring Boot 会自动配置它们，并准备好一个 web 应用程序。</li></ol><h2 id="有哪些启动器">有哪些启动器</h2><p>启动器通常包括：</p><ul><li>SpringBoot官方提供的启动器</li><li>非官方提供的启动器</li></ul><div class="tabs" id="启动器"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#启动器-1">官方提供的启动器</button></li><li class="tab"><button type="button" data-href="#启动器-2">非官方提供的启动器</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="启动器-1"><p>启动器命名特点：spring-boot-starter-*</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729328350698-5231f924-4ae0-447b-a1af-f2c25e4f8440.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="启动器-2"><p>启动器命名特点：*-spring-boot-starter</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729328504925-f0aa6730-ee7f-4a1d-85f9-3d2c9075318f.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>SpringBoot核心注解</h1><p>创建一个只有Web启动器的新模块，并添加一个Controller类。</p><h2 id="SpringBootApplication">@SpringBootApplication</h2><ul><li>SpringBoot的主入口就被<code>@SpringBootApplication</code>注解标注，可见该注解的重要性。<br>注解源码：</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729563192417-c03008ef-81f9-4741-ad09-42d49a4b2cc9.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><ul><li>该注解属于<code>组合注解</code>。拥有<code>@SpringBootConfiguration</code>、<code>@EnableAutoConfiguration</code>、<code>@ComponentScan</code>的功能。</li></ul><h2 id="SpringBootConfiguration">@SpringBootConfiguration</h2><p>注解源码：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729563436496-752f56df-52aa-404b-bf83-c122a06f1312.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><ul><li>能够发现该注解又被<code>@Configuration</code>注解标注，这说明<code>主入口</code>的程序本质是一个配置类，所以<code>主入口</code>的方法可以被<code>@Bean</code>注解标注，被<code>@Bean</code>注解的标注的方法会被Spring容器自动调用，并且将该方法的返回对象纳入IoC容器的管理。</li></ul><div class="tabs" id="测试configuration"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#测试configuration-1">测试configuration</button></li><li class="tab"><button type="button" data-href="#测试configuration-2">测试结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="测试configuration-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Sb305CoreApplication</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getNowDate</span><span class="params">()</span>&#123; <span class="comment">// 方法名作为bean的id</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> SpringApplication.run(Sb305CoreApplication.class, args);</span><br><span class="line">        <span class="type">Date</span> <span class="variable">dateBean1</span> <span class="operator">=</span> applicationContext.getBean(Date.class);</span><br><span class="line">        System.out.println(dateBean1);</span><br><span class="line">        <span class="type">Date</span> <span class="variable">dateBean2</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;getNowDate&quot;</span>, Date.class);</span><br><span class="line">        System.out.println(dateBean2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="测试configuration-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729564458157-1d953623-9405-4577-8fa4-ed955038be77.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note warning no-icon flat"><p>这个<code>配置类</code>也可以称为<code>源</code>，起源的意思，<code>SpringBoot</code>从这个配置类开始加载项目中所有的<code>bean</code>。</p></div><h2 id="EnableAutoConfiguration">@EnableAutoConfiguration</h2><ul><li>该注解表示<code>启用自动配置</code>。</li><li><strong>Spring Boot 会根据引入的依赖自动配置好一系列的 Bean，无需手动编写复杂的配置代码。</strong></li></ul><p>例如：在SpringBoot中进行了以下配置：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span><br><span class="line">spring.datasource.url=jdbc:mysql:<span class="comment">//localhost:3306/springboot</span></span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=<span class="number">123456</span></span><br></pre></td></tr></table></figure><p>并且在依赖中引入了<code>mybatis依赖</code>/<code>mybatis启动器</code>，那么SpringBoot框架将为你自动化配置以下bean：</p><ul><li><strong>SqlSessionFactory</strong>: MyBatis的核心工厂SqlSessionFactory会被自动配置。这个工厂负责创建SqlSession实例，后者用来执行映射文件中的SQL语句。</li><li><strong>TransactionManager</strong>: DataSourceTransactionManager会被自动配置来管理与数据源相关的事务。</li></ul><h2 id="ComponentScan注解">@ComponentScan注解</h2><p>这个注解的作用是：启动组件扫描功能，代替spring框架xml文件中这个配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.powernode.sb305core&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>因此被<code>@SpringBootApplication</code>注解标注之后，会自动扫描<code>主入口程序所在包及子包</code>，因此如果一个bean要纳入IoC容器的管理则必须放到主入口程序所在包及子包下。放到主入口程序所在包之外的话，扫描不到。测试一下：</p></div><div class="tabs" id="测试componentscan"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#测试componentscan-1">扫描到</button></li><li class="tab"><button type="button" data-href="#测试componentscan-2">扫描不到</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="测试componentscan-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729565961938-3cbe2276-79a3-4a57-ab29-d2cd3153d5f8.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello world!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>启动服务器测试：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729566015788-bfbce42f-90b2-48cf-b583-4490db6da625.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="测试componentscan-2"><ul><li>此时UserController不在主入口程序所在包及子包下</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729566119617-fd950fb7-d8a1-42f7-8ff0-e1d7fab60409.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">list</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user list!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>启动服务器测试：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729566187896-1d4053bd-d5da-4fd4-a243-ebd80388ac17.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div>通过测试得知UserController没有被纳入IoC容器的管理。<button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note danger no-icon flat"><p><strong>最终结论：要让Bean纳入IoC容器的管理，必须将类放到主入口程序同级目录下，或者子目录下。</strong></p></div><h1>SpringBoot的单元测试</h1><h2 id="不使用单元测试调用Service">不使用单元测试调用Service</h2><h3 id="第一步：创建模块">第一步：创建模块</h3><ul><li>使用脚手架创建一个模块，该模块不添加任何启动器</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729581295420-d78e7122-66d3-43da-9ba0-a5dea864cf7a.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><h3 id="第二步：编写Service">第二步：编写Service</h3><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729581533729-d56983cc-f11b-4f3a-ac12-cbc28989d0b9.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;userService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;保存用户信息&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="第三步：调用Service">第三步：调用Service</h3><ul><li>直接在入口程序调用service</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Sb306TestApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> SpringApplication.run(Sb306TestApplication.class, args);</span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">        userService.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729581624703-aa5dfd5f-1a61-48a9-bce3-9d3d615913e5.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><div class="note warning no-icon flat"><p>该方法是手动获取Spring上下文对象<code>ConfigurableApplicationContext</code>，然后通过getBean方法获取bean，从Spring容器中获取Service对象，然后调用方法。</p></div><h2 id="使用单元测试调用Service">使用单元测试调用Service</h2><h3 id="引入test-starter">引入test-starter</h3><ul><li>SpringBoot在创建项目时就为我们生成了单元测试类，但如果要使用单元测试，还需要引入单元测试的启动器，如果使用脚手架创建SpringBoot项目，这个test启动器会自动引入</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729581986594-85a62eb9-67d3-4637-a9de-d2578bc1b55f.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><h3 id="SpringBootTest注解">@SpringBootTest注解</h3><p><code>@SpringBootTest</code> 会创建一个完整的 Spring 应用程序上下文（Application Context），这个上下文包含了应用程序的所有组件和服务。以下是 <code>@SpringBootTest</code> 做的一些主要工作：</p><ul><li><p><strong>创建 ApplicationContext</strong>：</p><ul><li><code>@SpringBootTest</code> 使用 <code>SpringApplication</code> 的 <code>run()</code> 方法来启动一个 Spring Boot 应用程序上下文。这意味着它会加载应用程序的主配置类和其他相关的配置类。</li></ul></li><li><p><strong>加载配置文件</strong>：</p><ul><li>它会查找并加载默认的配置文件，如 <code>application.properties</code></li></ul></li><li><p><strong>自动配置</strong>：</p><ul><li>如果应用程序依赖于 Spring Boot 的自动配置特性，<code>@SpringBootTest</code> 会确保这些自动配置生效。这意味着它会根据可用的类和bean来自动配置一些组件，如数据库连接、消息队列等。</li></ul></li><li><p><strong>注入依赖</strong>：</p><ul><li>使用 <code>@SpringBootTest</code> 创建的应用程序上下文允许你在测试类中使用 <code>@Autowired</code> 注入需要的 bean，就像在一个真实的 Spring Boot 应用程序中一样。</li></ul></li></ul><p>总的来说，<code>@SpringBootTest</code> 为你的测试提供了尽可能接近实际运行时环境的条件，这对于验证应用程序的行为非常有用。</p><h3 id="注入Service并调用">注入Service并调用</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sb306TestApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">        userService.save();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试结果如下：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1729582782987-88067365-fba6-4240-b704-b2f710a96647.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><h1>外部化配置</h1><h2 id="什么是外部化配置？">什么是外部化配置？</h2><p><code>外部化配置</code>：将配置信息存储在应用程序代码之外的地方。这样配置信息可以独立于代码进行管理。这样方便了配置的修改，并且修改后不需要重新编译代码，也不需要重新部署项目。<br><a href="https://docs.spring.io/spring-boot/reference/features/profiles.html">官方文档</a></p><h3 id="5-1-1-外部化配置的方式">5.1.1. 外部化配置的方式</h3><p>SpringBoot支持多种外部化配置方式，包括但不限于：</p><ul><li>properties文件</li><li>YAML文件</li><li>系统环境变量</li><li>命令行参数</li><li>…</li></ul><h3 id="5-1-2-外部化配置的优势">5.1.2. 外部化配置的优势</h3><ol><li><strong>灵活性</strong>：配置文件可以独立于应用程序部署，这使得可以根据运行环境的不同来调整配置，而无需修改代码。</li><li><strong>易于维护</strong>：配置变更不需要重新构建和部署应用程序，降低了维护成本。</li><li><strong>安全性</strong>：敏感信息如数据库密码、API密钥等可以存储在外部，并且可以限制谁有权限访问这些配置信息。</li><li><strong>共享性</strong>：多实例或多服务可以共享相同的配置信息，减少重复配置的工作量。</li><li><strong>版本控制</strong>：配置文件可以存放在版本控制系统中，便于跟踪历史版本和回滚配置。</li></ol><p>总之，外部化配置使得配置更加灵活、安全、易于管理和共享，是现代云原生应用中非常推荐的做法</p><h3 id="5-1-3-外部化配置对比传统配置">5.1.3. 外部化配置对比传统配置</h3><ul><li>在传统的SSM三大框架中，如果修改XML的配置后，需要对应用<code>重新打包，重新部署</code>。</li><li>使用SpringBoot框架的<code>外部化配置</code>后，修改配置后，不需要对应用重新打包，也不需要重新部署，最多重启一下服务即可。</li></ul><h2 id="5-2-properties文件">5.2. properties文件</h2><ul><li><code>application.properties</code>配置文件是SpringBoot框架默认的配置文件。</li><li><code>application.properties</code>可以不配置，因为SpringBoot为我们提供了一套默认配置。</li><li>如果你要改变这些默认的行为，可以在<code>application.properties</code>文件中进行配置。</li><li><code>application.properties</code>可以放在类路径当中，也可以放在项目之外。因此称为<code>外部化配置</code>。</li></ul><p>Spring Boot 框架在启动时会尝试从以下位置加载 <code>application.properties</code> 配置文件：</p><ol><li><strong>file:./config/</strong>：首先在Spring Boot 当前工作目录下的 <code>config</code> 文件夹中查找。<ul><li><strong>注意：如果没有找到</strong><code>**application.properties**</code><strong>会继续找</strong><code>**application.yml**</code><strong>，如果这两个都没有找到，才会进入以下位置查找，以此类推。</strong></li></ul></li><li><strong>file:./</strong>：如果在当前工作目录下<code>config</code>目录中找不到时，再从当前工作目录中查找。</li><li><strong>classpath:/config/</strong>：如果从工作目录中找不到，会从类路径中找，先从类路径的 <code>/config/</code> 目录下寻找配置文件。</li><li><strong>classpath:/</strong>：如果在 <code>/config/</code> 下没有找到，它会在类路径的根目录下查找。</li></ol><p>Spring Boot 会按照这个顺序来加载配置文件，如果在多个位置有相同的属性定义，那么最先检查的位置中的属性值将优先使用。</p><p>如果你想要指定其他的配置文件位置或者改变默认的行为，可以通过 --spring.config.location= 后跟路径的方式来指定配置文件的具体位置。例如 ：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar sb3-01-first-web-1.0-SNAPSHOT.jar --spring.config.location=file:///E:\a\b\application.properties</span><br></pre></td></tr></table></figure><p>此时SpringBoot会首先从<code>E:\a\b</code>这个路径加载配置文件。这种方式可以用来覆盖默认的配置文件。</p><div class="note warning no-icon flat"><p><strong>注意：以上的–spring.config.location=file:///E:\a\b\application.properties就属于命令行参数，它将来会被传递到main方法的(String[] args)参数上。</strong></p></div><div class="note danger no-icon flat"><p><strong>优先级总结：</strong><br><strong><code>application.properties/yml (classpath)</code> &lt; <code>application.properties/yml (外部路径)</code> &lt; <code>profile 配置文件</code> &lt; <code>环境变量 &amp; JVM 参数</code> &lt; <code>命令行参数</code></strong></p></div>]]></content>
    
    
    <summary type="html">SpringBoot核心机制</summary>
    
    
    
    
    <category term="Java" scheme="https://silvan2077.github.io/tags/Java/"/>
    
    <category term="SpringBoot" scheme="https://silvan2077.github.io/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot入门</title>
    <link href="https://silvan2077.github.io/2025/10/01/Springboot-SpringBoot/"/>
    <id>https://silvan2077.github.io/2025/10/01/Springboot-SpringBoot/</id>
    <published>2025-10-01T10:53:18.710Z</published>
    <updated>2025-10-02T09:06:31.830Z</updated>
    
    <content type="html"><![CDATA[<h1>认识SpringBoot</h1><ul><li>官方这样描述SpringBoot：<a href="https://docs.spring.io/spring-boot/index.html">SpringBoot</a></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1728893860338-bce86e2c-719d-49fe-9932-419fe1e50fb1.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><ul><li><p><code>SpringBoot</code>提倡<code>约定优于配置</code>，将<code>简化开发</code>发挥到极致。通过SpringBoot来实现跳过大量繁琐的配置，快速构建Spring应用。</p></li><li><p>SpringBoot框架的设计目标：<strong>程序员只需要关注业务逻辑，环境配置交给SpringBoot。</strong></p></li><li><p>SpringBoot的<code>特性</code>：</p><ul><li>快速创建独立的Spring应用程序（Spring支持的SpringBoot都支持）</li><li>嵌入式的Tomcat、jetty、Undertow等容器</li><li>需要的功能直接引入对应的starter启动器即可。（启动器自动管理该功能需要的相关依赖，包括版本冲突等）</li><li>尽最大努力自动配置Spring应用和第三方库。（例如，进行事务管理时，不需要任何配置，只需要在Service类上添加@Transactional注解即可）</li><li>没有代码生成器，没有XML配置文件（SpringBoot的应用程序启动后不会动态创建新的Java类，所有逻辑在编译期就创建好了）</li><li>提供了生产监控的支持，也集成了外部监控系统。</li></ul></li><li><p>SpringBoot的<code>开箱即用</code>和<code>约定优于配置</code>：</p></li><li><p>**开箱即用：**Spring Boot框架设计得非常便捷，开发者能够在几乎不需要任何复杂的配置的情况下，快速搭建并运行一个功能完备的Spring应用。</p></li><li><p><strong>约定优于配置：</strong><code>约定优于配置</code>（Convention Over Configuration, CoC）是一种软件设计哲学，核心思想是**通过提供一组合理的默认行为来减少配置的数量，从而简化开发流程。**例如：SpringBoot默认约定了使用某个事务管理器，在事务方面不需要做任何配置，只需要在对应代码的位置上使用@Transactional注解即可。</p></li></ul><h1>学习前提</h1><p>学习SpringBoot应至少学过：</p><ul><li>Spring</li><li>SpringMVC</li><li>Mybatis</li></ul><h1>第一个SpringBoot项目</h1><div class="note danger no-icon flat"><p>需求：在浏览器输入http://localhost:8080/hello，返回&quot;Hello World&quot;</p></div><p><strong>使用SpirngBoot3开发Web项目，Spring官方提供的步骤如下：</strong></p><h2 id="第一步：创建空工程">第一步：创建空工程</h2><ul><li>创建一个空的工程，并设置JDK版本为21（SpringBoot3要求最低版本为17）</li></ul><div class="tabs" id="第一步"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#第一步-1">创建空工程</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="第一步-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1726108555353-e1941b34-dc63-4767-954c-4f6e5e3a9aa8.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="第二步：设置Maven">第二步：设置Maven</h2><ul><li>如果以前配置过Maven，可以跳过此步骤</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1726109769284-7a5cae72-e931-4fd3-bf1c-c99a37cb4023.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><h2 id="第三步：创建Maven项目">第三步：创建Maven项目</h2><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1726110490826-f7c563eb-4aff-488e-83dc-8daf82a700e9.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><h2 id="第四步：根据SpringBoot3文档操作">第四步：根据SpringBoot3文档操作</h2><p><a href="https://docs.spring.io/spring-boot/tutorial/first-application/index.html">官方文档</a></p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1726111411632-0a5cfc79-f222-4395-ae19-35b8d3868f3d.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><h2 id="第五步：继承SpringBoot">第五步：继承SpringBoot</h2><p>要使用Spring Boot 3，需要继承这个开源项目。从官方指导文档中复制以下内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--继承Spring Boot 3.3.3开源项目--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1726111736067-221c85d6-e3ce-4d41-9b20-2893705b11de.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><div class="note warning no-icon flat"><p>我们开发的每一个项目都可以看作是Springboot项目下的子项目</p></div><h2 id="第六步：添加Web启动器">第六步：添加Web启动器</h2><p>添加SpringBootweb的启动器，让SpringBoot项目具备开发Web应用的依赖：</p><div class="tabs" id="web1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#web1-1">官方文档</button></li><li class="tab"><button type="button" data-href="#web1-2">添加依赖</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="web1-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1726112199621-1d90cda6-1bb5-4c66-ac9f-b0f2bedb87b3.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="web1-2"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--引入Spring Boot web启动器依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>可以看到Web的关联依赖也会被引入进来，包括SpringMVC和Tomcat</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1726112541453-f0298719-9217-4792-9af5-bb39d6582560.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><h2 id="第七步：创建主程序">第七步：创建主程序</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(MyApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第八步：创建Controller">第八步：创建Controller</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第九步：启动项目">第九步：启动项目</h2><ul><li>运行Main方法就是启动Web项目了</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1726197869192-497ee49e-fffb-4201-9c20-6caa97823963.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><h2 id="第十步：访问项目">第十步：访问项目</h2><ul><li>直接打开浏览器，访问<a href="http://localhost:8080/hello">http://localhost:8080/hello</a>，返回&quot;Hello World&quot;</li></ul><h1>便捷的部署方式</h1><h2 id="打jar包运行">打jar包运行</h2><p><strong>SpringBoot为我们提供了打包插件，可以将SpringBoot项目打包为可执行 jar 包。</strong><code>Web服务器</code>（Tomcat）也会连同一块打入jar包中。只要电脑上安装了Java的运行环境（JDK），就可以启动Spring Boot项目。</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2024/png/21376908/1726199029529-6ffc59e1-3d92-4d4e-ab44-31f24cba9585.png?x-oss-process=image%2Fformat%2Cwebp"/></div></div><ul><li>根据官方文档步骤，引入打包插件</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>执行打包命令，生成可执行Jar包</li></ul>]]></content>
    
    
    <summary type="html">SpringBoot快速入门</summary>
    
    
    
    
    <category term="Java" scheme="https://silvan2077.github.io/tags/Java/"/>
    
    <category term="SpringBoot" scheme="https://silvan2077.github.io/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>常用配置文件</title>
    <link href="https://silvan2077.github.io/2025/09/29/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"/>
    <id>https://silvan2077.github.io/2025/09/29/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</id>
    <published>2025-09-29T04:30:04.161Z</published>
    <updated>2025-09-29T11:35:37.660Z</updated>
    
    <content type="html"><![CDATA[<div class="note warning no-icon flat"><ul><li>游戏中会存放许多数据,而存放的数据也分为<code>动态数据</code>和<code>静态数据</code>。<ul><li>动态数据：数据会频繁地改变，如当前玩家位置，玩家血量等数据。<strong>通常存储在数据库中。</strong></li><li>静态数据：数据不会频繁改变，如游戏角色的技能冷却时间，地图结构，障碍物位置等基础配置。<strong>通常存储在配置文件中。</strong></li></ul></li></ul></div><h1>JSON</h1><ul><li><p>JSON是一种轻量级的数据交换格式，它基于JavaScript语言，但是它不是JavaScript语言。</p></li><li><p>JSON对象：键值对，用花括号括起来，键和值用冒号隔开，多个键值对用逗号隔开。</p></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;myApp&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="number">1.0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;debug&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;database&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;port&quot;</span><span class="punctuation">:</span> <span class="number">3306</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;features&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;auth&quot;</span><span class="punctuation">,</span> <span class="string">&quot;logging&quot;</span><span class="punctuation">,</span> <span class="string">&quot;metrics&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">优点</button></li><li class="tab"><button type="button" data-href="#-2">缺点</button></li><li class="tab"><button type="button" data-href="#-3">适用场景</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><ul><li>语法简洁，结构清晰方便解析</li><li>跨语言支持广泛，各种语言都有对应的库可以解析JSON数据</li><li>与XML相比，JSON更轻量，占用更少空间，传输更快</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><ul><li>JSON不支持注释</li><li>JSON不支持对象继承</li><li>配置过大时可读性下降</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><ul><li>Web配置或前后端数据交换</li><li>需要语言跨兼容的配置文件</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>YAML</h1><ul><li><p>YAML是一种数据序列化格式，是一种可读性高的数据格式，但对缩进要求十分严格。</p></li><li><p>YAML对象：根据缩进来表示层级关系。键值对，用冒号隔开，冒号和值之间应当有一个空格。</p></li></ul><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">优点</button></li><li class="tab"><button type="button" data-href="#-2">缺点</button></li><li class="tab"><button type="button" data-href="#-3">适用场景</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><ul><li>语法简洁，结构清晰，缩进层次较小时能一眼看出</li><li>支持注释（<code>#</code>开头）</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><ul><li>缩进敏感，容易因缩进错误导致解析失败</li><li>不同解析器实现可能有差异</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>XML</h1><ul><li>XML是一种可扩展标记语言，可以高效且精准的描述层次化结构。</li><li>XML对象：用标签来表示数据的开始和结束，标签可以嵌套。</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">config</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>myApp<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">debug</span>&gt;</span>true<span class="tag">&lt;/<span class="name">debug</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">database</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">host</span>&gt;</span>localhost<span class="tag">&lt;/<span class="name">host</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">port</span>&gt;</span>3306<span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">database</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">features</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">feature</span>&gt;</span>auth<span class="tag">&lt;/<span class="name">feature</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">feature</span>&gt;</span>logging<span class="tag">&lt;/<span class="name">feature</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">feature</span>&gt;</span>metrics<span class="tag">&lt;/<span class="name">feature</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">features</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">config</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">优点</button></li><li class="tab"><button type="button" data-href="#-2">缺点</button></li><li class="tab"><button type="button" data-href="#-3">适用场景</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><ul><li>结构化数据表达能力强，支持层次、属性、命名空间</li><li>可扩展性好，支持自定义标签</li><li>支持模式约束，方便数据校验</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><ul><li>语法较复杂，可读性差</li><li>文件体积大，传输速度慢</li><li>对手动编辑不友好</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><ul><li>传统企业级项目（如 Java EE 配置、Spring XML）</li><li>需要严格数据校验的系统</li><li>文档型数据存储（Office 文档格式底层就是 XML）</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>INI</h1><ul><li>INI是一种用于配置文件的格式，它基于键值对，用等号（<code>=</code>）来分隔键和值。</li><li>INI对象：使用方括号划分不同的区域名，区域内的键值对表示该区域的配置。并且可以在分号后编写单行注释。</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[app]</span></span><br><span class="line"><span class="attr">name</span>=myApp</span><br><span class="line"><span class="attr">version</span>=<span class="number">1.0</span></span><br><span class="line"><span class="attr">debug</span>=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="section">[database]</span></span><br><span class="line"><span class="attr">host</span>=localhost</span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span>   <span class="comment">; 数据库端口号</span></span><br><span class="line"></span><br><span class="line"><span class="section">[features]</span></span><br><span class="line"><span class="attr">auth</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">logging</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">metrics</span>=<span class="literal">true</span></span><br></pre></td></tr></table></figure><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">优点</button></li><li class="tab"><button type="button" data-href="#-2">缺点</button></li><li class="tab"><button type="button" data-href="#-3">适用场景</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><ul><li>语法简单，结构清晰</li><li>编辑方便，适合小型项目配置</li><li>支持分区，方便管理</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><ul><li>数据类型有限（通常只能表示字符串，需要应用层解析）。</li><li>不支持复杂嵌套</li><li>没有严格标准，不同解析器可能有差异</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><ul><li>小型应用、本地配置文件</li><li>桌面软件设置、轻量级服务配置</li><li>不需要复杂嵌套的场景</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><!-- # TOML* TOML的设计目标是"比JSON更容易读写",语法直观，键值对清晰* TOML对象：键值对，用等号（`=`）来分隔键和值。```TOMLname = "myApp"version = 1.0debug = true --><h1>总结</h1><table><thead><tr><th>格式</th><th>可读性</th><th>表达能力</th><th>解析性能</th><th>注释</th><th>常见场景</th></tr></thead><tbody><tr><td>JSON</td><td>中等</td><td>中等</td><td>高</td><td>无</td><td>Web API、微服务</td></tr><tr><td>YAML</td><td>高</td><td>高</td><td>中等</td><td>支持</td><td>DevOps、K8s、CI/CD</td></tr><tr><td>XML</td><td>低</td><td>很高</td><td>低</td><td>支持</td><td>企业级应用、模式验证</td></tr><tr><td>INI</td><td>高</td><td>低</td><td>高</td><td>部分</td><td>小型应用、本地配置</td></tr></tbody></table><table><thead><tr><th>格式</th><th>可读性</th><th>文件体积</th><th>解析速度</th><th>跨平台兼容性</th><th>适用场景</th></tr></thead><tbody><tr><td><strong>YAML</strong></td><td>★★★★☆</td><td>小</td><td>中等</td><td>较好</td><td>人工可读配置（如 CI/CD、游戏配置）</td></tr><tr><td><strong>INI</strong></td><td>★★★★☆</td><td>很小</td><td>很快</td><td>一般</td><td>简单应用配置（桌面软件、老系统）</td></tr><tr><td><strong>JSON</strong></td><td>★★★☆☆</td><td>小</td><td>很快</td><td>极佳</td><td>前后端通信、现代应用配置</td></tr><tr><td><strong>XML</strong></td><td>★★☆☆☆</td><td>大</td><td>慢</td><td>极佳</td><td>需要严格结构/文档描述（如 SOAP、旧系统）</td></tr></tbody></table>]]></content>
    
    
    <summary type="html">个人对常用配置文件的适用场景的看法</summary>
    
    
    
    <category term="配置文件" scheme="https://silvan2077.github.io/categories/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"/>
    
    
  </entry>
  
  <entry>
    <title>Spring(2)</title>
    <link href="https://silvan2077.github.io/2025/09/28/Spring-Spring-2/"/>
    <id>https://silvan2077.github.io/2025/09/28/Spring-Spring-2/</id>
    <published>2025-09-28T09:49:18.948Z</published>
    <updated>2025-10-03T07:17:49.539Z</updated>
    
    <content type="html"><![CDATA[<h1>GoF之工厂模式</h1><h2 id="了解GoF">了解GoF</h2><ul><li><p><code>设计模式</code>是一种可以反复利用的解决<code>方案</code></p></li><li><p>GoF（Gang of Four），中文名——四人组。</p><ul><li>《Design Patterns: Elements of Reusable Object-Oriented Software》（即《设计模式》一书），1995年由 Erich Gamma、Richard Helm、Ralph Johnson 和 John Vlissides 合著。这几位作者常被称为&quot;四人组（Gang of Four）&quot;。</li></ul></li><li><p>常提到的23种设计模式，在这本书都能找到。除了GoF提到的23种设计模式，起始还有其他的设计模式，比如：JavaEE的设计模式（DAO模式、MVC模式等）。</p></li><li><p>GoF中的23种设计模式可以分为三大类：</p><ul><li><strong>创建型</strong>（5个）：解决对象创建问题。<ul><li>单例模式</li><li>工厂方法模式</li><li>抽象工厂模式</li><li>建造者模式</li><li>原型模式</li></ul></li><li><strong>结构型</strong>（7个）：一些类或对象组合在一起的经典结构。<ul><li>代理模式</li><li>装饰模式</li><li>适配器模式</li><li>组合模式</li><li>享元模式</li><li>外观模式</li><li>桥接模式</li></ul></li><li><strong>行为型</strong>（11个）：解决类或对象之间的交互问题。<ul><li>策略模式</li><li>模板方法模式</li><li>责任链模式</li><li>观察者模式</li><li>迭代子模式</li><li>命令模式</li><li>备忘录模式</li><li>状态模式</li><li>访问者模式</li><li>中介者模式</li><li>解释器模式</li></ul></li></ul></li></ul><div class="note danger no-icon flat"><ul><li>工厂模式是解决对象创建问题的，所以工厂模式属于<code>创建型设计模式</code>。</li><li>为什么在这里学习工厂模式呢？<ul><li>这是因为Spring框架底层使用了大量的工厂模式。</li></ul></li></ul></div><h2 id="工厂模式的三种形态">工厂模式的三种形态</h2><ul><li>第一种：<code>简单工厂模式（Simple Factory）</code>：不属于23种设计模式之一。简单工厂模式又叫做：静态工厂方法模式。简单工厂模式是工厂方法模式的一种特殊实现。</li><li>第二种：<code>工厂方法模式（Factory Method）</code>：是23种设计模式之一。</li><li>第三种：<code>抽象工厂模式（Abstract Factory）</code>：是23种设计模式之一。</li></ul><h2 id="简单工厂模式">简单工厂模式</h2><ul><li>简单工厂模式角色包括三个：<ul><li>抽象产品角色</li><li>具体产品角色</li><li>工厂类角色</li></ul></li></ul><div class="tabs" id="简单工厂模式"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#简单工厂模式-1">抽象产品角色</button></li><li class="tab"><button type="button" data-href="#简单工厂模式-2">具体产品角色</button></li><li class="tab"><button type="button" data-href="#简单工厂模式-3">工厂类角色</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="简单工厂模式-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Weapon</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所有的武器都有攻击行为</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="简单工厂模式-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tank</span> <span class="keyword">extends</span> <span class="title class_">Weapon</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;坦克开炮！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Fighter</span> <span class="keyword">extends</span> <span class="title class_">Weapon</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;战斗机投下原子弹！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="简单工厂模式-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WeaponFactory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Weapon <span class="title function_">get</span><span class="params">(String weaponType)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (weaponType == <span class="literal">null</span> || weaponType.trim().length() == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;TANK&quot;</span>.equals(weaponType)) &#123;</span><br><span class="line">            weapon = <span class="keyword">new</span> <span class="title class_">Tank</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;FIGHTER&quot;</span>.equals(weaponType)) &#123;</span><br><span class="line">            weapon = <span class="keyword">new</span> <span class="title class_">Fighter</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;DAGGER&quot;</span>.equals(weaponType)) &#123;</span><br><span class="line">            weapon = <span class="keyword">new</span> <span class="title class_">Dagger</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;不支持该武器！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> weapon;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note warning no-icon flat"><p>简单工厂模式的优点：</p><ul><li>客户端程序不需要关心对象的创建细节，需要哪个对象时，只需要向工厂索要即可，初步实现了责任的分离。客户端只负责“消费”，工厂负责“生产”。<strong>生产和消费分离。</strong></li></ul><p>简单工厂模式的缺点：</p><ul><li>工厂类集中了所有产品的创造逻辑，形成一个无所不知的全能类，有人把它叫做上帝类。显然工厂类非常关键，不能出问题，一旦出问题，整个系统瘫痪。</li><li><strong>不符合OCP开闭原则</strong>。在进行系统扩展时，需要修改工厂类。</li></ul></div><h2 id="工厂方法模式">工厂方法模式</h2><ul><li><p>工厂方法模式整体与简单工厂类似。既保留了简单工厂模式的优点，同时又解决了简单工厂模式的缺点。</p></li><li><p>工厂方法模式角色：</p><ul><li>抽象产品角色</li><li>具体产品角色</li><li><strong>抽象工厂角色</strong></li><li><strong>具体工厂角色</strong></li></ul></li></ul><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">抽象产品角色</button></li><li class="tab"><button type="button" data-href="#-2">具体产品角色</button></li><li class="tab"><button type="button" data-href="#-3">抽象工厂角色</button></li><li class="tab"><button type="button" data-href="#-4">具体工厂角色</button></li><li class="tab"><button type="button" data-href="#-5">测试程序</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Weapon</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所有武器都有攻击行为</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Gun</span> <span class="keyword">extends</span> <span class="title class_">Weapon</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;开枪射击！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Fighter</span> <span class="keyword">extends</span> <span class="title class_">Weapon</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;战斗机发射核弹！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">WeaponFactory</span> &#123;</span><br><span class="line">    Weapon <span class="title function_">get</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GunFactory</span> <span class="keyword">implements</span> <span class="title class_">WeaponFactory</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Weapon <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Gun</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FighterFactory</span> <span class="keyword">implements</span> <span class="title class_">WeaponFactory</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Weapon <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Fighter</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-5"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">WeaponFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GunFactory</span>();</span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon</span> <span class="operator">=</span> factory.get();</span><br><span class="line">        weapon.attack();</span><br><span class="line"></span><br><span class="line">        <span class="type">WeaponFactory</span> <span class="variable">factory1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FighterFactory</span>();</span><br><span class="line">        <span class="type">Weapon</span> <span class="variable">weapon1</span> <span class="operator">=</span> factory1.get();</span><br><span class="line">        weapon1.attack();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>此时想要扩展产品，只需要新增一个产品类和该产品对应的工厂即可，例如新增匕首类</li></ul><div class="tabs" id="dagger"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#dagger-1">匕首类</button></li><li class="tab"><button type="button" data-href="#dagger-2">匕首工厂类</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="dagger-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dagger</span> <span class="keyword">extends</span> <span class="title class_">Weapon</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">attack</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;砍丫的！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="dagger-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DaggerFactory</span> <span class="keyword">implements</span> <span class="title class_">WeaponFactory</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Weapon <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Dagger</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note warning no-icon flat"><p>工厂方法模式的优点：</p><ul><li>一个调用者想创建一个对象，只要知道其名称就可以了。</li><li>扩展性高，如果想增加一个产品，只要扩展一个工厂类就可以。</li><li>屏蔽产品的具体实现，调用者只关心产品的接口。<br>工厂方法模式的缺点：</li><li>每次增加一个产品时，都需要增加一个具体类和对象实现工厂，使得系统中类的个数成倍增加，在一定程度上增加了系统的复杂度，同时也增加了系统具体类的依赖。这并不是什么好事。</li></ul></div><h1>Bean的实例化方式</h1><p>Spring为Bean提供了多种实例化方式，通常包括4种方式。（也就是说在Spring中为Bean对象的创建准备了多种方案，目的：使Bean的实例更加灵活）</p><ul><li>第一种：通过<code>构造方法</code>实例化</li><li>第二种：通过<code>简单工厂模式</code>实例化</li><li>第三种：通过<code>BeanFactory</code>实例化</li><li>第四种：通过<code>FactoryBean</code>接口实例化</li></ul><h2 id="BeanFactory和FactoryBean的区别">BeanFactory和FactoryBean的区别</h2><ul><li><code>BeanFactory</code>：是Spring IoC容器的顶级对象，常常被翻译为Bean工厂，用于创建和管理Bean对象。<strong>BeanFactory是工厂</strong></li><li><code>FactoryBean</code>：是Spring的一个工厂Bean，是一个能够辅助Spring实例化其他Bean对象的一个Bean。</li></ul><div class="note danger no-icon flat"><p>在Spring中，Bean可以分为两类：</p><ul><li>第一类：普通Bean</li><li>第二类：工厂Bean（记住：工厂Bean也是一种Bean，只不过这种Bean比较特殊，它可以辅助Spring实例化其它Bean对象。）</li></ul></div><h1>Bean的生命周期</h1><h2 id="什么是Bean的生命周期？">什么是Bean的生命周期？</h2><p>Spring就是一个管理Bean对象的工厂。它负责对象的创建，对象的销毁等。<br>所谓的生命周期就是：<strong>对象从创建开始到最终销毁的整个过程。</strong></p><ul><li>什么时候创建Bean对象？</li><li>创建Bean对象的前后会调用什么方法？</li><li>Bean对象什么时候销毁？</li><li>Bean对象的销毁前后调用什么方法？</li></ul><h2 id="为什么要了解Bean的生命周期？">为什么要了解Bean的生命周期？</h2><p>生命周期的本质：<strong>在哪个时间节点上调用了哪个类的哪个方法。</strong><br>我们需要充分的了解在这个生命线上，都有哪些特殊的时间节点。<br>只有我们知道了特殊的时间节点都在哪，才可以准确的确定代码写到哪。<br>我们可能需要在某个特殊的时间点上执行一段特定的代码，这段代码就可以放到这个节点上。当生命线走到这里的时候，就会被自动调用。</p><h2 id="Bean的生命周期之5步">Bean的生命周期之5步</h2><ol><li>实例化Bean</li><li>Bean属性赋值</li><li>初始化Bean</li><li>使用Bean</li><li>销毁Bean</li></ol><div class="note warning no-icon flat"><ul><li>只有正常关闭spring容器，bean的销毁方法才会被调用。</li><li>ClassPathXmlApplicationContext类才有close()方法。`</li><li>配置文件中的init-method指定初始化方法。destroy-method指定销毁方法。</li></ul></div><h2 id="Bean的生命周期之7步">Bean的生命周期之7步</h2><ol><li>实例化Bean</li><li>Bean属性赋值</li><li><code>Bean后处理器的before方法</code></li><li>初始化Bean</li><li><code>Bean后处理器的after方法</code></li><li>使用Bean</li><li>销毁Bean</li></ol><ul><li>编写一个类实现BeanPostProcessor类，并重写before和after方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">BeanPostProcessor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Bean后处理器的before方法执行，即将开始初始化&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Bean后处理器的after方法执行，已完成初始化&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>在spring.xml文件中配置的Bean后处理器将作用于当前配置文件中所有的Bean。</p></div><p>在spring.xml文件中配置Bean后处理器</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置Bean后处理器。这个后处理器将作用于当前配置文件中所有的bean。--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.bean.LogBeanPostProcessor&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Bean的生命周期之10步（了解）">Bean的生命周期之10步（了解）</h2><ol><li>实例化Bean</li><li>Bean属性赋值</li><li><code>检查Bean是否实现了Aware相关接口，并设置相关依赖</code></li><li><strong>Bean后处理器的before方法</strong></li><li><code>检查Bean是否实现了InitializingBean接口，并调用接口方法</code></li><li>初始化Bean</li><li><strong>Bean后处理器的after方法</strong></li><li>使用Bean</li><li><code>检查Bean是否实现了DisposableBean接口，并调用接口方法</code></li><li>销毁Bean</li></ol><p>Aware相关的接口包括：<code>BeanNameAware</code>、<code>BeanClassLoaderAware</code>、<code>BeanFactoryAware</code></p><ul><li>当Bean实现了BeanNameAware，Spring会将Bean的名字传递给Bean。</li><li>当Bean实现了BeanClassLoaderAware，Spring会将加载该Bean的类加载器传递给Bean。</li><li>当Bean实现了BeanFactoryAware，Spring会将Bean工厂对象传递给Bean。</li></ul><div class="note warning no-icon flat"><ul><li>InitializingBean的方法早于init-method的执行。</li><li>DisposableBean的方法早于destroy-method的执行。</li></ul></div><div class="note danger no-icon flat"><p>对于Bean不同的作用域，Spring有不同的管理方式</p><ul><li>单例：Spring精确的知到Bean在何时创建，何时初始化，何时被销毁。</li><li>多例：Spring只负责创建，当Bean被创建后，Bean的实例就交给客户端代码管理，Spring不再追踪其生命周期。</li></ul></div><h2 id="将自己new的对象交给Spring管理">将自己new的对象交给Spring管理</h2><ul><li>Spring为我们创建的对象，它的生命周期由Spring管理。我们如何将自己new的对象交给Spring管理呢？</li></ul><h3 id="通过-Bean注解">通过@Bean注解</h3><ul><li>创建一个配置类，在配置类中定义一个方法，该方法返回值为要注册的Bean对象。</li><li>在方法上添加@Bean注解。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MyService <span class="title function_">myService</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyService</span>(); <span class="comment">// 手动 new，再交给 Spring</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="通过DefaultListableBeanFactory">通过DefaultListableBeanFactory</h3><p>可以通过<code>BeanDefinitionRegistryPostProcessor</code>或 <code>BeanFactoryPostProcessor</code>注册</p><div class="tabs" id="my-tabs"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#my-tabs-1">User</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="my-tabs-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="使用ApplicationContext">使用ApplicationContext</h3><p>在运行时获取 <code>ConfigurableApplicationContext</code>，调用其 API 注册：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> (ConfigurableApplicationContext) applicationContext;</span><br><span class="line">context.getBeanFactory().registerSingleton(<span class="string">&quot;myService&quot;</span>, <span class="keyword">new</span> <span class="title class_">MyService</span>());</span><br></pre></td></tr></table></figure><h3 id="总结">总结</h3><table><thead><tr><th>方式</th><th>优点</th><th>缺点</th><th>典型场景</th></tr></thead><tbody><tr><td><strong><code>@Bean</code> 注册</strong></td><td>简单直观，最推荐；支持依赖注入；易于维护</td><td>需要提前在配置类中写死</td><td>常规手动 new 对象交给 Spring 管理</td></tr><tr><td><strong><code>BeanFactoryPostProcessor</code> / <code>registerSingleton</code></strong></td><td>可在容器启动时动态注册 Bean；灵活性高</td><td>代码复杂，理解成本高；不常用</td><td>启动阶段根据条件动态注册 Bean</td></tr><tr><td><strong>运行时 <code>ApplicationContext.registerSingleton</code></strong></td><td>可以在运行时动态注册；方便临时扩展</td><td>容器已启动时使用，可能影响一致性</td><td>运行过程中需要临时创建并托管对象</td></tr><tr><td><strong><code>@Component</code> 扫描</strong></td><td>完全交给 Spring 扫描管理；简洁</td><td>不能满足“必须自己手动 new”的需求</td><td>适合完全由 Spring 托管的类</td></tr></tbody></table><div class="note danger no-icon flat"><ul><li><p>如果只是单纯要把 new 出来的对象交给 Spring → @Bean 是最佳实践。</p></li><li><p>如果对象的创建需要 运行时条件 或 外部输入 → 使用 registerSingleton。</p></li><li><p>如果在做 框架级开发，要批量、动态注册 → 用 ImportBeanDefinitionRegistrar。</p></li></ul></div><h1>Bean的循环依赖</h1><ul><li>A对象中有B属性。B对象中有A属性。这就是循环依赖。我依赖你，你也依赖我。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> B b;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setB</span><span class="params">(B b)</span> &#123; <span class="built_in">this</span>.b = b; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> A a;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setA</span><span class="params">(A a)</span> &#123; <span class="built_in">this</span>.a = a; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>此时<code>A</code>依赖<code>B</code>，<code>B</code>又依赖<code>A</code>，普通的构造过程就会出现<code>死循环</code>。</strong></li></ul><h2 id="单例下的set注入产生的循环依赖">单例下的set注入产生的循环依赖</h2><div class="note warning no-icon flat"><ul><li>singleton+Set注入的情况下，循环依赖是没有问题的。Spring可以解决这个问题<ul><li>Spring在创建单例Bean的时候，有一个<code>三级缓存机制</code>，提前曝光正在创建的对象引用，让另一个依赖方能够拿到这个对象的&quot;半成品&quot;（还未完全填充依赖的对象）。</li></ul></li><li>创建过程：<ul><li>Spring开始创建单例<code>A</code><ul><li>在实例化<code>A</code>后(还未注入属性)，Spring就把<code>ObjectFactory(A)</code>放到<code>singletonFactories</code>中。</li></ul></li><li>Spring发现<code>A</code>需要依赖<code>B</code>，开始创建<code>B</code></li><li>创建<code>B</code>时发现<code>B</code>需要依赖<code>A</code><ul><li>此时Spring会去<code>singletonFactories</code>中获取A的<code>ObjectFactory</code>，之后调用它生成一个<code>earlySingletonReference</code>（早期引用），这个引用会先放入<code>earlySingletonObjects</code>，然后B再依赖这个引用。</li><li>这样B就拿到了一个A的引用(还没有完成依赖注入)。</li></ul></li><li>B完成创建后也会放入<code>singletonObjects</code>。</li><li>回到A的注入阶段，Spring将完整的B注入到A中，此时A彻底完成初始化，重新放入<code>singletonObjects</code>中。</li><li>此时A和B全部完成了初始化</li></ul></li></ul></div><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">Husband</button></li><li class="tab"><button type="button" data-href="#-2">Wife</button></li><li class="tab"><button type="button" data-href="#-3">配置文件</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Husband</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Wife wife;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span></span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span></span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setWife</span><span class="params">(Wife wife)</span></span><br><span class="line">        <span class="built_in">this</span>.wife = wife;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// toString()方法重写时需要注意：不能直接输出wife，输出wife.getName()。要不然会出现递归导致的栈内存溢出错误。</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Husband&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, wife=&quot;</span> + wife.getName() +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Wife</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Husband husband;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span></span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span></span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHusband</span><span class="params">(Husband husband)</span> </span><br><span class="line">        <span class="built_in">this</span>.husband = husband;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// toString()方法重写时需要注意：不能直接输出husband，输出husband.getName()。要不然会出现递归导致的栈内存溢出错误。</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Wife&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, husband=&quot;</span> + husband.getName() +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;husbandBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.bean.Husband&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;张三&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;wifeBean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;wifeBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.bean.Wife&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小花&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;husband&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;husbandBean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>执行结果：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665453201014-160bb88e-08d4-4d37-a1d9-44d4911a32df.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_15%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10%2Fformat%2Cwebp"/></div></div><h2 id="多例下的set注入产生的循环依赖">多例下的set注入产生的循环依赖</h2><p>同样的循环依赖问题，换为多例模式：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;husbandBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.bean.Husband&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;张三&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;wifeBean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;wifeBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.bean.Wife&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小花&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;husband&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;husbandBean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>此时就会出现异常：<code>BeanCurrentlyInCreationException</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Caused by: org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name <span class="string">&#x27;husbandBean&#x27;</span>: Requested bean is currently in creation: Is there an unresolvable circular reference?</span><br><span class="line">at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:<span class="number">265</span>)</span><br><span class="line">at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:<span class="number">199</span>)</span><br><span class="line">at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:<span class="number">325</span>)</span><br><span class="line">... <span class="number">44</span> more</span><br></pre></td></tr></table></figure><ul><li>翻译为：创建名为“husbandBean”的bean时出错：请求的bean当前正在创建中：是否存在无法解析的循环引用？</li><li>通过测试可以知道，多例模式下的循环依赖，Spring无法解决，会抛出异常。</li></ul><div class="note danger no-icon flat"><ul><li>在全部为Set模式下的循环依赖：<ul><li>一个<code>单例Bean</code>，一个<code>多例Bean</code>不会产生循环依赖。</li><li>两个都为<code>单例Bean</code>也不会产生循环依赖。</li><li>只有两个都为<code>多例Bean</code>才会产生循环依赖。</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665454469042-69668f45-5d71-494f-8537-18142d354abd.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_32%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10%2Fformat%2Cwebp"/></div></div></div><h2 id="多例下的构造注入产生的循环依赖">多例下的构造注入产生的循环依赖</h2><div class="tabs" id="多例"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#多例-1">Husband</button></li><li class="tab"><button type="button" data-href="#多例-2">Wife</button></li><li class="tab"><button type="button" data-href="#多例-3">配置文件</button></li><li class="tab"><button type="button" data-href="#多例-4">测试程序</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="多例-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Husband</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Wife wife;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Husband</span><span class="params">(String name, Wife wife)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.wife = wife;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// -----------------------分割线--------------------------------</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Husband&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, wife=&quot;</span> + wife +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="多例-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Wife</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Husband husband;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Wife</span><span class="params">(String name, Husband husband)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.husband = husband;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// -------------------------分割线--------------------------------</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Wife&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, husband=&quot;</span> + husband +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="多例-3"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;hBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.bean2.Husband&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;张三&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;wBean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;wBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.bean2.Wife&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;小花&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;husband&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;hBean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="多例-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSingletonAndConstructor</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring2.xml&quot;</span>);</span><br><span class="line">    <span class="type">Husband</span> <span class="variable">hBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;hBean&quot;</span>, Husband.class);</span><br><span class="line">    <span class="type">Wife</span> <span class="variable">wBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;wBean&quot;</span>, Wife.class);</span><br><span class="line">    System.out.println(hBean);</span><br><span class="line">    System.out.println(wBean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>运行程序后发现和多例模式的set注入一样，会抛出异常：<code>BeanCurrentlyInCreationException</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Caused by: org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name <span class="string">&#x27;hBean&#x27;</span>: Requested bean is currently in creation: Is there an unresolvable circular reference?</span><br><span class="line">at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.beforeSingletonCreation(DefaultSingletonBeanRegistry.java:<span class="number">355</span>)</span><br><span class="line">at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:<span class="number">227</span>)</span><br><span class="line">at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:<span class="number">324</span>)</span><br><span class="line">at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:<span class="number">199</span>)</span><br><span class="line">at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:<span class="number">325</span>)</span><br><span class="line">... <span class="number">56</span> more</span><br></pre></td></tr></table></figure><div class="note danger no-icon flat"><p><strong>主要原因是因为通过构造方法注入导致的：因为构造方法注入会导致实例化对象的过程和对象属性赋值的过程没有分离开，必须在一起完成导致的。</strong></p></div><h2 id="Spring解决循环依赖的机理">Spring解决循环依赖的机理</h2><div class="note warning no-icon flat"><p>Spring解决循环依赖的根本原因：Spring 在创建单例 Bean 时，利用 <code>三级缓存</code>，通过 <strong>提前暴露 Bean 的“半成品”（仅完成实例化，还没完成属性赋值和初始化）</strong>，把 <code>实例化对象</code> 和 <code>依赖注入</code> 两个阶段拆开执行，从而打破循环依赖。</p></div><ul><li>使用Set注入，即在实例化BEan时，调用无参构造方法来完成。<strong>此时可以先不给属性赋值，可以提前将该Bean对象“曝光”给外界。</strong>，等到给Bean属性赋值时再调用Set方法完成</li><li>两个步骤是完全可以分离开去完成的，并且这两步不要求在同一个时间点上完成。</li><li>也就是说，Bean都是单例的，我们可以先把所有的单例Bean实例化出来，放到一个集合当中（我们可以称之为缓存），所有的单例Bean全部实例化完成之后，以后我们再慢慢的调用setter方法给属性赋值。这样就解决了循环依赖的问题。</li></ul><details class="folding-tag" ><summary> Spring底层源码 </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665456331018-18c45ae3-fa4c-4cd8-aabf-d9bace567693.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_41%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10%2Fformat%2Cwebp"/></div></div>* 以上类中包含三个重要的属性：  * **Cache of singleton objects: bean name to bean instance.** 单例对象的缓存：key存储bean名称，value存储Bean对象【一级缓存】  * **Cache of early singleton objects: bean name to bean instance.** 早期单例对象的缓存：key存储bean名称，value存储早期的Bean对象【二级缓存】  * **Cache of singleton factories: bean name to ObjectFactory.** 单例工厂缓存：key存储bean名称，value存储该Bean对应的ObjectFactory对象【三级缓存】* 这三个缓存本质上是三个Map集合。* 在该类中还有一个方法：`addSingletonFactory()`，这个方法的作用是：将创建Bean对象的ObjectFactory提前曝光<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665460724682-2222366d-cc07-43db-a8d0-fb27712b20a4.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_31%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10%2Fformat%2Cwebp"/></div></div>再看以下源码<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665460240687-3d0794c4-e6ed-4653-9463-767a7f943ff9.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_34%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10%2Fformat%2Cwebp"/></div></div>Spring会先从一级缓存获取Bean对象，如果一级缓存中没有，则从二级缓存中获取，如果二级缓存中没有，则从三级缓存中获取之前曝光的ObejectFactory对象，通过ObjectFactory对象获取Bean实例，这样就解决了循环依赖的问题。              </div>            </details><div class="note danger no-icon flat"><p><strong>总结：</strong><br><strong>Spring只能解决<code>setter方法</code>注入的单例bean之间的循环依赖。</strong> ClassA依赖ClassB，ClassB又依赖ClassA，形成依赖闭环。Spring在创建ClassA对象后，不需要等给属性赋值，直接将其曝光到bean缓存当中。在解析ClassA的属性时，又发现依赖于ClassB，再次去获取ClassB，当解析ClassB的属性时，又发现需要ClassA的属性，但此时的ClassA已经被提前曝光加入了正在创建的bean的缓存中，则无需创建新的的ClassA的实例，直接从缓存中获取即可。从而解决循环依赖问题。</p></div><h1>回顾反射</h1><h2 id="分析方法四要素">分析方法四要素</h2><ul><li>首先回顾不使用反射机制调用一个方法需要几个要素参与?</li></ul><div class="tabs" id="反射"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#反射-1">SystemService 类 %}</button></li><li class="tab"><button type="button" data-href="#反射-2">调用方法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="反射-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SystemService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logout</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;退出系统&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">login</span><span class="params">(String username, String password)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;admin&quot;</span>.equals(username) &amp;&amp; <span class="string">&quot;admin123&quot;</span>.equals(password)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="反射-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectTest01</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建对象</span></span><br><span class="line">        <span class="type">SystemService</span> <span class="variable">systemService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SystemService</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 调用方法并接收方法的返回值</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">success</span> <span class="operator">=</span> systemService.login(<span class="string">&quot;admin&quot;</span>, <span class="string">&quot;admin123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(success ? <span class="string">&quot;登录成功&quot;</span> : <span class="string">&quot;登录失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info no-icon flat"><p>调用一个方法一般需要知道该方法的四个要素</p><ul><li>调用哪个对象的方法（systemService）</li><li>哪个方法（login）</li><li>传什么参数（“admin”, “admin123”）</li><li>返回什么值（success）</li></ul></div><h2 id="获取Method">获取Method</h2><ul><li>如果想通过反射机制调用一个方法，首先需要获取这个方法，在反射中Method实例代表一个方法，如何获得Method实例呢？</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SystemService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logout</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;退出系统&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">login</span><span class="params">(String username, String password)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;admin&quot;</span>.equals(username) &amp;&amp; <span class="string">&quot;admin123&quot;</span>.equals(password)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">login</span><span class="params">(String password)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;110&quot;</span>.equals(password))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>想要获取这个类的三个方法，首先需要获取这个类Class。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.powernode.reflect.SystemService&quot;</span>);</span><br></pre></td></tr></table></figure><p>拿到这个类以后，就可以调用<code>getDeclaredMethod()</code>方法来获取方法。<br>假设想要获取login(String username, String password)方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Method</span> <span class="variable">loginMethod</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;login&quot;</span>, String.class, String.class);</span><br></pre></td></tr></table></figure><p>获取login(String password)方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Method</span> <span class="variable">loginMethod</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;login&quot;</span>, String.class);</span><br></pre></td></tr></table></figure><p>获取一个方法，告诉Java程序，想要获取的方法名字是什么，该方法的形参类型是什么，这样才能获取到对应的方法，因为方法是支持重载的，所以获取指定方法必须明确方法名和形参类型。<br>假如想要获得下面的方法，代码该如何写？</p><div class="tabs" id="获取方法"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#获取方法-1">setAge方法</button></li><li class="tab"><button type="button" data-href="#获取方法-2">获取方法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="获取方法-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.age = age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="获取方法-2"><p>其中setAge是方法名，int.class是形参的类型。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Method</span> <span class="variable">setAgeMethod</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;setAge&quot;</span>, <span class="type">int</span>.class);</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="调用Method">调用Method</h2><ul><li>获取方法后，如果想调用该方法，就关联到四要素了<ul><li>调用哪个对象的方法</li><li>哪个方法</li><li>传什么参数</li><li>返回什么值</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SystemService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logout</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;退出系统&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">login</span><span class="params">(String username, String password)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;admin&quot;</span>.equals(username) &amp;&amp; <span class="string">&quot;admin123&quot;</span>.equals(password)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">login</span><span class="params">(String password)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;110&quot;</span>.equals(password))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此时要调用方法：login(String username, String password)<br>第一步：创建对象(四要素之首：调用哪个对象的)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.powernode.reflect.SystemService&quot;</span>);</span><br><span class="line"><span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> clazz.newInstance();</span><br></pre></td></tr></table></figure><p>第二步：获取方法login(String,String)（四要素之一：哪个方法）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Method</span> <span class="variable">loginMethod</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;login&quot;</span>, String.class, String.class);</span><br></pre></td></tr></table></figure><p>第三步：调用方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Object</span> <span class="variable">retValue</span> <span class="operator">=</span> loginMethod.invoke(obj, <span class="string">&quot;admin&quot;</span>, <span class="string">&quot;admin123&quot;</span>);</span><br></pre></td></tr></table></figure><p>解说四要素：</p><ul><li>哪个对象：obj</li><li>哪个方法：loginMethod</li><li>传什么参数：“admin”, “admin123”</li><li>返回什么值：retValue</li></ul><div class="tabs" id="完整代码"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#完整代码-1">测试程序</button></li><li class="tab"><button type="button" data-href="#完整代码-2">执行结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="完整代码-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectTest02</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.powernode.reflect.SystemService&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">        <span class="type">Method</span> <span class="variable">loginMethod</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;login&quot;</span>, String.class, String.class);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">retValue</span> <span class="operator">=</span> loginMethod.invoke(obj, <span class="string">&quot;admin&quot;</span>, <span class="string">&quot;admin123&quot;</span>);</span><br><span class="line">        System.out.println(retValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="完整代码-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.nlark.com/yuque/0/2022/png/21376908/1665471501974-88a80910-1c8e-495b-956f-d6b7a82bf5b4.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_11%2Ctext_5Yqo5Yqb6IqC54K5%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10%2Fformat%2Cwebp"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>既没有参数，又没有返回值的logout方法怎么调用呢？</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectTest03</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.powernode.reflect.SystemService&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">        <span class="type">Method</span> <span class="variable">logoutMethod</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;logout&quot;</span>);</span><br><span class="line">        logoutMethod.invoke(obj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="知道属性名为属性赋值">知道属性名为属性赋值</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>知道以下信息：<ul><li>类名是：com.powernode.reflect.User</li><li>该类中有String类型的name属性和int类型的age属性。</li><li>另外你也知道该类的设计符合javabean规范。（也就是说属性私有化，对外提供setter和getter方法）</li></ul></li></ul><ul><li>如何通过反射机制给User对象的name属性赋值zhangsan，给age属性赋值20岁？</li></ul><pre><code class="language-java">public class UserTest &#123;    public static void main(String[] args) throws Exception&#123;        // 已知类名        String className = &quot;com.powernode.reflect.User&quot;;        // 已知属性名        String propertyName = &quot;age&quot;;        // 通过反射机制给User对象的age属性赋值20岁        Class&lt;?&gt; clazz = Class.forName(className);        Object obj = clazz.newInstance(); // 创建对象        // 根据属性名获取setter方法名        String setMethodName = &quot;set&quot; + propertyName.toUpperCase().charAt(0) + propertyName.substring(1);        // 获取Method        Method setMethod = clazz.getDeclaredMethod(setMethodName, int.class);        // 调用Method        setMethod.invoke(obj, 20);        System.out.println(obj);    &#125;&#125;</code></pre>]]></content>
    
    
    <summary type="html">进阶了解Spring</summary>
    
    
    
    <category term="Spring" scheme="https://silvan2077.github.io/categories/Spring/"/>
    
    <category term="Java" scheme="https://silvan2077.github.io/categories/Spring/Java/"/>
    
    
  </entry>
  
  <entry>
    <title>hexo快速入门</title>
    <link href="https://silvan2077.github.io/2025/09/27/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"/>
    <id>https://silvan2077.github.io/2025/09/27/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/</id>
    <published>2025-09-27T05:50:00.012Z</published>
    <updated>2025-10-05T10:02:25.270Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="aaa10f3c956ae012933e53a55b05fd528e56411fbace09904f0c2f8d760bbdd5">21f8e907b6ea59635716f91a3e5cdbab72d33928ba381b85ffe61f4f375cacd4a4b6cec2dac48eadcbdf2114b4f01729a10c03a134bf998350f06a99a208cc2dca2c5f1bd070c63c30c528c950f95281c7594f5f1ff00894995e3697886602cc3cd2833e1370b6c9a130273e6ebf1fd207a98dd517d0cc74d428ea0955bb369492b14f0df7f5ee5ef3a25b0ced5952ed754bb54b2c0b2ba1be51bd679a2d664d2feb4859eea08f5641f9102c57750c93f38a5bc5d134553ab4a7baa8f459ae1691ff2cbe1a721fa5555ee1db5945c55cfe477d54796548ccb8fc9fcf1c46abb9100fa63136227b927589a656f63b3a25ba0d57672378a5c666f7aae36e06ed0d420658fcc39b3c05bec274a481620c224deda982db19758e256f26ede424a9097085f2568c3929c0e18bcd76ab21f7cf2cd15a3317fe09bc87dea5ebdf9aa8ac284d97f792f21f4adee4cb0d10c4cb3d7cc75254f8b5ae48e884aa532bf857dc03c0d77e1dff106d046cdbeb49be148b6673b4dddcfbb5d1452613501344828eca1341058a1ad02d7413b8a3141d103020b61f890e7484f04adc3ef05aa674045a418d85f8d8946095ea289f1069ae0f6fa141da95078059d145922be9313428d4f85a4b6e25b3df510256c25a50ad3eef81fb471a7405666c29fa5d516b5c0c9860204c6acf7cbba6fbef9be27493c52279f525d19b3885094a63d1175a2208372f8709102e386b74a097fe5640d18197f88e757fc546037f6b1af765ae7b64ce0862a514fd4cb4c3563345f6861b21a4faf031e735a0b6eee4bff13f67a76bea2e9ee4be1f75ec4f07d82892eadb64b37648eb35e489b53fb73cc7c948a98500bf5c3b2c64240a6a1b764d0240f7b10afa4dd605cdf7dd11ea9a7c06cd520881f8a37f3c6fc7df0cb225b2f36d4c0205d9eb721ac1c7c0c6ab9d8ac0615c7ebb4240a7a4313e0cc3449118eebef88d5c909b84184f9c93f4c45fbe555ea42742919d5b2df9befe60bc480b6def835e0797127fd4fb2b9a9466b47b57c83da7a6e18ecb6612ec61349884aa6746bb359bfb18d8b30d95694569f984f5cb32fca2420eb5d38234caa8048d167f84f265540beb17e6d6132ff87a39e34acdd2b33c98707d565ffa023a70f11c22d59ce63d00be9789cdf1667a777cd161f4119ceb5cc42c01875fd4eb2094bb8051ef3e12f4ae6a38a32fd65155aa36591166ec160fa4b1a98d59401e7196b405e67ca8011d305cc6f0fe7f34e7d6667e05b0690ca15e1cca90598d237ae99d9392eb7feea50cfaa24c50ca18a559e78ec218f922a6c3cc868fe7c116afcc198c79f88c625344f5452a5f51eeed50bcff887eab8737e0576206c15d4bf4d7eaab237661227d47af9efb2b5dbd2b3c75ec66d7f114e8ecb505e800ebf71c4b81e19a3b7fbc37a9bd1ff95a199567e3b41714d2995728dfa012782e167c8a7e71d1f3daecd710d08923c21816bcdaa2cf0d4787d0d96f425068aef2e344197501a038dbe9092fc2f80d8755f5b2436e0a072acdcdba142b0599c1ee48d9474694e3fb77de0329897543a04c7bb430baaa64c759d6dc6c081a143003aab3ee15b347a0f258c850b39931d786a23ed180f6409fb9c78a39c33525199c2302e16183efa42c291789d64dab18d05adfa314afb4684dc31a65f53033dd9ad3e1b940780662a8b70d632f76b561ca3ee84cee914455a6f33efa8a5d682f64e51e6e13c2da8f148bf600ec0448668edf76fe10e62a23403438200c241c9e8eaec140a61feb76a4e32a7de72facf37abfbcea3539fda94264b380b7c56c7868e42ed1d4d211b849d850bf9ccafa8bcc24741e046f8224390a26fe1b8938cd882c6e67eb600faa913225a710f403c870c73e4da34df87be9e34f1faa70cd6ee9ffb34a4b7d06be2b94bcfb91f503bc98b491053314429111e1eacdfcfd3a0cec4c822756237ef127ae9faa68d1271ea6990a095da09ac83e16247f47e56e0894590e9163d86a432f1ea6bf5ba93345d9fde8928738553796bc766efa5d4cec6eb4a097280b45e0fd16a8d700b393e53bf87bc9d901bf87272a857b37560919e81bbc33e21cd15dc7264ab3837c6309740e58b8afbc30a15c31b210aa62d821b8dcfaa28c4ca4eacda0ba0b4c1b37b9431031c93e3fb0ccabfe1a075619c48367bab0310def969daab6812d779887d307d2c49723fceea1548cc41b7a29dfab5cc67f51b54782509a90c31fcd189ce616d440f6ca3036bb6713273542a62ae4e1ab684f6dc4ec2778952780852bafce60892f9a8a5ef6b5761d3ae9972478e0f9632c1f4503cc78052b2d1684b77bfd9b3a755ded93f7a2866826d123ba7e885aba8c6258385f9ccf8e59daff52e87a468931f91403e542e7bdecc88bd23b70b7d1dbfabb1640cd0d3cd5bbd52bf29be73f81ba57f8c730fd69c03b7fdf617806b1d127a81976ec18a9a616f816b1d6b2150bedf6ca9a0b6476c686ed615fc4379802433f3855bb89e83e39d1d93056c0dfabb49747666b75321a404d66efb7cbf1eff4895657f4db7595d3db43aa8cb60e300f117721dfc5b391be949fad1766bf7c3614bedf3eaa3b0c9ccc7dcaa08de9df242efe60bcae5f4f3271579e24350d5a71f4e4b777ec81c4999a3fcd137d398352a74354060180d230419c709708c51bc48f3d53136bbf3bb2b249df39daab67ee7a8bb626ea6a393e7852ce14bce0d4c7faff8771a87f0ea8edae10eb8a33498146c05bb0fbcd4d64456ee33a56b365b49607abc9096ca4f5ce3db541dc3ede7019f127d314ab9f9f5dee9e87e78af39d5f84d9e7edc53024df78202b9081ee7fa77da5464c13084b45651edc34f00c7227ad1ce24527fcd291bb9b0bc374b462114a6c0a74e2a06a3d4fda4a88a914b4bdac41d28890d14af8827f71eee66133bebe1c44a23261bfba859c8fd9ba1b2e1ca3ae8d1c359c5fb99e1c0781b565dfe03ea34b16296aa34494559f11fba91f9d9bc46226b1caaeaef6170d38c2ab298ba5a55c0e9b90688f9346bba1b9ffb11ea7baf573fae576302a59f1d8b23d21ffb2d0dddc21288f4fe75a8b52b5ae5e0b7bce539d6db7a3bc8880395b87cfab1430b2bf78c7072acb71fb9918d1d662b3417024a00c9b5b7f0c0f98fa326c74926a451781db82fa9b7763a1b6cd33f440856ae2eff669dc7e9989cf4a64caa758a144671e7c01d26b39c12d5bcc1f313cef8ab97590ee8484997601cf0a44b0dcf18cd5368e93be7d363d38713f4c3c66763803f30e4401586e4070f902de434a5a05402adf5c38f2ab2838309f069aaabe080b46bbc5413ab26e77815085d621f8c21fe14b40a8dbe28510078d53799614813b8092e11330285302de9aef9f5af6eda823c9f9775c4fe63a54171c884587d1b32e97f984936686d2c8c459efd604d8d90fa151c5851c619df0e8f76da27224b90e0e6fa0c685ab57af9de7dd4ad64cfc20928b8ae7cac580401198d665fc6cf6de6f3948ebc7d3784d0e7dae6e6c380b03feebde71df0596a9f93855248e32882f4af004fc40adae83107a63b6ee20d1df401d665d6fce845f34b146e3943f5acb30ed534e8007b0b162a4a57ca7f56eaad04af03d01f568c1fc949c483c32b95ae1d8c7c19942ca4cf6f49777046a029c55d65594bf9b4cea29d90928ed4a95684010788f0a6d9fca223cd3c8e0ae8edb005a635a9ac5e123cbb35d28e63b933a337bd44fbb833faa6f379498c94874b35649bf17cd5863ceb3f66518659c71a71497a878661726b90a01fe285d9b4591b2dd8996ec79b12c68cb8f5fa52e9f7a0a269a03995227c7ea69ac1f2172a051428cfeefabfcd2c3cd572c612f69aba7ed9626619b5bd1386371a10014b14b5fb326295db2d4356ac1c53704ba25bd4d24f2222131be75390daa16f9a50664f49eca24f3a14fe58e57bc6bc405696a12236e2d3452f0b73d7b212c8a2fcba4a3815291194984a4978fb76cb3bc8b4fc33f54d5aa214fe18d7ba2318694b9d92c9cc1e5a896d1525f9551a5785d27ded5e23c07de2cc815446d594473f272413879133f197523aa87d9edbf65ff626c2fe1459e54f98c46fa86ef3ef14e2c6e47b1a7b3c87df6648f3ac5a6b19c028ad0672a58e1df2b9d71ffbefba5b65e61810b27da79f9b734bc64b43a567c749a445baa8cf90e5be5be01016a4c9b2a290b7674bbe87fa0d6b4f3a8ec5529d09561a043bfc1034bd5bb85789fad0684df007d4e8bcd54d2aba9228f688c90317e9449acd963c3af32fdeb2d98b583d75df43d2513422cb8bb6dfdbfe707357a741249bc58fa8c9e89fffbeaafac7a1a9330623cc4fa0d09d49af80284425a3b0d4a918293cc97c218f63e399b760b04ebdbad8e6e2fbd9b3dfde8c0c9a539f0382755e1ec30781cf9d280a53d513efaa4c622512c4d334a94b95ad9fd25a4edb045b2ec96e7d7257f4887d336920fe9f8860cdf18b40a498586d75d1e83bae0cef546620cf2563e9ce3d077e7f34c02d6b1e05f06e84684e81c521b37d8aae4a8b3d015fae9b3f2c9ebf4b6e4d0b0b6f2eef19900fd728ba25cb8e17b90f1caea9b8a728498250cec113f992cf0e7b5a83d2fa4a673eb04734f2665342185442ada89cfb2a4027a8d0188f7f50c4c3a537e79b545572f10eb1136479c99df440244a484498ddd56a5a318c90cdbf5c55081d7972234bee9842556feb1916ccdc5322ee8b6fb9ca224ba1b2a162c9bfee7f083991155394e1f1139718e0305ac3e14195ceab8e3c7eafffee34568e40d3b5d7aa011e62bc24c05100809b983f5641193ee0f82845cd6a4f57192013ff375cc5379ec0384f88ac18533989763051d1c8113a84ad492b3d15853e82ae740a1a9c9a5035083996de52e73f300a8f6305267c94dd238880b62f86d73d41dfaf19778470b10b37d0180562868187bf4b40cca79ef0b1a462ab8e8fd4f7098051ddd7bb3ccf5421e392264367d689286aea5aaa654edb6f444d8d843abccb5d89d6aa11372dd655a00188f27bb29702f7bd324fd5f0a060eb78c47840fd4a0d54a055fca268530816efdd39e8f0877a1c96870029912e16aefcc97667fafe803907b8e13bec19a0f8a7126eee043deb831b16354927b5ea59361cae8b07a63969a9e3c5492d93c26b2221985384e10d2e01c2dc46ce004d301336937a7bf8c1d2ce68d864c5a6f45e5eb903c268649da1f4d75d4d310a1284b7e236dbce0371a8af2f5289717be4f9e2674aa6cab4efa9008d3e6dafd0626821037dbed157810ac9f69b4027c48575cc401cd5d979aaba3420e33fb4f873cfc63eee8c1f2657516bec250a2350c5f4748b8110da22c98e4ce3817f19a2c02b3c506ee925b3f76affbb914e2bc72adef0e5aa9519226dd9ddaafaff082c318c4cadee028fe591390a1aa7e7ba133fcbf82b0914082045c8de6eea94b091179ac772be49cc45cca4382bf471cd671e0fa5a4aac89b3611e70076b8e8539d384b631248484061141a5110bebc664589c4478c5fe229b011a08ac45e258bb3bffdc061ac04253bda98c242ec62f2e62af398e8e7bc92d2d1132f9b04da6fcd94d4d72061aa30e7133311d4db0bd2da75272bb1796c9732131eda84e867f5015b996df28d9c84a3ff2305acc44b830783641c9720c2dcbf6f02dd6ab8e49003158c4c15b3d6a5eed5828d6954e74cc57db845dc757d430619f85ad18ea3f9d37ca193c0a19888d6d2f0ed16f21788db4c3834eb7bbfd6646e25c41bd866f7f80c3dec3559d8623896dfe725b93d4ceb014df066388a85776bbe5ab6667caa0baaad7dd5d4764c9947996067f0d1d3a6e1cb0513c282fe3426879b0584ffb39a63d6900419615059a747afc09b8a3bba5df035daee09897c34e2a98116a20d5d88563b9c98f3944d9ccdff02c9538200feb05c19f5ff90086285020a59de143c653ecb4000f8a6c454529e54e5b254507a7f5ba8af0385883e4fd5aabb002c3935fe40f63d46951ece14cc8a0b70150d70def65704c1766394caeeea8f153bda603ed27d7f4e495053c780b6ef8907de630fa6765d078137780ac0e3036319045417bcb5fc6946a6bc153e53c4ad13fa0d7d8a19c855ee5149cf07a7433e03bea22be118fda237f905415a15c719e1d6ce236401eabf2ea0c866fb827adedb6285916d6e24905894572bc4af34e7ea2d9d22c9231ca0e106d5bd60ce601f1af2a93bbacf700adbe513519aba5929085ed20a295f7996a8129cb21b226eee09a4cb0e5349ac225db9ada5a08a1899835b4b940df1fcad1bd08bbb84b926d0fcd85a1427420c3edc47055e1772bb2d672520667c797f8749d7ecf39fc097045f1688c41e387ceacd02d7ca5357625088d9e2ac5872db5069bbdc4f8dfa00981b98410fd60ca2a99eb1124b49368275dedcd5ef41d8f5a640b7766baa3401dc8608d15bb853b5d8730d6ddcf4ea3bb7616d4bfbe7eacf8b578612f1c8618339eb5786543ba8c08dbdbebc912d23726fe38789769b118f7b942a57178112fb52447a135bc4a4fbfa16a8a34cfe05b9590184ea04429e51b3d1a16aeeabbab53d87534cc18fca76facbdb1dde594aa821126743d29187cafcd86e616a899b7fc05f7ede1ae9bb85a69b0aeeed4da5d87f3aa114087b8a8d584e4d7d95635e1c653b1e970bdc9e79e7cf66bf339a8e736e3b6a1c8d6a119140bfbe096bd3d0225395188d64eae7a32b1b55eea13ebed1c8a5845b94940c0c7d9df529708c5a164dafca4fe4fd1cb58fb4dae48ba7554d021fa239a63ef22fc90d30719af2fce2a5f047380111000e949c18cc16d31022fc6117c54aef988b84768c7ab47600b506665b7b503df26e89502cbcf4a6da2c70661b364149a1949e4635e28d679a9e0bea76fe152afadf3cc046e43c7dcd08003f48df952950a75513350f871ba988ebefcd3b4da27dd90ab27921b988e9b3e9e1fa022b6d1d6d9a490a79f9ad6fa240e4e73783236edfde4cd524d63e0411dce5dde6c1a3a2ae6dab1bc11ade6494dc3e287edb92d2da0cc7312248ae037268c4f7565872bfccf8e24667dbdbc59e746ec086f6e4d95ec70c6df8c477788fde035e08a6499286e6e0ae5fc784e248ff2b276039e5e55645127e7a65db86cf95f1224e4266a3b240a6fa90393386e003da9baa69f405bad43d7d48f89239eec70961d4bb90ea272f03991936f771665dc46bed56733b6ba0e55af14cdd845ffd3083561dec0f955b9eefd3994f2898bd4e8a01c64c7de7a35d0c20e2e7fa4118a65df00f7991a182cd1d303419ff36dcfde1b5455f468ee128b5ba3c14f4ee0db9d0b452e53ee5df4a19784f9521c74ea7a543cc6b4bd6065ab881f24c5bee070584a15eb877adac7f650a21f70d4a061700b5118b310e847789a23a000e4b2699df4348ca70c503c10efdcca470fd6616e6a8ca427d6e3c68f1c6261e96430d63e71883db60f873fb447e6449da98d304a4586163731482674b8fa6799a2b2dbad9cb50c341ac10e346042411e36013720db8855e37f184785efd9939f24a6f0293cb7114e8e60a57e0eebb46e5364ba14af17453f28d2efbb02a11ebe92c8ebb3fed091b5d39b3e4e87692819238ce57efb5fb2f8908657fb87661562db6877da8354621aa6b2bd7820491d18a551c9f51b50f8c76fb201e6a6c9b7f1516aff0f998d84fd4daf87a44371f50bd494d442a0b8c70ba8fdef64956d93b6ffaa52120f4f9e8d491d10f8f47e8d06cd7d0194b4de03351ab2f8e8078eb86248b22ef09ea0b2ce43df732e8627449ede3c3f244ade3610366919720342d78f2a498858e2085abd7df15495517438ae0ee6554dcbdc658b6257cffeaee406fcfe663592f5b683576eae31e2912175e50d33497de6ecf171bf39f50d0d342ebb2abe549cce23e31593cd820b1ca9924dc836c2ac97ad8500a96952c6672c1f7bef136a270cfeb6b71b4f1503483b6fd5f102fdea83954d26350872c6a319614d0d3b1ec1fa14e9401225d682dfd9fb13d96f6f2c1340ae77db06b270dab278f2602e9ae0d049ec6e6adf66ba14bc1673019fc9ecdba13a5a89ea1b62a044c79c1ad5ce22e5a485c0b42eaade084ec59e98908c85c9dc5d76e863c739d01a978a56e26d5fb504e4568ca613e72bbe425cd0acd69f3347342f39f13a53c1af09836bab3a356ba3e0299ab3c1cf8729c4f2695b73c7c00ae7c6dc12c2d083c50a5c0640a40e7abba240c861e4eeda58617fc9ba2f0d2aba0a97f034c6d6af0c293218ef0328a508bda20580532713bcf66ddd7a8cc079ce3d8f613cae906bff1a71f36e5092438c89a98aeef942e24d3ffbb17dfc1d6a1649e6302a5a4ad8ebbf03f26123d989727153fdfa163777ee190cb7d1853da2057e739aa351c25b7f9ef12953b18c3c2e37b3868c6cc0a7e5f1f3671ee9a20643c0b1c3938c6badb3ab2758164437900003296ca885e972036c2d973c12aa3aad00fc1709f178482b912c47de47bd06a9b905283fe99659ad9841b2cca3b5accec73df36d45a464a66eaaf1bbf79168f9d462bb7e7369dbb5de643995f32f5264604b60471f1507903a6b52367b8cddfe91df71c19e4dbcf7cafbaaec95175be3df23cafb14f28721928fef4e37f227623fdb5507007ea108de806228f87beed90e249ac9fb1f72dd6e9cdc38e19bcb67212e23d27e0a84c6cd3a6ad2186176ab77b06fc37b2fc00c6154b79baef93b2a8b4e60103740f3ef14d0c95288c205394d8d151dded61753353a4ca08f5ece2538d81f87894824f2e421d661840aa07eba6c8c6cda2e4406e66188f602ebb714fa766faa93495f1880cad98a8315e93f6567f37b2f57d51a5da6b04fa0f613355f854e636a1e0e483a8638afee5e89648b798a4c4f77edee086333e62ad1c5ede11bbccd4ee7dc8d62c3742cdd6aed11a97aa7b0311827e0fb34104d479ef03a91441bc68031f5b570cfec6b9c779ca63a28560c92ad0cd86af2893ba48779048693e42cca4922ed4ef23f6d33a811d1505eca90222b5d6e0268302f9e2c557d769e35c4f4f8b6b5b121b12b48129b6220801a1b5c13667c3f477e4fe882045c1a6b49c0fc1529cc603e7156ccb29aa181ac020f0e5b0f441e13be1751a7714245a55ffb4fc6eb9aa841d7bf75d96cdf6294d79bf76c68cc5cd572c8a9707647a9bf6fb2e10032b4da174126b924b7a9e7a8bb9acd77e93cd24709f73100ee82ee4d8072535a885e9b31a0c1895864d8ff3de5ed2e184777567fb804d3567656ccfb65204e26c772794cfcb47c303ebd093d26fe365e0ece681e74dd5c03c0b2fb4d0425900e091cf679af9483d6f08c23eccd9dd16f6e87a567e2a7070430ebe84e2db0687e0d9ef7374f0ee01ed7ae0d5cc8fa8d0aef00f89d2caf5ff304fee4a0d4b283c45ef65217cffbf18f7ce073361479cc119aeda2e1defc75add5f9e885d09c6ecb126298739a3d3b76d9f3c098a66de9ac2d22f11cd64452e7227117c9635f6228b1c7c4ab7fda0faed9ad3a1b2181caea811e22872c459f0d86913ddecbfe105dad5d9a490d6d21027c63101cea19a3bcf0a147923858fa107b49d5b1fcdd75722cc35bc0e591647031becaf428f53ffbd7e25475ae1da1ceed47b97fde3e323bb5216d8f63fc3733a57eeb579117f3ba319df26326870a7015de6b8121dc0e53eb3045e4e4f4037e03b428c0970096a30b09f661ca1bf7369292f9fec8b58fc5237ca7facde31f5d33d8bd91089824cfa978ec29a5f458940464699a58907688a64efd3d612d2b37990713e8e7e29e10abd84522b9b5a1d9baf307e3d8f7367428149a0d55ef5713f85692763cad31cb8b7c78a5c54272331ed0bcbf6694cf5f29fee884435aa1274e0e4d56a9f78f0a373a19a9dcd1ac353e07d8758d67da24e79a5150937d4957a74d50d114c5c85aa35570099b1718a468d39d569a7235a3608de97887e2c659001c530c5aa84c328e06140caa242ed68d8ed340aec967b43c59eb46f0a32587cbf5c88b3e234eb1e932d57e3c595e0de01d7142ca0f7b1dd0a63d8d82b110096bd2c9602721f9c48984a3d34e1b49aee592d64fffce324ef0645348947c6f38ab6cf30429f61743107f435d958c453f29c864fe31e26a2580b35583f262b3c4be8fe67556c1b60a6a8f062f0ed8f6772369dc8ccb30ae32b300f380b6e4253e962d8d8f82dd273e90a341a96180d2c14ad90dd9febb48e8f07d0b62e443f7100e359254b9c0514cbe2db7db57a83c3e1f84dd5a51d8147ece845108837d6c81859366353ff1a07283a2aca4cdd49829f4f3b171a3843de0952e8da3eb7b4485fc3617a5e451618998bd76bf4e210401f170ba3db5d2fdaf558b66204752c266281af84e542afb56e4b9c05d6a63a7cf150f7d5c32fdd97c4c6808dd8025499342ac36bd9c8ee258ae392e161b9965f8d1dfab9881af955c74e2276137554c073e51c7e381ac2e4e64fc92381c65374255ae17912d3b5472c5b84c9f9187b7fb840124d3b01637e37d22a62ae5b3e686fc65adbbab78abe81f4a0ad3829b10c0a59a524139479270c9ef89fa9df28eecd66f13f8a80932425f18d5c64ea2762c84b44b0a9143f42bce91041d1c6e6a606fb5c2395ba41bfbddfe286a1ef817d1c3edf25d44d374e286aa51baa5ce31a39ebd18b830223622f7b7a345b42dddb94d7ce0d2a47493c49785c93b36ebb6946b9a07e9e9c43cdcdd72449b52837538b8aa64691e45e281532a69dbf68d06efabe34eb7611ae24f07af6e98c1de8e91843f2dfb691d1e1893c7492c9500eb8723dc322e7ef259c26e73ae910ce1b0363564746ca6a945ef457c4706962dc178d7294986a61a703cd75146f4e5907d6d3d7c71147ddfd8dc0f0072c934fa308e6ceec649f3e992c81c3b2f9422a578b27a0d0b610459a1d16a9fca4544377134c5242d1cacd95b24cffe34c3292877a5dca93375206d3de9ca1699daa67355fb738ced5cadca5ec2c7377cdccfd109b06a5b588228289dcb1a0100a04825793e28d1551d5778daf03235f8d0e21b8e2cc41651dbc6d17af2e0a62717787919c7d67d15c53ade75c35d4adba1530077ff0f7a1c840cf0e932463920dc585454bad1c479e71c7e3f40acf30cabe4844f565aacbc8670f3924f1ec91a25259ea28660d0a980901be4d1943d59b731210ff7a91be93dc0612c3620838f4742e4124e7aecb1110dbe7b9a97c64a25b9aa18d4ac9a45f10f5133f395b9b745dde2ba7017848d7fb4b7f991c09e8d2fe2d240bea2d3d6bc4106c3e396c1a664f0bc8934b590334004c585b16ad15000fb53bcb42c361bc917ad9c8069fab32b8e4ed4d0ad8f596158a148873ce3b28de7ab909bd62f00141cae702d95fc41cad40f0f52548d409df735a4e8b089d64365b606880ab0a9aab8f26ff181e43bdcf21a8c5bd851068e20a5f9328f8aef1dbd4da2d2267210804e6433c6aea5b415180dddbc104338a543df1ff7acb73b713698a6bf358809114899310659f9caa45c2378ab2653d40011b73ff935f2e88ef5fc3ffa9204f8c1ebbcae7e7ba2836103df858ad04f63c4efe2fa959420b059d2c291aea7bc11b617b178388621a5318bec8fd92b18caf2b5f69b45484350024f1d082b298a6e98ae004059bf76da97b80d2faded6fb6a323e5d73ce2a006eedb3dcb8841b0b03a138760e43e9911f2be0f30303ae62f69e2e6dce48afca99e3d3ab52e9625d7265d683bb2149dadcb16fe7aa85e08900bc9ec9369c7be50134c8aedec219d7e34f43b1b612215b2caa8c45bb29856597b5fa065c1d662cdffced680136ac0b42aba979152aa1e824627aa519b062a3c897c027c4818bf32a0ca0e45175c99ad766f2666dee79897c84edfc6344a872b29363c7d89f4ef3e7f486d87c1c8d55e834b9324b58ff73f3bf6cd241f3c627e8453acb79712563d0e4b211b754a9c53f7546dfbe06c9b9e0dcdff1cc717578e79898972b235fec72e5271802c13dad21d6c3d33ed1f67cfe9dd4ce9bdc8611ae458452b3cec70f19f9bc961d09eae6b26a855bd9968072ece6ecf0ffab983f339f4b0f8a3793929f05c12ba6838e0e1b24239bfc869a62ec144ee4f0caea36c129d57e8602cad89a810cc9145af54152cda3f5d66de518034fb0b401934e0c488922a8edb779edba376ae08a86a0161e71e7890e09b0d0ca8ea91fd8f15cad23e6a9c12dc6f1fe8a2a9b149cf6a474676d5b506533c2fdd9c8fb3dd373b6a74b194873e605dc86b3543e7e907b8d8d01e6f0bb924d6d2d14a38d4bb759e4cad7ee748469cef09ed6c0a64fd241f2442c8a27ecfc57255dea48663e9c9b8a4b7d392ab90756f803ffbf0d3cca21480f214792f6b03d2499ab5621e030c99f9cc710cb50498b53cab86e4dc280e776be1e859e29f1463243f4d6ddb3310f99c2fddfd0f66316306274ff7136fa10065de40a7325cd5cd5f2a337add6ea606f42210a9e8a0da85636edf0f0f982df627f05f97db531c322bd7ce3446aca7c7c0b1d8b873ac5f41c548bf2beb0b7540a0a056d0fef388be9c1e50497e8fc11421025e19f688b3848c4a6cccc914095369729d4cef3d808188ff894655984deed461d3e2ee716c298e325bb8a797511a9dcaf30ee7b871a80f2de303799ed9015cf36b825f042caffb5b26eb912753b97f39f67877a11c58309c8cf6c2f61cfd021366e48b2e681aa2784d31a5cdf9dfcc2e50395d6b873a305a4c877c4ce892d3739696de3af587bc377647feb6f16afc5e1f316b541a5925bbc5986d5998350c2e9b764dc41aa4f1bb7f6a1a7086b3f5ad856140272798f9151fab001ec420c66700b0bb20228d3dfd2cd4a48a9bad7c3a6211b7eeef03cf887353bf14fb8d0225aced697d47b990d577f19e77d031050da97d2503cfbd83a8dfce12887198e6187d79529f6c3d19d18b551bf1a8de3704dbeff76c10c19452299525241d10e0585ee77e18d779807eacafddb6b36a64177277dc536c186f6f06e13a075480c25682c222b4a41f7ad68aea625fd62a1aea8c13c20327efd7bcabc18526724861504112d9e69df92c43a4a2376fd06dd89034d914673ff3e86f0b54963953bea4f3ada394c156255a432cd8c280d594ab4b50993678f234010be5e198525b3fef837f479e9da5e4c19a5b2099a75902fe37cde0c1787030e6f996d5875bbb144b08e386d261af8a766c50e34044b618311cf1bbd534f35d7063b29cfc0f9682eef1015584863889badfbeccca834c4b6e5d09df69673aca039dec3daa9c112f140cecba58ee3a0a7351521092a8602bd5b83bb65b47470779d15f1e13d3efa1335a42c53062b2b1548eac8703d4942abd522e181a9494993e1f646e994c07df47c2ee5c9f50ebeb727a07c6fb99d1ac413f0563a6a9bb5abc54e4eb4612c916af7aaf45453ff0ea4cef17606b0f79ce34bf5290a2cd88802bf7cd7293cfeab2a04e91f442a735271ee551a258dc9074fbdaff76d442a70797b78eeb0b0a92df7369a674c9a477d634d40be8a82975cc2faa2f76f160842103fea21c8015d29b6f5ed8a2f48aec51e01e081aaa55fa4add32eaa4583be2141ddba0f8d45feb2158bd99260711ea63c383430e2d11b1504557765f0bc20d8f479573d727cab85b7c69f1013457e9cd69362025d4c7526ece081f731eadb60df528ca959b19e1b3a3d0b14938bcca142a640a96ed7976bca707a4fd873a12f71111b144669637a3a69331e59b6ef2be407c47723ddbf5ef56d846b568991def48a88e4f96562e036b44e186db2a3fb2d6b5458e7f4502fddd0e33a8836f5c171384190c053e3dc30cb508d987f7bf9211bc7304d67fd710d65cb4f8c91ff25949d46b5e1b18e05a603f7252d3b353103a724a9983069e05de79dd502f74eb66ea18b001ea5906836896efff28327c71b56c5873fab3fe6e2f726138480d5b9e19b70008468fb8ad4442780c6c2935d799f0c9c66d2a57eb9c94dbc0a108741cc902b63abbd63b8d85891f48ebdcea63c570db51712228092ccb351f4e214c00fc07dbcbbbe439e0026ab42358e955622a5a3351d0c450f41f6055e3589471809b16248418905656046471f3fe32b3e2568898e998b649728ec4229cf0ca6b80ef6646498228c2fbe44ffe822893b305403507488838f4a7e6abbf6fcf84a96d7cd677f571d85e10df9479538a937c5bedc0fec903b04914e8c067012af168bc0a7e70f88622fa7b1d02dd6f7bc0822c499f698727da24fdf9b1993de0455aff94cbc14c168ccbcb1e2ebc58594d79983274a3663ee8e158e1e9981ba623f1bd8c8698d7db035ef4d7efad4a383e2df67da67ecb2ebc689b70df43dd5132f61fa2f155d3f194c72779962cdc734ab6958a31c5c582a3d99f6b88dedc8393827d89361ef93c1156f1e251afefa572d9c214bf38d6882234a95b6366eb47d3289d71e098b7583852c0102a62046cd9dbef284a5eb2fa94253576df3051e573a69f70d674562565a0f3c29c54c24deb6676d60e357caaff1cd78d5c5382fff20319ae07ab1e8ebdb11b6be1d65dd8f27cff1b7a6488cd07ca78b7a0bc8d1b96b8bcc6ee5383a29d43144debaae362d6cb2f470ddf2c23d4a01a1613557a4d7c796b447234c8fe513d64252fe422a414799801cdfb335d81ded4591b1f32a487205b02d2293bf449185528f14effaeacf364053f2df0887f1f4ec4e7b804ee7a3006ce67365aadf43cf43ec431ac9477dd03ff1ccc503948bffffe779493bf34c06f3937a90ee6c004232a5c5440b567721de7fc6bb5e9161406e62e9dcc1b8126558120804995ee294e17b5b3583998e79a7ecfc927b912c6aa7929b02a1b2e4a548f3aaecf739cebd25e994f072ab6d58cf1b47242a43743f273c16b0414efe01884caf167fc388ad661d952e94dbedd0f000d5bdb48a8e7fcd9b651515d11d2820f2b9fdaf6ad176d1cf852e1664216b72c44390b72db5fab9cbdda83954ca0c0e70d80760a19cccd3ed7c7e74869740787cfac7ea274ffd5796666de9b6edc47fd60642b393b037cf8f0a7e447090ba02a0c109b57e18e6e672a8b279375da6bd8566d52883a7157b8033816d1ddba9cd604845d922cd040861ee98102e8e338ba9ffc80512f466e53623cc58924a44fc6cf4fbf4b0ea916154520192a76fa125f7bf8ea015d6f4fc158b1c00382a712f5eb7b905dd947a0dc5e5c00f235f8940f78fc3b34896366fc9c227502c0672e9713533638beb8873a204fc0f3c094c661fcbbf73dbcc5e156c66c35895b8d8ef84d0cdd441c94426ac07b3e4111a109e85a47ada319610741eeb3de96265b0a2976df3855f61a75d785cd5b3e49ab2bb231836c80af04170658ff34ce454b8761b2d18adc4743407fca49048f82dda697d8befcf84600e806bca73f9784f9af15f03d7d288f03b394cbf7293252b77c16586d0cdff9f27988ee6c635d0094d6f775c0b690f1e520e7a596ce915e9704f58c3e33e0329efa86780361e8418f9a0d2540e4f808e6f438221b9dfda34295feef3e88a7a8922c595fde585ca0c07902ec6742e310ca7c43fba15754c0e014bf65a3e75fb042fb91cc0096c119e30910ddf6f78e3cbb7808f73e78edc9cda33bd108837fecfc765801c190b0797ee9b1c245861c79775532ba5277eb8c1b9b1323af993e0fe1b65f5e33327959a21797568e3340aae29c9b0cc1fec0c44fa0c5c5c4a3daf7cd725920a85c6bb1e30172ea314313c50a316c8c2129d608fcc6c2f4c4ea7c353c95fd529fc3aced1537fc11e5a2a0be33561ccea60ab4f7ba68f393373e4249f4df6a3a4f8cc299542bd648fa608f2e4441e95b42eb1dfc040f5159da478529a249c6e10fcd94610d504aafc106a4110389a845f1123cd1976a4e6373431316548cd1ba11208d2418f4a3e969a76521af29ec53c5976d73994d04cffb6a62fac250483986ece3a7d6fcd41e08da84e7bf96da8ea20d75730b1da854571ca4f00b66a9c9da693442d78d53cd34d4b9dbb1e3f8894d5a7b10a97acc66abcf26f374d643f3ec3fb94c14ff0a089d3699d697ddf8f89c853e5b8b3003690f6290579d3f264b1be4ddf880336baae302953d092546d5a36bc4a286f5c0612cb89ded98482766d9d7771127a09cc96dbe81bab28eff0b3ce8c4a71ca48b795087a4f4b3b70ae92611b41da20922b40613e917c58cf26d76fb3c64345abb39ca5f63ad0dc9675737232238c09df872d824e3a183133043a25c0a6481d2b9c4e27cb31f028409e281319ffa5cd26e3003bef051f46aeff9da1681f54fc5c10c22e8ccc801c09ac713777a014e0da00f67be828104bb91419ec96b615b4d476e0980be22f16348954a476dced53083a527a22e3fc16f12626646049297ff2ed092e9d7ab8b74288aa7fc58df2f4a44291163073e4a0225c4e9d3f7d79aad36025b84662e9afc88c5123ca7c7dd8193f9ba107b4928a4cc702cd021a0e8194a78573ab83d33b64e9e27113079e76e78ab757aa1760a2d7a16e66e49513017a6884af5b5759b8fb6298b5ab8153340bbecd9871962e56d1f0167890c1d19e116297d822dc6f6aad65b8376ae1f69a224035edbcee53f0afb4c0faf03660820a3b422db21392be7f1a3ea4c1391502ae07679609859b4e43a729bd9220e9e453fe1067bd0da1e3b60d2e460bd39a849e5e011656dcc43f3b89f6d8f2d44d2c76030c93deeb832b3a930062b16220a9eac2ec2eb68c76b23a30f62f583dac7b9b0b62a7c71c9f7d5aa6939b1e3c94ec787fc65f5d48860b776e3fec898f3a707bf67147980a470969ae53d46d5e42456ecfb994b3b570b2bc07c431910cc5422bc030dde218baa136cfb6674c9decb424877a14522da9b7c51aa1115498a6adbd67a8c15d01e49374cbf2d5f15a8695e3ebba3da5d0ab50cf41d3b4484192cc5b2baa10feebaae73dbc2aebeda34ec6814d436706f299e519b0cc6c8d9a84ae3ad83a0fa8f48241fe709147a15be8ff3e4b08a4c6c4ddc4dcb13b057d190019d0fc8a6a97ec3423eb6145f3b87356cb6cfeaa85c6494688d4f90fd85d5c055f52ae856a20603d077c5a8f89ca5c993e0d5d049027a89ba3a5b956e2e64a35a96d541049a112c33f8c08719a8e65ccb15af4a392859a9dfd1f1c9f08fce94064ad64b4372a63e65bccd3c8f2dd8b6ca2fbc9f93f12e455efc40bc85317850d77f14985667f614800ba0f98b10c237a019e0f8d61b1a0b85c2ddaf185be6b10a8c438d79c9d600c6dc993508f81c82a1d936cecfc24fb808e69206baf23588c7d3f71c3da1e7909286308072c7a0b8b838eb55f518fa80a088350ab2b4bc543a586c9f0e9faf9d64ae1783be4b26557d66233635320289ffa99030ac41207d53f1ddde539bbf483f1aecd8ab5d4078c60b8c59666a0df9a8882be3ea79d9e0e44477805cd13fb5ca53dd344964cfe7f6c777a43d7e354a6ee2c075f139142298611817a59aaded8e06b19126544f7bb42156e0b0a5aa70f1b3ef6518d8df7bfa2ae00aaa69b093e82a40766d14e5069df84a7838037b9d92e92eaf6fb66c6d23d873c04389256d371b35d901c86335a0dade5d369080691f9221df6326ec512fbaa1de682555e7412ac1d186f957df42b7936bd42031f78d394d9b860d7ddef456ed7be5dacabc476841cb0510558923903bdb5b994d5956ab2db93e71a1a2723cf292f5b7549e1db682877c30bba3560c9ab4ba29a0940aee9f440ea3984f769783a2cc4548841b5952f96629c8a79e07199205dd633fe720e5fc4cefb6b1b2e998a51016792c3573dc56e6c7d121f70e13c4a049329f8d269563e7a3088b8c51bc1019f0e759537523bdfb90d99197ceed8a47e1c3c5b863a13594be6701d47cc7cb96bd5090a44f65d11dc11cc21645f2af0516b33151be8f7a7c83994b737c2c6ac0b61797a89671ddb5339fb25585dd5920081e2c1362498c789b7a51a3e019797f078db351a7c6070157763563dfb8303be33c2f985b3aa519968355ccc78b6058667ff237e52d23fcb54e0602dc3adeb377dfa087e112d835cd27928bb47bddcdb2541ced9e2deb70a8f121b3ff6ba3d5a6c1c7c3b438a4647cd4d35d7363ccbfd93f716d9f8257f0d558fe183f3f497329f0eaaba732a2eb1751b29842d210c5250b459925dba8e39c18c912b32e3f0cfd96699e83fb496dcc000ed7f17dc49af13628c0b4557e993b7a649226f85ab094e47a855dc26fa0508d69f133a417e54e17e7327c18136465734f615cc3f0d0f1094edeb4c7add44804bff7b7118ff93ee4eaec4088790d50cd774ea3b721bf93c444e96a9ca0983c320cef0af14a47756425f527e8ac69c8078d2562238b520d333cd763fe820c1099f4ac3056cde6d96634b44e0dd01ae771494de9946c207f2399e0bf377b32a2f78b5c45904b8130cd6a8a9701e560d5c84c74d14ea7043f9373b867d29cd5ab3af2824aa921bfd14a3ac433a0ea144e69f2aeee37c6f2f2729102503a31954bd219d874fecbb6d760b46a0813d5efe33deba26ef8fe8890d6bcd8b7347f26b47b3acdf3eeccbd77907df800115dbef33f04f445d68b771713acabacfcd7bd5811ec02658ac34a8da7d5dcd5c8abd996f7ba432dce1bdc7ecd7ed0d222728da662e35cd5b8e53f4daa6aabbaaf9f817d1b67ed19bebbf04ea8692f4e2e89a3d8688d12e9aa33262c65ee3623301feba46e9722ccd73aa6a1cd94c2415f33e4ff23ccd2d8e7dd6c5b20b857b46a0b2b3f8a58116709cf8e01358de68b6d21e353e0003b35751a5254ef5f91dcd9c16361851cca3db95792813ef9da66aef02781784720fcdbfc4863352ee6ae238e004fc283db63de6ad290eb0dd6c66a89d6d4b7e7bfded8be3ee819b372fc44e3d45e6c18df34f3f2872b1ecf05eef537ea7966fb37c33bd08068c03cac527223a2334ac276d49361551c806143f2292e1d29bd03a8d1d8af0d17956d17816406cb0044631d0152abded0f5579efb146101fe7743ff4143aa2824c2cb1ef3cee6b22aaa67bd725eb9e9811f55b76b52030d29cd2c9b4c6752e3e903b01dd58e4f5b68ea3582f4b2029b2d8b3495656deb8f8357c3f357fdba36e60f0e55347324d62d82069ba6cebc0e0028a390adfbc30327b3f0d052d397154326368bf00e02d77b7553b433f54172cebd323abdce0c83d81faa71a3b9f42efe92b15887eaf97078f274314c25df80b8b5eecc8cce0b5d79350e408ea6bda47a66d13545c564d0b3e534b6c2453fc6b6c1a7832cfa32744db6236532c1562c0c6cb377df8207c8952a3468230aaa8154ef02bc7bc04101d10fb2895141a27069ca7b8aba75a1d3e6b83ecd49b61add2bb106333a7554998b67b3936e72569e99296ac13c75996328fba960c8c8a6497af0055dd5eec8d810b0bc15e118241635d69094223e6f2f1a89c141d78065717a55a43a964dc6d4bd28831c971154f2605c44fb5e568b41c70557e6ce891d3484eb79353ef914946361327fab376901b81f8af630bec87618534a991622c9ea630be9f8c62bf57d364d57309c4cc538deee2f3750f5e5996cebc58388b1a94c7a00f22d75b7b1b42f1a8661c9ba42599d52af203038f7e7f128948ee6bfb7e506ad1f58dab2812e54ae0bf3512926e92bc6e8ec5041e3046f4d668f636a9c46ac7f43be1f56c091b911f0f755cceb1a0065b4c5278eae5b7bfefc59bddbdae3efb161f6eae2d601fb8784db8d811deea50baa552dfed622a69f954d3368954037e828dfafe9a859abac91ece1c84aba6e1d24dc4dc82d88de6ee504729ee31785823e3c2eb587b87bc9ec96fc8c764c79e93af11f095e7b50d806fa4bb8ba8f4a8e3641992cc0007958c7ab59805ea0c681a52b79e6c9cb68874403a15bc7ecdd4cba37e668d7dd64cdcb8ca7a9a9fdd2931060ac0ddb11f7969b65e8358f4a7f48d4ce290f4d95d3ceafbfe5aab6472e5a500bf598ec88e254fb25ae01e4746999af30d1e56190830fc99a565021108a41dcbaf10a77e81c45cf770edfc1aa5bb8e059ac51a72abe9417589d0e7c1ee3fb2ffcd13953388fd212335068ab414bb611ad3957a59e068312a666bfb4c7cab955f44359df46f09f210e859a843f3f61038814fbd04dc5a293f66d6241139c9b81cd0e64325088b3e05c677633f1b24b8e1f3062e8b2a2db3f80cfca796cf9c33383b3d4f3e421832c583106c26f699cec6e26059cea5ead0c9e26bba2ef4f21ca410c851cb508da1186fa302b4e522b49341fb693edaf5db46933ee045d9f51fac53268d5eafd2cd8d497b40d0cf4c0fa7281e6efb9505f99def9a97080c70b0dad5e6c6b6a804bbbed1211a664fb06e6bb3d92953324f4e64ad2e8e2a5cda37c675afb5ef8ccb57a6d935f69ee76e02c645862a0229c102603efa21c4f639f7e01bc4b61f5d0ba827246d278edd57c5f2f9cc8aeb2d68942fa85834c0fcfc28943326c00d3496f9303fe8f60139167b27ca45bb3ac8371c65f58dfc4e57aeb5f11826c1df4a830d60f7196aeb056a47fe89bb3f2524fee6f74d31ef23cd9d03e5f842d89a83f981c5e9d0c35e29c4adcf48a08116296b1f6f45e43621bb731228f111b37498f1cb5dd99fc3392b2c4ac8acf94680afcf451b4568b25af1161158d6e993fe1c6b5b3ca19bcbe612631df12f6328b093e88e96bbd4e776cb566405885dc101979382776456c00ac069c7821218eb411bee3bedb12018e83d079a68cd794bd0e5031787271eba7c0b1e6eb4a47822ae37dffaf2eeb547247562ad19f1d8b595a878bdb56fcca67c765962aae640f53dbbfa72a9121d48ae0f1d0248cba3b1421cb89bcb8fbc60eb1176da3324477475058daf37a575e47c0b2b87154cc90f86e89b90d6190451bf5d8c052e00d2bb1d0254a6f22a33896b47e0d5fadc10331950e7fdae02817a6ce6b2eb4768c9c855b9fce53fac67739de7c902bb12d12832e26b6199c89716957d490bbd15ebcf14179fc9225eea0ca9309712d3974c9f6566b2693ab3a1a6469239e97ba63f698d2955ad5a33c016702e32fc2c43b0cc23fdce802467a14fcf13afe5a4f6c39ee2514b3ef5371ed13788f179e63d47aacb62536218bcabf46630a76689d981ec6de87ff0d4f2103305dc6ad2d9a12eaa4d7674a4808805bc5b2d9ec9ffc8699d07f8e8836f15cb46b2b2650d04961ff9355a9c9455f8a49a877e75fab22deef688a010f1a82dd3ebd1d8357efcdc61cb0a7dddd3d6ae120d2a2a32c2ca614357051a3726115f75ec792feb2fc0b367cc3603d84315544e56f2c5018938c545c8da9248c2916e95d4d185b6228b4463a6238e7166ba6f5db14de5605eb8bf4699f60630550fe90e44c75ad0dcf1fefa68d6b6d0f4e2929423fdba2b4e6cb4bef8487a8b609f90be6be691e65f24d5372e38e487b9c1a81b9ca92fc9a1c90cc9f5529a5388a81b16403822bb4c4694018777c30ed5e99452aaf3a078befb151ee089fda69d3515dcf83d0f91f140347a985ebdf45340ef823533329cb950bd0b2637178c34b918755bfcb1c68c20058a09eebb72bb22a26934dcd648d96a28d2ef0e427b3a28077fd68ab6cd28f32f68e036502b8a786faafe3f40c397c2a5789a5ca018e4f84651b774ab0d66e04caec1d53c913dc9eadd57de2520caaa1f8b6df7f1a770292219a4e50654bcfbe07439db2e4063d9f6ff6fb2807cd89e5440b18d29285aa48befab4cdd377ecda4b3e1d70804017eb3995900529f2e59bcb4cd4a3f5b33863eb8aaecc03a2045d1ab84ec539ae2e715e9ce65a12c35d229f8946b3852f624a4b456a77e65f61250b23e295fc2b7ccc0c5282f418a241d95c64d59466ab2b92aeb075e23158244f6c33ff4c7e3cb071cc57b3cf2c410401e379545543d39b4209cc2c76129e41afc5daca127108232f86070f74474ea57322adafce2f64021b21dbf298d538aa937d2e74b09dfebade94299de1d7c36884c685e141e304789ea049c3aefefbaf9f7154cea49e75a7620db817d1bca4f1a8a8cdd398907d701f717ae3ae3a5401f99554908b596b646c1125a3f9b9be2d45ff986eda8efdec251c685c3da5c7da12e0bc2cae3b64aebae8a45bd8f0f373d46b2cbed9d7f6932b8c80e85b134a7636c5bd0f625593cdcc9b5d64db0aeac4f2a25d83954c6a4c0c3340d4339eb9eef3bb44097f4abece4cde409d3f6e0796eaebe737007dca4f37cf1a15cc5a1fe4675663b41c5693cb339a19d08d374b070ec2e97cd5136eb4063bb13c7ee40465165a41fb95b6a84fc4139280a67e83e60306cfbcda404c0b5e13588c947f5bb7478c0605fdb0c015d6026201f25be75f6ce6ab4ac1891a146c739656f08677ac5d20e56183f12d5a08891cf7157c276555d0ce830d91be7b4b7bf22f004956248e4d2f38e62e2bf029501005dcc688385d3e95343d4c0f81bec297d464536aa3cf7d44ec1b758aeaa9263cb257238dd1675e7c9cb7130bd1df43cff15e609586dc7face51f0e1783417d4d25eac92926aef2939ddbf21f5bea3c6d1a8b9c528331398bc8d41429da5a2b6b0d3bd56c098580abc823f3a1e227e1265055db56ff151a794887ad7dd34d1f5e266e6dc47332fd496966e6d66e72c3f3315f4b8a7281542e5a9e4baba5989935f0d82302a41cc0e00c32205757e1db2306f599a69a28ced76ea7a12aeeebf5085d21f0fffb20b8a9db5d06f86e0bc4ac824740a5da1c6297a09eb7bec20b086e2de52175cf5bc77f3462f94591f035c73045e86d0fb4d1198d9afe6667d6ea502bd7c024985a5e65d515628845819430609957827e6aff94eb6c64679f4b06c766fb6538f760a3bc84ef77e136809f278a04234e7bb6957b66fed78e9441a00a017bac18a2c592d6ab381081a36eaf4eeb6c2aa7f8cb51105ad6471c795de4fb3d404ddfd30218dadf31f2f1b593559a9418d08b5427603e5da07a19427969c83c609f7eb53dcacdd7a30ccd2e1375db99d32fa44678feaefceadc67b1db1943ee3df97a9647ba4d63bae5cea8ef2aa9f115ab559ad94716c279accd6010a4f565cd60fa8ee149c174f059c77a93122e61a7be7d875febe1c174645cd531a3f71d4a6ec23d4fe2b3c41bce1f787883c4d8f72191df80514d0e42e0aeee8b7f52da9c842d29246e6cf6bb482f83b57d893be8588d7a17ddadafc3ca5c9879856305bfc8f2cb7b75187bc942007a3735b8050a2a4319ca6255ef0b3bbc9dd3e7b35054e5e28c590fcee3036c9ec164974c19b5c96ce671a3d0eb91a8c2462f71fe5d0ec5b71c9af6487b718105112b6caa7b793a62fb00f259830c08851da7fa838c3f24379cffa6f458a3d58560677a27e64fc1f7222a593fb1f049a9dd103c1edb488ff897c99e002fa20319068f9f1372eb3e68de893300ac1f9d97d5a92280ae978e305f5c8728dc99edc9fecf63452c84650a7cf0edf64a7878b4c941278b42cafe17ff2d5022028ecd5507ce0e3cd1f59eb09d9fff34bcb122b9e584a99360a3588becb0c76afc8b1b54f9ee24f27af8a5a8e326e286984842e19a860ae7ce8fc21adcd2ff404bf20fbecc4c47d38a2a979d56a3cd08f24369a180a38cf138e2db1542234244d26224999b23476ac3cd4cb617a9dea5ec0d65c90a84dd2fe0d14dc3dcb9796603d97230428e73235e43b52ba98905a45f5a105b1d697681bf4f6fa335c3ad88d3a4a8dd1804450445bc44501339676d675e8acca535ff0ec1058cee2ad330e74f0cbc34ba632f823b5da4c9b68f2c446e0cc2d53d773114fcd1e8a627587d9f80da1b3991700d407e9751b428fd74e823e5c3f38ae9bab01861af3f9d13149e9ae6fd5d202b8156d3915d04848939ddc5c9304a203ee321ee93f0d77ff9bd4a31f8e39d68c8c6e47c6eb06cfedac023a22fd23546c3b8bc2ad30b7a68cc3393c50c64fd9203b32e2be849f5d78c28c8c5a0d24bf2353b2de6d2e1aae10e3558a6efbaecbf0372addb1bf0942126908272bea8b3ad355a841ed87e70855532a633922e3de2584c8f193ebadb40f56699c1bfb92a165a61a0127e23025346ad0a6bb3e57d0d0429fb0329675fd555054596cb1e817d8874ffbdf13d1e3fe05095c8ea42b91bab7773622200036ad55ecb5ca31f2a33b1d0539882d1e25800d248e11042744d55453c9772ddca6d6294e563e06ef9549546b48ab71f21c42e9a60b5790cc367e4ce5d7abf072405989dd8c241a4e5d692be30b60ac3040e89c4771b130abd69c29d5654ffbb64b07fd4419c96053b5f0e3fcb25d7360bef7c2930e1d8f4ce03a88205277349ddc24eb35d3a122906f761239843909f17c91fdea47555f63446ddaec5f42bd56200eed16720e7f4f02b3aacc65de5b9c1538059f6ef48a45a767d42b28653c87baf1f40c040e20d2a7f776bd65ccb104732dfba4b0238bb0bb29bb3a74ef4efee8ea26472e472aa72489eb9a3e70112536dc9dabd6f74e61174a463633ba28f1692717093fd618052a5bdaecff26a47c5d7de8aa5571548b4e41f09ba045039cf6d8705c4609e1d83eb9ab27c80a9ac8bca283920b90ed09727a1931a50efc6544bc00d356ba4198ebd0d2c7f204d588b205045890cb51c3da5c59a84bba75b36e48bb89d1be901bda3c6e3bb4bfc057e1761efcd69648b15d666e7a967bce5147e8ed4361fce1ffab93e2a14e1f9250cbc53caabcad903743de61a960040fbcd470f6028ad3eb64192a892c5a391f4d155681b09b1595cb3f75575e752950bc26c310d70c73a31e0acb70d0332572372b842348ebcd88c2ca38bcf68dacaf5c2d934f46d9db8045f66683caa8826e18cbe526530725e9b66d85488dce34209a0e90e2758ab273d85ca0addc32c485d4db1ac67ce569b6ada32688806fecd534d13b02b3cd0cb928d3e18168f43e48da9c7f3ba9f23c82be7415467d0ef83316c548c17990ede67f2cd214ee993e7bb5733aae545f3f4f69f289af4caf66284d2c42b70234caa46e50237a92d19cbbc0ae44d9f4a15b612cfb023d4915ef5b56d492f3410ce6c8b94c45422b1dc568ebfa25ea4c23a87503e2c9920a030383c980daf3231681f9f7e04a0cfc81ed901bc3b1eef93fc862069875bcb05f0f6b2e6e03fc1552f5cc5ef44ac7e3d56bee7ab9b173921addd8d9ccb03c4b1ca8571ba8eeaa61aff27039df9f6949bd89cbe785a685207481a96d09e58e9d3641deec5b93a6999a89d106243b729439153fa8be4856dc0fd1c50597cf6205c846a609ea48e9c6c4c4c6b4add88bd5349f69199e77a7b64b90f259b241fa7ba4efdd63a23b1e23a2b6babc4e993d0c585d3e36b00ed7c2a5e4a47cdd00c4bf2127ee88858fc7777a17ac7dfba3d42b4c6bd934d559f0bf3acababf23db87499b4961db000619a21ec500672a8bbe9ecaee9a027957502d5f0f921bb1f4536bbdcee8b88a3ad1944791376dec6aa079db78a0e615c44c50272c9b3fcf8823d9cb5e72177b8efcf60333ceff3a16a0635759ffdc93b5a132a32278c80c2e54b99529c89fecc98bf427d7654481bb0c7f41acc1c705dc917232242e3a688eb028098ed578fe53406dee41dd4638a5d3163ee8675e55f4d47db3ce50ed4cc2fb4b36dda013846e504e6a34751fc356362b9fd59e3aaed68df5e99962d0e83b88a46f8876d736e34b3f387814333c6b818ffb885725280fc66b422a8c0ae9ec2238aecd90f5cd0570bd57e598d7f5d4755cba4b7ab65746b148f098539974fcae76b3faf7b25ffa117b12163cb76903761b91601d578ca5fd5ba52cf9cdc9bcfa900614c0a5de4fa5044a3d04af17823fb6ec8c9c25ade505c3588bbc643d8eb77212005b227bdf4b6d25a6825719675764aef27212b18cbb33b77cf63014b64f426bdeec4e33b0347e2caca6ed0526d670f146674aa426cbd1eae2830050c2600bf5ad3d1cc37e95c44d759c79e66c68ed1cfb5548e4b074245929ce4cfdb1e8c1f8071408c61e1d92e6877e366ccd03ca29a01cd9e803aec70992e13381a74aa0b1494d27081da5a660d21990bc7d3c03fef45135f0915d35fe549349c70fcbec7aad5bcecc8858a508fddbc83678a1efc6f39fddf7c36c91d12b0078755d40160d3b7081b9ede8b151953fd28a4c3beabe9d0126a0910d02975482df80942dc673bef552d4af166048c0e8733482aeaab359a3ac2ac97d4f508fd6f1270b79855b4ad16f4451ca82da750b3ae6be4a6096aaf844a83f9a48301c12fdf45852e1ff49dafaf823451caa1761654bb501bdabc9227c84000c19b36045acc7a474aad61603442f78254713cc19a6f9244c1208e97ed480e35845591dd304effdd6d0037acbece619783677bcf980fdf59f2480b99f3a6bce479018f82c15d3cee4fbf30f8b6938d7680277e95ccb5ca25c32ecd1be4e76cfe5b7ad30899741cea89d0b46d2f8ac322e10a582024c7f0892e83619d38fad74ca77b0669f9cf19f9223d29915a00f02bb136828a9a34ae6e46859ab3ed0caa5a2bb03dbefadc9e4b00cde4ed14a1efd5c463eb433fe9ae66e7063d8844795d2cf9662f852056834ca7b702256608a10c0697c324f1903b220ff01f0f5e6da9977fc7bcb0965a3bd84005584a5a90574c1ff4d38b4a0f36eecdb8b7d324c00df4141a4f2c0a30ab2ae67b4d033e1f9af3ec1d83cf453e857fd7ddf8f972c055d1303e26cd1392a677b15aa0d47728e8be454dc9a875d860ea90c16e53c5219ca5b17bf756a7c9ef432286a99f222b3c80cdd4abe444b432ab4124ab9b3b96b39b1cc30e7d4c580e6b292be8487352b6c2bb39d751190bccb7fc8b1941c629e8987c3a8f7c231fd609c11b6d78d28f1d3ed02dc34bbf89fd9c03394d9b63d7c57ed56533c3553151bfb87de0fe3f1bc9355be3709bf58004a1089a5de5534eab832262bc9d2a8c30d65ef258a51db80c7540727893aaafe5f07c41fb7532696e9f0edcf6d3ac624ba559fe6d4f9b9273e84ea0d5aa4fda6f352589ece08e892510f22bb1a17df7db2f74df0844fed2bc37123b565c57109dfbc4f060fb8138447ba4507c250e7ab70a52ca4481db75624eee97227043621a5573c6d07eab16cab4f1595c53661937fa1bc43faabfc08c62f7d5c6cce086704e06d8eddbe15559426c436defbb2b46febc6d9135ebc00495e86cdc60cba35664ce0eebf4663a2299c55f88d8342c040fa692cfcb47e50ec3d84359ea1abb75485e90bfb5a53e8c68037730d522034e548cdbb0183095ce10d595d67d953870a362af22910bb952a9849a3fe0fe9b7498f4a7e5a10608d4ef4557198f0d409ef6ade9664e2c21ad259ab50345309643e77e4c11738d5e038bdc605fb284a82be901c8086cfed94e032e2a347718d58ed773e5a3c1da5c5ba11b23defa9290eba10df3a80ce34ce6b77259e11713c73b9e280d986a275b862288ccbd438be9f2af2dd178f299dfee81cdf78f10d7b4c04cfb39351f85c67b84ce3819b0807adda2d7779265a5b53100eed0f59aa083744c80008642ff0a3e14472e6d146cda8421d788af539b6bde453f41955ff8d55fd7ea42ffddb5cb80f4fd47af38d6b6a72d15b881ade149e6dd064a343506d01c4e1b7075241ece886b6b889028c48e3cb6679e2e6b890b03d3ca8fef4ddc7cafe1cefc671da41f2468cbafd9802cab647c87a8d4a84401f5958091ae497d5cda8cf267b472e89f84cc0396a21daeea277c3258aee8076fff10c06ef700abd67e70fd4dbd5f297163c6823ad9eb62a1e500473a99ad3384371318d6b51f30361bf2d05a39bc4b61df90f241b6604b036a181a20cc3d70de251929ac6f56d0afae8051d3efb80a1f76c785ef5251969542a391e726d58fec35a0c43a0975d5df24c0eea505cb84185a2f4b8cd81c3a919e5b33e494fd5f60dfe6b23b8c4cad819719dd1a2c178841c774a3c2d0910382b4f6fa9319fd6040a3643c4fc5a1a96677b1662aebe188b2e4891e3b71c6390d2b5ec88fb3f2af6faa4c18d9f86c66603a49b8388b058ebeb977f29b091d45f2e37698c3188a221ebf2b39448017c32ac232c755a00514d26cf865f96a31422e0d01ff068f2484aff83ec59d14f2ce49decc30ec3a971c6043f8d5e56a9c100918502479fa5d8708146512c23b86d505603a867ad2b293c6279bc0ec2ac34beb0fbb265a5210b170103110f4d148011118172c1decf2ac9c7a23b0d1c67c4c66c48160f03306953828b4d9bcb4bd0db426ad6d6feb0c43354b9c96e50802950ec47a373e0db084865cad111c3df5fc83e00de3c64ce7e0af5f8545ffda2840f7588dd3490dc148a74e1742d345a50aabeed42745c493fb8d92d9230f2159202fa7773dd49f0cffa527d7de3ccf4c4ad363bd85b5f2f5de8a41f378163fe97fc925af00eee5faadcc401d608aff0dfa0781b5f0a9489d314c90e842d34f6509a78f83926c94e866904f3a48804660c2cd792096dc978a2d2d016df5283be243a20ee7126e5c5630600bbaf9bbf255e1da30d6a5bd926403c2db6b1c4620be0b5bbe27375b43ade4e5ac4574ddaae91eca7f7c702bc124e8c060c53826399d186e9f13c57429d195b03f93d078790d05ca4c531cf72d65ea5b16a90574384fc69d50dc7996c42749a5663e242797090165a1fab1cf20c91b24904be283f612fcc3e6529815edba18305224ab9113e2ec00fa78dd0c0823f141917a74acd5458d2830fe8aaed452cbdf5a306613ca5de529447f6aaf57ba6361965fd77d7eff57e9e6c7d6248b46a4c6bfdc3a7b41c3eb83351e68adb369c05c0ea986fa3b126befe7ebbcda09ebee1f5ca35b3593b3953be473b41196363f6aae795ded69b731f4152a410941d43e661fe9bcc8b714e6dc03c2f3a0f8792f74caca5bd7f17eab3f1644cb10a299eee92c30da4b5c0be636f14e5da54ff7ca0b6db3b2b288a3a2105996c43a6e0916c138c34a6647c1bfca8945d34f99be2ea60966453842912888a9bf3b1b5ec1a1b3330b29b8995131d58fd8160201d4c1e40a5cb6a82a1e6a805bf37a2a02bcdfb22ed9407ab7a4cc35e7372c5f4f7ebf2aecee5359862e9c2f3eba898e828d47bcf355f570012657eb2efde4bcc9dee97c5f4750a9f81498407f9fe151dc000f8dba9cf33cb810e449cd522cb6f4745f0460406805bf7a4696945c661e647d1d6a503c3c530a2b5a3bb2d39b9165d82de054e7fd3428dcd4e9f13044ca3b86f507d31c8faaa6833d80313df0c4adc480a2d6bc6aab3b711ee3d6a5046db3d26c12a137d3d8f57e29a73551d42c52cc76e60a8a3b04673386b4b5320f3a7a566708fbf4cd41ad945e59792e68136583686d49ac085e70614a569520113c07cb5208da3116bb5e03eb00345027dd4f058e02c79d842c203b032464a54b7151b4e09529cf1eb1750bd565eb5848af23f95cb499e839133d4d185eb25f99ec302d8f283649cf247d3657e6baa3be7a9a1d4ee0c1219bd962709896c1f829275a01fcc57e2bffa6aeea1a3fa2871b74ffa7b4bf5f65a53eda6108b76ef0f22507ecf533ab5e6ad125bdd3658fdd777dec5aef44f6f80c97d1c6f81416826560d7a0b686db675f8904f2b64a2ed05cf3def840d68dfc51e657219ba9d8dc885348ea9fcc4a1d25c0bb03fb83ab6b3ec4fc9173bdd0e1fab1d87a3d2ad33f82954326763911a506e9b723d50351793081f04a8d6fd342b5d16034b605d07afc41357ba28134125fd31eb355d6f6c21082194e482226e07b29f48447e38b7894853f17307ee61b3721fa55239da86e8665328f708e3549c29ce15e163d3dba7f4ec9413d48164200a78c4586b0db3ff32761ed333f61356ab83798d6e44449ebc03c461360b4bec2c5fc2faf9556777d86592f74a0a5c177388ddcac369255955f49389e87864ec8e884b7744c891dd99c0a9b93ddca66181f27644d1351df7a028436f6bd21732dd45b1595e26b9be57ca41bf644f5ba0951b0f3690d7acd6a231cbc2e30e3dd1ef6d90f0dad8fa835968fd46f7fb786bf8221d603b8c5df76d9a0ea3e1cd97df84871bc1aeb1147197f24767c0f59cdca849ada5b38a6093b9348a1062dae247fde275e19db633c30589b27ab47ad7033cc149247b7d296076845297b6f68e241573a8aefa9deadd75fe12ebc41907588dc6b8b78834c63737b2141a51325d94634cba91d89104f9c6d63e87d620308df75139bd3dec27adba0f35e663b5443b7a7180274394aa2ee3dd19125e1eadca166a5c2010b1fe35c9b04a5bac0d7af51e6c03c5eb49b39f6997696056270dd1e08a61862a20934398c06a0aebf8b36dcbf341f5b67144cbcc17e586fdecb7eb2ee911f50b9f41572af462983939ca9addb584a0cb0f3977abbb56e68bd130187136558c834b2461071c7a0f3e141d2213a62bb390359ec741a220821f297b83a7fa552dadf972e402fb54a7dd5f1b476b1a673f3ea2020f957f9f18ec032274839568b7da2b5e517cc8529f9bb77c55658cc3ebbbb00b8e0ae4593e9daae8d418c8f6932c627c6a4bf30b1b89fe604aee97b5556e0329317fdc67f811df5c7f12e4e7d23acc6bc21c306f3b814f48c869436a5e4ac30d6af6d7dae44e2e5c2f0085b43525bc63fe438f1510b6f8464ce79b9db0bd603acc1173c8acd5bcd8f8d89e02d6b938208c3cc0e43a6466c66ccb7b61e7e74b9099dce9b8dc18fa631c31827b6d4c92d4edace47ab2704bd37decdbba2825be3e4291284486894868135c386fee4bb1eff71beea9d6406af8271f41e230df0581a04bb2ee2c7a31f6fcb477949d0fb33290a51b06850613854cfc8d96b66e80ca6ca47033b2c12c5ab6c4e9504da83c1e1c11e2d246694c0c60ef4a3892586cb78643ae98e8d474a1cfbb315ebcc0bb3696a891459f6feff72eb1c9a93f95f86abed3b57ea75da695afd77ce109c8662791d8f890d19ea14da6d59d02ffea4d4d0eb391c3679645c7e000f5417bde8c6c807a76bb7f30934fec59748ce0fb238bed0b5b51452a88a63fe5f06d7815b1036d5aba23ddbd31567aae2d1ecf82c8594042191b5225e3244160a3cb70fb04e37823353cf5766f70bc15f9fb3fa4c132b1e54aa235d178d647aab8383f81d207acf87b425ca3e9235399d768e75908ad9107895322c6e3af5b37587f16e6865b99cdd73620e7ab38a1166f82f93df44c9f4612650bb44660663d8db2dc9273444186094559fcc4b0a29213c9daf68048dd1976db528814704cee778564291e260d7e60debb46740f54bfbfb68dd207620c611a59e4f3e654cfb71579ce806e02eb9a25c3f2d1c8170d577cf205bd71ab5dcc3f65a3567437add807de52fb62a70fcf7432c132b2168f0dd84ed357e059d12296c12e2270fbd181f7749f9fac8d2f4f2b2d6387c844b976f9e60a0cdbbd1227a80f8ca86826788cb46e39cbe28f12ec675f88ed946e024cf617b936d697cb04fdf629a7cb5764362c3fb1d8cf47008723f5aa39ac541380bbf2a57dd4c9d5e011885c76670c733c2660205da2743032afbf60a2ac79edd8083fb03196aeebd4033d2d6fd78ff19e5c1cd0ab759e465af101b6f3fe2e4ef2fc762c73a6f46000987c23c33e5d35992b9958ed327a29ae008a6d06b7ad1f647ddb9c32c23600fe0962bddfb9443629b45def17e0a82eed731470f5a18dbca2394462eb64c99cf189ee5c959bc3cb346dd63a16566f16f8f5341f15a820652214d69604172a2dd52c8c3ebb9fdab3d29f79306881d8c0f4d000d9fe00d49f058c8253a39af28acd14a3c15ca633d1ec64de6a424f1590aae84d1f3c62d88c8afc9db3636b0fc735b88e09a3ec0880e919f2b95263c1cd7c23bbf5406e4df111c50b4d617b22143028d352e348a03eaf3e619fa2779695387223b513427d2f4157c47a1a8c3c4f1f123e8f779d2125022d26ee9bcac3e5fea28e94e3897979ab04c854400c02a83e93643afa8590e7081a22ee3a3632e4dbcf3593a312e8c635f64cb2dcfbe7fffe036ff73bf9b72b65d08e9271eb6be59877341624891adfa876783e04327858242ecc1cb05ee5e23503c7d35d10dbad2293bc480bc1e6d34eacbc2e1b3e4ad6de6d472e2222ea815c4d4c002ee37f6d8e1fe4fd28c40a4cd56bf69694f8f23f8cccd5aabea5ffad89e2b538debb21f40adb25192dd55951d5b0a4e8f3f1e1ca812f1ac4bbf4f2348fe53f6076d6cd39d8e1beb6c3e0b609b30423a78a38cd75a5a7b6d4493a0ae9bad229699fa63e2079bcd11b63661cb7867f0eb1bbdf6ba4d9a7b03dbc284e69acab67b1e0098190422c0c5f1b34ca6a50f74dd2a3dea67da00734367930733fcbf3803a55d0f18bd991896cbe0fb34c5f2ffec395b0d9c2d6b6b4738c320256a6c91a9a6293ec9154842ed425dc8c6067c7929714ee3d8a3e2215ed700d04bafced2cc20ccac42e64db7e901dce24d35a4102d0d5063f1637aafe7d9eafdd959b08378a1aecf469899f24603563fd57acedb26c3e73a74273f37a26a272f1874e80b9a007c5c5a89d7a04e71e74a9f6f4fd4deab8e5b2000c790f9cbcfd88256283b2d48e5b793a30c129e45d5edf084f8bc4a179d1a7de3d3d8cbd4ec950878321c6be5ad382f9c8e1ee730f7b58d67d20cb7bd9a02d4b77cda819f3e55d7329dd61af8a66b71a2676290a016fdab623d250b0e4e4ec2b6f4d4173a130935fbbbb4593485c16a24cac2ee72bc8811193527cf2f45d0d54b575585a3160e1642c4a64a4557931d3e15e28aade49b0c4e835349aff4db0a9abaa03ee97e3d583c98aebdd6c986af2a47129729119dcee1fb32ecd184fb8c9512a63650a78887789d00603208b0495142cf9ad21e04a917dda8b18bf653ea285a69a2d156b344eb651b1eb6dc77761facc1fb3d923021f86e88737798458226b24f78bfd25efb899b5eca8c1975c516b0d0bf302f31038ee8ebae9cc2db8f0c57fcc3ade56e2814a74832a4ff183edf2f13b16463e499e6cf454658fe1bd562d9f55b4768efc6915a531406ab673eca1defa9ff1103fbcc9b462a6e5099ab7ec65fc0d40b299efdc60030951549ecb8d7b484cae905f80b76d0094714228e4bf8ef0463f1d9113c9c2d16ed964c029a97926a09a05486f9b139ca8a4a5191029c3d0ef471c805f5b088629312d75cbdb04270012b11cb916d1a00d131cf379884aeb132f88e9de56ecdc687f90e298b5b29ed57105a359d51d56e7e8a3e730951a7d709ba77515ddd52eddcacad86c5c113c3aa0699e717e5275c51842e8de75523ece028e6284135a585294eaaa02ccfdd5181e1fd9b3959f4ae90ecbcb6a5fb43c0e3f7cc07b4cfde9efad092f85f27428e10676735b063762774ab52d9f6cfb0eccb0427cb2c5390540dbab1046ac595ca1c56479fb986034350e813208d37191a3caa91e63342f4e87c4685f22cf37d0ed47fd88b41ae216503dd24abf93394fe5020dc617e9925c9ee2e7f41a605f0ee8d3212a8949504826f86096c4db107c7a4e7d0a6869f4824f80d68d92e9672bc7d0254e73a825f904c94a17942b29121c09592ebd81d3f5e7d0dbd8d70aef4d710d82ce6a8e016509e2c460e12249cab74e80fc5da3daacf97699b6f90e2e456f3689d63510cb1b55680fa2497aed9b50a2770dbf475c46337bf88c46672c9ddbe0e56226b8fc580a14d4a49e5b93ce49b89183599eb861739175388cd87a15497c69f26866607ab1da52e78074de0b960ee270078bd4ec32a97f2a3e264fa0666f92954b9f0ebf353342ebdf8925c0b836fd66ea15dd9da3a8bdde87d93338ebcdf3aee336c9cf2a6b8780cce2f9b5c8a17d141cdb23257f94214438bb3224df9b6431dd9a4a943b413289cbfcb0d32a71c296227ac4273f9a445e7b1d3f29812dc79a9212c3204a285fc67f904bc7709d4c3a35482044cc4c0d0b96f9a8220d023d8802012213cd2178628c1fc9b2613306c24c8a77413c3c6b7bca591dfd30114c81f63d445cee6dbbeaaac379b4ff833be08e9d203254d8ba02be3aee39dfaeacd981301b22bc6e02b9a36b7834f271fd786e9ac1719b9ea87ff555e2cb85bb30a3f322062bc24fbb18c7456d16f7fee7ae36b40a36f66d8228d97c108e1e77a9414fc0974bfda6a01857d37e32b052bd67050c007cd05a2390a9eff5bd24f25adf46d266a7d9b7df875ba3709c11b139dc200a61771d62f4168df46de88261b5ea57f3a32d7b43af2a515da1735974bbffc1565c18d0310d6138c15c53b37cbdf5ac1d329c59b24c991e5cb8bd74947781411157e48439d43059402077312d4f7225b629424ceece90d21ce84c45d4e934e712dde7880a053731e5429cf8262417072415f89f7ad82119d07c8e6c5c585afd1764febf6aa5d015cf0c9696239f1d075e59328a50d0b5a552a85e87e38a57bc78dc3018e5d338da2bddaab1deab9fe97f9c3e71f7883f35305fff28df40ae158fec4c63f86828c21d8b99ad3ec3ee03823beb8912f8d8e0f9ba65b14b5a546fbd37c302fa98458bd433b6e419fa8143751a4107724b1e32d6f1854ea1478b4dd4500e513626fbd316c46d234022a17ac402cef6c27cd29d26fb77143dc87565d1f1fd023d135bf8cd2fa0f1d4f5040521d53eb2fb214285d47f6340e26acc12a88c128162c70946849831abbb37860e0392096626197989049f5e14af4c5d138259b0a6a8fb888549f96e5ca6dd1221611ebb317c8839c4d03e77fc6fbe6242ad8fdd368af5a78f8acb17d4092d9899c330f257c3ac0ea92482ac00619059d2d3868a5c32e2c536cf44994053ce903fe64a6710086bffaef4df23a0e53be755cd628443dc3e457167e9257e2b33afefe53725d8e48d04cfcd21e4bac8c8f33ba2b4caf13a4cd67190b4eb9547f444d69dc5c59692cce5899e79824cbf2252edfeb42d48a08720c2d5fa1ea004fa64b36330fa23180fa8b4090d31bec0a3ba1bda0a45f5f1b28bc465f6e369a93b5c9223b2e977e31e5ded61cb268225952eb5c298846661c8ba0aa9b6c1f77011d40293d075d4e42bb75e6f74e3db8ece4c7f4d0404074d0cd625b37449410a8b349097ed2277dd0560d3ab63415dc4faff7067318fb945bb02e0bb144e5eec7ddb8ef92dc27f46193817926027992b6f77da4b7df0b715f30c01891104e1967dbadd7acad180dcbef86679109357e9d14bce5b7b266f03dfa2bb0346200daa5492daba4d4de1fa558e5298100bcfecee2681e32a6bef5fea250982826f846d365687f21803248ba0914daa2642da8744175e5d570a51f831e865571e7ce1414be60ab129b7541c020273623058331ff6194613d3daa4d4512561b0368bcdbb25dfe8a0a78de523cc7b6606c7793bb5646f798a519e1c904e1932e3629cd6b3ed372cc3b0ded283878fe69d4e029f31be22a455ca71b3744f0903ef93a7be2f9f654c63a75f18d5128142ddce0c2c4625e4ba0eb24eb317a44efe7e5660c3fc7bd860c94aa246ff0676226b02bbb5d4381dca62d5a616b91f7fcef09e5ffc25bed81b754d83e714cb5e0e7926c59dd14ae2cb1641954a2170af98ef646fea42a0861d2d5203f4e4d4e103920f783d9f03600b3bfc024baf9800f7b8563c26b19566e67cbc86a6da5001095ab5e53fbb7650e587d3bb89d4199882cbdbefbc66d9f5b7e208908974d0f7b6e09e3c3556ff0249eb1b1e1f9f2b2ea706a8ef8f15bf3594d4005d2256f8a1ca6031722f194e1eec8667d2741765a64412a7f8e923acbc1119c9a1239c0aaa74d53d96ce7e1f988b8d1821607e7b4b6baef93358c82ca4656a97a1bd914a566aa99c557a1ddf8ac3efdfbc8cbbc356eda964e8c058726c6b570a461720f23b4bd033433829c4ab646d8f306d580c8d3e562ba7e7d50dbf0bdbf73391ef20c4e5174edc38fbc05235390f9ac45737ff395dba3cadc93802ff9af0a8af4e6aaf443d6ca06e9310871520d0a6adb51946a7d7ca3771c701b931467f0e6cdd75615ef9c2f06671004bab22e5b7c47fc195c295d4f0cca080a14d7e8050188605be93172b2d8d2b29b3693d3c8e5176903e376a9006561eb6776387dc1ddd31533f9be7dcce3128053710bdd00e1edbb532489b74223cfd7b1ef182d430cc73b7872801755855c9cc131229ba10a4ec78b88d8a8ee8cf1190ab348de603570bdc08d43deacb9bbed0a0f1a2c28e216ce0178099e86c1d17d7709343541c81fd38bbabcdd2430fab408727ed5820c0362d488afbdce8b4615ec5029dcfb81f09431860b40aebd0684fc788706e963219bbd90c899657fe4533eed9bb37c3be0e451bdd85f31d3b5f3ed53f387aad5d15a9dcd2dca16bff432a8c47210c24c1f582026263a1497ba90951d3d81e3514554e711d3d286e04fe2a78051e4689655ed1bf8f0e99176e6e48ad503db4a23f22791b2bfcd25e949406461280d65acbe6d6d6839649e0c094d019e78460ae283d2dbabf2b8395c9cbeebb252f084e26c3d7b58fa7902bd820518283a3d2094cf726ebbc443a05c257b09c66ba72b098950f39f5568634ff9a93a409714799c25dbfbde0ab6cc1ae96a95fa74829eb50c05a50b8a340660b676add89a35d27cbdae46f95807d0ecc511902b20627e3b0078db05768dd496d5dda9d47200b3efcce52c5c622412a59fd4ee89ae147fbeff0f9f052883e3e007e64037694b171470de860e35834c99226aad82202391928a39a149d8187942e0bdce69d2f30c502b8d44fc7b5716d7b8f44cf44c9c5416ac518580fb0bc945a12640adbaa7780bab87d423337bf902a86b1b1db1080a284a676ddc85f34df9defc7cf95ed3d140a2e77afbdc0000131bb04c07432d7eac226e9d3fd1779f26c6d61b1a4219360842b984e9f1b735da113824a9f5d6c16fa4a778d2eb41827bb5ae4587a509faacb3ae9f1aea311ca80f7b620e751d554afd90d588748f903f3f650f6c082adc0cf5dab61e17338dba345b32f2d3635091add768dc7197bc0b554c958579d5809e7fdf99170823f9735212156cadafbd9a59e5be73b4bb0499e8906259cc182bb68576dbfefcabe558453fdd0b37d49efa765abaa326012fcac23bb5a20c7e45497e560e6188f8e0e86e5e3d262c4556795a24f8910cfe211d55e4385305c2f19d1128b190e80fdc18ce68c2dd03f6383b10a0abe8215173d0e7b807e829a7beb60135ac8319e363160c916aa80162e3c6847358307c2f42d462f15d684e20a676823043946b8831a5f0994645e4f922061aea5f7069ac8ebe117830e4c6115fe6eb0c3e01af57553e33be10edd626382bfb3788df459e47b26fc4105b4ed12ca9933c3cb40293e984ada08838e1b9f10adbd919c130314154317c8b41c07826cc3fb07e8ca1f0d0c38796b1bccf073543833f03f4f29f1532d02e9a2094c78460fd6b142a3a338750200cc7febb5de4452c5bf07423a6e859a47dd8bf583d9df0743db7550f281667036608ed9b891ffc10bf4903d3dad26ce1475357c6ed652807acffdaa1dce13ca8c79e8394b80b9d43bc8d412c73d47a7438a933df312d7acd63c96c8d8515e5fa81e98783379f2dd30bf7f3e2586c98e9994229a411125287ecd18d4c6b1180ec43ea7d3b3d8faf3c44e69adb086b9927f94b0b6da2cda933bf45982054cf61fe436b4812eba8784f0019263a331ac7593800e93f80c5dc6fe418b1510ac485a7eaf6366e592da6b9fc814b08bb86a034247d2186ca392df338919948e05c15b92a3cabb173af5982ef40e6a79c4ff8b6f804178feeeee2ab104c03a93308d3a76ef0d3fbee879b51606ef52f2622d782cc0df4c3b6307f0a6e8731e41eed00b74371d022c8b4868021493f77cbe523b17d87223e96772574f9a0a2521697323459aa5eb29e365622c2dfbd826ddc4bf339abc6fb0692a140e4be66978fc37dd8332add79be5ff9b1611c299a105988b7a4edd5a2808961433fbcc2df90c1820ca45eb69b7124b2f260f193981bb98bc9e8eff319864adaa10c927b20acfab67833101b7f17d64ac2fa35c0b710f78312c20c50866a3521a814b25cfe89bcacb8f211e1dccbcb7900b6098893a29468e115e3da2c0079b978388b62062baf3d925b9fe85aabf0bc1775986b802e243b8cf5e17082f13e5df3dbf2fab13e33c1ef0f3727a886349a28a1be7403b118c5ce516faade01dff4bcb1e7a3c598fc752fad39d594a3f788267485870114a7380dd4c1ca61548fdbdc022b4c94e5372c0239ff7f8150bac563b282801153e44c98c0d12a2db72132f6e3b2b578ba55b76ee4cddd9cdfe4160544717c4aaa26cfbef02068dc15a63043ef47ee83f33e2e083f53166f11e6f772d4279a5f6c6bf81bbffda46d96b1823b2ebddccaa1112c41dcc3b70d9a555ae8a866017ca3f6ef0f6fb198ea6cb8fa26d5f32823609ad24ebf89102d1c94c824ba30288812177bf9d987c2c88cc6db7df62a841ab7897f11ce28e2413ae30a6a9222be6b277095547abf475c3ca86f0929b969603cfa751e15ddd4012452fd35243eb66dfbffd1032ca3a3aa27c1fff8194c758d0860d40f6a0ef8c992443334754736beb1de6ef5e4c4d1abc5f1883252312a7b9b11016dd33d29c41fcf96e9fe22ad0a1e246bd79925fd45a12d897bf93969b72034b8639905868e2c0ea053d1f87a7890eafe4312ab5050422cc48973c9a6e81a60fae1abf67cba8bbc5afaabd70055b7cb54675654c899c209d98dfef620a2c9b64ee090fca165767a55db7dd55ed21d365a91291d1c00ba9342cb51907bf91febae1271402e9a7cc2fec639b9ad58b741d06b49febdc7e886fcedc64942738edce52140925588c2a701cfdf9cccb2fb6cec18c7923187b182300ef624d7d7f0a24b1c57e616271f7c44681270c5c4e5f1606147ec46469dd77128ba15817c2ef334863c400b8a97ecad24c76bc8dbe3bbf586838c2e8223512d0b91d6cfdbcd7fc68138984b7063a316a9f9647dcc632f172ffaa2ac42ba68f52acc693948f564c88e8e25521e44ae8293bc835b50adfbb1b6cb222133e13efeba4008a188ebbc96fc36dd37c1b816fa57f56bc6262503678e3cd09922d59f07c6fabe63947f2d72358d186dbf8c66833183c11371a2071bcac57ad8c504d5c9c79effc81ab6e8228f8ca9727115c28631391330ef62584b5dbe518e50f7cf3d6d90f2984cc76dc48ecab4059c4ffe7d56dd73d471f2d5d2dd65e788a08847e36f6226d26836963d6ea079f24101c462e3a3485dcae40d35980406bb6fa89e59df0490fb934d3eba5bae446a89563385444bf835746393d52590363c80c962cd2527a4c64635d369d653afc5b1bc28cceb5e1d0bc6b4bbf3d51fbf3b04bd5719dd557230fbdf8dd4b270ffa5991b37b5415cb32f648121cb8b1f408a2ac15a80540c7e05ba271d07e4437a271161f5069997b9f5e5b5073c55bdcf64eeb9189cce69ca9ea4c8d0dbf808a2dea7c36631a0266ed52cb92f718a38f2a5fd7c5c678a5dac2071695f2f8523de8c331377ac8da4437c8f8313feabf6982be2683d9038fbd2c91b36fbb20d06bbbd51e35b22154bf49db7d0431ae3677330a3285183831a0e2a9989d23afa66cd1d82e126567d202ac0b929930a6461a2b49c79eea9d50a2d96ab75a7fa27dc599915c416ad7bb8eee0af661a158418559addfc2ee84cee62d7433a30248e2d782640e3f89e7c4cd5f8508a101dec6c8ecbb27dd4e139c48d179c2912350a7a69ffd1728ff946b343e678fb0ef99ac4567890a871f4beae28a26f0903922c9b349f55de8a3a1e19c338c14a15478c1ad9734149ac2f2f009fe9216b102fe04c8014c84813fdf6c778f8fc8a6ab5ed2ba22935bded9ca0af656a666deaa66a8221a77c6cf368e8aca4919d45ac382aaa24705a5206f9eeebe32ecd5b475054df28d51fb7e54c0b789a03daab6fe021585e3a4403113bb43a8ed9ed7a04a8d2ef360745f992d34e1cf4a89b44fd448c875536a9ceb16ddf3e63a87d9fc45e97bc4752c4157433a05584a3b459a9e87df2164500c2caef88bc5b1e41070a2a1387adb16db4517cd67b69a98b9e3bb2ec8a9ebce228f146297873a2784351084427eb88b8c0c65f039e9fd146190d1cbdff161448f3dc7739acd58caa08366630bb3282293d07e2513bd826a192f1a25cee04333e14888cb67549cd55b03562e14eebb6f7167b499552d1e9bcd48e98915fae8836a12825845e5d7d01c222003826755a0062061cc10124915efd76bd854e2471995072ee0eed8a06d0eb755abd0688bd2cb5f8314c8960e12ac868491917bfb91894400f9967d3ef9469c3d37473904eb32dd8558b7f042716d1d9bc2dcd96eb934112c6a2cb6044a8b4c05893690c07a32314a7d8c4fe113681fa24b4bdfb2f033c0309e48dc71590394a689acfebfc22eea855f84c0490eada372b04983bf321a03f5c49cf53a0486e6603867545d49d64e8002c861656cc6e67f6e35bad4bd1a5e6362b2bceb7c42a45c0c19237b77d293464fa8f1b967c843466728ab8443e9df65f5a9905204bd08ae714c19e3669afd6eaf07ac7f01d0f093b44e4f4ea75e2ef3e43331a6d1fc9df4de16f08f3209ecd3ffd43a629680586d396a076f50889a6114d4960e89fc8d58a0ea2d5ca4d86b5c7be924072849ba05f62a8fde23d4189981540ee6bfdddc7bc57f2179221105fed50caa74079e8dbca3f9ec608f0f5b10abd4e964878b7cd229e7b69c25a4377ebe42adf59d72f9984b3289ea2096b9e802d816754f56f994391830003f3dd5fd1852a9a0f45c0350ee5a8539bfad5ec25398495e32a893b487516dd66c8c3503e4f5aab12d8c8ec82f6542d65c0fcc1cf3c8f859656f824039fac43b04882a9dfe4d174b5bf9a5e08fa8bf20ac21b8bdb4609cb6cb7ae128e189cfe53891efd9ffdd651253b94f4e794b1682d4f876762b38fd646efdf44714f74fa65599bd06e9a72bb9c0da62bd156f690b0c28ab7f99143a3a956b51c390a4f86ed466cce5982500788affd7eb6f37c4d682e706f5606e4efa52ec12ca87c666d19bd88d5ba1bb9737664298aa9a06953c18e4fa6a7cde1ffcaca1f0e32dbc98f514d4002c136847cff2feb05e3e12845d202ea1e27fce86b604d14ae8d0b863ab88069ce0bdfbd690112d117646a534f48205c06e1400a3d1975c700573606b4bf33ac5655b7ab4f183ff25c395a4f16dfe0b6176bb9e820e1664fc09448fe7df8bb94d9d8dc03d1672582cbb5b305c5b678738a5b2db2620d0edd87ab78b9fedd2a8a85bec980c8d6d86104a115669af8499d64d534870fcb31f1ec2de89bdceeedad77870a6b30be0cd95a1e909db37b76d59fdeb6962136bf0e10d318807bf85a64fb275da8982169498d57a9ee3edfaf4a8f50f5df7bc73af9f8937bc77bdeb450e157034d3e8799ecf5db7abd280ef9953909dacad688a2b8a624a2eaf5942041ce3fb105ac3452661d2438316e3ec42e2e1f5807fc069ea4b2c1685ff45a91232204b7ac11522de7318d60ecd6ab45ae7accde6aea4594ea198448cc38c1a8f93e6de7dbf7101a3b81b3c279996b6c8ad9b9df83845e45d6ca0d690754e01a5613bd2ba8c27a49ce025ebee04d2d01668dd5236ebd0a66586388b23734cc4faaafdb4bf82356f22cf1fd2e6f704cecb200e8f8afcc0993539cfe59f45a1046531bb0bbc227fcdc3fadf156381641005e94adf3d3082543e3bed680c8d0bdd3c3bac13753a70bc5f70205ed51ab71ca55a3b17453fc4f9663324650ec314ca8bdbe792187dc118c2e4bfe43b5230b7420289684971bedf8364e898b245d22c9b4009a2a11d87ac304d8c28fcb50e0f32f93e1b87189c44992f57ebfe0d643d12d7fefb6a6948de2523e5ded5cf7d685a50edd12fe445c7f88fa0d66191143261d0f4c0fa86a66d759338a37bc48fd98082a3fb7561feb7ab4df096171b16829e2371251fc168b39b72e7c4bcd37cd663576904023135e25467a0781e37a9f978602baa52d439d2cd5eaba4c5603ed11cc7cd933cc66942577d4d8055ccbb0079620a9212b9c23a73903b1e09c4c161b7fda5fc206cb94ed6118009017086ec1ade80c50b027900a47a9ac51fc0265d0ee988042171cac147312f169ff8918c1f52656b481ed3de529917de2810b38bad419538016c1128ebc3a0a01e58d4f78932e15130e7811a5fc7041d78ec08124ea8dfbc3373c9c47befdf4332f716355100bf882fb1d402f4ccea43717eca81ceb5203b99f2e8484a3a9d839839ce40e0fd6ed25cc6b66c62e1a9131d7fb44b3f1872715f33a562c6102f1bc23212911d04cca19ec225c3bdd2608d8c642e7abc146ec562709f588d634c0ccca9cf67d2ae649748a94e30be21d47c50d4755dc01484902cd6e818800be6a082eac3d6d5ff5cb476393c79058864f40934bff4a387e1400a81d5723c4551bcffdec97d5c1d2c2ab49a3dc6b80d30322f376fe335481254ad970dad92c7d49772dbb2775cecfd05980cef79fc755dc4e264c70e65bab2b9421b0a31fce137dee7ad6b5d4fd4a8b5b4c0d6322f885dd72ba9ac50b8a89c60f327c63158f88b66a2d1e2ba390d7791fdf4633a3af325f4b7a9c910c2ba6a1c146606eee6cacb5333996d0188b5af1758b93ba89e2dce23669a1e5840d0a9c0b7c1363763733cf97a571a59bc9fe1d920a542eab3a7e4b3f8cd3ab8fb1bdb49b6c483364be5a65c38ac163af4a64c90a5b8be81956690b8a647683a65a29bc9c457be8407ed52c4623c144d44db42b79a20cb1d3512537e66c0c15fce25e7af952836f5753ff706a8c6c2299e4b59513c2053c99d599d0669da8253705c8da9ffbb840c955a49ccff7df62b577943260b64619cf24e4d9568a5d40cfc19cc90a701311b7e72950c4ac7815d595dfcd07b3aed82eda814c1b509a85a8f7b3716b33fcab9b9070bd66491b9347d9828a929d2bd85a80abc3b870f8987a78f86f6a1f6e7bb54700f228748bb1c105228816998d4896bd02128d67d6c680351d420e18e537d1f6e42c2481b63fb7a12cd82caca7b792f776a63c3cefab87b7981eca68445daf2076d5cdfdc8eee09cca4bc7ba39a1a1fff25e659f4341e90fd98ac37c7003f446300900d59ac978019f29b2938653d50ab164e0145e7cad9685f996a445ab702e4235147e7fd6cbf1d0946115d04ce250e25b8516f057b6c337f646b669a3d567920e17c37c293fefd8121af75bc7fb1305500fc0e201a5e9843d2abb101d690aab793560fec20737289d8fa56f8da8c60033f4e1ab7f5e86c1615103d7774d26867a18b0a8950d833492d505d2e9ad3c560b63dcc702f4eb7e33ee25676072105627ace9dbe9a34316897763adcd823f2be150583d136231d477c42040efc424c76bd6765d7916a750e994d72716c12de3b3b89af6d393fbd26b7cf42abda91d52417ccb9b8d7d898d26fd82e08d09f663675872ed5c0375de38378b5016950442923e6a86fd9fc242fb30f82192d5bbc17b04ae43095cc045ff2bbae230dc8970700e7cd2c6ba2d8a349158d157d064ecf5dc04090e30397cc50a756f210ff2df9022a6351bc5e56d1d973195c3dfdc60c9e35158bda7d4ff38babbf9161f9f5799cb7a9193d97cf88cf074b902e2126f5e84264bf43d66d273ffe62c47cf9c6917ff9eb31210d96db300259e305d7f1dda380f1f26121ddc787e9408bf898569ca36f06c51652a9386ac647fc5083fdaa31d498bac03c9ecc9f41ab8a9f789759ac33795570c6293988f6b1df9114b22e80f919c0cb70d67c9c4753994c09457172c07ca1d2b0254868ff8146c31011217ec0caff82265c0c8c934a91c8d3c4aec358c5c515f7bf0e444e9092967eaf82113f56de0e7e0e325bd29406f9778cfbaac75a71962983bceaa5e3d0b689e150eb1849bddbd817625e6faae926a785a8d2f42b8d0beeb0c3e506e7436922e394c011c0695647c0be338a76c884d3e1e5baa48c934200f7e7eb49462f2ce510a5d325686e42dda4189f7ea9da29211d7df000833de14b4a81144d2cd18f59dd1562a5fbc3763247696c0509b4cf239314ccd6749314c6811ac1fa73346d6e892883e4cf80bbd9e85480a5dd9de49c9a6350b17c530df6839c6eac3b3a4b3bd86b1f1ffb992a0f032aaeb94d79fe42cef0e89fb44ebb386c7019399e68a0e269b77bb7944b458ff7cce169dedae270bc38996ce70ca6b8543e7f7028c179af3ed713f800804b9d890289ee445c2bf9ba8d621631ed53e1b047fde98a01b80af08cc1d88cc4dc7bee40ef553d7a0291122fc921df593a33ae6532f32beba5ebe80d428ef52a614cc90ee3295eb167621e308ab63bdd705eb76d4e0fa94f90a9ec1bb4aab1a8d9a8f23b43861c0d054ad3f164416e7ad8277c68f82e7eea992c21185d491515c5696d8d1dd1f2861eda8b7643e09276de5612f2c01305719b107808d65677c4e98a903bf4b537e2703630a4d0d60eaeed20d08fcfd598b2937c30727c800b29a102122fc38fb3f247e73ab75d4af1c72d6eafa025e3944a89d9bf7dfe3767d7e5d52cd5a4eb07f718e53a79098b6bb88effbaa58bfbddca6f7c0d7a58ae7622055329e8cfefb60504c44f06cf4f47ec349f08dd5064ee12a65d268ef227fd8c912ebfde1ed5cd4dfaaa00b42dbd468cce2f2c2abf493e6ab9f0a661e9977d28359fa219f98ff1f9cc84cae5eea6d66852eb80afbbc64d6c4ba0364fd8a453bc575a51e67010cfcf0fbd12000492421743ef881c13f48c7884ac628d40decc25acd52657af1e0187f33a5e4d79963bd1cd87c7f29bcc2284f1dd6ffc01f80abdc71e231413ad7ef1fb21ae3fc7d26e9e3c0713a9924f87a80e3e1a87fc3780c35347fe289e41f105a23dce6c79951c877d83c063be8fb130fabe9be120c1daeffdecd9e7e9bcfc4b33829f994c4d0b87dff40b659dc124815a6e0541aa0758611277d113e8883dde65e25147a4b2da1732afcd4773e28f1f7e3f90bcb20b3a521ad846dc15ac14627e2a6865a95638d1d497b0ca84f2dc2cf136b4be439798d1674b65731709c63259c020d154437d5d36dd9b3ac1a9abef54bbd4f0878416fa04f87172f6a2602fdbb3c328bc5161c887a1d3c295e934f44639e42d0ffe8927bf36499f00e666a5ff11b0ad8646ff1fb1988685b8ff6abddcf78b1d5a3718c005ae62a453949a29061a6a51c7b2a639d1c1c077d68659aae3cb3d1b09e031c8c84aa04b28dec75a56d6a1efdf8b92fb6c208f4902d8a567fb4e6dc906596b221beb66cf223d88bc64c6c9b7c95b1cdd4624e3dc6b8e925c292287233af624e79d1dd71157b740bb2e82e4ac8697d791e6b0803064176d0f96c2d6a82e28a3108fa35ec4efcced3edb32a9ebec6cb05684da0e5dc215d80eab78a6e2d1d4aefb7381600a2bcac1c64f21c419114e9545a73f056747a2911cdffe81aca87475f639880057da628cdb352965045a52004cf5b1f5d88dc9276ce35cc79a9ffbae24a1927ebe82e3e51aa0a7bed819d65a1fe42e1094ef7ff2880d5c8f5747f98a264bf2fbfdc2043d5f49e3f2a2d18edf0e55a238a28ff1f5e6eab7812401c1f8977cb9aa50273d52b58797eb6c2bd4121d70271aa79957ce035ed8009e7dafec4840617ebc2d8c66feaaaef85867c5b89de6a7925daced62d522974896e878d7918c7496596e73e5c0abcce52da59341f09f17873533eb620e42bcdb473c62067b2ac09b2ebdbb1f5cc0997de5b4cf24bbce1595430f43f5976e41d3f72850b5d1c24bfb5242db03e86c592e7818a1f0400d283863d52c235427c2b7e68e2dfe013905519f63c985c79287f7cc5c9ff02b36725ea8bd80ec922c03cb2824acba27bf7cebd13dded9b04af3c29876834ec3d138ca773c94d6212195a8ac03cbd07c6aa295a5c5cc1513744ff39040fed12b2d104a5c3011ca00d922c86ee625a621482e9e62ea8c883461c907a204d4961591be8b2ff7e07745a99f0ddfc8f9caf4b2d7e52adfed6f3333fa3590009da40c5725227230c1967dc20346659c8a3c1c92ffa8f29f49c2088046532c1ca8979f95157281cd3bab08d424e990e8cd8559e780e191e4eff676300c2adfdd23bd6f1c5c2972bc1fdb14423e70c47e7543746b70437066023325da3eb20e217697cf6201056d2b62ed40203e1b38ad158ea669b16fea848df9ecf095da28198780f0b2d4bb0047a1dc83399a399ee4de39e2799ee3e92a2e4e61cb51a7168f057d334bd277ce190d2a22fcbcacfb664290f3f8278b7913b72ed4e654d3e5827897ae391246ef3d083542904b0d6ea5ed4d61ae47ff95da9fcbe220fb29c7ecd8e53212f80a79265fe90f0270817f7efd37861a143ae090507004186bfa4414e11384fda74ec007f74e2e8b333adcedb7bf3040f28df60ae1572908fb730599b8cf68c3895d56af6aacceaeacd76aea47e15ca041814e0e7e17532ef6a697abe6a105892694a2dd4db153a2f7bdb68c1f22717c2c1b71ce5825da459bbcce3ccf7e597cf9111f1bb12cafee43a4b65c00c196de17c941162f745f9bc652e14bf4b4731a5fc0fdbfbd185596ed95f9a0ac2a318397b0a368f9e6773e185a3c78f2af56fc998aa4656fb85e1ad43edd77ba02e50547daab258b40243be138915dbbc0e007179d35bc55717fd6fd73099cb34160ace3dc10e0e880c36d1499a6fbd7f45bb3fcefc709b524cc2cb1bcfaf50d566d2c7967ae1669531db443ff2feaedf23b0ee36d4fcd7dddd3f7c1115cef2ff4ae3e4e38b4f3aaa99ed87a1ddec0163a17200a3b41f6ae0abbbea8312ccd365ae49271124766dd3d9c3291927bc74bc572a87ab78ba7a4eaecd5cc26c7d2edca4bb24a1f31d4bbcbad5b25eff9e5ef4dd66b50b518cc75ce02610b8a705829bfeb83585a07e9fe607da6d745d41c5b15c49d51ea3e3c1677a3c6ec6699d3f2a7ae7f942711900c72946e15dbf58f8a5914afc1da56126cb237fae93f06b78f2104d32a5fe3eb9f702f96b81f05f37e6aff4ff5d400cf3fb12530668a902d95c88808030d9b0a8e7936394bfc4370282af86901d96cb239d7d6115cc90b1e6538a7ff7fee0dcf0d334ef6b6871be38b194723825e7340ba576055f656f716acfeedabd903d04579b78544b78320d0cb93ce4e2acc5a127cb962073752d1c8e043557374cc197da48c592c35d0ec460b7d334d4e8d8afa441f2005eaa7c412fad06e82aede7e78ad257e2a300ee3d07b1fb53081678a766be6e4db4a639629e277845d7cf4db9076fcfa21c100f37a3bfb127a3783ca732253d7a21a467ecb73d803b465b3a5f69e5bf2820d8514c9881f99b9e858f9efe319a54e0187a8a386ee38d9650f5aaa4094ad956b4da6d5d6f70f070ab27e74cf6978a66451aea7c7804c20b489e386a9e3f63a94de76c541e11fa16ad7ba9ab0077585c255411961968ea16b42a8d6111d072d19b202018669b7a30b35185f63c0e21aa11969877ec2b962ec54b8fd4cf3c243a0a26b7d51416801366345d535ae130196318ca4893b4d537b8d39302c4e05685c4e5ffed26784dddf197c08ecb660fc268a85aa52c3eacd150ef1baaca9ef8c8a3f40ad47687a2cbd28334ba4cd315faf1e4385abfe191507428cb44d13e825ec1f840528d079ae7229f434ce36f76c14ce53f4eb0da4bd96a13e31102beb07950c2b981e63669f99dac6c2ed1de5ff2cdf1b9c159c16d0fe36baa43a5b8be5e05685a3ec534a40e8f5a1dcff97cb03eef9de6d44702cae372eed55a408efccf0771d9c5900fc321bf96084a5fb3d9400fd7ecc0e89da34cd10ce2531e644cbd204068da00685d5efb784c7c7ce66bc090aa946669b02f25638f71bb68109b47e1fb713e3a51939410e5c862211fe42e21e62c976c8bb20999b72f72ecd774cb6568aa8a51c6e59a1741f2a4a4534105a1799b300de50a5956766d614e29caf02abb8fb2d6ff085ce86f56ff3578947962dc62451da13e65914f2f08b9468326959e5954229347eb5bdca584d8b4ae6627a4111fc54cee8becfc7df942f2fbbc03725ef4c0001363903209e78010fc02086db205bfb6ec2daef6e0cc639a70e12b7296f4e064f9f33c873950498bde9f1672124eb26274be8ac5f2fcb3bbd671c596769697339789c6e4b8e547fa1b4427c7bbb3b6488ec65db3c24fea1f4338db967f5934686ebd997c682cd043c654f6037952e9b51806752546b61e097ad191f2940c059b9b375d1174e02fb091ab3467679af452b4727ac7de2eda797c827b305445f53132de8eb3e04ce8a15a4407c4c1b9d409fdd6ed39a1a51e967aecfc784324d92faad31d6bb41d12d91a47f2f938c15bcc1baeb86a0dd3017f5866a0bc67d077f3b718437d16f43e532d8373fa449cc668178f5f25000264319c419f2f24c2645c936005a5cfa8932614378ddbf259205c2c5dfe67e555ca94ce361fa112afe823c2fe327e6b509623adda73211ae2111e9e7d49500afe0e03acdb9c46d645bf9cba442778e2d92bf356122f2ec1dc31005e32224fb10b4771d32c6b17c7deaa4b960d7f8a34cb5892433de93b6e9c373e3a535926aaae0ac4c725fc3debcd72983dbc616a4eb328ea7280fbd4dad346806451f0e4a10e022f62b3e3362dc6c1f176e098874359443498e6868852007df2bf14023cc1168e0c2d9424ad4f180b7730f6104d58c6c34cd8a1568795a7f5336dcf91ea7c6021a340ff75a3b611691ed33f597dcee124738ca7b0879226e61604c80ca96f12ea4d6d4a021affdcd667b4b5b41206a42a0903989941bd3d50888ce6539e5ff4a114b6cfca223ecb46c48ca00375a090dbb3ccdbb6201334a2ecc3316e6f9238cf8d128322a9e7ff4aa63334ad5270f647d51fcd9d9ef6ff4c00a6ac75f6cb4d34858de8d810034829a97fb909b4c5ffc0fde5bf06f091ccfbfcafc1e4ccb8483dc4edf89470562f8ee3f35916798e3732eea3ce41f11dc265df8b258288405e6ec048b42c008cf30e1e16489fb3c0ce8d3698ed132134e7e24dad251d767d7c7d6e0a8a86d29c1c76c9d0d44719afd7a7621b98888127f51a7615ecec20ea095bccfee10acafcfaee70d5b18ab44b4dbd4a9e1cb340e5f8f48e7006f606a02124132f2a62c39856694526bc8ace43a08accdc1c3f31ec380ad996b422dc72461844fad0d6092245c1d66b0760dbc3d4ee9542feea4f600e9ae58de2412b2b23401dc2c6ef6678167f993538409a1c8a610780b6d60174bed49856c405004ffdf250fd10b7c84d47d3a0a335049961b31b6567dd09180911b0c13b3c1371c8779aef6b7d959b58756953c49789d07d0eca9362ff1f4c04f4776fd826b500878f0efb40e1e2b91d4fe6ad05f01052f241b8e0b96f4769fbd02541fa6d04639581bd432094569a5302b3c66ba3222941013d176f56708f2cf53d7073225cc84fb5ebfc2e795ffb2825f87cceecd0ab1cf36ba126351b5345b8eb6866e4b013922852eb1abec39af0c69e4698a3ecdfa460abbe7a78107461f33193185045f5a03f22d5b4343f3d06a98813c6a83d995d3fb77749ea749fdfe50d36790dd748d8b8b3a44f2608006115fd8019dc52d56892819c7456c7765df9645e55d7b04ab0b6c0ef011198e111aabaeeab88fd5ee7e112b15ff5d1af4581db158b253d64105ee3073b27b28a17acb91fcfdb4e8d94bc5291b9ec370c71f6c77e0dfb55c44d904c4baf83bb2d3ce49c5b37c883e524c4f6c36c632bfca8c9ad315d1d25393cad8ab31fbfc0985c14519da0dfb27b23493d3ef873d6df52e9b05a7ea7db9a8bb3551ed9ce08ba2fe28e82ca157d1adfd300bf592a54dd9a26fb87416a139d4c98eca45519e3c2bb7d0c91d8403d6f93bbc7503782134f92091ad73965cd7f8d5b81ea2f93db71b0f8c06567efc6fd11bad066669557a8086fc453fe3db409843f72c890bdb64c3e8da83bc1480087bae138be7c7958985c3405733010ac11c7d05bec8378dce6b817ea113daedef6cf8c32f26da49aa0ece3597d74954ce0fd1dd4657d9224e5c9f6d80ca7a762872c2d8b484891e440f6da78cd38d2689c202583d2bbfb34be43b1a8b7485e83f65020ac3fef2848dbe5cffa3a832aabf93d193928d569825db01a65ae7d2eb7b0ea985748ec1cb62694925c454030caad6d15d39880e0c7ff7d546f7805b705cef091d6e404b77b200b5e18f7c34745573ea4b9c6bd80b6e835c8b1efada7f25d3ea4e9ec774e394c54cd683df1e26cd28d2a1f2ce297d1c98f5b98332fa0866ed45c24c0045e134f154cc017851388d3e9afd4c19eff4bc90a1a3b21c16cc3fb327b8e0927811571bdb6898333d854b58a516badadd3da1fd0e1b8c90ce53f3b76962be36b112673a3976229dbd20061639f954f57a7bf0efc843b5c3ca401dc8f7a06a90c2900b1d7a8d48531dde5d1efeb0026fab13f8cbc7ad5606e99c739d1498e9d967f43f781c53046355adb9d29e7ad69957197dc2e0ccc8249edcb76afd5db68e65ad0e281248a9108fa8ccbab2e8effeccd534a3a23009017bf1a9f8824b51b32cdf485bafc922f770f03680895d09e8c198bf30d5a398ea236b0be6c7316236f2d42b665530a6dd4431ea4d227888649f2b67f81b13f31eb68b7167afa3574a1978bb5e06b9a97d466a392fb3d1167e615d57a2282af1f18acff19b306d102e5db448bd81d0128c30e92b45767d43a01fd01f60815161de237bd8affb98b997cbe197f6bd856c9a3013fc3371d7b2fa48ed4d8a9d0b9c667b7b3d8ddc1178a1bf72ba6be6a84f64ad3454fc43f5551f8e166225f85471375bdd73a200fd731a9cb3de678bb90896e80a64ec8da2e0c9b2accbc9df5f14db971f91323c79d83bbd0703b8cf9a1aaa70f9996316a6f189cae0a3051b5be5b71c458af7f2fa92deb08e9c082dfbab99bb92c054f08d67c49774af17830e32ef462cec8ca029fb07b7d9cbbc0cb292dbf029c2278caf931f3c05c75e9dd99ca3f969a0c3de85a5067c6de6cd64d2c31a7596da83ec2a15e627bccb8b6d4d2725dc594be854d5022f7eeac87d53d192d881801c3d55ca179d9d03b7f0cc2a045cc9bc236042c0c2ec85221ae5ebcc755a9fc3bd2e1ca6319f02f3b654a90b9c97fe246d2aaa2483599dbde60e6d5b1f894af8158b9708a772ff84ce49b49f14019244454460d47f2a9865fcdf2eea834471c0f8f2fb75ed356d88d0db2485907511f7a41821bb5439852c3e391412cb98af912bd8202cc8a4f47e92d1043f1b3a6ca60627e7c46c6033bb5433ee5fdfc0a67be599e0a44ccfd72f20b2335cae7882f8cbfe128c17d236d7145faef58a8d68ef80a65132e423c44a735e50a1fed5f5effffc3336f9449860382b4869fb3075116dcf8f38a92b56a6059fcc98ce17c6217c670db81461a84ae4a127cb6b839bce35eba916f52dac7a5fd2ab907b7638ec0c726158269ff6443490250165fe4c436ab9c3f9f181bd6412424811064ca20fb447d42973465fed2b0f627df46ed713cf07b54810deb52aed2e8117d3b8e9638eaa3c69d62965327cb973d9e1d4443d6e115c53de386518ce185c6f61ad972e6e6638f990136c2dff6c332b987af6da4431e7e6cdbd3a58bad659b984668b9424fd3d7c998e104ca30825a36f4a17c46af80ab747a70b2dbd4d4a1c9a4111f4bb6fd835c25405ef7ad101838256e8e2091a3fb48525ff710513e32333eed604afc95cf4b6d2d5d6cfbd13365e38c49aeb8fdf0f0dae22fd7b5536f349b036c2eaec9d2b27b4d60f9dfffc11e1502196b72d84c4045f272c926ae9d79f02f02184230ac3d20b7295caac8b37d8d076f0031b9561970c132fff712e28721245a9c4d5b602a06288005c9ab8b14d3126815023a6e21bc267513eb71150197968ecbbf51a56a7817303fe82de5dc309b8e7bf6485ae92cad9c2223f3c2e8e411c157d2291a5f9e7b0f0eefa219a69710f38c5fe6c0602081d72c1373cd2cec4695f594a297d4c242e048f1e9dd545ed8a1ce1fe70f65ce593a8552e25249fa6b9f0a0bf0bb127b27d00ccc0b7c107e8369b050896753bff111150bd64d03b112813c13d0388299b2060c7d4442ddf115912d02c5441bc006c18448b7fbbe826d4f3a71b95c8b0acd8df90ea99e1e7ae8758df6a21f54d46e11e334c826e83a13406d1bbc1c72901987c983ab372d5e1444f517b83e7ca000080b97f9e764c29654834a6461dc0411baa7406d8c2f3675bb999a8d4310faee43535aa7c0abd98314c83fe8c5b31eea3f63f947a4655680cd64d215659562b2325f6b3aeedd9b9eae0632a372e2eb30da5f7547ac2c0486e46a7e25be4d2b1a1a8f5424ea002beebb5837680288bf64a67cfc3ccfd403148a4607c51c95bdbfcdd562ccd97dbf4fa2a43a7d18232860fc797c1a68cd4a7bc8a0eba45108fdfb7893aa1c9c6cd904592b1aa923a1eab222a29be2064c2ab3a68102045a7ae22030aba69205aca8c4fcc82d973dfb56166e36fb5364933dd4b20fa2aea05c8557cf6ad3402ac258c2520e1004fe5eb2340874ac3e9fee70bc781fcad39769f666ce4752454b4b77e477a9ebbaa9de0963f11e11df65c10be6460ce09f971b17aa234de533c09c96ede2d449436f30d96501c5767296c45e66cc0059d5a495cebab521dec9ed08a355bbb60825314bbf83c59d57012cbf07c4a94058bdf0c59b122c823af402f789c69e3168d14242a88d3af9ed5aa8a1e2e00800d01435b0d63eb4e05a4e2b0d728cadce2fb4de5b37a79e15792509d18aff1d63fdfe1b2dc8ad379867dddca219a696aa47f59a53c219c5a299b7f992a88c3107cdf5391a4bf36a4187e32165763a3603c9c655db9211d49852de0bd0e4ee37d5645101dccc18eaeffe8168d86aaf8ea096f83bcd1e6d972f77758958f4ee093a0aae28ad24250c05c5683a8e4c37720dd75c6283e8f552f9998004f42c2491c3a95c549724a6576fa4c3f564f34c7bcad8ecaa380553a25b856bf55c9411b2a36edbdf1d8508f306c3710930bef3cc1acde5963de178bdec3da5b80898258587052528834f18a08013a03aae356bffb69a4318f8945832319a9230217cc855522f7c44a1e54f1bcb694c2381ebf9f08af5302f4f765915a6a61efe8027b644a80a43f54aca357fcb8a1d242c5c718eaa4e4e6353ae287d7a314bc6ba794c2b781ac28e7c8c9046758cfd3b2f68c976b05994ff235b3b23b02414ffa2dc6726705b14960e1c3fc1f19dea169480036f91e1bf4c72b9467398a01580cbef2dfaedf25f0c4446554936da717f59a50fae5ddf5639cda5fc66959206880614d852cee146983559e13d0bd608fc53c17b24d0edbe207f43679fff13e8d160cc9dceb5f9c9bbf86b3dc3cc838979eb3e9742749e49801deda1519e90057b1b4a9e9f8227379b8ed75a5e45286cf8c6c2c3d75831cd3221ce76c6bce593e039375542b972976110e85686414fc9c38a5a6a6f961ac82624f40f848cb78c6c9cc77d3a1c18afd93fc0287cee80ba195cd9ee81cce186b00ea0b1b7023c1b4325e504df4cdd63f7fad7ff5ad05c918c9ab9c065cac81ac7538457e22a7608e85d63cbfd81370909118fe25e3783ec92886cce536426bc9b4f575adaa26dde178b950c755e8bf0e8b80e2868c0325b04267fbe2168a66a607753355e2d825821f3df33d06293ce51a8a3295587c225f07f8275b44af0c0c97d85b676b12ce444ca9c4a3f2dc67f16391af5612b79e824a9b4f3cd1a52efefe6dc61ff6f5a60bdb4c170b62e282878836b5337c912d53617efd0103f26793c14d63193b80adb20db80d180036cf16e80f58a2e8218ac5702a100830dabd840c2bda5eaec2809e843f9224de9cb3061ab163c31af60cebb28fadb10e765188c160e3acdc73f722f4bc1807323618c86b7db51c9a93a608230b59377a004a25ad3ebf7d8fcc0c49fdba53cd19ef6972bd88091129771d41685879fe6f6b71c2de31ffc8fe5de664099f6bcc8e5e19c779f912ba60b5cbfb9ce81f583a5ddf42e2df668cbf63fb1b8ba0d6f35eae956abeca4268217b7461720f60b1c4bfb7631b52fc168f9293876274f57254b62a862a9d13cacd62326cd8b4a7ce039531eaaa1e048a2ff846a2fa050483c894a4e4fa62e84295ed3f75db13f42150bcbff8abb30e7be7d7580d971dd98af2993b5d0fe538793141da5de02ac8075224143c68d5c063bad54de9dd87e4246b0bd1d211c15bef9b1d61a18955e5c8a9e851636a060e4f0fb7852bb77383c1684e2bb16f47550dfe36d6591819599bcc2aa40100d7d11eb0211f7410730752dd7b3f9652aed7315b396e2190c2403da9ae0df6ccdff297023091707ec248f027190574aa4f58ac85e9c1838e80185054e9dfb0d7bfaf477fe7ab2d3b383b4203e1096735065f5133c4a1b12b62ebf44417e07953c6aaaa50b26295125d1a2878a94cda0f20850f35e35d283ac0af3e683d80eeb3399ab1b0fc4fa8c7714202c1824e8a546d6ab25922a3ef07ff2b8ccf9adc43bd2ff61b406bb4d5f887438b19ecbd3b54f7972eb88cd8198f39eed24f6918209c49ebf2dfff64fe24e7b017458927ccc9d213397bf8f4dce6170333b1dccabd7f3e98807d7477182ab2a16af229b0f16e84500fb6a3377701d6425cfeb043e71cf1eba88f270147f38a885badfa74c4fba16f2da6189f36bb4efb8157d57d1ebcfd2bf2211ab8aba8b182edf01d55176767b84bfb34999cbbe0d9e1093e64951a5d3d268e7af1d89c7da1ae3f42bc3a9f91871564f309d07b1aa9c8877a0aca1ed6a3ef3e3cbab08b7201d2f11a7dc74c06d5068f6c1b4a3a2007b81cb12e1972328dcf57127e52e0cb8a69a81c645035f3fd59c29311dcd87b31aaa06194b5922cfbffae0359c49c16ca7d7b8c9ce948953a402e49f16aef53a00920ecf87aa521bc55195b250f377eac40a480cc0cb3c6cf06149d1f12d6f4faf57d61e301a192b152cd3d53a58e4c7083dc19e493874b5d165c6420b3526cdf1d4ae27a57ab35de4d9731a9c91e03dc23c11ed2ac67508a27a64dcf35fa5b7601e92ebb3165de061a7d38778ef9b8295c08a4a651b794a459f5956a9fad8d1508673f329a90218c128aab4055bade2c520fb8e52125c0438ea3cc73387ffa13fe23accd79e2069f20b977a3c02</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">您好, 这里需要密码.</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">快速入门</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>JavaWeb--JSP</title>
    <link href="https://silvan2077.github.io/2025/09/26/JaveWeb-JSP/"/>
    <id>https://silvan2077.github.io/2025/09/26/JaveWeb-JSP/</id>
    <published>2025-09-26T10:35:50.590Z</published>
    <updated>2025-09-26T11:29:01.507Z</updated>
    
    <content type="html"><![CDATA[<h1>概念</h1><ul><li><code>第一个JSP程序：</code><ul><li>在WEB-INF目录之外创建一个index.jsp文件，然后这个文件中没有任何内容。</li><li>将上面的项目部署后，启动服务器，打开浏览器，访问以下地址:<code>http://localhost:8080/jsp/index.jsp</code> 此时展现在大家面前的是一个空白页</li></ul></li><li><code>过程：</code><ul><li>实际上访问该index.jsp文件时，底层执行的是：index_jsp.class这个java程序。</li><li>这个index.jsp会被Tomcat翻译生成一个index_jsp.java文件，之后Tomcat会将这个java文件编译成一个class文件，最后由JVM来执行这个class文件。</li><li>访问index.jsp，实际上执行的是index_jsp.class中的方法</li></ul></li><li><code>JSP生命周期</code><ul><li>index.jsp访问的时候会自动翻译成index_jsp.java文件，该文件再编译为class文件，index_jsp这就是一个类。</li><li>index_jsp类继承了HttpJspBase，而HttpJspBase类继承了HttpServlet类，故index_jsp类也是一个Servlet</li><li>JSP实际上就是一个Servlet，<strong>Jsp的生命周期和Servlet一样，没有任何区别</strong></li><li>jsp和Servlet一样，都是单例的(假单例)。</li></ul></li><li><code>思考:为什么JSP文件的第一次访问速度较慢？</code><ul><li>大部分运维人员给客户演示项目，都需要先将所以JSP文件先访问一遍、</li><li>第一次访问JSP文件<ul><li>将jsp文件翻译生成Java文件</li><li>编译Java文件生成class文件</li><li>通过class去创建servlet对象</li><li>调用Servlet的init方法</li><li>最后调用servlet对象的service方法</li></ul></li><li>之后访问JSP文件<ul><li>此时直接调用servlet对象的service方法即可</li></ul></li></ul></li><li><code>JSP概念总结</code><ul><li>JSP是什么？<ul><li>JSP是java程序（JSP本质还是一个Servlet）</li><li>JSP是：JavaServer Pages的缩写。（基于Java语言实现的服务器端的页面。）</li><li>Servlet是JavaEE的13个子规范之一，那么JSP也是JavaEE的13个子规范之一。</li><li>JSP是一套规范。所有的web容器/web服务器都是遵循这套规范的，都是按照这套规范进行的“翻译”</li><li>每一个Web容器/Web服务器都会内置一个JSP翻译引擎</li></ul></li><li>对JSP进行错误调试时，依旧需要打开JSP文件对应的Java文件，检查代码</li><li>开发JSP最高境界：看着JSP代码，能想象到Java代码</li></ul></li></ul><h1>JSP语法</h1><ul><li>在JSP文件中直接编写文字会被翻译到Servlet类的Service方法的<code>out.write(&quot;文字内容&quot;)</code>中，直接翻译到双引号里，被Java程序当做字符串来打印输出到浏览器</li><li></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;概念&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;第一个JSP程序：&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;在WEB-INF目录之外创建一个index.jsp文件，然后这个文件中没有任何内容。&lt;/li&gt;
&lt;li&gt;将上面的项目部署后，启动服务器，打开浏览器，访问以下地址:&lt;code&gt;</summary>
      
    
    
    
    <category term="JavaWeb" scheme="https://silvan2077.github.io/categories/JavaWeb/"/>
    
    
    <category term="java" scheme="https://silvan2077.github.io/tags/java/"/>
    
    <category term="javaWeb" scheme="https://silvan2077.github.io/tags/javaWeb/"/>
    
  </entry>
  
  <entry>
    <title>Servlet</title>
    <link href="https://silvan2077.github.io/2025/09/25/JaveWeb-Servlet/"/>
    <id>https://silvan2077.github.io/2025/09/25/JaveWeb-Servlet/</id>
    <published>2025-09-25T06:49:31.957Z</published>
    <updated>2025-09-26T10:33:18.828Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Servlet生命周期">Servlet生命周期</h2><ul><li>网站中所有的Servlet接口实现类的实例对象，只能<strong>由Http服务器负责创建</strong>,开发人员不能手动创建Servlet接口实现类的实例对象</li><li>在默认的情况下，用户第一次请求的时候，自动创建Servlet接口实现类对象。(调用无参构造方法)</li><li>在手动配置情况下，要求Http服务器在启动时自动创建某个Servlet接口实现类的实例对象(填写一个大于0的整数即可)</li></ul><div class="tabs" id="servlet"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#servlet-1">基于 XML ⽂件的配置⽅式</button></li><li class="tab"><button type="button" data-href="#servlet-2">基于注解的配置⽅式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="servlet-1"><ul><li>基于 XML ⽂件的配置⽅式。</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span> <span class="comment">&lt;!--声明一个变量存储servlet接口实现类类路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.bjpowernode.controller.OneServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span> <span class="comment">&lt;!--声明servlet接口实现类类路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>30<span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span><span class="comment">&lt;!--填写一个大于0的整数即可--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!--为了降低用户访问Servlet接口实现类难度，需要设置简短请求别名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/newhello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span> <span class="comment">&lt;!--设置简短请求别名,别名在书写时必须以&quot;/&quot;为开头--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="servlet-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/newhello&quot;)</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloServlet</span> <span class="keyword">implements</span> <span class="title class_">Servlet</span> &#123; </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note danger no-icon flat"><p>关于Servlet类中方法的调用次数？</p><ul><li>构造方法只执行一次。</li><li>init方法只执行一次</li><li>service方法：用户发送一次请求则执行一次，发送N次请求则执行N次。</li><li>destroy方法只执行一次</li></ul></div><p>说明:</p><ul><li>用户在发送第一次请求的时候Servlet对象被实例化（AServlet的构造方法被执行了。并且执行的是无参数构造方法。）</li><li>AServlet对象被创建出来之后，Tomcat服务器马上调用了AServlet对象的init方法。</li><li>用户发送第一次请求的时候，init方法执行之后，Tomcat服务器马上调用AServlet对象的service方法。</li><li>用户在发送第二次，或者第三次，或者第四次请求的时候，Servlet对象并没有新建，还是使用之前创建好的Servlet对象，直接调用该Servlet对象的service方法.</li></ul><h3 id="注解详细解释">注解详细解释</h3><p>我们的第一个注解：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jakarta.servlet.annotation.WebServlet</span><br></pre></td></tr></table></figure><p>在Servlet类上使用：@WebServlet，WebServlet注解中有哪些属性呢？</p><ul><li>name属性：用来指定Servlet的名字。等同于：<code>&lt;servlet-name&gt;</code></li><li>urlPatterns属性：用来指定Servlet的映射路径。可以指定多个字符串。<code>&lt;url-pattern&gt;</code></li><li>loadOnStartUp属性：用来指定在服务器启动阶段是否加载该Servlet。等同于：<code>&lt;load-on-startup&gt;</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@WebServlet(urlPatterns = &#123;&quot;/welcome1&quot;, &quot;/welcome2&quot;&#125;)</span></span><br><span class="line"><span class="comment">// 注意：当注解的属性是一个数组，并且数组中只有一个元素，大括号可以省略。</span></span><br><span class="line"><span class="comment">//@WebServlet(urlPatterns = &quot;/welcome&quot;)</span></span><br><span class="line"><span class="comment">// 这个value属性和urlPatterns属性一致，都是用来指定Servlet的映射路径的。</span></span><br><span class="line"><span class="comment">//@WebServlet(value = &#123;&quot;/welcome1&quot;, &quot;/welcome2&quot;&#125;)</span></span><br><span class="line"><span class="comment">// 如果注解的属性名是value的话，属性名也是可以省略的。</span></span><br><span class="line"><span class="comment">//@WebServlet(value = &quot;/welcome1&quot;)</span></span><br><span class="line"><span class="comment">//@WebServlet(&#123;&quot;/wel&quot;, &quot;/abc&quot;, &quot;/def&quot;&#125;)</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/wel&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WelcomeServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="GenericServlet">GenericServlet</h2><ol><li>使用MyServlet直接实现Servlet接口，需要将该接口中所有方法实现</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServlet</span> <span class="keyword">implements</span> <span class="title class_">Servlet</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ServletConfig <span class="title function_">getServletConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getServletInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>我们进行改进</li></ol><p>我们让抽象类GenericServlet把不需要的方法实现即可，让service变成抽象类。</p><div class="tabs" id="genericservlet"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#genericservlet-1">GenericServlet</button></li><li class="tab"><button type="button" data-href="#genericservlet-2">MyServlet</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="genericservlet-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">GenericServlet</span>  <span class="keyword">implements</span> <span class="title class_">Servlet</span> &#123;</span><br><span class="line">    <span class="comment">//ServletConfig servletConfig形参，我们不知道传进来的是什么</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig servletConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ServletConfig <span class="title function_">getServletConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getServletInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="genericservlet-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServlet</span>  <span class="keyword">extends</span> <span class="title class_">GenericServlet</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>第一个问题MyServlet还能使用GenericServlet类中的init方法吗?<ul><li>可以。会执行GenericServlet类中的init方法。</li></ul></li><li>第二个问题：init方法是谁调用的？<ul><li>Tomcat服务器调用的。</li></ul></li><li>第三个问题：init方法中的ServletConfig对象是谁创建的？是谁传过来的？<ul><li>都是Tomcat干的。</li><li>Tomcat服务器先创建了ServletConfig对象，然后调用init方法，将ServletConfig对象传给了init方法。</li></ul></li></ul><p>Tomcat服务器伪代码：</p><div class="tabs" id="tomcat"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tomcat-1">Tomcat</button></li><li class="tab"><button type="button" data-href="#tomcat-2">GenericServlet</button></li><li class="tab"><button type="button" data-href="#tomcat-3">MyServlet</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tomcat-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tomcat</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="comment">// .....</span></span><br><span class="line">        <span class="comment">// Tomcat服务器伪代码</span></span><br><span class="line">        <span class="comment">// 创建LoginServlet对象（通过反射机制，调用无参数构造方法来实例化MyServlet对象）</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.bjpowernode.javaweb.servlet.MyservletServlet&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> clazz.newInstance();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 向下转型</span></span><br><span class="line">        <span class="type">Servlet</span> <span class="variable">servlet</span> <span class="operator">=</span> (Servlet)obj;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 创建ServletConfig对象</span></span><br><span class="line">        <span class="comment">// Tomcat服务器负责将ServletConfig对象实例化出来。</span></span><br><span class="line">        <span class="comment">// 多态（Tomcat服务器完全实现了Servlet规范）</span></span><br><span class="line">        <span class="type">ServletConfig</span> <span class="variable">servletConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">org</span>.apache.catalina.core.StandardWrapperFacade();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 调用Servlet的init方法</span></span><br><span class="line">        <span class="comment">//将这个实参传入到那个方法里。</span></span><br><span class="line">        servlet.init(servletConfig);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 调用Servlet的service方法</span></span><br><span class="line">        <span class="comment">// ....</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tomcat-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">GenericServlet</span> <span class="keyword">implements</span> <span class="title class_">Servlet</span>, ServletConfig,</span><br><span class="line">        java.io.Serializable &#123;</span><br><span class="line">    <span class="comment">//版本号</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> ServletConfig config;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        此构造方法啥也不做，因为Servlet的所有初始化任务都是由init方法完成的。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GenericServlet</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// NOOP</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// NOOP by default</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getInitParameter</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getServletConfig().getInitParameter(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Enumeration&lt;String&gt; <span class="title function_">getInitParameterNames</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getServletConfig().getInitParameterNames();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ServletConfig <span class="title function_">getServletConfig</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/*通过该方法，可以让子类调用父类私有属性*/</span></span><br><span class="line">        <span class="keyword">return</span> config;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ServletContext <span class="title function_">getServletContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getServletConfig().getServletContext();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getServletInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="comment">/*该方法是形参，tomcat将实参传进来，然后通过this.config=config</span></span><br><span class="line"><span class="comment">          把局部变量变为全局变量。*/</span></span><br><span class="line">        <span class="built_in">this</span>.config = config;</span><br><span class="line">      <span class="comment">//Tomcat首先调用init()有参方法，然后调用init()无参方法。</span></span><br><span class="line">        <span class="built_in">this</span>.init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/*目的是让子类重写init()方法的无参构造方法。*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="comment">// NOOP by default</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">        getServletContext().log(getServletName() + <span class="string">&quot;: &quot;</span> + msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String message, Throwable t)</span> &#123;</span><br><span class="line">        getServletContext().log(getServletName() + <span class="string">&quot;: &quot;</span> + message, t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest req, ServletResponse res)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getServletName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> config.getServletName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tomcat-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> GenericServlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyServlet</span>  <span class="keyword">extends</span> <span class="title class_">GenericServlet</span>&#123;</span><br><span class="line">    <span class="comment">//我们需要在MyServlet中重写init方法</span></span><br><span class="line">    <span class="comment">//子类重写第二个(无参的)就可</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span>  <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;MyServlet init() method execute!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">//我想在MyServlet子类中使用Servlet对象怎么办?</span></span><br><span class="line">        ServletConfig config=<span class="built_in">this</span>.getServletConfig();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="ServletConfig">ServletConfig</h3><ul><li>什么是<code>ServletConfig</code>？<ul><li>ServletConfig是一个接口。是Servlet规范中的一员。</li><li>ServletConfig对象中封装了标签中的配置信息。（web.xml文件中servlet的配置信息）</li></ul></li><li>一个Servlet对应一个ServletConfig对象。</li><li>Servlet对象是Tomcat服务器创建，并且ServletConfig对象也是Tomcat服务器创建。并且默认情况下，他们都是在用户发送第一次请求的时候创建。</li><li>Tomcat服务器调用Servlet对象的init方法的时候需要传一个ServletConfig对象的参数给init方法。</li><li>ServletConfig接口的实现类是Tomcat服务器给实现的。（Tomcat服务器说的就是WEB服务器。）</li><li>ServletConfig接口有哪些常用的方法？</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">getInitParameter</span><span class="params">(String name)</span>; <span class="comment">// 通过初始化参数的name获取value</span></span><br><span class="line"><span class="keyword">public</span> Enumeration&lt;String&gt; <span class="title function_">getInitParameterNames</span><span class="params">()</span>; <span class="comment">// 获取所有的初始化参数的name</span></span><br><span class="line"><span class="keyword">public</span> ServletContext <span class="title function_">getServletContext</span><span class="params">()</span>; <span class="comment">// 获取ServletContext对象</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getServletName</span><span class="params">()</span>; <span class="comment">// 获取Servlet的name</span></span><br></pre></td></tr></table></figure><p>以上方法在Servlet类当中，都可以使用this去调用。因为GenericServlet实现了ServletConfig接口。</p><h3 id="ServletContext-应用域">ServletContext(应用域)</h3><ul><li>一个ServletContext对象通常对应的是一个web.xml文件。</li><li>只要在同一个webapp当中，只要在同一个应用当中，所有的Servlet对象都是共享同一个ServletContext对象的。</li><li>ServletContext对象在服务器启动阶段创建，在服务器关闭的时候销毁。这就是ServletContext对象的生命周期。ServletContext对象是应用级对象。</li><li>ServletContext是一个接口，Tomcat服务器对ServletContext接口进行了实现。<ul><li>ServletContext对象的创建也是Tomcat服务器来完成的。启动webapp的时候创建的。</li></ul></li></ul><p>ServletContext接口中有哪些常用的方法？</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">getInitParameter</span><span class="params">(String name)</span>; <span class="comment">// 通过初始化参数的name获取value</span></span><br><span class="line"><span class="keyword">public</span> Enumeration&lt;String&gt; <span class="title function_">getInitParameterNames</span><span class="params">()</span>; <span class="comment">// 获取所有的初始化参数的name</span></span><br></pre></td></tr></table></figure><p>通过该两个方法可以获得以下的信息：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--以上两个方法是ServletContext对象的方法，这个方法获取的是什么信息？是以下的配置信息--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>pageSize<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>10<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>startIndex<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>0<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--注意：以上的配置信息属于应用级的配置信息，一般一个项目中共享的配置信息会放到以上的标签当中。--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--如果你的配置信息只是想给某一个servlet作为参考，那么你配置到servlet标签当中即可，使用ServletConfig对象来获取。--&gt;</span></span><br></pre></td></tr></table></figure><p>其他方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取应用的根路径（非常重要），因为在java源代码当中有一些地方可能会需要应用的根路径，这个方法可以动态获取应用的根路径</span></span><br><span class="line"><span class="comment">// 在java源码当中，不要将应用的根路径写死，因为你永远都不知道这个应用在最终部署的时候，起一个什么名字。</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getContextPath</span><span class="params">()</span>;</span><br><span class="line"><span class="comment">//String contextPath = application.getContextPath();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取文件的绝对路径（真实路径）</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getRealPath</span><span class="params">(String path)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过ServletContext对象也是可以记录日志的</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String message)</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String message, Throwable t)</span>;</span><br><span class="line"><span class="comment">// 这些日志信息记录到哪里了？</span></span><br><span class="line"><span class="comment">// localhost.2021-11-05.log</span></span><br><span class="line"><span class="comment">// Tomcat服务器的logs目录下都有哪些日志文件？</span></span><br><span class="line"><span class="comment">//catalina.2021-11-05.log 服务器端的java程序运行的控制台信息。</span></span><br><span class="line"><span class="comment">//localhost.2021-11-05.log ServletContext对象的log方法记录的日志信息存储到这个文件中。</span></span><br><span class="line"><span class="comment">//localhost_access_log.2021-11-05.txt 访问日志</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ServletContext对象还有另一个名字：应用域（后面还有其他域，例如：请求域、会话域）</span></span><br><span class="line"><span class="comment">// 如果所有的用户共享一份数据，并且这个数据很少的被修改，并且这个数据量很少，</span></span><br><span class="line"><span class="comment">// 可以将这些数据放到ServletContext这个应用域中</span></span><br><span class="line"><span class="comment">// 存（怎么向ServletContext应用域中存数据）</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAttribute</span><span class="params">(String name, Object value)</span>; <span class="comment">// map.put(k, v)</span></span><br><span class="line"><span class="comment">// 取（怎么从ServletContext应用域中取数据）</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">getAttribute</span><span class="params">(String name)</span>; <span class="comment">// Object v = map.get(k)</span></span><br><span class="line"><span class="comment">// 删（怎么删除ServletContext应用域中的数据）</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeAttribute</span><span class="params">(String name)</span>; <span class="comment">// map.remove(k)</span></span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>以后我们编写Servlet类的时候，实际上是不会去直接继承GenericServlet类的，因为我们是B/S结构的系统，这种系统是基于HTTP超文本传输协议的，在Servlet规范当中，提供了一个类叫做HttpServlet，它是专门为HTTP协议准备的一个Servlet类。我们编写的Servlet类要继承HttpServlet。（HttpServlet是HTTP协议专用的。）使用HttpServlet处理HTTP协议更便捷。但是我们需要知道它的继承结构：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jakarta.servlet.Servlet（接口）【爷爷】</span><br><span class="line">jakarta.servlet.GenericServlet <span class="keyword">implements</span> <span class="title class_">Servlet</span>（抽象类）【儿子】</span><br><span class="line">jakarta.servlet.http.HttpServlet <span class="keyword">extends</span> <span class="title class_">GenericServlet</span>（抽象类）【孙子】</span><br><span class="line"></span><br><span class="line">我们以后编写的Servlet要继承HttpServlet类。</span><br></pre></td></tr></table></figure></div><h2 id="HttpServlet">HttpServlet</h2><div class="note warning no-icon flat"><ul><li><strong>HttpServlet类是专门为HTTP协议准备的。比GenericServlet更加适合HTTP协议下的开发。</strong></li></ul></div><ul><li><p><strong>HttpServlet在哪个包下？</strong></p><ul><li>jakarta.servlet.http.HttpServlet</li></ul></li><li><p>**http包下都有哪些类和接口呢？**jakarta.servlet.http.*;</p><ul><li>jakarta.servlet.http.HttpServlet （HTTP协议专用的Servlet类，抽象类）</li><li>jakarta.servlet.http.HttpServletRequest （HTTP协议专用的请求对象）</li><li>jakarta.servlet.http.HttpServletResponse （HTTP协议专用的响应对象）</li></ul></li><li><p><strong>HttpServletRequest对象中封装了什么信息？</strong></p><ul><li>HttpServletRequest，简称<code>request对象</code>。</li><li>HttpServletRequest中封装了请求协议的全部内容。</li><li>Tomcat服务器（WEB服务器）将“请求协议”中的数据全部解析出来，然后将这些数据全部封装到request对象当中了。</li></ul></li></ul><div class="note warning no-icon flat"><ul><li>我们只需要面向HttpServletRequest，就可以获取请求协议中的数据。</li><li>HttpServletResponse对象是专门用来响应HTTP协议到浏览器的。</li></ul></div><ul><li><strong>回忆Servlet生命周期？</strong><ul><li>用户第一次请求<ul><li>Tomcat服务器通过反射机制，调用无参数构造方法。创建Servlet对象。(web.xml文件中配置的Servlet类对应的对象。)</li><li>Tomcat服务器调用Servlet对象的init方法完成初始化。</li><li>Tomcat服务器调用Servlet对象的service方法处理请求。</li></ul></li><li>用户第二次请求<ul><li>Tomcat服务器调用Servlet对象的service方法处理请求。</li></ul></li><li>用户第三次请求<ul><li>Tomcat服务器调用Servlet对象的service方法处理请求。</li></ul></li><li>…<ul><li>Tomcat服务器调用Servlet对象的service方法处理请求。</li></ul></li><li>服务器关闭<ul><li>Tomcat服务器调用Servlet对象的destroy方法，做销毁之前的准备工作。</li><li>Tomcat服务器销毁Servlet对象。</li></ul></li></ul></li><li>HttpServlet源码分析：</li></ul><div class="tabs" id="httpservlet"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#httpservlet-1">HelloServlet</button></li><li class="tab"><button type="button" data-href="#httpservlet-2">GenericServlet</button></li><li class="tab"><button type="button" data-href="#httpservlet-3">HttpServlet</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="httpservlet-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line"><span class="comment">// 用户第一次请求，创建HelloServlet对象的时候，会执行这个无参数构造方法。</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">HelloServlet</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="httpservlet-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">GenericServlet</span> <span class="keyword">implements</span> <span class="title class_">Servlet</span>, ServletConfig,</span><br><span class="line">        java.io.Serializable &#123;</span><br><span class="line">           </span><br><span class="line"><span class="comment">/* 用户第一次请求的时候，HelloServlet对象第一次被创建之后，因为HelloServlet</span></span><br><span class="line"><span class="comment">       没有init方法，HttpServlet也没有，所以执行GenericServlet的init有参构造.。  */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="built_in">this</span>.config = config;</span><br><span class="line">        <span class="built_in">this</span>.init();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// 用户第一次请求的时候，带有参数的init(ServletConfig config)执行之后，会执行这个没有参数的init()</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="comment">// NOOP by default</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="httpservlet-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HttpServlet模板类。</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">HttpServlet</span> <span class="keyword">extends</span> <span class="title class_">GenericServlet</span> &#123;</span><br><span class="line">    <span class="comment">// 用户发送第一次请求的时候这个service会执行(HelloServlet没有service,执行Httpservlet的)</span></span><br><span class="line">    <span class="comment">// 用户发送第N次请求的时候，这个service方法还是会执行。</span></span><br><span class="line">    <span class="comment">// 用户只要发送一次请求，这个service方法就会执行一次。</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(ServletRequest req, ServletResponse res)</span></span><br><span class="line">        <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        HttpServletRequest  request;</span><br><span class="line">        HttpServletResponse response;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 将ServletRequest和ServletResponse向下转型为带有Http的HttpServletRequest和HttpServletResponse</span></span><br><span class="line">            request = (HttpServletRequest) req;</span><br><span class="line">            response = (HttpServletResponse) res;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassCastException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ServletException</span>(lStrings.getString(<span class="string">&quot;http.non_http&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 调用重载的service方法。</span></span><br><span class="line">        service(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 这个service方法的两个参数都是带有Http的。</span></span><br><span class="line">    <span class="comment">// 这个service是一个模板方法。</span></span><br><span class="line">    <span class="comment">// 在该方法中定义核心算法骨架，具体的实现步骤延迟到子类中去完成。</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">service</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span><br><span class="line">        <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 获取请求方式</span></span><br><span class="line">        <span class="comment">// 这个请求方式最终可能是：&quot;&quot;</span></span><br><span class="line">        <span class="comment">// 注意：request.getMethod()方法获取的是请求方式，可能是七种之一：</span></span><br><span class="line">        <span class="comment">// GET POST PUT DELETE HEAD OPTIONS TRACE</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">method</span> <span class="operator">=</span> req.getMethod();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果请求方式是GET请求，则执行doGet方法。</span></span><br><span class="line">        <span class="keyword">if</span> (method.equals(METHOD_GET)) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">lastModified</span> <span class="operator">=</span> getLastModified(req);</span><br><span class="line">            <span class="keyword">if</span> (lastModified == -<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// servlet doesn&#x27;t support if-modified-since, no reason</span></span><br><span class="line">                <span class="comment">// to go through further expensive logic</span></span><br><span class="line">                doGet(req, resp);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">long</span> ifModifiedSince;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    ifModifiedSince = req.getDateHeader(HEADER_IFMODSINCE);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalArgumentException iae) &#123;</span><br><span class="line">                    <span class="comment">// Invalid date header - proceed as if none was set</span></span><br><span class="line">                    ifModifiedSince = -<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (ifModifiedSince &lt; (lastModified / <span class="number">1000</span> * <span class="number">1000</span>)) &#123;</span><br><span class="line">                    <span class="comment">// If the servlet mod time is later, call doGet()</span></span><br><span class="line">                    <span class="comment">// Round down to the nearest second for a proper compare</span></span><br><span class="line">                    <span class="comment">// A ifModifiedSince of -1 will always be less</span></span><br><span class="line">                    maybeSetLastModified(resp, lastModified);</span><br><span class="line">                    doGet(req, resp);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    resp.setStatus(HttpServletResponse.SC_NOT_MODIFIED);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_HEAD)) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">lastModified</span> <span class="operator">=</span> getLastModified(req);</span><br><span class="line">            maybeSetLastModified(resp, lastModified);</span><br><span class="line">            doHead(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_POST)) &#123;</span><br><span class="line">            <span class="comment">// 如果请求方式是POST请求，则执行doPost方法。</span></span><br><span class="line">            doPost(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_PUT)) &#123;</span><br><span class="line">            doPut(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_DELETE)) &#123;</span><br><span class="line">            doDelete(req, resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_OPTIONS)) &#123;</span><br><span class="line">            doOptions(req,resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.equals(METHOD_TRACE)) &#123;</span><br><span class="line">            doTrace(req,resp);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            <span class="comment">// Note that this means NO servlet supports whatever</span></span><br><span class="line">            <span class="comment">// method was requested, anywhere on this server.</span></span><br><span class="line">            <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">errMsg</span> <span class="operator">=</span> lStrings.getString(<span class="string">&quot;http.method_not_implemented&quot;</span>);</span><br><span class="line">            Object[] errArgs = <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">1</span>];</span><br><span class="line">            errArgs[<span class="number">0</span>] = method;</span><br><span class="line">            errMsg = MessageFormat.format(errMsg, errArgs);</span><br><span class="line"></span><br><span class="line">            resp.sendError(HttpServletResponse.SC_NOT_IMPLEMENTED, errMsg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*子类没有重写doGet就会走父类的，报405错误*/</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span><br><span class="line">        <span class="keyword">throws</span> ServletException, IOException&#123;</span><br><span class="line">        <span class="comment">// 报405错误</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> lStrings.getString(<span class="string">&quot;http.method_get_not_supported&quot;</span>);</span><br><span class="line">        sendMethodNotAllowed(req, resp, msg);</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="comment">/*子类没有重写doPost就会走父类的，报405错误*/</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span><br><span class="line">        <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 报405错误</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> lStrings.getString(<span class="string">&quot;http.method_post_not_supported&quot;</span>);</span><br><span class="line">        sendMethodNotAllowed(req, resp, msg);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info no-icon flat"><ul><li><p>假设前端发送的请求是<code>get请求</code>，后端程序员重写的方法是<code>doPost</code></p></li><li><p>假设前端发送的请求是<code>post请求</code>，后端程序员重写的方法是<code>doGet</code>会发生什么呢？</p><ul><li>发生405这样的一个错误。405表示前端的错误，发送的请求方式不对。和服务器不一致。不是服务器需要的请求方式。</li><li>405错误，前端收到这个错误，前端会进行相应的处理。 比如：提示用户，请使用正确的请求方式。</li></ul></li><li><p>通过以上源代码可以知道：只要HttpServlet类中的doGet方法或doPost方法执行了，必然405.</p></li><li><p>怎么避免405的错误呢？</p><ul><li>后端重写了doGet方法，前端一定要发get请求。</li><li>后端重写了doPost方法，前端一定要发post请求。</li><li>这样可以避免405错误。</li></ul></li><li><p><strong>这种前端到底需要发什么样的请求，其实应该后端说了算。后端让发什么方式，前端就得发什么方式。</strong></p></li></ul></div><ul><li><p>我们编写的HelloServlet直接继承HttpServlet，直接重写HttpServlet类中的service()方法行吗？</p><ul><li>可以，但是这样将会享受不到405错误。享受不到HTTP协议专属的东西。</li></ul></li><li><p>最终的一个Servlet类的开发步骤：</p><ul><li>第一步：编写一个Servlet类，直接继承HttpServlet</li><li>第二步：重写doGet方法或者重写doPost方法，到底重写谁，javaweb程序员说了算。</li><li>第三步：将Servlet类配置到web.xml文件当中。</li><li>第四步：准备前端的页面（form表单），form表单中指定请求路径即可。</li></ul></li></ul><h3 id="欢迎资源文件">欢迎资源文件</h3><ul><li><strong>前提：</strong><ul><li>用户可以记住网站名，但是不会记住网站资源文件名</li></ul></li><li><strong>默认欢迎资源文件:</strong><ul><li>用户发送了一个针对某个网站的【默认请求】时，此时由Http服务器自动从当前网站返回的资源文件</li><li>正常请求： <a href="http://localhost:8080/myWeb/index.html">http://localhost:8080/myWeb/index.html</a></li><li>默认请求： <a href="http://localhost:8080/myWeb/">http://localhost:8080/myWeb/</a></li></ul></li><li><strong>设置当前网站的默认欢迎资源文件规则：</strong><ul><li>规则位置:网站/web/WEB-INF/web.xml</li><li>规则命令:<ul><li><welcome-file-list></li><li><welcome-file>login.html</welcome-file></li><li></welcome-file-list></li></ul></li></ul></li><li>网站设置自定义默认文件定位规则，此时Tomcat自带定位规则将失效</li></ul><ul><li>动态资源：Servlet类。</li><li>步骤：</li><li>第一步：写一个Servlet</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WelcomeServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line">        out.print(<span class="string">&quot;&lt;h1&gt;welcome to bjpowernode!&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>第二步：在web.xml文件中配置servlet</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">    &lt;servlet-name&gt;welcomeServlet&lt;/servlet-name&gt;</span><br><span class="line">    &lt;servlet-class&gt;com.bjpowernode.javaweb.servlet.WelcomeServlet&lt;/servlet-class&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">    &lt;servlet-name&gt;welcomeServlet&lt;/servlet-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;http:<span class="comment">//localhost:8080/myWeb/login.html&lt;/url-pattern&gt;</span></span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure><p>第三步：在web.xml文件中配置欢迎页</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;welcome-file-list&gt;</span><br><span class="line">    &lt;welcome-file&gt;http:<span class="comment">//localhost:8080/myWeb/login.html&lt;/welcome-file&gt;</span></span><br><span class="line">&lt;/welcome-file-list&gt;</span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><ul><li>关于WEB-INF目录<ul><li>在WEB-INF目录下新建了一个文件：welcome.html</li><li>打开浏览器访问：<a href="http://localhost:8080/servlet07/WEB-INF/welcome.html">http://localhost:8080/servlet07/WEB-INF/welcome.html</a> 出现了404错误。</li><li><strong>注意：放在WEB-INF目录下的资源是受保护的。在浏览器上不能够通过路径直接访问。所以像HTML、CSS、JS、image等静态资源一定要放到WEB-INF目录之外。</strong></li></ul></li></ul></div><h2 id="HttpServletRequest接口详解">HttpServletRequest接口详解</h2><ul><li><p><code>HttpServletRequest</code>是一个接口，全限定名称：jakarta.servlet.http.HttpServletRequest</p></li><li><p>HttpServletRequest对象中都有什么信息？都包装了什么信息？</p><ul><li>**HttpServletRequest对象是Tomcat服务器负责创建的。**这个对象中封装了HTTP的请求协议。</li><li>实际上是用户发送请求的时候，遵循了HTTP协议，发送的是HTTP的请求协议，Tomcat服务器将HTTP协议中的信息以及数据全部解析出来，然后Tomcat服务器把这些信息封装到HttpServletRequest对象当中，传给了我们javaweb程序员。</li><li>javaweb程序员面向HttpServletRequest接口编程，调用方法就可以获取到请求的信息了。</li></ul></li><li><p>request和response对象的生命周期？</p><ul><li>request对象和response对象，一个是<code>请求对象</code>，一个是<code>响应对象</code>。这两个对象只在当前请求中有效。</li><li>一次请求对应一个request。</li><li>两次请求则对应两个request。</li></ul></li><li><p>…</p></li></ul><h3 id="常用的方法">常用的方法</h3><h4 id="获取用户提交的数据">获取用户提交的数据</h4><ul><li>怎么获取前端浏览器用户提交的数据？</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String,String[]&gt; getParameterMap() 这个是获取Map</span><br><span class="line">Enumeration&lt;String&gt; <span class="title function_">getParameterNames</span><span class="params">()</span> 这个是获取Map集合中所有的key</span><br><span class="line">String[] getParameterValues(String name) 根据key获取Map集合的value</span><br><span class="line">String <span class="title function_">getParameter</span><span class="params">(String name)</span>  获取value这个一维数组当中的第一个元素。这个方法最常用。</span><br><span class="line"><span class="comment">// 以上的4个方法，和获取用户提交的数据有关系。</span></span><br></pre></td></tr></table></figure><details class="folding-tag" ><summary> 思考：如果是你，前端的form表单提交了数据之后，你准备怎么存储这些数据，你准备采用什么样的数据结构去存储这些数据呢？ </summary>              <div class='content'>              <ul><li>前端提交的数据格式：username=abc&amp;userpwd=111&amp;aihao=s&amp;aihao=d&amp;aihao=tt</li><li>我会采用Map集合来存储：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String,String&gt;</span><br><span class="line">    key存储String</span><br><span class="line">    value存储String</span><br><span class="line">    这种想法对吗？不对。</span><br><span class="line">    如果采用以上的数据结构存储会发现key重复的时候value覆盖。</span><br><span class="line">    key         value</span><br><span class="line">    ---------------------</span><br><span class="line">    username    abc</span><br><span class="line">    userpwd     <span class="number">111</span></span><br><span class="line">    aihao       s</span><br><span class="line">    aihao       d</span><br><span class="line">    aihao       tt</span><br><span class="line">    这样是不行的，因为map的key不能重复。</span><br><span class="line">Map&lt;String, String[]&gt;</span><br><span class="line">    key存储String</span><br><span class="line">    value存储String[]</span><br><span class="line">    keyvalue</span><br><span class="line">    -------------------------------</span><br><span class="line">    username&#123;<span class="string">&quot;abc&quot;</span>&#125;</span><br><span class="line">    userpwd&#123;<span class="string">&quot;111&quot;</span>&#125;</span><br><span class="line">    aihao&#123;<span class="string">&quot;s&quot;</span>,<span class="string">&quot;d&quot;</span>,<span class="string">&quot;tt&quot;</span>&#125;</span><br></pre></td></tr></table></figure><ul><li>注意：前端表单提交数据的时候，假设提交了120这样的“数字”，其实是以字符串&quot;120&quot;的方式提交的，所以服务器端获取到的一定是一个字符串的&quot;120&quot;，而不是一个数字。（前端永远提交的是字符串，后端获取的也永远是字符串。）</li></ul>              </div>            </details><p><strong>四个方法的使用</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//username=zhangsan&amp;userpwd=123&amp;interest=s&amp;interest=d</span></span><br><span class="line"><span class="comment">/*Map&lt;String,String[]&gt;</span></span><br><span class="line"><span class="comment">     keyvalue</span></span><br><span class="line"><span class="comment">  ---------------------------</span></span><br><span class="line"><span class="comment">  &quot;username&quot;&#123;&quot;zhangsan&quot;&#125;</span></span><br><span class="line"><span class="comment">  &quot;userpwd&quot;    &#123;&quot;123&quot;&#125;</span></span><br><span class="line"><span class="comment">  &quot;interest&quot;&#123;&quot;s&quot;, &quot;d&quot;&#125;  */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException,ServletException&#123;</span><br><span class="line">  </span><br><span class="line">         <span class="comment">/*1.最常用的方式  String getParameter(String name)*/</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">userpwd</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;userpwd&quot;</span>);</span><br><span class="line">  </span><br><span class="line">  System.out.println(username);</span><br><span class="line">         System.out.println(userpwd);</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/*2.既然是checkbox，调用方法：request.getParameterValues(&quot;interest&quot;)*/</span></span><br><span class="line">      String[] interests = request.getParameterValues(<span class="string">&quot;interest&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(String  i : interests)&#123;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*3.直接通过getParameterNames()这个方法，可以直接获取这个Map集合的所有key*/</span></span><br><span class="line">        Enumeration&lt;String&gt; names = request.getParameterNames();</span><br><span class="line">        <span class="keyword">while</span>(names.hasMoreElements())&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> names.nextElement();</span><br><span class="line">            System.out.println(name);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="comment">/*4.获取参数Map集合*/</span></span><br><span class="line">        Map&lt;String,String[]&gt; parameterMap = request.getParameterMap();</span><br><span class="line">        <span class="comment">// 遍历Map集合(获取Map集合中所有的key，遍历)</span></span><br><span class="line">        Set&lt;String&gt; keys = parameterMap.keySet();</span><br><span class="line">        Iterator&lt;String&gt; it = keys.iterator();</span><br><span class="line">        <span class="keyword">while</span>(it.hasNext())&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> it.next();</span><br><span class="line">  System.out.print(key+<span class="string">&quot;=&quot;</span>);</span><br><span class="line">            <span class="comment">// 通过key获取value</span></span><br><span class="line">            String[] values = parameterMap.get(key);</span><br><span class="line">          <span class="keyword">for</span>(String value : values)&#123;</span><br><span class="line">                System.out.print(value+<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println();</span><br><span class="line">          </span><br><span class="line">          <span class="comment">/*4.输出结果</span></span><br><span class="line"><span class="comment">          username=zhangsan,</span></span><br><span class="line"><span class="comment">userpwd=123,</span></span><br><span class="line"><span class="comment">interest=s,d,</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure><h4 id="HttpServletRequest接口的其他常用方法：">HttpServletRequest接口的其他常用方法：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取客户端的IP地址</span></span><br><span class="line"><span class="type">String</span> <span class="variable">remoteAddr</span> <span class="operator">=</span> request.getRemoteAddr();</span><br><span class="line"></span><br><span class="line"><span class="comment">// get请求在请求行上提交数据。</span></span><br><span class="line"><span class="comment">// post请求在请求体中提交数据。</span></span><br><span class="line"><span class="comment">// 设置请求体的字符集。（显然这个方法是处理POST请求的乱码问题。这种方式并不能解决get请求的乱码问题。）</span></span><br><span class="line"><span class="comment">// Tomcat10之后，request请求体当中的字符集默认就是UTF-8，不需要设置字符集，不会出现乱码问题。</span></span><br><span class="line"><span class="comment">// Tomcat9前（包括9在内），如果前端请求体提交的是中文，后端获取之后出现乱码，怎么解决这个乱码？执行以下代码。</span></span><br><span class="line">request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在Tomcat9之前（包括9），响应中文也是有乱码的，怎么解决这个响应的乱码？</span></span><br><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line"><span class="comment">// 在Tomcat10之后，包括10在内，响应中文的时候就不在出现乱码问题了。以上代码就不需要设置UTF-8了。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意一个细节</span></span><br><span class="line"><span class="comment">// 在Tomcat10包括10在内之后的版本，中文将不再出现乱码。（这也体现了中文地位的提升。）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// get请求乱码问题怎么解决？</span></span><br><span class="line"><span class="comment">// get请求发送的时候，数据是在请求行上提交的，不是在请求体当中提交的。</span></span><br><span class="line"><span class="comment">// get请求乱码怎么解决</span></span><br><span class="line"><span class="comment">// 方案：修改CATALINA_HOME/conf/server.xml配置文件</span></span><br><span class="line">&lt;Connector URIEncoding=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span><br><span class="line"><span class="comment">// 注意：从Tomcat8之后，URIEncoding的默认值就是UTF-8，所以GET请求也没有乱码问题了。</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">// 获取应用的根路径</span></span><br><span class="line"><span class="type">String</span> <span class="variable">contextPath</span> <span class="operator">=</span> request.getContextPath();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取请求方式</span></span><br><span class="line"><span class="type">String</span> <span class="variable">method</span> <span class="operator">=</span> request.getMethod();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取请求的URI</span></span><br><span class="line"><span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> request.getRequestURI();  <span class="comment">// /aaa/testRequest</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取servlet path</span></span><br><span class="line"><span class="type">String</span> <span class="variable">servletPath</span> <span class="operator">=</span> request.getServletPath(); <span class="comment">//   /testRequest</span></span><br></pre></td></tr></table></figure><h3 id="请求域对象request">请求域对象request</h3><ul><li><code>请求域</code>对象要比<code>应用域</code>对象范围小很多。生命周期短很多。请求域只在一次请求内有效。</li><li>一个请求对象request对应一个请求域对象。一次请求结束之后，这个请求域就销毁了。</li></ul><ul><li>请求域对象也有这三个方法：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 存（怎么向request请求域中存数据）</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAttribute</span><span class="params">(String name, Object value)</span>; <span class="comment">// map.put(k, v)</span></span><br><span class="line"><span class="comment">// 取（怎么从request请求域中取数据）</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">getAttribute</span><span class="params">(String name)</span>; <span class="comment">// Object v = map.get(k)</span></span><br><span class="line"><span class="comment">// 删（怎么删除request请求域中的数据）</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeAttribute</span><span class="params">(String name)</span>; <span class="comment">// map.remove(k)</span></span><br></pre></td></tr></table></figure><ul><li>**请求域和应用域的选用原则:**尽量使用小的域对象，因为小的域对象占用的资源较少。</li></ul><div class="note dafult no-icon flat"><p>两个Servlet怎么共享数据？</p><ul><li>将数据放到ServletContext应用域当中，当然是可以的，但是应用域范围太大，占用资源太多。不建议使用。</li><li>可以将数据放到request域当中，然后AServlet转发到BServlet，保证AServlet和BServlet在同一次请求当中，这样就可以做到两个Servlet，或者多个Servlet共享同一份数据。</li></ul></div><h3 id="转发">转发</h3><p>**原理：**是由WEB服务器来控制的。A资源跳转到B资源，这个跳转动作是Tomcat服务器内部完成的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一步：获取请求转发器对象</span></span><br><span class="line"><span class="type">RequestDispatcher</span> <span class="variable">dispatcher</span> <span class="operator">=</span> request.getRequestDispatcher(<span class="string">&quot;/b&quot;</span>);</span><br><span class="line"><span class="comment">// 第二步：调用转发器的forward方法完成跳转/转发</span></span><br><span class="line">dispatcher.forward(request,response);</span><br><span class="line">            </span><br><span class="line"><span class="comment">// 第一步和第二步代码可以联合在一起。</span></span><br><span class="line"> request.getRequestDispatcher(<span class="string">&quot;/b&quot;</span>).forward(request,response);</span><br><span class="line"></span><br><span class="line"><span class="comment">//注意:转发的时候是一次请求,会将当前的request和response对象传递给下一个servlet.</span></span><br><span class="line">         </span><br></pre></td></tr></table></figure><ul><li>转发的下一个资源必须是一个Servlet吗？<ul><li>不一定，只要是Tomcat服务器当中的合法资源，都是可以转发的。例如：html…</li></ul></li></ul><div class="note warning no-icon flat"><p>注意：转发的时候，路径的写法要注意，转发的路径以“/”开始，不加项目名。</p></div><p><strong>关于request对象中两个非常容易混淆的方法：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// uri?username=zhangsan&amp;userpwd=123&amp;sex=1</span></span><br><span class="line"><span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 之前一定是执行过：request.setAttribute(&quot;name&quot;, new Object())</span></span><br><span class="line"><span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> request.getAttribute(<span class="string">&quot;name&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以上两个方法的区别是什么？</span></span><br><span class="line"><span class="comment">// 第一个方法：获取的是用户在浏览器上提交的数据。</span></span><br><span class="line"><span class="comment">// 第二个方法：获取的是请求域当中绑定的数据。</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250925213814.png"/></div></div><div class="note warning no-icon flat"><p>特点:<br>在请求转发过程中，浏览器只发送一个了个Http请求协议包。<br>参与本次请求的所有Servlet共享同一个请求协议包，因此这些Servlet接收的请求方式与浏览器发送的请求方式保持一致</p></div><h3 id="重定向">重定向</h3><p>***工作原理:***由浏览器来完成。具体跳转到哪个资源，是浏览器说了算。<br><em><strong>实现命令：</strong></em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response.sendRedirect(<span class="string">&quot;请求地址&quot;</span>)</span><br><span class="line"><span class="comment">//注意:重定向地址需要加上 项目名</span></span><br><span class="line"><span class="comment">//因为浏览器发送请求是需要加上项目名的</span></span><br></pre></td></tr></table></figure><p><em><strong>特征:</strong></em></p><ul><li>请求地址：<ul><li>可以把当前网站内部的资源文件地址发送给浏览器 （/网站名/资源文件名）</li><li>可以把其他网站资源文件地址发送给浏览器(<a href="http://xn--ip-im8ckc">http://ip地址</a>:端口号/网站名/资源文件名)</li></ul></li><li>请求次数：<ul><li>浏览器至少发送两次请求，但是只有第一次请求是用户手动发送。</li><li>后续请求都是浏览器自动发送的。</li></ul></li><li>请求方式：<ul><li>重定向解决方案中，通过地址栏通知浏览器发起下一次请求，因此通过重定向解决方案调用的资源文件接收的请求方式一定是<code>GET</code><br><em><strong>缺点:</strong></em><br>重定向解决方案需要在浏览器与服务器之间进行多次往返，大量时间消耗在往返次数上，增加用户等待服务时间</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250925214354.png"/></div></div><h4 id="转发和重定向区别">转发和重定向区别</h4><p>转发和重定向应该如何选择?什么时候使用转发，什么时候使用重定向?</p><ul><li>如果在上一个Servlet当中向request域当中绑定了数据，希望从下一个Servlet当中把request域里面的数据取出来，使用转发机制。</li><li>剩下所有的请求均使用重定向。(重定向使用较多。)</li><li>他俩跳转的资源只要是服务器内部合法的资源即可。(Servlet,JSP,HTML)…</li><li>转发会存在浏览器刷新问题,而重定向不会</li></ul><h2 id="Session和Cookie">Session和Cookie</h2><h3 id="Session">Session</h3><ul><li>什么是会话？<ul><li>用户打开浏览器，进行一系列操作，然后最终将浏览器关闭，这个整个过程叫做：一次会话。会话在服务器端也有一个对应的java对象，这个java对象叫做：session。</li><li>什么是一次请求：用户在浏览器上点击了一下，然后到页面停下来，可以粗略认为是一次请求。请求对应的服务器端的java对象是：<code>request</code></li></ul></li></ul><div class="note warning no-icon flat"><ul><li>一个会话当中包含多次请求。（一次会话对应N次请求。）</li></ul></div><ul><li>在java的servlet规范当中，session对应的类名：<code>HttpSession</code>（jarkata.servlet.http.HttpSession）</li><li>session机制属于B/S结构的一部分。如果使用php语言开发WEB项目，同样也是有session这种机制的。session机制实际上是一个规范。不同的语言对这种会话机制都有实现。</li><li>session对象最主要的作用是：<code>保存会话状态。</code>（用户登录成功了，这是一种登录成功的状态，你怎么把登录成功的状态一直保存下来呢？使用session对象可以保留会话状态。）</li><li>为什么需要session对象来保存会话状态呢？<ul><li>因为HTTP协议是一种<code>无状态协议</code>。</li><li>什么是无状态：请求的时候，B和S是连接的，但是请求结束之后，连接就断了。HTTP协议为什么要设计成这样？因为这样的无状态协议，可以<strong>降低服务器的压力</strong>。请求的瞬间是连接的，请求结束之后，连接断开，这样服务器压力小。</li><li>B和S断开以后，关闭浏览器这个动作，服务器都不会知道</li></ul></li><li>张三打开一个浏览器A，李四打开一个浏览器B，访问服务器之后，在服务器端会生成：<ul><li>张三专属的session对象</li><li>李四专属的session对象</li><li>每个人通过getSession()方法获取的session对象获得的都是他们专属的session对象</li></ul></li><li>为什么不使用request对象保存会话状态？为什么不使用ServletContext对象保存会话状态？<ul><li>request.setAttribute()存，request.getAttribute()取，ServletContext也有这个方法。request是请求域。ServletContext是应用域。</li><li>ServletContext对象的域太大。request对象域太小，均不适合保存会话状态。</li><li>request请求域（HttpServletRequest）、session会话域（HttpSession）、application域（ServletContext）</li><li><strong>request &lt; session &lt; application</strong></li></ul></li></ul><p><em><strong>session的实现原理：</strong></em></p><ul><li>JSESSIONID=xxxxxx 这个是以Cookie的形式保存在浏览器的内存中的。浏览器只要关闭。这个cookie就没有了。</li><li>session列表是一个Map，map的key是sessionid，map的value是session对象。</li><li>用户第一次请求，服务器生成session对象，同时生成id，将id发送给浏览器。</li><li>用户第二次请求，自动将浏览器内存中的id发送给服务器，服务器根据id查找session对象。</li><li>关闭浏览器，内存消失，cookie消失，sessionid消失，会话等同于结束</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250925215605.png"/></div></div><ul><li>Cookie禁用了，session还能找到吗？<ul><li>cookie禁用是什么意思？服务器正常发送cookie给浏览器，但是浏览器不要了。<strong>拒收了。并不是服务器不发了。</strong></li><li>找不到了。每一次请求都会获取到新的session对象。</li><li>cookie禁用了，session机制还能实现吗？<ul><li>可以。需要使用URL重写机制。</li><li><a href="http://localhost:8080/servlet12/test/session;jsessionid=19D1C99560DCBF84839FA43D58F56E16">http://localhost:8080/servlet12/test/session;jsessionid=19D1C99560DCBF84839FA43D58F56E16</a></li><li>URL重写机制会提高开发者的成本。开发人员在编写任何请求路径的时候，后面都要添加一个sessionid，给开发带来了很大的难度，很大的成本。所以大部分的网站都是这样设计的：你要是禁用cookie，你就别用了。</li></ul></li></ul></li></ul><div class="note danger no-icon flat"><ul><li>总结一下到目前位置我们所了解的域对象：<ul><li>request（对应的类名：HttpServletRequest）<ul><li>请求域（请求级别的）</li></ul></li><li>session（对应的类名：HttpSession）<ul><li>会话域（用户级别的）</li></ul></li><li>application（对应的类名：ServletContext）<ul><li>应用域（项目级别的，所有用户共享的。）</li></ul></li><li>这三个域对象的大小关系<ul><li>request &lt; session &lt; application</li></ul></li><li>他们三个域对象都有以下三个公共的方法：<ul><li>setAttribute（向域当中绑定数据）</li><li>getAttribute（从域当中获取数据）</li><li>removeAttribute（删除域当中的数据）</li></ul></li></ul></li><li><strong>使用原则：尽量使用小的域。</strong></li></ul></div><h3 id="cookie">cookie</h3><ul><li>session的实现原理中，<strong>每一个session对象都会关联一个sessionid</strong>，例如：<ul><li>JSESSIONID=41C481F0224664BDB28E95081D23D5B8</li><li>以上的这个键值对数据其实就是cookie对象。</li><li>对于session关联的cookie来说，这个cookie是被保存在浏览器的“运行内存”当中。</li><li>只要浏览器不关闭，用户再次发送请求的时候，会自动将运行内存中的cookie发送给服务器。</li><li>例如，这个Cookie: JSESSIONID=41C481F0224664BDB28E95081D23D5B8就会再次发送给服务器。</li><li>服务器就是根据41C481F0224664BDB28E95081D23D5B8这个值来找到对应的session对象的。</li></ul></li><li><strong>cookie怎么生成？cookie保存在什么地方？cookie有啥用？浏览器什么时候会发送cookie，发送哪些cookie给服务器？？？？？？？</strong><ul><li>cookie最终是保存在浏览器客户端上的。</li><li>可以保存在运行内存中。（浏览器只要关闭cookie就消失了。）</li><li>也可以保存在硬盘文件中。（永久保存。）</li></ul></li><li><strong>cookie有啥用呢？</strong><ul><li>cookie和session机制其实都是为了<code>保存会话</code>的状态。</li><li>cookie是将会话的状态保存在浏览器客户端上。（cookie数据存储在浏览器客户端上的。）</li><li>session是将会话的状态保存在服务器端上。（session对象是存储在服务器上。）</li><li>为什么要有cookie和session机制呢？因为<strong>HTTP协议是无状态,无连接协议。</strong></li></ul></li></ul><details class="folding-tag" blue><summary> cookie的经典案例 </summary>              <div class='content'>              <ul><li>京东商城，在未登录的情况下，向购物车中放几件商品。然后关闭商城，再次打开浏览器，访问京东商城的时候，购物车中的商品还在，这是怎么做的？<strong>没有登录，为什么购物车中还有商品呢？</strong><ul><li>将购物车中的商品编号放到cookie当中，cookie保存在硬盘文件当中。这样即使关闭浏览器。硬盘上的cookie还在。下一次再打开京东商城的时候，查看购物车的时候，会自动读取本地硬盘中存储的cookie，拿到商品编号，动态展示购物车中的商品。<ul><li>京东存储购物车中商品的cookie可能是这样的：productIds=xxxxx,yyyy,zzz,kkkk</li><li>注意：cookie如果清除掉，购物车中的商品就消失了。</li></ul></li></ul></li><li><strong>126邮箱中有一个功能：十天内免登录</strong><ul><li>这个功能也是需要cookie来实现的。</li><li>怎么实现的呢？<ul><li>用户输入正确的用户名和密码，并且同时选择十天内免登录。登录成功后。浏览器客户端会保存一个cookie，这个cookie中保存了用户名和密码等信息，这个cookie是保存在硬盘文件当中的，十天有效。在十天内用户再次访问126的时候，浏览器自动提交126的关联的cookie给服务器，服务器接收到cookie之后，获取用户名和密码，验证，通过之后，自动登录成功。</li></ul></li><li>怎么让cookie失效？<ul><li>十天过后自动失效。</li><li>或者改密码。</li><li>或者在客户端浏览器上清除cookie。</li></ul></li></ul></li></ul>              </div>            </details><ul><li>cookie机制和session机制其实都不属于java中的机制，实际上<strong>cookie机制和session机制都是HTTP协议的一部分</strong>。php开发中也有cookie和session机制，只要是你是做web开发，不管是什么编程语言，cookie和session机制都是需要的。</li><li>HTTP协议中规定：任何一个cookie都是由<code>name</code>和<code>value</code>组成的。<strong>name和value都是字符串类型的。</strong></li><li>在java的servlet中，对cookie提供了哪些支持呢？<ul><li>提供了一个Cookie类来专门表示cookie数据。jakarta.servlet.http.Cookie;</li><li>java程序怎么把cookie数据发送给浏览器呢？response.addCookie(cookie);</li></ul></li><li>在HTTP协议中是这样规定的：当浏览器发送请求的时候，会自动携带该path下的cookie数据给服务器。（URL）</li><li><strong>关于cookie的有效时间</strong><ul><li>怎么用java设置cookie的有效时间<ul><li>cookie.setMaxAge(60 * 60); 设置cookie在一小时之后失效。</li></ul></li><li>没有设置有效时间：默认保存在浏览器的运行内存中，浏览器关闭则cookie消失。</li><li>只要设置cookie的有效时间 &gt; 0，这个cookie一定会存储到硬盘文件当中。</li><li>设置cookie的有效时间 = 0 呢？<ul><li>cookie被删除，同名cookie被删除。</li></ul></li><li>设置cookie的有效时间 &lt; 0 呢？<ul><li>保存在运行内存中。和不设置一样。</li></ul></li></ul></li><li><strong>关于cookie的path，cookie关联的路径：</strong><ul><li>假设现在发送的请求路径是“<a href="http://localhost:8080/servlet13/cookie/generate%E2%80%9D%E7%94%9F%E6%88%90%E7%9A%84cookie%EF%BC%8C%E5%A6%82%E6%9E%9Ccookie%E6%B2%A1%E6%9C%89%E8%AE%BE%E7%BD%AEpath%EF%BC%8C%E9%BB%98%E8%AE%A4%E7%9A%84path%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F">http://localhost:8080/servlet13/cookie/generate”生成的cookie，如果cookie没有设置path，默认的path是什么？</a></li><li>默认的path是：<a href="http://localhost:8080/servlet13/cookie">http://localhost:8080/servlet13/cookie</a> 以及它的子路径。</li><li>也就是说，以后只要浏览器的请求路径是http://localhost:8080/servlet13/cookie 这个路径以及这个路径下的子路径，cookie都会被发送到服务器。</li></ul></li><li><strong>手动设置cookie的path</strong><ul><li>cookie.setPath(“/servlet13”); 表示只要是这个servlet13项目的请求路径，都会提交这个cookie给服务器。</li></ul></li></ul><p>浏览器发送cookie给服务器了，服务器中的java程序怎么接收？</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Cookie[] cookies = request.getCookies(); <span class="comment">// 这个方法可能返回null</span></span><br><span class="line"><span class="keyword">if</span>(cookies != <span class="literal">null</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(Cookie cookie : cookies)&#123;</span><br><span class="line">        <span class="comment">// 获取cookie的name</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> cookie.getName();</span><br><span class="line">        <span class="comment">// 获取cookie的value</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> cookie.getValue();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用cookie实现一下十天内免登录功能。</p><h2 id="过滤器和监听器">过滤器和监听器</h2><h3 id="过滤器">过滤器</h3><ul><li><p>当前的OA项目存在什么缺陷？</p><ul><li>DeptServlet、EmpServlet、OrderServlet。每一个Servlet都是处理自己相关的业务。在这些Servlet执行之前都是需要判断用户是否登录了。如果用户登录了，可以继续操作，如果没有登录，需要用户登录。这段判断用户是否登录的代码是固定的，并且在每一个Servlet类当中都需要编写，显然代码没有得到重复利用。包括每一个Servlet都要解决中文乱码问题，也有公共的代码。这些代码目前都是重复编写，并没有达到复用。怎么解决这个问题?</li></ul></li><li><p><strong>可以使用Servlet规范中的Filter过滤器来解决用户登录问题。</strong></p></li><li><p><strong>Filter是什么，有什么用，执行原理是什么？</strong></p><ul><li>Filter是过滤器。</li><li>Filter可以在Servlet这个目标程序执行之前添加代码。也可以在目标Servlet执行之后添加代码。之前之后都可以添加过滤规则。</li><li>一般情况下，都是在过滤器当中编写公共代码。</li></ul></li><li><p>一个过滤器怎么写呢？</p><ul><li>第一步：编写一个Java类实现一个接口：jarkata.servlet.Filter。并且实现这个接口当中所有的方法。<ul><li><code>init方法</code>：在Filter对象第一次被创建之后调用，并且只调用一次。</li><li><code>doFilter方法</code>：只要用户发送一次请求，则执行一次。发送N次请求，则执行N次。在这个方法中编写过滤规则。</li><li><code>destroy方法</code>：在Filter对象被释放/销毁之前调用，并且只调用一次。</li></ul></li><li>第二步：在web.xml文件中对Filter进行配置。这个配置和Servlet很像。</li></ul></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>filter2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.bjpowernode.javaweb.servlet.Filter2<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>filter2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.do<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>或者使用注解：@WebFilter({“*.do”})</li></ul><div class="note warning no-icon flat"><ul><li>注意：<ul><li>Servlet对象默认情况下，在服务器启动的时候是不会新建对象的。</li><li>Filter对象默认情况下，在服务器启动的时候会新建对象。</li><li>Servlet是单例的。Filter也是单例的。（单实例。</li></ul></li></ul></div><ul><li></li><li><p>目标Servlet是否执行，取决于两个条件：</p><ul><li>条件一：在过滤器当中是否编写了：<code>chain.doFilter(request, response)</code></li><li>条件二：用户发送的请求路径是否和Servlet的请求路径一致。</li></ul></li><li><p>chain.doFilter(request, response); 这行代码的作用：</p><ul><li>执行下一个过滤器，如果下面没有过滤器了，执行最终的Servlet。</li></ul></li></ul><div class="note warning no-icon flat"><p>**注意：Filter的优先级，天生的就比Servlet优先级高。**若/a.do 对应一个Filter，也对应一个Servlet。那么一定是先执行Filter，然后再执行Servlet。</p></div><ul><li><p>关于Filter的配置路径：</p><ul><li>/a.do、/b.do、/dept/save。这些配置方式都是精确匹配。</li><li>/* 匹配所有路径。</li><li>*.do 后缀匹配。不要以 / 开始</li><li>/dept/*  前缀匹配。</li></ul></li><li><p>在web.xml文件中进行配置的时候，Filter的执行顺序是什么？</p><ul><li>依靠filter-mapping标签的配置位置，越靠上优先级越高。</li></ul></li><li><p><strong>过滤器的调用顺序，遵循栈数据结构。</strong></p></li><li><p>使用@WebFilter的时候，Filter的执行顺序是怎样的呢？</p><ul><li>执行顺序是：比较Filter这个类名。</li><li>比如：FilterA和FilterB，则先执行FilterA。</li><li>比如：Filter1和Filter2，则先执行Filter1.</li></ul></li><li><p><strong>Filter的生命周期？</strong></p><ul><li>和Servlet对象生命周期一致。</li><li>唯一的区别：Filter默认情况下，在服务器启动阶段就实例化。Servlet不会。</li></ul></li><li><p>Filter过滤器这里有一个设计模式：</p><ul><li>责任链设计模式。</li><li>过滤器最大的优点：<ul><li>在程序编译阶段不会确定调用顺序。因为Filter的调用顺序是配置到web.xml文件中的，只要修改web.xml配置文件中filter-mapping的顺序就可以调整Filter的执行顺序。显然Filter的执行顺序是在程序运行阶段动态组合的。那么这种设计模式被称为责任链设计模式。</li></ul></li><li>责任链设计模式最大的核心思想：<ul><li>在程序运行阶段，动态的组合程序的调用顺序。</li></ul></li></ul></li></ul><ul><li><strong>过滤器的实现原理</strong></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250926182404.png"/></div></div><h3 id="Listener监听器">Listener监听器</h3><ul><li><p>什么是监听器？</p><ul><li>监听器是Servlet规范中的一员。就像Filter一样。Filter也是Servlet规范中的一员。</li><li>在Servlet中，所有的监听器接口都是以“Listener”结尾。</li></ul></li><li><p>监听器有什么用？</p><ul><li>监听器实际上是Servlet规范留给我们javaweb程序员的特殊时机。</li><li>特殊的时刻如果想执行这段代码，你需要想到使用对应的监听器。</li></ul></li><li><p><strong>Servlet规范中提供了哪些监听器？</strong></p><ul><li>jakarta.servlet包下：<ul><li>ServletContextListener</li><li>ServletContextAttributeListener</li><li>ServletRequestListener</li><li>ServletRequestAttributeListener</li></ul></li><li>jakarta.servlet.http包下：<ul><li>HttpSessionListener</li><li>HttpSessionAttributeListener<ul><li>该监听器需要使用@WebListener注解进行标注。</li><li>该监听器监听的是什么？是session域中数据的变化。只要数据变化，则执行相应的方法。主要监测点在session域对象上。</li></ul></li><li>HttpSessionBindingListener<ul><li>该监听器不需要使用<code>@WebListener</code>进行标注。</li><li>假设User类实现了该监听器，那么User对象在被放入session的时候触发bind事件，User对象从session中删除的时候，触发unbind事件。</li><li>假设Customer类没有实现该监听器，那么Customer对象放入session或者从session删除的时候，不会触发bind和unbind事件。</li></ul></li><li>HttpSessionIdListener<ul><li>session的id发生改变的时候，监听器中的唯一一个方法就会被调用。</li></ul></li></ul></li></ul></li><li><p>HttpSessionActivationListener</p><ul><li><strong>监听session对象的<code>钝化</code>和<code>活化</code>的。</strong></li><li>钝化：session对象从内存存储到硬盘文件。</li><li>活化：从硬盘文件把session恢复到内存。</li></ul></li><li><p>实现一个监听器的步骤：以ServletContextListener为例。</p><ul><li>第一步：编写一个类实现ServletContextListener接口。并且实现里面的方法。</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">contextInitialized</span><span class="params">(ServletContextEvent event)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">contextDestroyed</span><span class="params">(ServletContextEvent event)</span></span><br></pre></td></tr></table></figure><ul><li>第二步：在web.xml文件中对ServletContextListener进行配置，如下：</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.bjpowernode.javaweb.listener.MyServletContextListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>当然，第二步也可以不使用配置文件，也可以用注解，例如：@WebListener</li></ul><div class="note warning no-icon flat"><ul><li>注意：所有监听器中的方法都是不需要javaweb程序员调用的，由服务器来负责调用？什么时候被调用呢？<ul><li>当某个特殊的事件发生（特殊的事件发生其实就是某个时机到了。）之后，被web服务器自动调用。</li></ul></li></ul></div><p>思考一个业务场景：</p><ul><li><p>请编写一个功能，<strong>记录该网站实时的在线用户的个数</strong></p><ul><li>我们可以通过服务器端有没有分配session对象来判断在线人数，因为一个session代表了一个用户。有一个session就代表有一个用户。如果你采用这种逻辑去实现的话，session有多少个，在线用户就有多少个。这种方式的话：HttpSessionListener够用了。session对象只要新建，则count++，然后将count存储到ServletContext域当中，在页面展示在线人数即可。</li><li>业务发生改变了，只统计登录的用户的在线数量，这个该怎么办？<ul><li>session.setAttribute(“user”, userObj);</li><li>用户登录的标志是什么？session中曾经存储过User类型的对象。那么这个时候可以让User类型的对象实现HttpSessionBindingListener监听器，只要User类型对象存储到session域中，则count++，然后将count++存储到ServletContext对象中。页面展示在线人数即可。</li></ul></li></ul></li><li><p><strong>实现oa项目中当前登录在线的人数</strong></p><ul><li>什么代表着用户登录了？<ul><li>session.setAttribute(“user”, userObj); User类型的对象只要往session中存储过，表示有新用户登录。</li></ul></li><li>什么代表着用户退出了？<ul><li>session.removeAttribute(“user”); User类型的对象从session域中移除了。</li><li>或者有可能是session销毁了。（session超时）</li></ul></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Servlet生命周期&quot;&gt;Servlet生命周期&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;网站中所有的Servlet接口实现类的实例对象，只能&lt;strong&gt;由Http服务器负责创建&lt;/strong&gt;,开发人员不能手动创建Servlet接口实现类的实例对象&lt;/li&gt;
&lt;li&gt;</summary>
      
    
    
    
    <category term="JaveWeb" scheme="https://silvan2077.github.io/categories/JaveWeb/"/>
    
    
    <category term="java" scheme="https://silvan2077.github.io/tags/java/"/>
    
    <category term="javaweb" scheme="https://silvan2077.github.io/tags/javaweb/"/>
    
  </entry>
  
  <entry>
    <title>JavaWeb---互联网通信</title>
    <link href="https://silvan2077.github.io/2025/09/24/JaveWeb-%E4%BA%92%E8%81%94%E7%BD%91%E9%80%9A%E4%BF%A1/"/>
    <id>https://silvan2077.github.io/2025/09/24/JaveWeb-%E4%BA%92%E8%81%94%E7%BD%91%E9%80%9A%E4%BF%A1/</id>
    <published>2025-09-24T13:24:14.301Z</published>
    <updated>2025-09-25T06:48:31.509Z</updated>
    
    <content type="html"><![CDATA[<h1>关于系统架构</h1><div class="note waning no-icon flat"><p><strong>C/S即为用户下载下来的软件，B/S即为用户输入网址访问的网页</strong></p></div><h2 id="C-S结构">C/S结构</h2><p><em><strong>优点:</strong></em></p><ul><li><p><strong>速度快</strong>(大量的数据都是集成在客户端软件当中，所以服务器只需要传送很少的数据量**)**</p></li><li><p><strong>服务器压力小</strong>(大量的数据都是集成在客户端软件当中，所以服务器只需要传送很少的数据量**)**</p></li><li><p><strong>安全</strong>(大量的数据都是集成在客户端软件当中,数据在多个客户端上有缓存**)**</p></li></ul><p><em><strong>缺点:</strong></em></p><ul><li><strong>升级维护比较差劲(每一个客户端都需要单独升级)</strong></li></ul><h2 id="B-S架构">B/S架构</h2><p><em><strong>优点:</strong></em></p><ul><li><p><strong>升级维护方便，成本比较低。</strong>（只需要升级服务器端即可。）</p></li><li><p><strong>不需要安装特定的客户端软件,只需要打开浏览器，输入网址即可。</strong></p></li></ul><p><em><strong>缺点:</strong></em></p><ul><li><p><strong>速度慢</strong>(所有的数据都是在服务器上，用户发送的每一个请求都需要服务器来响应数据)</p></li><li><p><strong>不安全</strong>(更改服务器数据后所有用户访问的数据都会更改)</p></li></ul><h1>B/S结构的系统通信原理</h1><h2 id="域名">域名</h2><div class="note info no-icon flat"><p><a href="https://www.baidu.com/(%E7%BD%91%E7%AB%99)">https://www.baidu.com/(网站)</a><br><a href="http://www.baidu.com">www.baidu.com</a> 是一个域名</p></div><ul><li><p>在浏览器地址栏上输入域名，回车之后，域名解析器会将域名解析出来一个具体的<code>IP地址</code>和<code>端口号</code>等。解析结果也许是：<a href="http://110.242.68.3:80/index.html">http://110.242.68.3:80/index.html</a></p></li><li><p>IP地址:  一台主机的身份证号</p></li><li><p>端口号:  一个软件</p></li></ul><h2 id="Web系统的通信原理">Web系统的通信原理</h2><ul><li>用户在地址栏输入网址（URL）</li><li>域名解析器进行域名解析：110.242.68.3:80/index.html</li><li>浏览器软件在网络中搜索并找到110.242.68.3这一台主机</li><li>该台主机定位到80端口对应的服务器软件</li><li>80端口对应的服务器软件得知浏览器想要的资源名是：index.html</li><li>服务器软件找到index.html文件，并且将index.html文件中的内容直接输出响应到浏览器上。</li><li>浏览器接收并执行到来自服务器的代码（HTML CSS JS）</li></ul><h2 id="各部分起到的作用">各部分起到的作用</h2><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250924213704.png"/></div></div><ul><li>SUN公司负责制定Servlet规范(通过创建接口的方式)</li><li>各大webapp的开发团队实现SUN公司发布的接口，创建类去实现该接口</li><li>Tomcat负责根据用户不同的请求路径，来寻找对应的XXXservlet，根据反射机制来创建对应的对象</li></ul><div class="note warning no-icon flat"><p>这个配置文件的文件名不能乱来。固定的。<br>这个配置文件的存放路径不能乱来。固定的。</p></div><p><strong>Servlet规范中规定了：</strong></p><ul><li>一个合格的webapp应该是一个怎样的目录结构。</li><li>一个合格的webapp应该有一个怎样的配置文件。</li><li>一个合格的webapp配置文件路径放在哪里。</li><li>一个合格的webapp中java程序放在哪里。</li><li>这些都是Servlet规范中规定的。</li><li>Tomcat服务器要遵循Servlet规范。JavaWEB程序员也要遵循这个Servlet规范。这样Tomcat服务器和webapp才能解耦合。</li></ul><h2 id="使用IDEA开发一个Servlet的web">使用IDEA开发一个Servlet的web</h2><h3 id="第一步：基础搭建">第一步：基础搭建</h3><ul><li><strong>创建项目</strong></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/1754130539354-eae9a9f1-79c5-4fd1-899a-c5bf8be583cb.png"/></div></div><ul><li><strong>添加模块</strong><br>双击Shift----&gt;Add Framework Support…(添加框架支持)------&gt;选择Web Application</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250925131417.png"/></div></div><ul><li><strong>导入依赖</strong></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jakarta.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="第二步：编写Servlet">第二步：编写Servlet</h3><p>实现jakarta.servlet.Servlet接口中的5个方法。</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/1754131098196-53fef0cd-385f-4178-874f-51d9a4411983.png"/></div></div><h3 id="第三步-在web-xml文件中完成StudentServlet类的注册">第三步: 在web.xml文件中完成StudentServlet类的注册</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>studentServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.bjpowernode.javaweb.servlet.StudentServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>studentServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet/student<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="第四步-给一个html页面，在HTML页面中编写一个超链接">第四步:给一个html页面，在HTML页面中编写一个超链接</h3><ul><li>student.html</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--这里的项目名是 /xmm ，无法动态获取，先写死--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/xmm/servlet/student&quot;</span>&gt;</span>student list<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="第五步：让IDEA工具去关联Tomcat服务器。">第五步：让IDEA工具去关联Tomcat服务器。</h3><ol><li>Add Configuration</li><li>左上角加号，点击Tomcat Server --&gt; local</li></ol><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/1710849953450-a3e709f9-b321-4db7-a653-a5b5b634dbc2.png"/></div></div><ol start="3"><li>Deployment（点击这个用来部署webapp），继续点击加号，部署即可。修改 Application context为：/xmm</li></ol><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250925131858.png"/></div></div><h3 id="第六步-启动tom服务器，浏览器输入地址">第六步:启动tom服务器，浏览器输入地址</h3><p>打开浏览器，在浏览器地址栏上输入：<a href="http://localhost:8080/xmm/student.html">http://localhost:8080/xmm/student.html</a><br>注意:前端发送请求要加项目名</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/1710850613636-63c201e9-a100-415e-bc4f-7469abc87e68.png"/></div></div><h1>Http协议</h1><p><code>HTTP协议</code>：是W3C制定的一种超文本传输协议。(通信协议：发送消息的模板提前被制定好。)</p><ul><li>HTTP协议包括：<ul><li>请求协议<ul><li>浏览器  向  WEB服务器发送数据的时候，这个发送的数据需要遵循一套标准，这套标准中规定了发送的数据具体格式。</li></ul></li><li>响应协议<ul><li>WEB服务器  向  浏览器发送数据的时候，这个发送的数据需要遵循一套标准，这套标准中规定了发送的数据具体格式。</li></ul></li></ul></li></ul><h2 id="1-HTTP的请求协议（B-S）">1.HTTP的请求协议（B --&gt; S）</h2><ul><li><p>HTTP的请求协议包括：</p><ul><li>请求行</li><li>请求头</li><li>空白行</li><li>请求体</li></ul></li><li><p>HTTP请求协议的具体报文：<code>GET请求 </code></p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GET /servlet05/getServlet?username=lucy&amp;userpwd=<span class="number">1111</span> HTTP/<span class="number">1.1</span>                       请求行</span><br><span class="line">Host: localhost:<span class="number">8080</span>                                                                请求头</span><br><span class="line">Connection: keep-alive</span><br><span class="line">sec-ch-ua: <span class="string">&quot;Google Chrome&quot;</span>;v=<span class="string">&quot;95&quot;</span>, <span class="string">&quot;Chromium&quot;</span>;v=<span class="string">&quot;95&quot;</span>, <span class="string">&quot;;Not A Brand&quot;</span>;v=<span class="string">&quot;99&quot;</span></span><br><span class="line">sec-ch-ua-mobile: ?<span class="number">0</span></span><br><span class="line">sec-ch-ua-platform: <span class="string">&quot;Windows&quot;</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">95.0</span><span class="number">.4638</span><span class="number">.54</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Sec-Fetch-Site: same-origin</span></span><br><span class="line"><span class="comment">Sec-Fetch-Mode: navigate</span></span><br><span class="line"><span class="comment">Sec-Fetch-User: ?1</span></span><br><span class="line"><span class="comment">Sec-Fetch-Dest: document</span></span><br><span class="line"><span class="comment">Referer: http://localhost:8080/servlet05/index.html</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate, br</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="comment">                                                                                    空白行</span></span><br><span class="line"><span class="comment">                                                                                    请求体</span></span><br></pre></td></tr></table></figure><ul><li>HTTP请求协议的具体报文：POST请求</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">POST /servlet05/postServlet HTTP/<span class="number">1.1</span>                                              请求行</span><br><span class="line">Host: localhost:<span class="number">8080</span>                                                              请求头</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: <span class="number">25</span></span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">sec-ch-ua: <span class="string">&quot;Google Chrome&quot;</span>;v=<span class="string">&quot;95&quot;</span>, <span class="string">&quot;Chromium&quot;</span>;v=<span class="string">&quot;95&quot;</span>, <span class="string">&quot;;Not A Brand&quot;</span>;v=<span class="string">&quot;99&quot;</span></span><br><span class="line">sec-ch-ua-mobile: ?<span class="number">0</span></span><br><span class="line">sec-ch-ua-platform: <span class="string">&quot;Windows&quot;</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">Origin: http:<span class="comment">//localhost:8080</span></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">95.0</span><span class="number">.4638</span><span class="number">.54</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Sec-Fetch-Site: same-origin</span></span><br><span class="line"><span class="comment">Sec-Fetch-Mode: navigate</span></span><br><span class="line"><span class="comment">Sec-Fetch-User: ?1</span></span><br><span class="line"><span class="comment">Sec-Fetch-Dest: document</span></span><br><span class="line"><span class="comment">Referer: http://localhost:8080/servlet05/index.html</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate, br</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="comment">                                                                                  空白行</span></span><br><span class="line"><span class="comment">username=lisi&amp;userpwd=123                                                         请求体</span></span><br></pre></td></tr></table></figure><p><em><strong>请求行</strong></em></p><ul><li>包括三部分：<ul><li>第一部分：请求方式（7种）<ul><li>get（常用的）</li><li>post（常用的）</li><li>delete</li><li>put</li><li>head</li><li>options</li><li>trace</li></ul></li><li>第二部分：URI<ul><li>什么是URI？ 统一资源标识符。代表网络中某个资源的名字。但是通过URI是无法定位资源的。</li><li>什么是URL？统一资源定位符。代表网络中某个资源，同时，通过URL是可以定位到该资源的。</li><li>URI和URL什么关系，有什么区别？<ul><li>URL包括URI</li><li><a href="http://localhost:8080/servlet05/index.html">http://localhost:8080/servlet05/index.html</a> 这是URL。</li><li>/servlet05/index.html 这是URI。</li></ul></li></ul></li><li>第三部分：HTTP协议版本号</li></ul></li></ul><p><em><strong>请求头</strong></em></p><ul><li>请求的主机</li><li>主机的端口</li><li>浏览器信息</li><li>平台信息</li><li>cookie等信息</li><li>…</li></ul><p><em><strong>空白行</strong></em></p><ul><li>空白行是用来区分“请求头”和“请求体”</li></ul><p><em><strong>请求体</strong></em></p><ul><li>向服务器发送的具体数据。</li></ul><h2 id="2-HTTP的响应协议（S-B）">2. HTTP的响应协议（S --&gt; B）</h2><ul><li>HTTP的响应协议包括：4部分<ul><li>状态行</li><li>响应头</li><li>空白行</li><li>响应体</li></ul></li><li>HTTP响应协议的具体报文：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> ok                                     状态行</span><br><span class="line">Content-Type: text/html;charset=UTF-<span class="number">8</span>               响应头</span><br><span class="line">Content-Length: <span class="number">160</span></span><br><span class="line">Date: Mon, 08 Nov <span class="number">2021</span> <span class="number">13</span>:<span class="number">19</span>:<span class="number">32</span> GMT</span><br><span class="line">Keep-Alive: timeout=<span class="number">20</span></span><br><span class="line">Connection: keep-alive</span><br><span class="line">                                                    空白行</span><br><span class="line">&lt;!doctype html&gt;                                     响应体</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;title&gt;from get servlet&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;h1&gt;from get servlet&lt;/h1&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><em><strong>状态行</strong></em></p><ul><li>三部分组成<ul><li>第一部分：协议版本号（HTTP/1.1）</li><li>第二部分：状态码（HTTP协议中规定的响应状态号。不同的响应结果对应不同的号码。）<ul><li>**1xx: 信息响应：**这类响应结果不是很常见<ul><li>100 Continue: 服务器已接收请求头，客户端应继续发送请求主体。</li><li>101 Switching Protocols: 服务器同意切换协议。</li></ul></li><li>**2xx: 成功：**这类状态码基本都是请求成功。<ul><li>200 OK: 请求成功，服务器已返回请求的数据。</li><li>201 Created: 请求已成功，并且服务器创建了新的资源。</li><li>202 Accepted: 服务器已接受请求，但尚未处理。</li><li>204 No Content: 请求成功但无返回内容。</li></ul></li><li>**3xx: 重定向：**这类状态码一般是用于告诉浏览器请求的站点已经被移动到其他地址了，需要更换到新的地址。<ul><li>301 Moved Permanently: 请求的资源已被永久移动到新URL。</li><li>302 Found: 请求的资源临时被移动到新URL。</li><li>304 Not Modified: 资源未被修改，可以使用缓存的版本。</li></ul></li><li>**4xx: 客户端错误：**这类状态码在我们后续学习中会经常碰到，基本都是由于浏览器发送的请求少携带了什么数据或是请求有问题之类的。<ul><li>400 Bad Request: 服务器无法理解请求的格式。</li><li>401 Unauthorized: 请求需要用户认证。</li><li>403 Forbidden: 服务器拒绝请求。</li><li>404 Not Found: 服务器找不到请求的资源。</li><li>405 Method Not Allowed: 请求方法被禁用。</li><li>429 Too Many Requests: 客户端在给定的时间内发送了太多请求。</li></ul></li><li>**5xx: 服务器错误：**这类状态码也会在外面后续学习中经常碰到，基本都是由于服务端出现错误导致的。<ul><li>500 Internal Server Error: 服务器内部错误。</li><li>501 Not Implemented: 服务器不支持请求的功能。</li><li>502 Bad Gateway: 网关或代理服务器收到无效响应。</li><li>503 Service Unavailable: 服务器暂时无法处理请求（超负载或维护）。</li><li>504 Gateway Timeout: 网关或代理服务器未及时收到上游服务器的响应。<br><strong>响应头：</strong></li></ul></li></ul></li></ul></li><li>响应的内容类型</li><li>响应的内容长度</li><li>响应的时间</li><li>…</li></ul><p><strong>空白行：</strong></p><ul><li>用来分隔“响应头”和“响应体”的。</li></ul><p><strong>响应体：</strong></p><ul><li>响应体就是响应的正文，这些内容是一个长的字符串，这个字符串被浏览器渲染，解释并执行，最终展示出效果。</li><li>怎么向服务器发送GET请求，怎么向服务器发送POST请求？<ul><li>到目前为止，只有一种情况可以发送POST请求：使用form表单，并且form标签中的method属性值为：method=“post”。</li></ul></li></ul><h2 id="3-GET和POST有什么区别">3.GET和POST有什么区别?</h2><ul><li><p><strong>GET请求和POST请求有什么区别？</strong></p><ul><li>（get请求在“请求行”上发送数据） get请求发送数据的时候，数据会挂在URI的后面，并且在URI后面添加一个“?”，&quot;?&quot;后面是数据。这样会导致发送的数据显示浏览器的地址栏上:<a href="http://localhost:8080/servlet05/getServlet?username=zhangsan&amp;userpwd=1111">http://localhost:8080/servlet05/getServlet?username=zhangsan&amp;userpwd=1111</a></li><li>（post请求在“请求体”当中发送数据）post请求发送数据时在请求体中发送，不会回显到浏览器的地址栏上</li></ul></li><li><p><strong>发送内容上的区别</strong></p><ul><li>get请求只能发送普通的字符串。并且发送的字符串长度有限制，不同的浏览器限制不同。</li><li>get请求无法发送大数据量。</li><li>post请求可以发送任何类型的数据，包括普通字符串，流媒体等信息：视频、声音、图片。</li><li>post请求可以发送大数据量，理论上没有长度限制。</li></ul></li><li><p><strong>适用情况的区别</strong></p><ul><li>get请求在W3C中是这样说的：get请求比较适合从服务器端获取数据。</li><li>post请求在W3C中是这样说的：post请求比较适合向服务器端传送数据。</li></ul></li><li><p><strong>数据安全性（正确使用的前提下）</strong></p><ul><li>get请求是安全的。get请求是绝对安全的。为什么？因为get请求只是为了从服务器上获取数据。不会对服务器造成威胁。</li><li>post请求是危险的。为什么？因为post请求是向服务器提交数据，如果这些数据通过后门的方式进入到服务器当中，服务器是很危险的。另外post是为了提交数据，所以一般情况下拦截请求的时候，大部分会选择拦截（监听）post请求。</li></ul></li><li><p><strong>是否支持缓存</strong></p><ul><li>get请求支持缓存。<ul><li>实际上，你只要发送get请求，浏览器做的第一件事都是先从本地浏览器缓存中找，找不到的时候才会去服务器上获取。这种缓存机制目的是为了提高用户的体验。</li></ul></li><li>post请求不支持缓存。(POST是用来修改服务器端的资源的.)</li></ul></li><li><p><strong>Get请求和POST请求如何选择？</strong></p><ul><li>如果想从服务器获取资源，建议使用GET请求，如果这个请求是为了向服务器提交数据，建议使用POST请求</li><li>大部分的form表单提交都是post方式，因为form表单中要填写大量的数据，这些数据时手机用户信息，一般需要传给服务器，服务器将数据保存/修改</li><li>如果表单有敏感信息，建议使用post请求，因为get请求会回显信息到地址栏上（如：密码信息）</li><li>做文件上传时一定是post请求，因为传输的数据不是普通文本</li><li>其他情况都可以使用GET请求</li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;关于系统架构&lt;/h1&gt;
&lt;div class=&quot;note waning no-icon flat&quot;&gt;&lt;p&gt;&lt;strong&gt;C/S即为用户下载下来的软件，B/S即为用户输入网址访问的网页&lt;/strong&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&quot;C-S结构&quot;&gt;C/S结构&lt;/h</summary>
      
    
    
    
    <category term="JavaWeb" scheme="https://silvan2077.github.io/categories/JavaWeb/"/>
    
    
    <category term="java" scheme="https://silvan2077.github.io/tags/java/"/>
    
    <category term="javaweb" scheme="https://silvan2077.github.io/tags/javaweb/"/>
    
  </entry>
  
  <entry>
    <title>Spring(1)</title>
    <link href="https://silvan2077.github.io/2025/09/21/Spring-Spring-1/"/>
    <id>https://silvan2077.github.io/2025/09/21/Spring-Spring-1/</id>
    <published>2025-09-21T06:24:21.000Z</published>
    <updated>2025-10-03T06:57:33.090Z</updated>
    
    <content type="html"><![CDATA[<h1>Spring启示录</h1><h2 id="OCP开闭原则">OCP开闭原则</h2><ul><li><strong><code>开闭原则规定</code></strong>：软件开发中应做到 <strong><code>对拓展开放，对修改关闭</code></strong>。即程序可以对原有功能进行拓展，但是不能因为拓展功能而修改原本可以正常运行的程序。因为因为一旦修改，会导致整个项目要进行全方位的重新测试。而导致这个问题的主要原因是：<strong>代码之间耦合度过高</strong></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250921142953.png"/></div></div><ul><li>在这个程序里上层依赖下层。<code>UserController</code>依赖<code>UserServiceImpl</code>，而<code>UserServiceImpl</code>依赖<code>UserDaoImplForMySQL</code>，这样就会导致<strong>下面只要改动，上面必然会受牵连（跟着也会改）</strong>，所谓牵一发而动全身。这样也就同时违背了另一个开发原则：<strong><code>依赖倒置原则</code></strong>。</li></ul><h2 id="依赖倒置原则">依赖倒置原则</h2><ul><li>依赖倒置原则(Dependence Inversion Principle)，简称<code>DIP</code>。主要倡导<strong>面向抽象编程，面向接口编程。（不直接手动new对象，由系统为属性分配对象）</strong>,该原则包含两个关键点：<ul><li><strong>高层模块不应该依赖低层模块，两者都应该依赖抽象</strong>。此处抽象通常指<code>接口</code>或者<code>抽象类</code></li><li><strong>抽象不应该依赖细节，细节(具体实现)应该依赖抽象</strong></li></ul></li><li>实现该原则的核心问题：<ol><li><strong>谁来创建对象</strong></li><li><strong>谁来负责为新建的对象赋值</strong></li></ol></li></ul><div class="note info no-icon flat"><ul><li>Spring框架为我们解决了这两个问题。</li><li>通过将对象的创建权/管理权交出去，不再使用硬编码的格式去操纵对象。像这种把对象的创建权和管理权交出去，被称为<code>控制反转</code>。</li></ul></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250921143706.png"/></div></div><h2 id="Ioc控制反转">Ioc控制反转</h2><ul><li><code>控制反转（Inversion of Control,缩写为IOC）</code>是一种更宽泛的<code>设计模式或架构原则</code>，能够用来降低代码代码之间的耦合度，符合依赖倒置原则。</li><li>控制反转的核心是：<strong>将对象的创建权交出去，将对象和对象之间关系的管理权交出去，有第三方容器来负责创建与维护</strong></li><li></li></ul><p><strong>目的：</strong></p><ul><li><strong>解耦组件：</strong> 组件不需要自己定位或创建依赖，只需要声明需要什么（如通过构造函数参数、setter 方法、字段标注）。容器负责满足这些依赖。</li><li><strong>集中管理配置和生命周期：</strong> 对象的创建、依赖关系、作用域（单例、原型等）可以在一个地方（如 XML、注解、Java Config）集中配置和管理。</li><li><strong>提高可测试性：</strong> 依赖可以更容易地被 Mock 或 Stub 替换进行单元测试。</li><li><strong>促进模块化和可重用性：</strong> 组件更专注于自身业务逻辑，不涉及复杂的依赖管理代码。</li><li><strong>为 AOP 等高级特性提供基础：</strong> IoC 容器是实现面向切面编程（AOP）的常见基础。</li></ul><ul><li>控制反转常见的实现方式：<code>依赖注入</code></li><li>通常依赖注入的方式有两种：<ul><li><strong>Set注入</strong></li><li><strong>构造注入</strong></li></ul></li></ul><h1>Spring概述</h1><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250921151210.png"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250921151701.png"/></div></div><details class="folding-tag" ><summary> Spirng Context模块 </summary>              <div class='content'>              <p>如果说核心模块中的BeanFactory使Spirng成为容器，那么上下文模块就是Spring成为框架的原因</p><p>此模块拓展类BeanFactory，增加了对国际化（I18N）消息、事件传播、验证的支持。另外提供了许多企业服务，例如电子邮件、JNDI访问、EJB集成、远程以及时序调度（scheduling）服务。也包括了对模版框架例如Velocity和FreeMarker集成的支持</p>              </div>            </details><details class="folding-tag" ><summary> Spring AOP模块 </summary>              <div class='content'>              <p>Spring在它的AOP模块中提供了对面向切面编程的丰富支持，Spring AOP 模块为基于 Spring 的应用程序中的对象提供了事务管理服务。通过使用 Spring AOP，不用依赖组件，就可以将声明性事务管理集成到应用程序中，可以自定义拦截器、切点、日志等操作。</p>              </div>            </details><details class="folding-tag" ><summary> Spring DAO模块 </summary>              <div class='content'>              <p>提供了一个JDBC的抽象层和异常层次结构，消除了烦琐的JDBC编码和数据库厂商特有的错误代码解析，用于简化JDBC。</p>              </div>            </details><details class="folding-tag" ><summary> Spring ORM模块 </summary>              <div class='content'>              <p>Spring提供了ORM模块。Spring并不试图实现它自己的ORM解决方案，而是为几种流行的ORM框架提供了集成方案，包括Hibernate、JDO和iBATIS SQL映射，这些都遵从 Spring 的通用事务和 DAO 异常层次结构。</p>              </div>            </details><details class="folding-tag" ><summary> Spring web MVC模块 </summary>              <div class='content'>              <p>Spring为构建Web应用提供了一个功能全面的MVC框架。虽然Spring可以很容易地与其它MVC框架集成，例如Struts，但Spring的MVC框架使用IoC对控制逻辑和业务对象提供了完全的分离。</p>              </div>            </details><details class="folding-tag" ><summary> Spring webFlux模块 </summary>              <div class='content'>              <p>Spring Framework 中包含的原始 Web 框架 Spring Web MVC 是专门为 Servlet API 和 Servlet 容器构建的。反应式堆栈 Web 框架 Spring WebFlux 是在 5.0 版的后期添加的。它是完全非阻塞的，支持反应式流(Reactive Stream)背压，并在Netty，Undertow和Servlet 3.1+容器等服务器上运行。</p>              </div>            </details><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250921153238.png"/></div></div><details class="folding-tag" ><summary> Spring web模块 </summary>              <div class='content'>              <p>Web 上下文模块建立在应用程序上下文模块之上，为基于 Web 的应用程序提供了上下文，提供了Spring和其它Web框架的集成，比如Struts、WebWork。还提供了一些面向服务支持，例如：实现文件上传的multipart请求。</p>              </div>            </details><h2 id="Spring的特点">Spring的特点</h2><ul><li><strong>轻量级</strong><ul><li>从大小与开销两方面而言Spring都是轻量的。完整的Spring框架可以在一个大小只有1MB多的JAR文件里发布。并且Spring所需的处理开销也是微不足道的。</li><li>Spring是<code>非侵入式</code>的：Spring应用中的对象不依赖于Spring的特定类。</li></ul></li><li><strong>控制反转</strong><ul><li>Spring通过一种称作控制反转（IoC）的技术促进了松耦合。当应用了IoC，一个对象依赖的其它对象会通过被动的方式传递进来，而不是这个对象自己创建或者查找依赖对象。你可以认为IoC与JNDI相反——不是对象从容器中查找依赖，而是容器在对象初始化时不等对象请求就主动将依赖传递给它。</li></ul></li><li><strong>面向切面</strong><ul><li>Spring提供了面向切面编程的丰富支持，允许通过分离应用的业务逻辑与系统级服务（例如审计（auditing）和事务（transaction）管理）进行内聚性的开发。应用对象只实现它们应该做的——完成业务逻辑——仅此而已。它们并不负责（甚至是意识）其它的系统级关注点，例如日志或事务支持。</li></ul></li><li><strong>容器</strong><ul><li>Spring包含并管理应用对象的配置和生命周期，在这个意义上它是一种容器，你可以配置你的每个bean如何被创建——基于一个可配置原型（prototype），你的bean可以创建一个单独的实例或者每次需要时都生成一个新的实例——以及它们是如何相互关联的。然而，Spring不应该被混同于传统的重量级的EJB容器，它们经常是庞大与笨重的，难以使用。</li></ul></li><li><strong>框架</strong><ul><li>Spring可以将简单的组件配置、组合成为复杂的应用。在Spring中，应用对象被声明式地组合，典型地是在一个XML文件里。Spring也提供了很多基础功能（事务管理、持久化框架集成等等），将应用逻辑的开发留给了你。</li></ul></li></ul><div class="note warning no-icon flat"><p>Spring的这些特征能使编写更干净、更可管理、并且更易于测试的代码。它们也为Spring中的各种模块提供了基础支持。</p></div><h1>Spring 入门程序</h1><h2 id="引入依赖">引入依赖</h2><ul><li>Spring有各种Jar包，来满足不同需求，仅仅使用Spring的IOC功能，只需要引入spring-context这个Jar包即可</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.14<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>当引入Spring-Context包之后，还会关联引入一些其他的依赖：</p><div class="tabs" id="设置依赖"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#设置依赖-1">关联引入</button></li><li class="tab"><button type="button" data-href="#设置依赖-2">Maven</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="设置依赖-1"><p><strong>spring aop：</strong> 面向切面编程<br><strong>spring beans：</strong> IoC核心<br><strong>spring core：</strong> spring的核心工具包<br><strong>spring jcl：</strong> spring的日志包<br><strong>spring expression：</strong> spring表达式</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="设置依赖-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250921154021.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="定义bean：User">定义bean：User</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="编写Spring的配置文件">编写Spring的配置文件</h2><ul><li>创建一个Spring的配置文件，命名为beans.xml，来统一管理Bean，该文件放在类的根路径下</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--这就是Spring的配置文件--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--IDEA工具为我们提供了这个文件的模板，一定要使用这个模板来创建。--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--这个文件名不一定叫微spring.xml，可以是其它名字。--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--这个文件最好是放在类路径当中，方便后期的移植。--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--放在resources根日灵下，就相当于是放到了类的根路径下。--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 配bean，这样spring才可以帮助我们管理这个对象。--&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  bean标签的两个重要属性:</span></span><br><span class="line"><span class="comment">  id:是这个bean的身份证号，不能重复，是唯一的标识。</span></span><br><span class="line"><span class="comment">  cLass: 必须填写类的全路径，全限定类名。 (带包名的类名)</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.bean.User&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="编写测试程序">编写测试程序</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Spring6Test</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFirst</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="comment">// 第一步:获取Spring 容器对象。</span></span><br><span class="line"><span class="comment">// ApplicationContext 翻译为:应用上下文。其实就是Spring容器</span></span><br><span class="line"><span class="comment">// ApplicationContext 是一个接口。</span></span><br><span class="line"><span class="comment">//ApplicationContext 接口下有很多实现类。其中有一个实现类叫做: CLassPathXmLApplicationContext</span></span><br><span class="line"><span class="comment">// CLassPathXmlApplicationContext 专门从类路径当中加我spring配置文件的一个Spring上下文对象。</span></span><br><span class="line"><span class="comment">// 这行代码只要执行:就相当于启动了Spring容器，解析spring.xml文件，并且实例化所有的ben对象，放到spring容器当中。</span></span><br><span class="line"><span class="comment">// 初始化Spring容器上下文（解析beans.xml文件，创建所有的bean对象）</span></span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line"><span class="comment">//第二部:根据id获取bean对象</span></span><br><span class="line"><span class="type">Object</span> <span class="variable">userBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userBean&quot;</span>);</span><br><span class="line">System.out.println(userBean);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>需要注意的问题：<ul><li>spring的配置文件中id不能重复</li><li>Spirng底层是通过反射机制调用无参数的构造方法，因此想让spring创建对象，必须保证无参数构造方法存在</li><li>配置文件的名称不固定，需要我们在创建类之前手动提供配置文件</li><li>beans.xml这样的配置文件可以有多个，初始化Spring之前指定好即可</li><li>Spring配置文件配置的bean既可以是JDK中的类，也可以是自定义的，只要这个类不是抽象的，且提供了无参构造方法即可</li><li>直接getBean（）方法返回的类型是Object类，如果想直接返回指定类，则需要添加类的Class类型作为第二个参数</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userBean&quot;</span>, User.class);</span><br></pre></td></tr></table></figure><h2 id="使用Bean工厂获得Bean">使用Bean工厂获得Bean</h2><p>BeanFactory是Application的超级父接口，也可以用来加载Bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring.xml&quot;</span>);</span><br><span class="line"><span class="type">Object</span> <span class="variable">vipBean</span> <span class="operator">=</span> beanFactory.getBean(<span class="string">&quot;vipBean&quot;</span>);</span><br><span class="line">System.out.println(vipBean);</span><br></pre></td></tr></table></figure><h2 id="启用Log4j2日志框架">启用Log4j2日志框架</h2><ul><li>首先引入Log4j2的依赖</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--log4j2的依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.19.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-slf4j2-impl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.19.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>然后在类的根路径提供一个log4j2.xml的配置文件（文件名固定，且必须放到类的根路径下）</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">loggers</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    level指定日志级别，从低到高的优先级：</span></span><br><span class="line"><span class="comment">    ALL &lt; TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL &lt; OFF</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;spring6log&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">loggers</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">appenders</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--输出日志信息到控制台--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">console</span> <span class="attr">name</span>=<span class="string">&quot;spring6log&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--控制日志输出的格式--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss SSS&#125; [%t] %-3level %logger&#123;1024&#125; - %msg%n&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">console</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">appenders</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>使用日志框架</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Spring6Test</span> &#123;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFirst</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line"><span class="type">Object</span> <span class="variable">userBean</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;userBean&quot;</span>);</span><br><span class="line">System.out.println(userBean);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 你自己怎么去使og4j2 记录日志信息呢?</span></span><br><span class="line"><span class="comment">// 第一步:创建日志记录器对象</span></span><br><span class="line"><span class="comment">// 获FirstSpringTest类的日志记录器对象，也就是说只要FirstSpringTest类中的代码执行记录日志的话，就输出相关的日志信息。</span></span><br><span class="line"><span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(Spring6Test.class);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二步:记录日志，根不同的级别来输出日志</span></span><br><span class="line">logger.info(<span class="string">&quot;我是一条日志消息&quot;</span>);</span><br><span class="line">logger.debug(<span class="string">&quot;我是一条调试消息&quot;</span>);</span><br><span class="line">logger.error(<span class="string">&quot;我是一条错误消息&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>Spring对IoC的实现</h1><h2 id="IoC控制反转">IoC控制反转</h2><ul><li><strong>Ioc控制反转是一种设计思想，而依赖注入是IoC思想的具体实现。</strong></li><li>IoC控制反转的作用：降低程序耦合度，提高程序扩展力，达到OCP原则的实现。</li><li>Ioc控制反转中，反转的是什么？<ul><li>反转的是对象间依赖关系的控制权。</li><li>将对象的创建权利和对象间关系的维护权交出去，交给第三方容器负责</li></ul></li></ul><h2 id="依赖注入">依赖注入</h2><ul><li>Spring通过依赖注入来完成Bean的管理</li><li>两种注入方式：<ul><li>Set注入</li><li>构造注入</li></ul></li><li>Bean管理： Bean对象的创建，以及Bean对象中属性的赋值（Bean对象间关系的维护）</li></ul><h3 id="Set注入">Set注入</h3><ul><li>Set注入是基于Set方法实现的，故需提供对应的Set方法，且Set方法应符合<code>标准命名规范</code>，底层会通过反射来调用Set方法给属性赋值</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.dao.UserDao&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.service.UserService&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoBean&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><strong>实现原理：</strong><ul><li>通过Property标签来获得属性名，ref属性来获得注入的属性类型(通过ref属性来完成bean的装配，这是bean最简单的一种装配方式。装配指的是：创建系统组件之间关联的动作)</li><li>通过属性名来推断出Set方法名（故Set方法应遵循标准命名规范）</li><li>利用反射机制调用相关Set方法来给属性赋值</li></ul></li></ul><h3 id="构造注入">构造注入</h3><ul><li><strong>核心原理：调用构造方法为属性赋值</strong></li></ul><div class="tabs" id="构造注入"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#构造注入-1">一个参数</button></li><li class="tab"><button type="button" data-href="#构造注入-2">多个参数</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="构造注入-1"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.dao.OrderDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.service.OrderService&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--index=&quot;0&quot;表示构造方法的第一个参数，将orderDaoBean对象传递给构造方法的第一个参数。--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;orderDaoBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line"><span class="keyword">private</span> OrderDao orderDao;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过反射机制调用构造方法给属性赋值</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">OrderService</span><span class="params">(OrderDao orderDao)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.orderDao = orderDao;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span>&#123;</span><br><span class="line">orderDao.deleteById();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="构造注入-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line"><span class="keyword">private</span> OrderDao orderDao;</span><br><span class="line"><span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过反射机制调用构造方法给属性赋值</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">OrderService</span><span class="params">(OrderDao orderDao, UserDao userDao)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.orderDao = orderDao;</span><br><span class="line"><span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span>&#123;</span><br><span class="line">orderDao.deleteById();</span><br><span class="line">userDao.insert();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.dao.OrderDao&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.service.OrderService&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--第一个参数下标是0--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;orderDaoBean&quot;</span>/&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--第二个参数下标是1--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.dao.UserDao&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>也可以不使用参数的下标，直接使用参数的名字实现构造注入，建议最好顺序不要乱，这样会更清晰</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.dao.OrderDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;orderServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.service.OrderService&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--没有指定下标，也没有指定参数名字--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;orderDaoBean&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoBean&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.dao.UserDao&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><ul><li>构造注入：<ul><li>可以通过下标来指定参数的位置</li><li>可以通过参数名字来指定参数的位置</li><li>也可以不指定下标和参数名，根据类型自动推断</li></ul></li></ul><h2 id="Set注入专题">Set注入专题</h2><h3 id="注入外部Bean">注入外部Bean</h3><ul><li>前面演示的Set注入就是注入外部Bean的方式</li><li>注入外部Bean的特点：Bean定义在外面，直接使用ref标签注入即可</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.dao.UserDao&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.service.UserService&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoBean&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注入内部Bean">注入内部Bean</h3><ul><li>注入内部Bean的特点：Bean定义在里面，需要在Bean标签中嵌套Bean标签,用的较少</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.service.UserService&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.dao.UserDao&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注入简单类型">注入简单类型</h3><ul><li>简单类型包括：<ul><li>基本数据类型</li><li>基本数据类型的包装型</li><li>String和Class</li><li>Number子类</li><li>Date可以通过PropertyEditor 或 Converter 将字符串转换为日期类型</li><li>Enum子类</li><li>URL等扩展类型均可以</li></ul></li><li>注入简单类型的特点：直接使用value标签注入即可</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:config.properties&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h3 id="级联属性赋值（了解）">级联属性赋值（了解）</h3><ul><li>级联属性赋值：在Spring的Set注入中，集合中存放的是对象类型，可以直接在集合定义时为内部对象的属性赋值，简单来说就是可以在Set中给对象的私有属性赋值，而不需要单独创建对象再Set</li><li>要点：<ul><li>必须注意配置顺序正确</li><li>在Spring的配置文件中，clazz属性必须提供Getter方法，因为在复制过程中，Spring需要通过Getter方法获取clazz，再为clazz的属性赋值</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Clazz</span> &#123;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Clazz</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Clazz</span><span class="params">(String name)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> Clazz clazz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, Clazz clazz)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.name = name;</span><br><span class="line"><span class="built_in">this</span>.clazz = clazz;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;clazzBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Clazz&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;张三&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--要点1：以下两行配置的顺序不能颠倒--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;clazz&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;clazzBean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--要点2：clazz属性必须有getter方法--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;clazz.name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;高三一班&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注入数组">注入数组</h3><ul><li>当数组中元素是简单类型时直接使用数组标签即可</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Person&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;favariteFoods&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>鸡排<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>汉堡<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>鹅肝<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>当数组中的元素是非简单类型时，需要使用array标签的ref元素来引用其他Bean</li></ul><div class="tabs" id="注入非简单类型"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#注入非简单类型-1">定义商品</button></li><li class="tab"><button type="button" data-href="#注入非简单类型-2">定义订单</button></li><li class="tab"><button type="button" data-href="#注入非简单类型-3">配置文件</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="注入非简单类型-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Goods</span> &#123;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Goods</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Goods</span><span class="params">(String name)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="注入非简单类型-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Order</span> &#123;</span><br><span class="line"><span class="comment">// 一个订单中有多个商品</span></span><br><span class="line"><span class="keyword">private</span> Goods[] goods;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Order</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">Order</span><span class="params">(Goods[] goods)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.goods = goods;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="注入非简单类型-3"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  //分别创建两个bean代表不同种类的水果</span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;goods1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Goods&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;西瓜&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;goods2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Goods&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;苹果&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;order&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Order&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;goods&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--这里使用ref标签即可--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;goods1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;goods2&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note warning no-icon flat"><p>要点：</p><ul><li>数组是简单类型，使用value标签</li><li>数组是飞简单类型，使用ref标签</li></ul></div><h3 id="注入List集合">注入List集合</h3><ul><li>与注入数组类似，使用List标签即可，如果是简单类型，使用value标签，如果是非简单类型，使用ref标签</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> &#123;</span><br><span class="line"><span class="comment">// 一个人有多个名字</span></span><br><span class="line"><span class="keyword">private</span> List&lt;String&gt; names;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;peopleBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.People&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;names&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>铁锤<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>狼<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注入Set集合">注入Set集合</h3><ul><li>与注入其他类型一致，使用<set>标签，简单类型使用value，非简单类型可以使用ref</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> &#123;</span><br><span class="line">    <span class="comment">// 一个人有多个电话</span></span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; phones;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;peopleBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.People&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;phones&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--非简单类型可以使用ref，简单类型使用value--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>110<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>110<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>120<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>120<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>119<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>119<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注入Map集合">注入Map集合</h3><p><strong>要点：</strong></p><ul><li><strong>使用<map>标签</strong></li><li><strong>如果key是简单类型，使用 key 属性，反之使用 key-ref 属性。</strong></li><li><strong>如果value是简单类型，使用 value 属性，反之使用 value-ref 属性。</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> &#123;</span><br><span class="line">    <span class="comment">// 一个人有多个住址</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;Integer, String&gt; addrs;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;peopleBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.People&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;addrs&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--如果key不是简单类型，使用 key-ref 属性--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--如果value不是简单类型，使用 value-ref 属性--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;北京大兴区&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;上海浦东区&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;3&quot;</span> <span class="attr">value</span>=<span class="string">&quot;深圳宝安区&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注入Properties">注入Properties</h3><ul><li>java.util.Properties继承java.util.Hashtable，所以Properties本质上也是一个Map集合,故注入方式类似</li></ul><p><strong>要点：</strong></p><ul><li><strong>使用<props>标签</strong></li><li><strong>如果key是简单类型，使用 key 属性，反之使用 key-ref 属性。</strong></li><li><strong>如果value是简单类型，使用 value 属性，反之使用 value-ref 属性。</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Properties properties;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="注入null和空字符串">注入null和空字符串</h3><ul><li>注入空字符串使用：<value/> 或者 value=“”</li><li>注入null使用：<null/> 或者 不为该属性赋值</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;vipBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Vip&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--空串的第一种方式--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;property name=&quot;email&quot; value=&quot;&quot;/&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--空串的第二种方式--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">  //注入Null的第一种</span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;vipBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Vip&quot;</span> /&gt;</span></span><br><span class="line">  //注入Null的第二种</span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;vipBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Vip&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">null</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注入的值含义特殊符号">注入的值含义特殊符号</h3><ul><li>XML中有5个特殊字符，分别是：&lt;、&gt;、'、&quot;、&amp;</li><li>以上5个特殊符号在XML中会被特殊对待，会被当做XML语法的一部分进行解析，如果这些特殊符号直接出现在注入的字符串当中就会报错。</li></ul><p>解决方案包括两种：</p><ul><li>第一种：特殊符号使用转义字符代替。</li><li>第二种：将含有特殊符号的字符串放到：<![CDATA[]]> 当中。因为放在CDATA区中的数据不会被XML文件解析器解析。</li></ul><p>5个特殊字符对应的转义字符分别是：</p><table><thead><tr><th style="text-align:center"><strong>特殊字符</strong></th><th style="text-align:center"><strong>转义字符</strong></th></tr></thead><tbody><tr><td style="text-align:center">&gt;</td><td style="text-align:center">&gt;</td></tr><tr><td style="text-align:center">&lt;</td><td style="text-align:center">&lt;</td></tr><tr><td style="text-align:center">’</td><td style="text-align:center">'</td></tr><tr><td style="text-align:center">&quot;</td><td style="text-align:center">&quot;</td></tr><tr><td style="text-align:center">&amp;</td><td style="text-align:center">&amp;</td></tr></tbody></table><div class="tabs" id="转义"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#转义-1">转义字符</button></li><li class="tab"><button type="button" data-href="#转义-2">![CDATA[]]</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="转义-1"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mathBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Math&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;result&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2 <span class="symbol">&amp;lt;</span> 3&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="转义-2"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mathBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Math&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;result&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--只能使用value标签--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>&lt;![CDATA[2 &lt; 3]]&gt;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="P命名空间注入">P命名空间注入</h2><ul><li>目的：简化Set注入。</li><li>前提条件：<ul><li>在XML文件中引入P命名空间：<code>xmlns:p=&quot;http://www.springframework.org/schema/p&quot;</code></li><li>P命名空间是基于Setter方法的，所以需要对应属性提供Setter方法</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.beans;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Customer</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;customerBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.Customer&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;zhangsan&quot;</span> <span class="attr">p:age</span>=<span class="string">&quot;20&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="C命名空间注入">C命名空间注入</h2><ul><li>目的：简化构造注入。</li><li>前提条件：<ul><li>在XML文件中引入C命名空间：<code>xmlns:c=&quot;http://www.springframework.org/schema/c&quot;</code></li><li>C命名空间是基于构造方法的，所以需要对应属性提供构造方法</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.powernode.spring6.beans;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTime</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> year;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> month;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> day;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyTime</span><span class="params">(<span class="type">int</span> year, <span class="type">int</span> month, <span class="type">int</span> day)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.year = year;</span><br><span class="line">        <span class="built_in">this</span>.month = month;</span><br><span class="line">        <span class="built_in">this</span>.day = day;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:c</span>=<span class="string">&quot;http://www.springframework.org/schema/c&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--&lt;bean id=&quot;myTimeBean&quot; class=&quot;com.powernode.spring6.beans.MyTime&quot; c:year=&quot;1970&quot; c:month=&quot;1&quot; c:day=&quot;1&quot;/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myTimeBean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.MyTime&quot;</span> <span class="attr">c:_0</span>=<span class="string">&quot;2008&quot;</span> <span class="attr">c:_1</span>=<span class="string">&quot;8&quot;</span> <span class="attr">c:_2</span>=<span class="string">&quot;8&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>不管是p命名空间还是c命名空间，注入的时候都可以注入简单类型以及非简单类型。</p></div><h2 id="Util命名空间">Util命名空间</h2><ul><li>目的：让配置复用</li><li>前提条件：在XML文件中引入Util命名空间：<code>xmlns:util=&quot;http://www.springframework.org/schema/util&quot;</code></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:util</span>=<span class="string">&quot;http://www.springframework.org/schema/util&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">  http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">util:properties</span> <span class="attr">id</span>=<span class="string">&quot;prop&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;driver&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;url&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/spring<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">util:properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.MyDataSource1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;prop&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.beans.MyDataSource2&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;prop&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="基于XML的自动装配">基于XML的自动装配</h2><ul><li>Spring的自动化注入又被称为<code>自动装配</code>，能根据<code>名字</code>进行自动装配，也可根据<code>类型</code>进行自动装配。</li><li>无论是通过名字还是类型进行自动装配，都是基于<code>Set方法</code>进行自动装配的，所以Set方法必须提供。(不考虑使用注解)</li></ul><h3 id="基于名字进行自动装配">基于名字进行自动装配</h3><ul><li>底层调用Set方法进行注入。主要是根据属性名称所对应的Set方法与Bean的ID之间的关联进行自动装配</li></ul><div class="tabs" id="user"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#user-1">UserDao</button></li><li class="tab"><button type="button" data-href="#user-2">UserService</button></li><li class="tab"><button type="button" data-href="#user-3">配置文件</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="user-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;正在保存用户数据。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="user-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserDao aaa;</span><br><span class="line">    <span class="comment">// 这个set方法非常关键</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAaa</span><span class="params">(UserDao aaa)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.aaa = aaa;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">()</span>&#123;</span><br><span class="line">        aaa.insert();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="user-3"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.service.UserService&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;aaa&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.powernode.spring6.dao.UserDao&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>配置文件中的autowire=&quot;byName&quot;起到关键作用，表示通过名称进行自动装配</li><li>UserService类中有一个UserDao属性，而UserDao属性的名字是aaa，对应的set方法是setAaa()，正好和UserDao Bean的id是一样的。这就是根据名称自动装配。</li></ul><h3 id="基于类型进行自动装配">基于类型进行自动装配</h3>]]></content>
    
    
    <summary type="html">基础介绍了Spring的简单使用方法</summary>
    
    
    
    <category term="Spring" scheme="https://silvan2077.github.io/categories/Spring/"/>
    
    <category term="Java" scheme="https://silvan2077.github.io/categories/Spring/Java/"/>
    
    
  </entry>
  
  <entry>
    <title>Ajax</title>
    <link href="https://silvan2077.github.io/2025/09/18/Ajax-java%E5%85%A5%E9%97%A8/"/>
    <id>https://silvan2077.github.io/2025/09/18/Ajax-java%E5%85%A5%E9%97%A8/</id>
    <published>2025-09-18T05:02:49.622Z</published>
    <updated>2025-09-27T08:52:53.623Z</updated>
    
    <content type="html"><![CDATA[<h1>Ajax的使用</h1><h2 id="传统请求及缺点">传统请求及缺点</h2><ul><li><p>传统的请求都有哪些？</p></li><li><p>点击超链接</p></li><li><p>提交form表单</p></li><li><p>使用JS代码发送请求</p></li><li><p>window.open(url)</p></li><li><p>document.location.href = url</p></li><li><p>window.location.href = url</p></li><li><p>…</p></li><li><p>传统请求存在的问题</p></li><li><p>页面全部刷新导致了用户的体验较差。</p></li><li><p>传统的请求导致用户的体验有空白期。（用户的体验是不连贯的）</p></li></ul><h2 id="AJAX概述">AJAX概述</h2><ul><li><p>AJAX不能称为一种技术，它是多种技术的综合产物。</p></li><li><p>AJAX可以让浏览器发送一种特殊的请求，这种请求可以是：异步的。</p></li><li><p>什么是异步，什么是同步？</p></li><li><p>假设有t1和t2线程，t1和t2线程并发，就是异步。</p></li><li><p>假设有t1和t2线程，t2在执行的时候，必须等待t1线程执行到某个位置之后t2才能执行，那么t2在等t1，显然他们是排队的，排队的就是同步。</p></li><li><p><strong>AJAX可以发送异步请求</strong>。也就是说，在同一个浏览器页面当中，可以发送多个ajax请求，这些ajax请求之间不需要等待，是并发的。</p></li><li><p>AJAX代码属于WEB前端的JS代码。和后端的java没有关系，后端也可以是php语言，也可以是C语言。</p></li><li><p>AJAX 应用程序可能使用 XML 来传输数据，但将数据作为纯文本或 JSON 文本传输也同样常见。</p></li><li><p><strong>AJAX可以更新网页的部分，而不需要重新加载整个页面。（页面局部刷新）</strong></p></li><li><p>AJAX可以做到在同一个网页中同时启动多个请求，类似于在同一个网页中启动“多线程”，一个“线程”一个“请求”。</p></li></ul><h2 id="XMLHttpRequest对象">XMLHttpRequest对象</h2><ul><li>XMLHttpRequest对象是AJAX的核心对象，发送请求以及接收服务器数据的返回，全靠它了。</li><li>XMLHttpRequest对象，现代浏览器都是支持的，都内置了该对象。直接用即可。</li><li>创建XMLHttpRequest对象</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var xhr = new XMLHttpRequest();</span><br></pre></td></tr></table></figure><ul><li><strong>XMLHttpRequest对象的方法</strong></li></ul><table><thead><tr><th><strong>方法</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td>abort()</td><td>取消当前请求</td></tr><tr><td>getAllResponseHeaders()</td><td>返回头部信息</td></tr><tr><td>getResponseHeader()</td><td>返回特定的头部信息</td></tr><tr><td>open(<em>method</em>, <em>url</em>, <em>async</em>, <em>user</em>, <em>psw</em>)</td><td>规定请求method：请求类型 GET 或 POSTurl：文件位置async：true（异步）或 false（同步）user：可选的用户名称psw：可选的密码</td></tr><tr><td>send()</td><td>将请求发送到服务器，用于 GET 请求</td></tr><tr><td>send(<em>string</em>)</td><td>将请求发送到服务器，用于 POST 请求</td></tr><tr><td>setRequestHeader()</td><td>向要发送的报头添加标签/值对</td></tr></tbody></table><ul><li><strong>XMLHttpRequest对象的属性</strong></li></ul><table><thead><tr><th><strong>属性</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td>onreadystatechange</td><td>定义当 readyState 属性发生变化时被调用的函数</td></tr><tr><td>readyState</td><td>保存 XMLHttpRequest 的状态。0：请求未初始化 1：服务器连接已建立 2：请求已收到 3：正在处理请求 4：请求已完成且响应已就绪</td></tr><tr><td>responseText</td><td>以字符串返回响应数据</td></tr><tr><td>responseXML</td><td>以 XML 数据返回响应数据</td></tr><tr><td>status</td><td>返回请求的状态号200: &quot;OK&quot;403: &quot;Forbidden&quot;404: “Not Found”</td></tr><tr><td>statusText</td><td>返回状态文本（比如 “OK” 或 “Not Found”）</td></tr></tbody></table><h2 id="AJAX-GET请求">AJAX GET请求</h2><p>发送AJAX get请求，前端代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>发送ajax get请求<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;btn&quot;</span>).<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">//1. 创建AJAX核心对象</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">//2. 注册回调函数</span></span></span><br><span class="line"><span class="language-javascript">          xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">readyState</span> == <span class="number">4</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">status</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 通过XMLHttpRequest对象的responseText属性可以获取到服务器响应回来的内容。</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 并且不管服务器响应回来的是什么，都以普通文本的形势获取。（服务器可能响应回来：普通文本、XML、JSON、HTML...）</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// innerHTML属性是javascript中的语法，和ajax的XMLHttpRequest对象无关。</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// innerHTML可以设置元素内部的HTML代码。（innerHTML可以将后面的内容当做一段HTML代码解释并执行）</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//document.getElementById(&quot;myspan&quot;).innerHTML = this.responseText</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;mydiv&quot;</span>).<span class="property">innerHTML</span> = <span class="variable language_">this</span>.<span class="property">responseText</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// innerText也不是AJAX中的，是javascript中的元素属性，和XMLHttpRequest无关。</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// innerText也是设置元素中的内容，但是即使后面是一段HTML代码，也是将其看做一个普通字符串设置进去。</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//document.getElementById(&quot;myspan&quot;).innerText = this.responseText</span></span></span><br><span class="line"><span class="language-javascript">              &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">status</span>)</span></span><br><span class="line"><span class="language-javascript">              &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">//3. 开启通道</span></span></span><br><span class="line"><span class="language-javascript">          xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;/ajax/ajaxrequest2&quot;</span>, <span class="literal">true</span>)</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">//4. 发送请求</span></span></span><br><span class="line"><span class="language-javascript">          xhr.<span class="title function_">send</span>()</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>发送ajax get请求<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;myspan&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;mydiv&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="AJAX-GET请求的缓存问题">AJAX GET请求的缓存问题</h2><ul><li><p>对于<strong>低版本</strong>的IE浏览器来说，AJAX的get请求可能会走缓存。存在缓存问题。对于现代的浏览器来说，<strong>大部分浏览器都已经不存在AJAX get缓存问题</strong>了。</p></li><li><p>什么是AJAX GET请求缓存问题呢？</p></li><li><p>在HTTP协议中是这样规定get请求的：get请求会被缓存起来。</p></li><li><p>发送AJAX GET请求时，在同一个浏览器上，前后发送的AJAX请求路径一样的话，对于低版本的IE来说，第二次的AJAX GET请求会走缓存，不走服务器。</p></li><li><p>POST请求在HTTP协议中规定的是：POST请求不会被浏览器缓存。</p></li><li><p>GET请求缓存的优缺点：</p></li><li><p>优点：直接从浏览器缓存中获取资源，不需要从服务器上重新加载资源，速度较快，用户体验好。</p></li><li><p>缺点：无法实时获取最新的服务器资源。</p></li><li><p>浏览器什么时候会走缓存？</p></li><li><p>第一：是一个GET请求</p></li><li><p>第二：请求路径已经被浏览器缓存过了。第二次发送请求的时候，这个路径没有变化，会走浏览器缓存。</p></li><li><p>如果是低版本的IE浏览器，怎么解决AJAX GET请求的缓存问题呢？</p></li><li><p>可以在请求路径url后面添加一个时间戳，这个时间戳是随时变化的。所以每一次发送的请求路径都是不一样的，这样就不会走浏览器的缓存问题了。</p></li><li><p>可以采用时间戳：“url?t=” + new Date().getTime()</p></li><li><p>或者可以通过随机数：“url?t=” + Math.random()</p></li><li><p>也可以随机数+时间戳…</p></li></ul><h2 id="AJAX-POST请求">AJAX POST请求</h2><ul><li>AJAX POST请求和GET请求只是前端代码有区别。后端代码没有区别。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 4. 发送AJAX POST请求</span><br><span class="line">xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;) // 设置请求头的内容类型。模拟form表单提交数据。</span><br><span class="line">// 获取表单中的数据</span><br><span class="line">var username = document.getElementById(&quot;username&quot;).value;</span><br><span class="line">var password = document.getElementById(&quot;password&quot;).value;</span><br><span class="line">// send函数中的参数就是发送的数据，这个数据在“请求体”当中发送。</span><br><span class="line">xhr.send(&quot;username=&quot;+username+&quot;&amp;password=&quot;+password)</span><br></pre></td></tr></table></figure><ul><li><p>实现一个案例：使用AJAX POST请求实现用户注册的时候，用户名是否可用。（验证用户名是否可以注册）实现步骤如下：</p></li><li><p>在前端，用户输入用户名之后，失去焦点事件blur发生，然后发送AJAX POST请求，提交用户名</p></li><li><p>在后端，接收到用户名，连接数据库，根据用户名去表中搜索</p></li><li><p>如果用户名已存在</p></li><li><p>后端响应消息：对不起，用户名已存在（在前端页面以红色字体展示）</p></li><li><p>如果用户名不存在</p></li><li><p>后端响应消息：用户名可以使用（在前端页面以绿色字体展示）</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;AJAX POST请求验证用户名是否可用&lt;/title&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">      window.onload = function()&#123;</span><br><span class="line">        </span><br><span class="line">        document.getElementById(&quot;username&quot;).onfocus = function ()&#123;</span><br><span class="line">          document.getElementById(&quot;tipMsg&quot;).innerHTML = &quot;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        document.getElementById(&quot;username&quot;).onblur = function ()&#123;</span><br><span class="line">          //console.log(&quot;正在发送AJAX POST请求验证用户名&quot;)</span><br><span class="line">          // 发送AJAX POST请求</span><br><span class="line">          // 1.</span><br><span class="line">          var xhr = new XMLHttpRequest()</span><br><span class="line">          // 2.</span><br><span class="line">          xhr.onreadystatechange = function () &#123;</span><br><span class="line">            if (this.readyState == 4) &#123;</span><br><span class="line">              if (this.status == 200) &#123;</span><br><span class="line">                document.getElementById(&quot;tipMsg&quot;).innerHTML = this.responseText</span><br><span class="line">              &#125;else&#123;</span><br><span class="line">                alert(this.status)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          // 3.</span><br><span class="line">          xhr.open(&quot;POST&quot;, &quot;/ajax/ajaxrequest4&quot;, true)</span><br><span class="line">          // 4.</span><br><span class="line">          xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;)</span><br><span class="line">          // 获取表单数据</span><br><span class="line">          var username = document.getElementById(&quot;username&quot;).value</span><br><span class="line">          xhr.send(&quot;uname=&quot; + username)//这个uname随便写,前端的发送，后端使用这个接受</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    </span><br><span class="line">    用户名：&lt;input type=&quot;text&quot; id=&quot;username&quot;&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;span id=&quot;tipMsg&quot;&gt;&lt;/span&gt;</span><br><span class="line">    </span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">package com.bjpowernode.ajax.servlet;</span><br><span class="line"></span><br><span class="line">import jakarta.servlet.ServletException;</span><br><span class="line">import jakarta.servlet.annotation.WebServlet;</span><br><span class="line">import jakarta.servlet.http.HttpServlet;</span><br><span class="line">import jakarta.servlet.http.HttpServletRequest;</span><br><span class="line">import jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line">import java.sql.*;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @program: 代码</span><br><span class="line"> * @ClassName: AjaxRequest4Servlet</span><br><span class="line"> * @version: 1.0</span><br><span class="line"> * @description: 验证用户名是否可用</span><br><span class="line"> * @author: bjpowernode</span><br><span class="line"> * @create: 2022-05-14 10:19</span><br><span class="line"> **/</span><br><span class="line">@WebServlet(&quot;/ajaxrequest4&quot;)</span><br><span class="line">public class AjaxRequest4Servlet extends HttpServlet &#123;</span><br><span class="line">    @Override</span><br><span class="line">    protected void doPost(HttpServletRequest request, HttpServletResponse response)</span><br><span class="line">            throws ServletException, IOException &#123;</span><br><span class="line">        // 获取用户名</span><br><span class="line">        String uname = request.getParameter(&quot;uname&quot;);</span><br><span class="line">        // 打布尔标记（一种编程模型）</span><br><span class="line">        boolean flag = false; // 默认是用户名不存在。</span><br><span class="line">        // 连接数据库验证用户名是否存在</span><br><span class="line">        Connection conn = null;</span><br><span class="line">        PreparedStatement ps = null;</span><br><span class="line">        ResultSet rs = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            // 1.注册驱动</span><br><span class="line">            Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br><span class="line">            // 2.获取连接</span><br><span class="line">            conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/bjpowernode?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=UTC&quot;, &quot;root&quot;, &quot;root&quot;);</span><br><span class="line">            // 3.获取预编译的数据库操作对象</span><br><span class="line">            String sql = &quot;select id,name from t_user where name = ?&quot;;</span><br><span class="line">            ps = conn.prepareStatement(sql);</span><br><span class="line">            ps.setString(1, uname);</span><br><span class="line">            // 4.执行SQL语句</span><br><span class="line">            rs = ps.executeQuery();</span><br><span class="line">            // 5.处理结果集</span><br><span class="line">            if (rs.next()) &#123;</span><br><span class="line">                // 用户名已存在。</span><br><span class="line">                flag = true;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            // 6.释放资源</span><br><span class="line">            if (rs != null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    rs.close();</span><br><span class="line">                &#125; catch (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (ps != null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    ps.close();</span><br><span class="line">                &#125; catch (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (conn != null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    conn.close();</span><br><span class="line">                &#125; catch (SQLException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 响应结果到浏览器</span><br><span class="line">        response.setContentType(&quot;text/html;charset=UTF-8&quot;);</span><br><span class="line">        PrintWriter out = response.getWriter();</span><br><span class="line">        if (flag) &#123;</span><br><span class="line">            // 用户名已存在，不可用</span><br><span class="line">            out.print(&quot;&lt;font color=&#x27;red&#x27;&gt;对不起，用户名已存在&lt;/font&gt;&quot;);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            // 用户名不存在，可以使用</span><br><span class="line">            out.print(&quot;&lt;font color=&#x27;green&#x27;&gt;用户名可以使用&lt;/font&gt;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>实现一个案例：用户点击按钮之后，发送AJAX请求，显示学生列表。</p></li><li><p>在后端java程序中拼接HTML代码，然后将HTML代码直接响应到浏览器客户端。</p></li></ul><h2 id="基于JSON的数据交换">基于JSON的数据交换</h2><p>在WEB前端中如何将一个json格式的字符串转换成json对象</p><p>最简单粗暴的方法：在后端拼接JSON格式的字符串，响应给前端的浏览器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">json.append(&quot;[&quot;);</span><br><span class="line">while (rs.next()) &#123;</span><br><span class="line">    // 获取每个学生的信息</span><br><span class="line">    String name = rs.getString(&quot;name&quot;);</span><br><span class="line">    String age = rs.getString(&quot;age&quot;);</span><br><span class="line">    String addr = rs.getString(&quot;addr&quot;);</span><br><span class="line">    // 拼接json格式的字符串</span><br><span class="line">    // &#123;&quot;name&quot;:&quot;   王五    &quot;,&quot;age&quot;:    20      ,&quot;addr&quot;:&quot;      北京大兴区     &quot;&#125;,</span><br><span class="line">    json.append(&quot;&#123;\&quot;name\&quot;:\&quot;&quot;);</span><br><span class="line">    json.append(name);</span><br><span class="line">    json.append(&quot;\&quot;,\&quot;age\&quot;:&quot;);</span><br><span class="line">    json.append(age);</span><br><span class="line">    json.append(&quot;,\&quot;addr\&quot;:\&quot;&quot;);</span><br><span class="line">    json.append(addr);</span><br><span class="line">    json.append(&quot;\&quot;&#125;,&quot;);</span><br><span class="line">&#125;</span><br><span class="line">jsonStr = json.substring(0, json.length() - 1) + &quot;]&quot;;</span><br></pre></td></tr></table></figure><p>但在后端拼接JSON格式的字符串过于痛苦，可以使用阿里巴巴的fastjson组件，可以直接将java对象转换成json格式的字符串</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Student&gt; studentList = new ArrayList&lt;&gt;();</span><br><span class="line">while (rs.next()) &#123;</span><br><span class="line">    // 取出数据</span><br><span class="line">    String name = rs.getString(&quot;name&quot;);</span><br><span class="line">    int age = rs.getInt(&quot;age&quot;);</span><br><span class="line">    String addr = rs.getString(&quot;addr&quot;);</span><br><span class="line">    // 将以上数据封装成Student对象</span><br><span class="line">    Student s = new Student(name, age, addr);</span><br><span class="line">    // 将Student对象放到List集合</span><br><span class="line">    studentList.add(s);</span><br><span class="line">&#125;</span><br><span class="line">// 将List集合转换成json字符串</span><br><span class="line">jsonStr = JSON.toJSONString(studentList);</span><br></pre></td></tr></table></figure><p><strong>注意：使用fastjson需要引入fastjson-1.2.2.jar</strong></p><h2 id="基于XML的数据交换">基于XML的数据交换</h2><ul><li>注意：如果服务器端响应XML的话，响应的内容类型需要写成：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(<span class="string">&quot;text/xml;charset=UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li><p>xml和JSON都是常用的数据交换格式</p></li><li><p>XML体积大，解析麻烦。较少用。</p></li><li><p>JSON体积小，解析简单，较常用。</p></li><li><p>基于XML的数据交换，前端代码</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>使用XML完成数据交换<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;btn&quot;</span>).<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 1.创建XMLHTTPRequest对象</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 2.注册回调函数</span></span></span><br><span class="line"><span class="language-javascript">            xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">readyState</span> == <span class="number">4</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">status</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">// 服务器端响应了一个XML字符串，这里怎么接收呢？</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">// 使用XMLHTTPRequest对象的responseXML属性，接收返回之后，可以自动封装成document对象（文档对象）</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">var</span> xmlDoc = <span class="variable language_">this</span>.<span class="property">responseXML</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">//console.log(xmlDoc)</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">// 获取所有的&lt;student&gt;元素，返回了多个对象，应该是数组。</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">var</span> students = xmlDoc.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;student&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">//console.log(students[0].nodeName)</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">var</span> html = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; students.<span class="property">length</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="keyword">var</span> student = students[i]</span></span><br><span class="line"><span class="language-javascript">                            <span class="comment">// 获取&lt;student&gt;元素下的所有子元素</span></span></span><br><span class="line"><span class="language-javascript">                            html += <span class="string">&quot;&lt;tr&gt;&quot;</span></span></span><br><span class="line"><span class="language-javascript">                            html += <span class="string">&quot;&lt;td&gt;&quot;</span>+(i+<span class="number">1</span>)+<span class="string">&quot;&lt;/td&gt;&quot;</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="keyword">var</span> nameOrAge = student.<span class="property">childNodes</span></span></span><br><span class="line"><span class="language-javascript">                            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; nameOrAge.<span class="property">length</span>; j++) &#123;</span></span><br><span class="line"><span class="language-javascript">                                <span class="keyword">var</span> node = nameOrAge[j]</span></span><br><span class="line"><span class="language-javascript">                                <span class="keyword">if</span> (node.<span class="property">nodeName</span> == <span class="string">&quot;name&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                                    <span class="comment">//console.log(&quot;name = &quot; + node.textContent)</span></span></span><br><span class="line"><span class="language-javascript">                                    html += <span class="string">&quot;&lt;td&gt;&quot;</span>+node.<span class="property">textContent</span>+<span class="string">&quot;&lt;/td&gt;&quot;</span></span></span><br><span class="line"><span class="language-javascript">                                &#125;</span></span><br><span class="line"><span class="language-javascript">                                <span class="keyword">if</span> (node.<span class="property">nodeName</span> == <span class="string">&quot;age&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                                    <span class="comment">//console.log(&quot;age = &quot; + node.textContent)</span></span></span><br><span class="line"><span class="language-javascript">                                    html += <span class="string">&quot;&lt;td&gt;&quot;</span>+node.<span class="property">textContent</span>+<span class="string">&quot;&lt;/td&gt;&quot;</span></span></span><br><span class="line"><span class="language-javascript">                                &#125;</span></span><br><span class="line"><span class="language-javascript">                            &#125;</span></span><br><span class="line"><span class="language-javascript">                            html += <span class="string">&quot;&lt;/tr&gt;&quot;</span></span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;stutbody&quot;</span>).<span class="property">innerHTML</span> = html</span></span><br><span class="line"><span class="language-javascript">                    &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">status</span>)</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 3.开启通道</span></span></span><br><span class="line"><span class="language-javascript">            xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;/ajax/ajaxrequest6?t=&quot;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>(), <span class="literal">true</span>)</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 4.发送请求</span></span></span><br><span class="line"><span class="language-javascript">            xhr.<span class="title function_">send</span>()</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>显示学生列表<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">width</span>=<span class="string">&quot;500px&quot;</span> <span class="attr">border</span>=<span class="string">&quot;1px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>序号<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span> <span class="attr">id</span>=<span class="string">&quot;stutbody&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;tr&gt;</span></span><br><span class="line"><span class="comment">        &lt;td&gt;1&lt;/td&gt;</span></span><br><span class="line"><span class="comment">        &lt;td&gt;zhangsan&lt;/td&gt;</span></span><br><span class="line"><span class="comment">        &lt;td&gt;20&lt;/td&gt;</span></span><br><span class="line"><span class="comment">    &lt;/tr&gt;</span></span><br><span class="line"><span class="comment">    &lt;tr&gt;</span></span><br><span class="line"><span class="comment">        &lt;td&gt;2&lt;/td&gt;</span></span><br><span class="line"><span class="comment">        &lt;td&gt;lisi&lt;/td&gt;</span></span><br><span class="line"><span class="comment">        &lt;td&gt;22&lt;/td&gt;</span></span><br><span class="line"><span class="comment">    &lt;/tr&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>基于XML的数据交换，后端java程序：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bjpowernode.ajax.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> jakarta.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: 代码</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: AjaxRequest6Servlet</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>: 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: 服务器端返回XML字符串</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: bjpowernode</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2022-05-15 11:48</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/ajaxrequest6&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AjaxRequest6Servlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">            <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 注意：响应的内容类型是XML。</span></span><br><span class="line">        response.setContentType(<span class="string">&quot;text/xml;charset=UTF-8&quot;</span>);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        &lt;students&gt;</span></span><br><span class="line"><span class="comment">            &lt;student&gt;</span></span><br><span class="line"><span class="comment">                &lt;name&gt;zhangsan&lt;/name&gt;</span></span><br><span class="line"><span class="comment">                &lt;age&gt;20&lt;/age&gt;</span></span><br><span class="line"><span class="comment">            &lt;/student&gt;</span></span><br><span class="line"><span class="comment">            &lt;student&gt;</span></span><br><span class="line"><span class="comment">                &lt;name&gt;lisi&lt;/name&gt;</span></span><br><span class="line"><span class="comment">                &lt;age&gt;22&lt;/age&gt;</span></span><br><span class="line"><span class="comment">            &lt;/student&gt;</span></span><br><span class="line"><span class="comment">        &lt;/students&gt;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">xml</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        xml.append(<span class="string">&quot;&lt;students&gt;&quot;</span>);</span><br><span class="line">        xml.append(<span class="string">&quot;&lt;student&gt;&quot;</span>);</span><br><span class="line">        xml.append(<span class="string">&quot;&lt;name&gt;zhangsan&lt;/name&gt;&quot;</span>);</span><br><span class="line">        xml.append(<span class="string">&quot;&lt;age&gt;20&lt;/age&gt;&quot;</span>);</span><br><span class="line">        xml.append(<span class="string">&quot;&lt;/student&gt;&quot;</span>);</span><br><span class="line">        xml.append(<span class="string">&quot;&lt;student&gt;&quot;</span>);</span><br><span class="line">        xml.append(<span class="string">&quot;&lt;name&gt;lisi&lt;/name&gt;&quot;</span>);</span><br><span class="line">        xml.append(<span class="string">&quot;&lt;age&gt;22&lt;/age&gt;&quot;</span>);</span><br><span class="line">        xml.append(<span class="string">&quot;&lt;/student&gt;&quot;</span>);</span><br><span class="line">        xml.append(<span class="string">&quot;&lt;/students&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        out.print(xml);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="AJAX乱码问题">AJAX乱码问题</h2><ul><li><p>测试内容：</p></li><li><p>发送ajax get请求</p></li><li><p>发送数据到服务器，服务器获取的数据是否乱码？</p></li><li><p>服务器响应给前端的中文，会不会乱码？</p></li><li><p>发送ajax post请求</p></li><li><p>发送数据到服务器，服务器获取的数据是否乱码？</p></li><li><p>服务器响应给前端的中文，会不会乱码？</p></li><li><p>对于tomcat10来说，关于字符集，我们程序员不需要干涉，不会出现乱码。</p></li><li><p>对于tomcat9来说呢？</p></li><li><p>响应中文的时候，会出现乱码，怎么解决？</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(&quot;text/html;charset=UTF-8&quot;);</span><br></pre></td></tr></table></figure><ul><li>发送ajax post请求的时候，发送给服务器的数据，服务器接收之后乱码，怎么解决？</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="AJAX的异步与同步">AJAX的异步与同步</h2><ul><li><p>什么是异步？什么是同步？</p></li><li><p>ajax请求1和ajax请求2，同时并发，谁也不用等谁，这就是异步。（a不等b，b也不等a）</p></li><li><p>如果ajax请求1在发送的时候需要等待ajax请求2结束之后才能发送，那么这就是同步。（a等待b，或者b等待a，只要发生等待，就是同步。）</p></li><li><p>异步和同步在代码上如何实现？</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 假设这个是ajax请求1</span></span><br><span class="line"><span class="comment">// 如果第三个参数是false：这个就表示“ajax请求1”不支持异步，也就是说ajax请求1发送之后，会影响其他ajax请求的发送，只有当我这个请求结束之后，你们其他的ajax请求才能发送。</span></span><br><span class="line"><span class="comment">// false表示，不支持异步。我这个请求发了之后，你们其他的请求都要靠边站。都等着。你们别动呢，等我结束了你们再说。</span></span><br><span class="line">xhr1.<span class="title function_">open</span>(<span class="string">&quot;请求方式&quot;</span>, <span class="string">&quot;URL&quot;</span>, <span class="literal">false</span>)</span><br><span class="line">xhr1.<span class="title function_">send</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 假设这个是ajax请求2</span></span><br><span class="line"><span class="comment">// 如果第三个参数是true：这个就表示“ajax请求2”支持异步请求，也就是说ajax请求2发送之后，不影响其他ajax请求的发送。</span></span><br><span class="line">xhr2.<span class="title function_">open</span>(<span class="string">&quot;请求方式&quot;</span>, <span class="string">&quot;URL&quot;</span>, <span class="literal">true</span>) </span><br><span class="line">xhr2.<span class="title function_">send</span>()</span><br></pre></td></tr></table></figure><ul><li><p>什么情况下用同步？（大部分情况下我们都是使用ajax异步方式，同步很少用。）</p></li><li><p>举一个例子</p></li><li><p>用户注册</p></li><li><p>用户名需要发送ajax请求进行校验</p></li><li><p>邮箱地址也需要发送ajax请求校验</p></li><li><p>其他的也可能需要发送ajax请求。。。</p></li><li><p>并且最终注册按钮的时候，也是发送ajax请求进行注册。</p></li><li><p>那么显然，注册的Ajax请求和校验的ajax请求不能异步，必须等待所有的校验ajax请求结束之后，注册的ajax请求才能发。</p></li></ul><h2 id=""></h2><ul><li></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Ajax的使用&lt;/h1&gt;
&lt;h2 id=&quot;传统请求及缺点&quot;&gt;传统请求及缺点&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;传统的请求都有哪些？&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;点击超链接&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;提交form表单&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;</summary>
      
    
    
    
    
    <category term="java" scheme="https://silvan2077.github.io/tags/java/"/>
    
    <category term="前端基础" scheme="https://silvan2077.github.io/tags/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>算法入门</title>
    <link href="https://silvan2077.github.io/2025/09/18/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%AE%97%E6%B3%95/"/>
    <id>https://silvan2077.github.io/2025/09/18/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E7%AE%97%E6%B3%95/</id>
    <published>2025-09-18T05:02:37.321Z</published>
    <updated>2025-09-27T08:54:10.728Z</updated>
    
    <content type="html"><![CDATA[<h1>从社会实验到算法</h1><div class="note no-icon flat"><p>一开始有100个人，每个人都有100元<br>在每一轮都做如下的事情 :<br>每个人都必须拿出1元钱给除自己以外的其他人，给谁完全随机<br>如果某个人在这一轮的钱数为0，那么他可以不给，但是可以接收<br>发生很多很多轮之后，这100人的社会财富分布很均匀吗？此时社会的<code>基尼系数</code>会是多少？</p></div><ul><li>首先从一个社会实验开始，该实验的规则看似非常公平，甚至对于0元者还有&quot;优待&quot;，所以乍一眼望去我们会感觉应当随着次数增多，金币的分布会越平均，于是我们编写一个Java程序来模拟这个实验，并计算出这个社会的基尼系数。</li></ul><div class="tabs" id="模拟实验"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#模拟实验-1">实验模拟</button></li><li class="tab"><button type="button" data-href="#模拟实验-2">实验进行100次</button></li><li class="tab"><button type="button" data-href="#模拟实验-3">实验进行100000次</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="模拟实验-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Experiment</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;一个社会的基尼系数是一个在0~1之间的小数&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;基尼系数为0代表所有人的财富完全一样&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;基尼系数为1代表有1个人掌握了全社会的财富&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;基尼系数越小，代表社会财富分布越均衡；越大则代表财富分布越不均衡&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;在2022年，世界各国的平均基尼系数为0.44&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;目前普遍认为，当基尼系数到达 0.5 时&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;就意味着社会贫富差距非常大，分布非常不均匀&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;社会可能会因此陷入危机，比如大量的犯罪或者经历社会动荡&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;测试开始&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;人数 : &quot;</span> + n);</span><br><span class="line">        System.out.println(<span class="string">&quot;轮数 : &quot;</span> + t);</span><br><span class="line">        experiment(n, t);</span><br><span class="line">        System.out.println(<span class="string">&quot;测试结束&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 完全按照说的来实验</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">experiment</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> t)</span> &#123;</span><br><span class="line">        <span class="type">double</span>[] wealth = <span class="keyword">new</span> <span class="title class_">double</span>[n];</span><br><span class="line">        Arrays.fill(wealth, <span class="number">100</span>);</span><br><span class="line">        <span class="type">boolean</span>[] hasMoney = <span class="keyword">new</span> <span class="title class_">boolean</span>[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; t; i++) &#123;</span><br><span class="line">            Arrays.fill(hasMoney, <span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (wealth[j] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    hasMoney[j] = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (hasMoney[j]) &#123;</span><br><span class="line">                    <span class="type">int</span> <span class="variable">other</span> <span class="operator">=</span> j;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        <span class="comment">// (int) (Math.random() * n);</span></span><br><span class="line">                        <span class="comment">// int : 0 ~ n-1，等概率随机</span></span><br><span class="line">                        other = (<span class="type">int</span>) (Math.random() * n);</span><br><span class="line">                    &#125; <span class="keyword">while</span> (other == j);</span><br><span class="line">                    wealth[j]--;</span><br><span class="line">                    wealth[other]++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(wealth);</span><br><span class="line">        System.out.println(<span class="string">&quot;列出每个人的财富(贫穷到富有) : &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            System.out.print((<span class="type">int</span>) wealth[i] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">10</span> == <span class="number">9</span>) &#123;</span><br><span class="line">                System.out.println();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">        System.out.println(<span class="string">&quot;这个社会的基尼系数为 : &quot;</span> + calculateGini(wealth));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算基尼系数</span></span><br><span class="line">    <span class="comment">// 看代码就可以轻易知道怎么算的</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">double</span> <span class="title function_">calculateGini</span><span class="params">(<span class="type">double</span>[] wealth)</span> &#123;</span><br><span class="line">        <span class="type">double</span> <span class="variable">sumOfAbsoluteDifferences</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">double</span> <span class="variable">sumOfWealth</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> wealth.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            sumOfWealth += wealth[i];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                sumOfAbsoluteDifferences += Math.abs(wealth[i] - wealth[j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sumOfAbsoluteDifferences / (<span class="number">2</span> * n * sumOfWealth);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="模拟实验-2"><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">一个社会的基尼系数是一个在0~1之间的小数</span><br><span class="line">基尼系数为0代表所有人的财富完全一样</span><br><span class="line">基尼系数为1代表有1个人掌握了全社会的财富</span><br><span class="line">基尼系数越小，代表社会财富分布越均衡；越大则代表财富分布越不均衡</span><br><span class="line">在2022年，世界各国的平均基尼系数为0.44</span><br><span class="line">目前普遍认为，当基尼系数到达 0.5 时</span><br><span class="line">就意味着社会贫富差距非常大，分布非常不均匀</span><br><span class="line">社会可能会因此陷入危机，比如大量的犯罪或者经历社会动荡</span><br><span class="line">测试开始</span><br><span class="line">人数 : 100</span><br><span class="line">轮数 : 100</span><br><span class="line">列出每个人的财富(贫穷到富有) : </span><br><span class="line">80 81 82 84 84 84 85 86 86 87 </span><br><span class="line">87 88 89 89 89 90 90 91 91 91 </span><br><span class="line">92 92 92 92 92 93 94 94 94 95 </span><br><span class="line">95 95 95 96 96 97 97 97 97 97 </span><br><span class="line">97 98 98 98 98 98 99 99 99 100 </span><br><span class="line">100 100 100 100 100 101 101 101 101 101 </span><br><span class="line">101 101 102 102 102 102 102 103 103 103 </span><br><span class="line">104 104 104 105 105 105 106 107 107 107 </span><br><span class="line">108 108 109 109 110 111 112 113 113 113 </span><br><span class="line">116 116 116 119 119 120 120 123 124 131 </span><br><span class="line"></span><br><span class="line">这个社会的基尼系数为 : 0.056606</span><br><span class="line">测试结束</span><br><span class="line"></span><br><span class="line">进程已结束，退出代码为 0</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="模拟实验-3"><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">一个社会的基尼系数是一个在0~1之间的小数</span><br><span class="line">基尼系数为0代表所有人的财富完全一样</span><br><span class="line">基尼系数为1代表有1个人掌握了全社会的财富</span><br><span class="line">基尼系数越小，代表社会财富分布越均衡；越大则代表财富分布越不均衡</span><br><span class="line">在2022年，世界各国的平均基尼系数为0.44</span><br><span class="line">目前普遍认为，当基尼系数到达 0.5 时</span><br><span class="line">就意味着社会贫富差距非常大，分布非常不均匀</span><br><span class="line">社会可能会因此陷入危机，比如大量的犯罪或者经历社会动荡</span><br><span class="line">测试开始</span><br><span class="line">人数 : 100</span><br><span class="line">轮数 : 1000000</span><br><span class="line">列出每个人的财富(贫穷到富有) : </span><br><span class="line">0 1 2 4 4 4 5 6 8 9 </span><br><span class="line">9 11 11 11 12 13 13 14 14 16 </span><br><span class="line">17 20 20 20 25 26 27 27 28 29 </span><br><span class="line">30 30 32 32 34 36 36 37 37 39 </span><br><span class="line">41 44 46 47 49 53 53 53 53 55 </span><br><span class="line">56 60 63 63 63 72 75 90 92 93 </span><br><span class="line">93 94 95 97 97 103 105 108 111 111 </span><br><span class="line">112 114 114 121 128 129 136 143 146 151 </span><br><span class="line">154 160 170 181 183 189 197 202 227 231 </span><br><span class="line">239 272 273 279 304 310 355 419 484 893 </span><br><span class="line"></span><br><span class="line">这个社会的基尼系数为 : 0.552244</span><br><span class="line">测试结束</span><br><span class="line"></span><br><span class="line">进程已结束，退出代码为 0</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>这是一个乍一看很公平的实验，但实际中，随着模拟的次数越来越多，这个实验的基尼系数会非常高</li></ul><details class="folding-tag" cyan><summary> 实验原因 </summary>              <div class='content'>              <ul><li><p>刚开始次数过少，财富差距无法拉开明显差距所以基尼系数很小，但随着次数越来越多，逐渐出现“少数人掌握大量财富，多数人财富微薄甚至为 0” 的格局</p></li><li><p><strong>关键机制 1：<code>单轮内 “固定支出 + 随机收入” 的不对称，必然产生微小差距</code></strong></p><ul><li><strong>支出端（刚性固定）</strong>：只要手里有钱（&gt;0 元），无论你有 100 元还是 1 元，都必须拿出1 元（支出金额与自身财富无关，是 “定额税” 式的强制流出）；</li><li><strong>收入端（完全随机）</strong>：所有人拿出的钱（总捐赠额 = 当前非 0 元人数 ×1 元）会随机分给 100 人（包括 0 元者），每人收到的金额可能是 0 元、1 元、2 元…… 最多等于总捐赠额。</li></ul></li><li><p><strong>关键机制 2：<code>多轮 “差距累积效应”，让微小差距滚雪球式放大</code></strong></p><ul><li>单轮的微小差距（如 99 元 vs 101 元），不会因后续轮次 “随机抵消”，反而会复利式累积</li><li>财富基数的 “非对称影响”：同样是 1 元的支出 / 收入，对富人（如 200 元）和穷人（如 10 元）的影响天差地别 ——<ul><li>富人支出 1 元，仅减少 0.5% 财富，几乎无影响；</li><li>穷人支出 1 元，减少 10% 财富，极易陷入 “财富缩水→变 0 元” 的循环。</li></ul></li></ul></li><li><p><strong>关键机制 3：<code>0 元者 “豁免机制”，进一步固化差距</code></strong></p><ul><li>若 0 元者收到 1 元（变成 1 元），下一轮必须支出 1 元；若再没收到收入，又会回到 0 元，陷入 “0 元→1 元→0 元” 的死循环，无法形成财富基数。</li><li>非 0 元者的 “优势循环”：财富多的人（如 200 元）几乎不可能变 0 元，能持续参与 “支出 1 元 + 接收收入”—— 即使短期收到 0 元，财富仅从 200→199，仍有足够基数应对后续波动，且有更多机会 “接住” 他人的随机捐赠，财富持续增长。</li></ul></li><li><p>基尼系数随轮次上升的本质：<strong>财富离散度持续扩大</strong></p></li><li><p>总结：“随机分配”≠“均匀分配”</p></li><li><p>**这个实验的核心启示是：<code>规则的微小不对称，会通过 “累积效应” 被无限放大。</code>**即使初始绝对均匀，只要存在 “固定支出 + 随机收入” 的不对称，以及 “0 元者难以积累” 的机制，随机波动就不会抵消差距，反而会让财富逐渐向少数人集中 —— 这也是现实中 “马太效应”（富者愈富，贫者愈贫）的简化模型。</p></li></ul>              </div>            </details><ul><li>这个实验的目的仅仅是引起对学习算法的兴趣，告诉我们不要以感觉为标准来判断算法，应当认真思考，仔细学习。</li></ul><h1>选择、冒泡、插入排序</h1><ul><li>这是算法中最基础的排序方法，也有人叫他们：<psw>三傻排序</psw></li></ul><h2 id="选择排序">选择排序</h2><ul><li><p>选择排序的原理：每次从待排序的元素中找出最小的元素，将其放到已排序的元素序列的末尾。</p></li><li><p>一句话总结：i~n-1的范围上，找到最小值并放在i位置，然后i+1~n-1的范围上，找到最小值并放在i+1位置，以此类推，直到n-1位置。</p></li><li><p>代码实现过程：</p><ul><li>先设置一个变量来不断存储最小值，初始值为第一个元素。</li><li>采用双层循环，外循环用来遍历数组，内循环在遍历过程中寻找每次的最小值。</li><li>在整个数组遍历中，不断比较每一个元素和最小值的大小，若找到更小的元素，则更新最小值，并记录下当前位置。</li><li>在执行完一次内循环以后，用交换最小值和i的位置，将最小值放到已排序的元素序列的末尾。</li></ul></li></ul><div class="tabs" id="选择排序"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#选择排序-1">核心代码</button></li><li class="tab"><button type="button" data-href="#选择排序-2">完整代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="选择排序-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">selectSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="comment">//此时元素数量过少无需排序，直接返回</span></span><br><span class="line">    <span class="keyword">if</span>(arr ==<span class="literal">null</span>|| arr.length&lt;<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//记录最小值的下标</span></span><br><span class="line">    <span class="type">int</span> minIndex;</span><br><span class="line">    <span class="comment">//记录最小值</span></span><br><span class="line">    <span class="type">int</span> minVal;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;arr.length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">        <span class="comment">// 每次开始循环更新最小值和下标，更新为当前进行的元素</span></span><br><span class="line">        minIndex = i;</span><br><span class="line">        minVal = arr[i];</span><br><span class="line">        <span class="comment">// 从i+1开始循环，找到最小值</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;arr.length;j++)&#123;</span><br><span class="line">            <span class="comment">//找到最小值则将最小值的位置更新为当前元素</span></span><br><span class="line">            <span class="keyword">if</span>(arr[j]&lt;minVal)&#123;</span><br><span class="line">                minIndex = j;</span><br><span class="line">                minVal=arr[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//如果位置有更新则说明有比当前元素还小的元素，更新位置</span></span><br><span class="line">        <span class="comment">//如果下标值不变则证明当前位置便是未排序的部分中最小的元素</span></span><br><span class="line">        <span class="keyword">if</span>(minIndex!=i)&#123;</span><br><span class="line">            swap(arr,i,minIndex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="选择排序-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SelectSort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> arr[i];</span><br><span class="line">        arr[i] = arr[j];</span><br><span class="line">        arr[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] randomArray(<span class="type">int</span> n)&#123;</span><br><span class="line">        <span class="type">int</span>[] array = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            array[i]=(<span class="type">int</span>)(Math.random()*<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">selectSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(arr ==<span class="literal">null</span>|| arr.length&lt;<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//记录最小值的下标</span></span><br><span class="line">        <span class="type">int</span> minIndex;</span><br><span class="line">        <span class="comment">//记录最小值</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">minVal</span> <span class="operator">=</span> arr[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;arr.length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">            minIndex = i;</span><br><span class="line">            minVal = arr[i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;arr.length;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(arr[j]&lt;minVal)&#123;</span><br><span class="line">                    minIndex = j;</span><br><span class="line">                    minVal=arr[j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(minIndex!=i)&#123;</span><br><span class="line">                swap(arr,i,minIndex);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arr = randomArray(<span class="number">10</span>);</span><br><span class="line">        selectSort(arr);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line">            System.out.print(arr[i]+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="冒泡排序">冒泡排序</h2><ul><li><p>冒泡排序是一种简单直观的排序算法。它的工作原理是重复地走访过要排序的数列，一次比较两个元素，如果它们的顺序错误就把它们交换过来。走访数列的工作是重复地进行直到没有再需要交换，也就是说该数列已经排序完成。</p></li><li><p>每次循环从数组前边逐个筛选较大的值放到尾部</p></li><li><p>代码实现过程：</p><ul><li>循环判断后，将大的值放到数组尾部后，便不再判断尾部的值</li><li>可以理解为从数组最大的值开始找起，找到最大值后排好，再找下一个最大值，直到数组排序完成</li></ul></li></ul><div class="tabs" id="冒泡排序"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#冒泡排序-1">核心代码</button></li><li class="tab"><button type="button" data-href="#冒泡排序-2">完整代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="冒泡排序-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">bubbleSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(arr ==<span class="literal">null</span>|| arr.length&lt;<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//        0~n-1</span></span><br><span class="line"><span class="comment">//        0~n-2</span></span><br><span class="line"><span class="comment">//        0~n-3</span></span><br><span class="line">    <span class="comment">//每结束一次循环代表找到一个最大值，排好一位数，以此往复</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> end=arr.length-<span class="number">1</span>;end&gt;<span class="number">0</span>;end--)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> start=<span class="number">0</span>;start&lt;end;start++)&#123;</span><br><span class="line">            <span class="comment">//在数组中不断判断找到最大值</span></span><br><span class="line">            <span class="keyword">if</span>(arr[start]&gt;arr[start+<span class="number">1</span>])&#123;</span><br><span class="line">                swap(arr,start,start+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="冒泡排序-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SelectSort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> arr[i];</span><br><span class="line">        arr[i] = arr[j];</span><br><span class="line">        arr[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] randomArray(<span class="type">int</span> n)&#123;</span><br><span class="line">        <span class="type">int</span>[] array = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            array[i]=(<span class="type">int</span>)(Math.random()*<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">bubbleSort</span><span class="params">(<span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(arr ==<span class="literal">null</span>|| arr.length&lt;<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        0~n-1</span></span><br><span class="line"><span class="comment">//        0~n-2</span></span><br><span class="line"><span class="comment">//        0~n-3</span></span><br><span class="line">        <span class="comment">//每结束一次循环代表找到一个最大值，排好一位数，以此往复</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> end=arr.length-<span class="number">1</span>;end&gt;<span class="number">0</span>;end--)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> start=<span class="number">0</span>;start&lt;end;start++)&#123;</span><br><span class="line">                <span class="comment">//在数组中不断判断找到最大值</span></span><br><span class="line">                <span class="keyword">if</span>(arr[start]&gt;arr[start+<span class="number">1</span>])&#123;</span><br><span class="line">                    swap(arr,start,start+<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arr = randomArray(<span class="number">10</span>);</span><br><span class="line">        bubbleSort(arr);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line">            System.out.print(arr[i]+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="插入排序">插入排序</h2><ul><li><p>插入排序的工作原理是将未排序的数组元素插入到已排序的数组中，从而得到一个新的有序数组。</p></li><li><p>类似于打扑克牌，将手上的牌排好一部分后，未排好的牌依次按顺序插入到已排好的牌中，最终达到整体有序的效果。</p></li><li><p>代码实现过程：</p><ul><li>将数组从0~1,0~2,0~3…0~n-1依次进行排序。</li><li>将0~1的元素插入到0~0的数组中，得到0~1有序的数组。</li><li>将0~2的元素插入到0~0,0~1的数组中，得到0~2有序的数组。</li><li>以此类推</li></ul></li></ul><div class="tabs" id="插入排序"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#插入排序-1">核心代码</button></li><li class="tab"><button type="button" data-href="#插入排序-2">完整代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="插入排序-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">insertionSort</span><span class="params">(<span class="type">int</span>[] arr)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(arr==<span class="literal">null</span>||arr.length==<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;arr.length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=i;j&gt;=<span class="number">0</span>;j--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(arr[j+<span class="number">1</span>]&lt;arr[j])&#123;</span><br><span class="line">                swap(arr,j,j+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="插入排序-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SelectSort</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> arr[i];</span><br><span class="line">        arr[i] = arr[j];</span><br><span class="line">        arr[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] randomArray(<span class="type">int</span> n)&#123;</span><br><span class="line">        <span class="type">int</span>[] array = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            array[i]=(<span class="type">int</span>)(Math.random()*<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">insertionSort</span><span class="params">(<span class="type">int</span>[] arr)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr==<span class="literal">null</span>||arr.length==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;arr.length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i;j&gt;=<span class="number">0</span>;j--)&#123;</span><br><span class="line">                <span class="keyword">if</span>(arr[j+<span class="number">1</span>]&lt;arr[j])&#123;</span><br><span class="line">                    swap(arr,j,j+<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arr = randomArray(<span class="number">10</span>);</span><br><span class="line">        insertionSort(arr);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line">            System.out.print(arr[i]+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="三种排序总结">三种排序总结</h2><p><strong>选择排序：</strong></p><ul><li><strong>基本思想</strong>：每一趟从无序区选择最小（或最大）元素，放到有序区的末尾。</li><li><strong>时间复杂度</strong>：<ul><li>最好：O(n²)</li><li>最坏：O(n²)</li><li>平均：O(n²)</li></ul></li><li><strong>空间复杂度</strong>：O(1)</li><li><strong>稳定性</strong>：不稳定（可能改变相等元素的相对顺序）</li><li><strong>特点</strong>：<ul><li>交换次数少（最多 n-1 次交换），但比较次数多；</li><li>不管数据有序与否，时间复杂度都一样；</li><li>简单直观，但性能比插入排序稍差。</li></ul></li></ul><p><strong>冒泡排序：</strong></p><ul><li><strong>基本思想</strong>：通过相邻元素比较并交换，把较大（或较小）的元素逐步“冒泡”到序列的一端。</li><li><strong>时间复杂度</strong>：<ul><li>最好：O(n)（序列本身有序，只需一次冒泡即可）</li><li>最坏：O(n²)</li><li>平均：O(n²)</li></ul></li><li><strong>空间复杂度</strong>：O(1)</li><li><strong>稳定性</strong>：稳定（相邻元素相等时不交换顺序）</li><li><strong>特点</strong>：<ul><li>思想直观，常用于入门讲解；</li><li>效率较低，数据量大时不推荐。</li></ul></li></ul><p><strong>插入排序：</strong></p><ul><li><strong>基本思想</strong>：把序列分为有序区和无序区，每次将无序区的第一个元素插入到有序区合适的位置。</li><li><strong>时间复杂度</strong>：<ul><li>最好：O(n)（原本接近有序时）</li><li>最坏：O(n²)</li><li>平均：O(n²)</li></ul></li><li><strong>空间复杂度</strong>：O(1)（原地排序）</li><li><strong>稳定性</strong>：稳定（相等元素不会交换顺序）</li><li><strong>特点</strong>：<ul><li>简单，适合数据量小或基本有序的情况；</li><li>插入过程像整理扑克牌。</li></ul></li></ul><h1>二分搜索</h1><ol><li>在有序数组中确定num存在还是不存在</li><li>在有序数组中找&gt;=num的最左位置</li><li>在有序数组中找&lt;=num的最右位置</li><li>二分搜索不一定发生在有序数组上（比如寻找峰值问题）</li></ol><h1>链表入门题</h1><h2 id="单双链表及其反转">单双链表及其反转</h2><h3 id="按值传递，按引用传递">按值传递，按引用传递</h3><ul><li>一般基本数据类型默认是<code>按值传递</code>，函数会获得参数的副本，修改副本不会修改原始值</li><li>引用数据类型默认为<code>按引用传递</code>，在函数中的操作会直接影响原始值</li><li>C和C++可以通过传递指针来使函数在修改副本的同时也修改原始值</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// int、long、byte、short</span></span><br><span class="line">        <span class="comment">// char、float、double、boolean</span></span><br><span class="line">        <span class="comment">// 还有String</span></span><br><span class="line">        <span class="comment">// 都是按值传递</span></span><br><span class="line">        <span class="comment">//在f(int)函数中修改a，但a并没有变化</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        f(a);</span><br><span class="line">        System.out.println(a);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 其他类型按引用传递</span></span><br><span class="line">        <span class="comment">// 比如下面的Number是自定义的类</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//        在内存的堆空间申请了一片区域，哪个区域保存了5</span></span><br><span class="line"><span class="comment">//        同时在栈空间新建了一个变量b,可以通过b找到堆空间的5</span></span><br><span class="line">        <span class="type">Number</span> <span class="variable">b</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">5</span>);</span><br><span class="line"><span class="comment">//        这里看似是b被设为空,实则是拷贝了一个b&#x27;进入函数，使b&#x27;也指向堆中的空间</span></span><br><span class="line"><span class="comment">//        所以函数内也只是将b&#x27;指向的位置改为空，对实际的b无影响</span></span><br><span class="line">        g1(b);</span><br><span class="line">        System.out.println(b.val);</span><br><span class="line"><span class="comment">//        这里g2将b的值改为6</span></span><br><span class="line"><span class="comment">//        实际上操作的是b&#x27;，将b&#x27;指向的地方的value改为了6，但b和b&#x27;指向了同一个地方</span></span><br><span class="line"><span class="comment">//        所以b的val也会变成6</span></span><br><span class="line">        g2(b);</span><br><span class="line">        System.out.println(b.val);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 比如下面的一维数组</span></span><br><span class="line">        <span class="type">int</span>[] c = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span> &#125;;</span><br><span class="line">        g3(c);</span><br><span class="line">        System.out.println(c[<span class="number">0</span>]);</span><br><span class="line">        g4(c);</span><br><span class="line">        System.out.println(c[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">f</span><span class="params">(<span class="type">int</span> a)</span> &#123;</span><br><span class="line">        a = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Number</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> val;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Number</span><span class="params">(<span class="type">int</span> v)</span> &#123;</span><br><span class="line">            val = v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">g1</span><span class="params">(Number b)</span> &#123;</span><br><span class="line">        b = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">g2</span><span class="params">(Number b)</span> &#123;</span><br><span class="line">        b.val = <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">g3</span><span class="params">(<span class="type">int</span>[] c)</span> &#123;</span><br><span class="line">        c = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">g4</span><span class="params">(<span class="type">int</span>[] c)</span> &#123;</span><br><span class="line">        c[<span class="number">0</span>] = <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 单链表节点</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> val;</span><br><span class="line">        <span class="keyword">public</span> ListNode next;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ListNode</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ListNode</span><span class="params">(<span class="type">int</span> val, ListNode next)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">            <span class="built_in">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="实现链表反转">实现链表反转</h3><ul><li>假设一个链表的指向为: 11-&gt;22-&gt;33-&gt;44-&gt;55</li><li>反转后效果则为:       55-&gt;44-&gt;33-&gt;22-&gt;11</li><li>构造函数原型<ul><li>首先函数必须有一个参数，这个参数就是链表的头结点</li><li>其次，函数还应当有返回值，返回值就是反转后的链表头结点</li><li>我们可以使用堆栈的方式来实现链表反转</li></ul></li><li>题目链接：<a href="https://leetcode.cn/problems/reverse-linked-list/">https://leetcode.cn/problems/reverse-linked-list/</a></li><li><em><strong>反转链表实现：</strong></em><ul><li>从头结点开始，先将当前节点的下一个结点的位置用一个变量暂存起来(因为等会修改下一个节点的位置，不存储起来会导致链表断连)</li><li>然后修改当前节点的下一个结点为前一个结点(即使是单链表也可以，因为前一个节点是每次实现反转后，将当前结点存在前一个结点，存完后再向后移动链表)</li><li>让前一个结点等于当前结点(这就是上一步说的更新节点，链表反转后并后移以后，当前结点就是前结点)</li><li>将当前结点后移，进行下一轮循环</li><li>循环结束后，返回的是pre节点，这是反转后链表的头结点，不是head因为此时在循环的最后一步，head会移动到链表末尾，指向NULL</li></ul></li></ul><div class="tabs" id="单链表反转"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#单链表反转-1">单链表反转</button></li><li class="tab"><button type="button" data-href="#单链表反转-2">双链表反转</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="单链表反转-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单链表节点</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> val;</span><br><span class="line">        <span class="keyword">public</span> ListNode next;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ListNode</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ListNode</span><span class="params">(<span class="type">int</span> val, ListNode next)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">            <span class="built_in">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">reverseList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">while</span> (head != <span class="literal">null</span>) &#123;</span><br><span class="line">                next = head.next;</span><br><span class="line">                head.next = pre;</span><br><span class="line">                pre = head;</span><br><span class="line">                head = next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> pre;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="单链表反转-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 双链表节点</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DoubleListNode</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">public</span> DoubleListNode last;</span><br><span class="line">    <span class="keyword">public</span> DoubleListNode next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">DoubleListNode</span><span class="params">(<span class="type">int</span> v)</span> &#123;</span><br><span class="line">        value = v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 反转双链表</span></span><br><span class="line"><span class="comment">// 没有找到测试链接,如下方法是对的</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> DoubleListNode <span class="title function_">reverseDoubleList</span><span class="params">(DoubleListNode head)</span> &#123;</span><br><span class="line">    <span class="type">DoubleListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">DoubleListNode</span> <span class="variable">next</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">null</span>) &#123;</span><br><span class="line">        next = head.next;</span><br><span class="line">        head.next = pre;</span><br><span class="line">        head.last = next;</span><br><span class="line">        pre = head;</span><br><span class="line">        head = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pre;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="合并两个有序链表">合并两个有序链表</h2><ul><li>要求：将两个升序链表合并为一个新的升序链表并返回。新链表是通过拼接给定的两个链表的所有节点组成的。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250911165520.png"/></div></div><ul><li><p><em><strong>合并链表实现：</strong></em></p><ul><li>先判断两个有序链表谁的头结点更小，将头结点小的结点作为合并后的链表的头结点。</li><li>分别定义两个指针cur1和cur2，一个连接在头结点小的那个结点的下一个结点上，一个连接在头结点较大的那个结点上，假设此题选第一个链表的1作为头结点，那么cur1将指向2，cur2将指向第二个链表的1，并设置pre作为前驱结点，pre指向第一步比较中较小的那个结点</li><li>定义循环，循环的结束条件是有一条链表的元素全部遍历完</li><li>在循环中，不断比较cur1和cur2的值，将较小的值连接到新的链表上，并向后移动移动对应指针，更新pre的值为当前较小的结点，并继续循环</li><li>当循环结束时，直接将另一条有元素未比较的链表的剩余元素链接到新的链表上，因为链表是有序的，所以直接链接即可</li><li>返回新链表头结点</li></ul></li><li><p><a href="https://leetcode.cn/problems/merge-two-sorted-lists/">测试连接</a></p></li><li><div class="tabs" id="合并链表"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#合并链表-1">代码</button></li><li class="tab"><button type="button" data-href="#合并链表-2">leetcode测试代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="合并链表-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">mergeTwoLists</span><span class="params">(ListNode head1, ListNode head2)</span> &#123;</span><br><span class="line">            <span class="comment">//一方为空，则无需合并直接返回另一个链表即可</span></span><br><span class="line">            <span class="keyword">if</span> (head1 == <span class="literal">null</span> || head2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> head1 == <span class="literal">null</span> ? head2 : head1;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//判断谁的头结点小谁做新生成的链表的头(在前面确定好head后，在中间连接过程head没有任何变化，最后作为返回值返回)</span></span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">head</span> <span class="operator">=</span> head1.val &lt;= head2.val ? head1 : head2;</span><br><span class="line">            <span class="comment">//cur1连接头结点后一个结点（）</span></span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">cur1</span> <span class="operator">=</span> head.next;</span><br><span class="line">            <span class="comment">//cur2连接未做头结点的那个结点的后一个结点</span></span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">cur2</span> <span class="operator">=</span> head == head1 ? head2 : head1;</span><br><span class="line"><span class="comment">//            pre保存当前结点的前驱，cur1更新后继</span></span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> head;</span><br><span class="line"><span class="comment">//            当两链表都不为空就不断比较谁小，谁作为下一个结点</span></span><br><span class="line">            <span class="keyword">while</span> (cur1 != <span class="literal">null</span> &amp;&amp; cur2 != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (cur1.val &lt;= cur2.val) &#123;</span><br><span class="line">                    pre.next = cur1;</span><br><span class="line">                    cur1 = cur1.next;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    pre.next = cur2;</span><br><span class="line">                    cur2 = cur2.next;</span><br><span class="line">                &#125;</span><br><span class="line">                pre = pre.next;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//            有一个链表全部比较完了，此时未比较完的链表剩余元素一定大于比较完的链表的每一个元素，故直接将未比较的剩余链表元素直接连到刚刚排序好的新链表</span></span><br><span class="line">            pre.next = cur1 != <span class="literal">null</span> ? cur1 : cur2;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="合并链表-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode() &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val) &#123; this.val = val; &#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val, ListNode next) &#123; this.val = val; this.next = next; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">mergeTwoLists</span><span class="params">(ListNode list1, ListNode list2)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(list1==<span class="literal">null</span>||list2==<span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> list1==<span class="literal">null</span>?list2:list1;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">head</span> <span class="operator">=</span> list1.val&gt;list2.val ? list2:list1;</span><br><span class="line">        ListNode cur1=head.next;</span><br><span class="line">        ListNode cur2= head==list1?list2:list1;</span><br><span class="line">        ListNode pre=head;</span><br><span class="line">        <span class="keyword">while</span>(cur1!=<span class="literal">null</span>&amp;&amp;cur2!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cur1.val&lt;cur2.val)&#123;</span><br><span class="line">                pre.next=cur1;</span><br><span class="line">                cur1=cur1.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                pre.next=cur2;</span><br><span class="line">                cur2=cur2.next;</span><br><span class="line">            &#125;</span><br><span class="line">            pre=pre.next;</span><br><span class="line">        &#125;</span><br><span class="line">        pre.next=cur1==<span class="literal">null</span>?cur2:cur1;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></li></ul><h2 id="两个链表相加">两个链表相加</h2><ul><li><p>实际上就是利用链表实现<code>高精度算法</code>的加法</p></li><li><p>它们每位数字都是按照 <code>逆序</code> 的方式存储的，并且每个节点只能存储一位数字</p></li><li><p>题目链接：<a href="https://leetcode.cn/problems/add-two-numbers/"></a></p></li><li><p><em><strong>链表相加实现：</strong></em></p><ul><li>创建一个ans结点，该结点只用来作为结果链表的头结点返回</li><li>创建一个cur结点，该结点来记录当前操作位置，每次计算更新位置</li><li>创建一个进位变量carry，记录当前位相加的结果是否超过10，超过则进位</li><li>定义循环，每次循环移动两条链表到下一位，链表的结束条件为两条链表都为空</li><li>在循环中，直接计算两个链表数值相加的结果，并分别记录下结果的个位和十位</li><li>判断是否为第一次计算，如果是第一次计算，则将cur指向ans结点，如果不是则将cur指向下一个结点</li><li>不断循环，直到两条链表都为空</li><li>最后跳出循环后，如果carry为1，则再创建一个数值为1的结点，并添加到链表末尾</li></ul></li></ul><div class="tabs" id="链表相加"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#链表相加-1">代码</button></li><li class="tab"><button type="button" data-href="#链表相加-2">提交代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="链表相加-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 不要提交这个类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> val;</span><br><span class="line">        <span class="keyword">public</span> ListNode next;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ListNode</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ListNode</span><span class="params">(<span class="type">int</span> val, ListNode next)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">            <span class="built_in">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">addTwoNumbers</span><span class="params">(ListNode h1, ListNode h2)</span> &#123;</span><br><span class="line"><span class="comment">//            ans作为结果链表的头结点，第一次计算初始化后便不再改变，cur为记录当前操作的位置，每次计算更新</span></span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="literal">null</span>, cur = <span class="literal">null</span>;</span><br><span class="line">            <span class="comment">//carry表示当前位是否进位</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">carry</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> sum, val; <span class="comment">// 声明变量</span></span><br><span class="line">                 h1 != <span class="literal">null</span> || h2 != <span class="literal">null</span>; <span class="comment">// 终止条件，需要两条链表都为空，结果才为false，跳出循环</span></span><br><span class="line">                 <span class="comment">//移动指针到下一位（为空时保持 null）</span></span><br><span class="line">                 h1 = h1 == <span class="literal">null</span> ? <span class="literal">null</span> : h1.next, <span class="comment">// 每一步h1的跳转</span></span><br><span class="line">                         h2 = h2 == <span class="literal">null</span> ? <span class="literal">null</span> : h2.next <span class="comment">// 每一步h2的跳转</span></span><br><span class="line">            ) &#123;</span><br><span class="line">                <span class="comment">//sum来暂时存储每一位相加的结果</span></span><br><span class="line">                sum = (h1 == <span class="literal">null</span> ? <span class="number">0</span> : h1.val)</span><br><span class="line">                        + (h2 == <span class="literal">null</span> ? <span class="number">0</span> : h2.val)</span><br><span class="line">                        + carry;</span><br><span class="line"></span><br><span class="line">                val = sum % <span class="number">10</span>;</span><br><span class="line">                carry = sum / <span class="number">10</span>;</span><br><span class="line">                <span class="keyword">if</span> (ans == <span class="literal">null</span>) &#123;</span><br><span class="line">                    ans = <span class="keyword">new</span> <span class="title class_">ListNode</span>(val);</span><br><span class="line">                    cur = ans;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    cur.next = <span class="keyword">new</span> <span class="title class_">ListNode</span>(val);</span><br><span class="line">                    cur = cur.next;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (carry == <span class="number">1</span>) &#123;</span><br><span class="line">                cur.next = <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="链表相加-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode() &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val) &#123; this.val = val; &#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val, ListNode next) &#123; this.val = val; this.next = next; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">addTwoNumbers</span><span class="params">(ListNode l1, ListNode l2)</span> &#123;</span><br><span class="line">        ListNode ans=<span class="literal">null</span>;</span><br><span class="line">        ListNode cur=<span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> carry=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> sum,val;</span><br><span class="line">            l1!=<span class="literal">null</span>||l2!=<span class="literal">null</span>;</span><br><span class="line">            l1=l1==<span class="literal">null</span>?<span class="literal">null</span>:l1.next,</span><br><span class="line">            l2=l2==<span class="literal">null</span>?<span class="literal">null</span>:l2.next)&#123;</span><br><span class="line">                sum=(l1==<span class="literal">null</span>?<span class="number">0</span>:l1.val)+(l2==<span class="literal">null</span>?<span class="number">0</span>:l2.val)+carry;</span><br><span class="line">                val=sum%<span class="number">10</span>;</span><br><span class="line">                carry=sum/<span class="number">10</span>;</span><br><span class="line">                <span class="keyword">if</span>(ans==<span class="literal">null</span>)&#123;</span><br><span class="line">                    ans= <span class="keyword">new</span> <span class="title class_">ListNode</span>(val);</span><br><span class="line">                    cur=ans;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    cur.next=<span class="keyword">new</span> <span class="title class_">ListNode</span>(val);</span><br><span class="line">                    cur=cur.next;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(carry!=<span class="number">0</span>)&#123;</span><br><span class="line">                cur.next=<span class="keyword">new</span> <span class="title class_">ListNode</span>(carry);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="划分链表">划分链表</h2><ul><li><p>题目要求：将链表分为两个部分，前一部分小于x，后一部分大于等于x，且划分后不改变链表的相对次序</p></li><li><p>题目链接：<a href="https://leetcode.cn/problems/partition-list/">https://leetcode.cn/problems/partition-list/</a></p></li><li><p><em><strong>划分链表实现：</strong></em></p><ul><li>首先定义四个结点，分别表示小于x的链表头结点，小于x的链表尾结点，大于等于x的链表头结点，大于等于x的链表尾结点，以及当前遍历的结点的下一个结点的位置</li><li>遍历链表，首先先更新next结点为下一个结点</li><li>然后判断当前结点的数值是否小于x，如果是，则将当前结点插入到小于x的链表末尾，并更新小于x的链表尾结点为当前结点</li><li>如果当前结点的数值大于等于x，则将当前结点插入到大于等于x的链表末尾，并更新大于等于x的链表尾结点为当前结点</li><li>如果这是第一个元素还需要记录该链表的头为当前结点</li><li>更新当前链表到下一个结点</li><li>最后遍历结束，判断小于x的链表是否有值，</li><li>若没有则直接返回大于x的链表的头指针，若有值则将大于等于x的链表头结点连接到小于x的链表尾结点的next位置</li><li>返回小于x的链表头结点</li></ul></li></ul><div class="tabs" id="划分代码"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#划分代码-1">代码</button></li><li class="tab"><button type="button" data-href="#划分代码-2">提交代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="划分代码-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 不要提交这个类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ListNode</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> val;</span><br><span class="line">        <span class="keyword">public</span> ListNode next;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ListNode</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ListNode</span><span class="params">(<span class="type">int</span> val, ListNode next)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">            <span class="built_in">this</span>.next = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title function_">partition</span><span class="params">(ListNode head, <span class="type">int</span> x)</span> &#123;</span><br><span class="line">            <span class="comment">//&lt; x的区域的链表的头和尾</span></span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">leftHead</span> <span class="operator">=</span> <span class="literal">null</span>, leftTail = <span class="literal">null</span>;</span><br><span class="line">            <span class="comment">//&gt;= x的区域的链表的头和尾</span></span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">rightHead</span> <span class="operator">=</span> <span class="literal">null</span>, rightTail = <span class="literal">null</span>;</span><br><span class="line">            <span class="comment">// 用来存储下一个结点的位置，防止链表断连</span></span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">while</span> (head != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">//更新next的位置</span></span><br><span class="line">                next = head.next;</span><br><span class="line">                <span class="comment">//断连，重新划分该结点属于哪个链表,必须要要，否则可能有成环的情况</span></span><br><span class="line">                head.next = <span class="literal">null</span>;</span><br><span class="line">                <span class="comment">//小于的区域</span></span><br><span class="line">                <span class="keyword">if</span> (head.val &lt; x) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (leftHead == <span class="literal">null</span>) &#123;</span><br><span class="line">                        leftHead = head;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        leftTail.next = head;</span><br><span class="line">                    &#125;</span><br><span class="line">                    leftTail = head;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (rightHead == <span class="literal">null</span>) &#123;</span><br><span class="line">                        rightHead = head;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        rightTail.next = head;</span><br><span class="line">                    &#125;</span><br><span class="line">                    rightTail = head;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//更新到原链表的下一个结点</span></span><br><span class="line">                head = next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (leftHead == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> rightHead;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// &lt; x的区域有内容，将大于区域的头接到小于区域的尾部</span></span><br><span class="line">            leftTail.next = rightHead;</span><br><span class="line">            <span class="keyword">return</span> leftHead;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="划分代码-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode() &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val) &#123; this.val = val; &#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val, ListNode next) &#123; this.val = val; this.next = next; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">partition</span><span class="params">(ListNode head, <span class="type">int</span> x)</span> &#123;</span><br><span class="line">        ListNode leftHead=<span class="literal">null</span>,leftTail=<span class="literal">null</span>,rightHead=<span class="literal">null</span>,rightTail=<span class="literal">null</span>;</span><br><span class="line">        ListNode next=<span class="literal">null</span>;</span><br><span class="line">       </span><br><span class="line">        <span class="keyword">while</span>(head!=<span class="literal">null</span>)&#123;</span><br><span class="line">            next=head.next;</span><br><span class="line">            head.next=<span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span>(head.val&lt;x)&#123;</span><br><span class="line">                <span class="keyword">if</span>(leftHead==<span class="literal">null</span>)</span><br><span class="line">                    leftHead=head;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    leftTail.next=head;</span><br><span class="line">                leftTail=head;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(rightHead==<span class="literal">null</span>)</span><br><span class="line">                    rightHead=head;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    rightTail.next=head;</span><br><span class="line">                rightTail=head;</span><br><span class="line">            &#125;</span><br><span class="line">            head=next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(leftHead==<span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> rightHead;</span><br><span class="line">        leftTail.next=rightHead;</span><br><span class="line">        <span class="keyword">return</span> leftHead;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>队列和栈</h1><ul><li>队列：先进先出</li><li>栈：先进后出</li></ul><h2 id="使用链表和数组实现">使用链表和数组实现</h2><ul><li>使用链表实现队列：<ul><li>这里直接使用Java内部提供的双端链表实现的队列</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Queue1</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// java中的双向链表LinkedList</span></span><br><span class="line">    <span class="comment">// 单向链表就足够了</span></span><br><span class="line">    <span class="keyword">public</span> Queue&lt;Integer&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用任何方法之前，先调用这个方法来判断队列内是否有东西</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queue.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 向队列中加入num，加到尾巴</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">offer</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        queue.offer(num);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从队列拿，从头拿</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">poll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queue.poll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回队列头的元素但是不弹出</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queue.peek();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回目前队列里有几个数</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queue.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>使用数组实现队列：<ul><li>前提是该队列最大长度是固定的，即数组的长度是固定的</li><li>不要求队列的头部必须待在数组头部，可以待在数组的任意位置</li></ul></li><li>实际刷题时更常见的写法，因为常数时间好，且一般笔试、面试都会有一个明确数据量</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Queue2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] queue;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> l;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> r;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加入操作的总次数上限是多少，一定要明确</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Queue2</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        queue = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        l = <span class="number">0</span>;</span><br><span class="line">        r = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用任何方法之前，先调用这个方法来判断队列内是否有东西</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> l == r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">offer</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        queue[r++] = num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">poll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queue[l++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ?</span></span><br><span class="line">    <span class="comment">// l...r-1 r</span></span><br><span class="line">    <span class="comment">// [l..r)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">head</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queue[l];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">tail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queue[r - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> r - l;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>使用数组实现栈:<ul><li>链表实现的栈Java内部已经提供了，不过常数时间不太好</li><li>前提依旧是最大长度固定</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Stack2</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span>[] stack;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 同时在栈里的元素个数不会超过n</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Stack2</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">            stack = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">            size = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 调用任何方法之前，先调用这个方法来判断栈内是否有东西</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> size == <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">            stack[size++] = num;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> stack[--size];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> stack[size - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> size;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ul><li>设置环形队列</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyCircularQueue</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span>[] queue;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> l, r, size, limit;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 同时在队列里的数字个数，不要超过k</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">MyCircularQueue</span><span class="params">(<span class="type">int</span> k)</span> &#123;</span><br><span class="line">            queue = <span class="keyword">new</span> <span class="title class_">int</span>[k];</span><br><span class="line">            l = r = size = <span class="number">0</span>;</span><br><span class="line">            limit = k;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果队列满了，什么也不做，返回false</span></span><br><span class="line">        <span class="comment">// 如果队列没满，加入value，返回true</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">enQueue</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isFull()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                queue[r] = value;</span><br><span class="line">                <span class="comment">// r++, 结束了，跳回0</span></span><br><span class="line">                r = r == limit - <span class="number">1</span> ? <span class="number">0</span> : (r + <span class="number">1</span>);</span><br><span class="line">                size++;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果队列空了，什么也不做，返回false</span></span><br><span class="line">        <span class="comment">// 如果队列没空，弹出头部的数字，返回true</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deQueue</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// l++, 结束了，跳回0</span></span><br><span class="line">                l = l == limit - <span class="number">1</span> ? <span class="number">0</span> : (l + <span class="number">1</span>);</span><br><span class="line">                size--;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 返回队列头部的数字（不弹出），如果没有数返回-1</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">Front</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> queue[l];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">Rear</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">last</span> <span class="operator">=</span> r == <span class="number">0</span> ? (limit - <span class="number">1</span>) : (r - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">return</span> queue[last];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> size == <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isFull</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> size == limit;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="栈和队列相互实现">栈和队列相互实现</h2><h3 id="使用栈实现队列">使用栈实现队列</h3><ul><li>仅仅需要两个栈即可实现，一个栈叫做in，一个栈叫做out，in栈用来接收数据，out栈用来输出数据，倒数据时严格遵循两点要求<ul><li>out栈为空时，才能倒数据到out栈</li><li>一旦倒数据，in栈必须一下倒完，不能有数据留在in栈中</li></ul></li><li>测试链接 : <a href="https://leetcode.cn/problems/implement-queue-using-stacks/">https://leetcode.cn/problems/implement-queue-using-stacks/</a></li><li><em><strong>实现流程：</strong></em><ul><li>先对两个栈进行初始化，使用泛型时，要记住使用引用数据类型</li><li>接着编写in栈倒数据到out栈的方法，这个方法十分重要，应当实现当out栈为空时，将in栈的数据倒入out栈中，当out栈不为空则不进行操作</li><li>编写入队的push方法时，直接将数据push到in栈中即可，另外要在push方法后调用inToOut()方法，在out栈为空的时候，将in栈的数据倒到out栈中，防止数据一直堆积在in栈中</li><li>编写pop方法时，要先调用inToOut()方法，确保out栈中没数据的时候，及时从in栈中获取，然后返回out栈的栈顶元素</li><li>编写peek方法时，要先调用inToOut()方法，确保out栈中没数据的时候，及时从in栈中获取，然后返回out栈的栈顶元素</li><li>编写empty方法时，即可以判断in栈和out栈是否都为空，也可以先调用inToOut()方法，再判断out栈是否为空</li></ul></li></ul><div class="tabs" id="栈实现队列"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#栈实现队列-1">实现代码</button></li><li class="tab"><button type="button" data-href="#栈实现队列-2">测试代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="栈实现队列-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyQueue</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Stack&lt;Integer&gt; in;</span><br><span class="line">        <span class="keyword">public</span> Stack&lt;Integer&gt; out;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">MyQueue</span><span class="params">()</span> &#123;</span><br><span class="line">            in = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;Integer&gt;();</span><br><span class="line">            out = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;Integer&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inToOut</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="comment">// 只有out栈为空时，才能倒数据</span></span><br><span class="line">            <span class="keyword">if</span> (out.empty()) &#123;</span><br><span class="line">                <span class="keyword">while</span> (!in.empty()) &#123;</span><br><span class="line">                    out.push(in.pop());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">            <span class="comment">// 当out栈为空时，则将in栈的数据全倒到out栈中</span></span><br><span class="line">            <span class="comment">// 当out栈不为空时，则先存在in栈中</span></span><br><span class="line">            in.push(x);</span><br><span class="line">            inToOut();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">            inToOut();</span><br><span class="line">            <span class="keyword">return</span> out.pop();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">            inToOut();</span><br><span class="line">            <span class="keyword">return</span> out.peek();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">empty</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> in.isEmpty() &amp;&amp; out.isEmpty();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="栈实现队列-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyQueue</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Stack&lt;Integer&gt; in;</span><br><span class="line">    <span class="keyword">public</span> Stack&lt;Integer&gt; out;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        in= <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;Integer&gt;();</span><br><span class="line">        out= <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;Integer&gt;();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  将in栈的数据全部倒到out栈中</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">inToOut</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(out.empty())&#123;</span><br><span class="line">            <span class="keyword">while</span>(!in.empty())&#123;</span><br><span class="line">                out.push(in.pop());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line"></span><br><span class="line">        in.push(x);</span><br><span class="line"><span class="comment">//  如果out栈还有数据就不执行，如果没有数据则推in栈的数据到out栈</span></span><br><span class="line">        inToOut();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        inToOut();</span><br><span class="line">        <span class="keyword">return</span> out.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">peek</span><span class="params">()</span> &#123;</span><br><span class="line">        inToOut();</span><br><span class="line">        <span class="keyword">return</span> out.peek();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">empty</span><span class="params">()</span> &#123;</span><br><span class="line">        inToOut();</span><br><span class="line">        <span class="keyword">return</span> out.empty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MyQueue object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MyQueue obj = new MyQueue();</span></span><br><span class="line"><span class="comment"> * obj.push(x);</span></span><br><span class="line"><span class="comment"> * int param_2 = obj.pop();</span></span><br><span class="line"><span class="comment"> * int param_3 = obj.peek();</span></span><br><span class="line"><span class="comment"> * boolean param_4 = obj.empty();</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="使用队列实现栈">使用队列实现栈</h3><ul><li>使用队列实现栈，使用一个队列即可，实际主要变化的是入队操作，使其入队后在队列的次序和栈的次序一致，出队操作则保持栈的先进后出的次序</li><li>测试链接 : <a href="https://leetcode.cn/problems/implement-stack-using-queues/">https://leetcode.cn/problems/implement-stack-using-queues/</a></li><li>入队操作的时间复杂度为O(N),其他操作的时间复杂度均为O(1)</li><li><em><strong>实现原理：</strong></em> 每当元素入队时，记录下当前队列长度，将队列现有数据全部出队，将新元素入队，再把原来的数据重新入队，这样就实现了入队时的栈先进后出的次序</li></ul><div class="tabs" id="队列实现栈"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#队列实现栈-1">实现代码</button></li><li class="tab"><button type="button" data-href="#队列实现栈-2">测试代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="队列实现栈-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyStack</span> &#123;</span><br><span class="line"></span><br><span class="line">Queue&lt;Integer&gt; queue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">MyStack</span><span class="params">()</span> &#123;</span><br><span class="line">queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;Integer&gt;();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// O(n)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line"><span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> queue.size();</span><br><span class="line">queue.offer(x);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">queue.offer(queue.poll());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> queue.poll();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">top</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> queue.peek();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">empty</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> queue.isEmpty();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="队列实现栈-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyStack</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Queue&lt;Integer&gt; queue;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyStack</span><span class="params">()</span> &#123;</span><br><span class="line">        queue=<span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;Integer&gt;();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="type">int</span> n=queue.size();</span><br><span class="line">        queue.offer(x);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            queue.offer(queue.poll());</span><br><span class="line">        &#125;        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queue.poll();        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">top</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queue.peek();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">empty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queue.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MyStack object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MyStack obj = new MyStack();</span></span><br><span class="line"><span class="comment"> * obj.push(x);</span></span><br><span class="line"><span class="comment"> * int param_2 = obj.pop();</span></span><br><span class="line"><span class="comment"> * int param_3 = obj.top();</span></span><br><span class="line"><span class="comment"> * boolean param_4 = obj.empty();</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="栈的入门题目——最小栈">栈的入门题目——最小栈</h2><ul><li><ul><li>栈的入门题目，要求实现一个栈，并且实现一个getmin()方法，要求时间复杂度为O(1)，因此不能依靠遍历获得最小值</li></ul></li><li>测试链接 : <a href="https://leetcode.cn/problems/min-stack/">https://leetcode.cn/problems/min-stack/</a></li><li><em><strong>最小栈实现思路：</strong></em><ul><li>使用两个栈，一个栈用于存储数据，一个栈用于存储最小值</li><li>每次在数据栈中添加元素时，比较新添数据和最小栈的栈顶哪个更小，将更小的数据重新压入最小栈，一直保持数据栈和最小栈的数量一致</li><li>每次删除数据时，同步删除最小栈的栈顶数据</li><li>每次获取最小值时，直接返回最小栈的栈顶数据</li></ul></li><li>因为前面提到的内置栈的常数时间复杂度较慢，所以这里两种方式的栈都记录一下</li></ul><div class="tabs" id="最小栈"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#最小栈-1">测试代码——内置栈</button></li><li class="tab"><button type="button" data-href="#最小栈-2">测试代码——自定义数组栈</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="最小栈-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MinStack</span> &#123;</span><br><span class="line">    <span class="comment">// 初始化最小栈和数据栈</span></span><br><span class="line">    <span class="keyword">public</span> Stack&lt;Integer&gt; data;</span><br><span class="line">    <span class="keyword">public</span> Stack&lt;Integer&gt; min;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MinStack</span><span class="params">()</span> &#123;</span><br><span class="line">        data = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;Integer&gt;();</span><br><span class="line">        min = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;Integer&gt;();       </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="comment">// 先将数据压入数据栈中</span></span><br><span class="line">        data.push(val);</span><br><span class="line">        <span class="comment">// 如果最小栈为空或者新添的数据小于最小栈的栈顶数据，则将新添的数据重新压入最小栈</span></span><br><span class="line">        <span class="keyword">if</span>(min.isEmpty()||val&lt;min.peek())&#123;</span><br><span class="line">            min.push(val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 否则，将最小栈的栈顶数据重新压入最小栈</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            min.push(min.peek());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 删除两个栈的栈顶数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        data.pop();</span><br><span class="line">        min.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 返回数据栈的栈顶数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">top</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data.peek();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回最小栈的栈顶数据即为最小值</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getMin</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> min.peek();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MinStack object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MinStack obj = new MinStack();</span></span><br><span class="line"><span class="comment"> * obj.push(val);</span></span><br><span class="line"><span class="comment"> * obj.pop();</span></span><br><span class="line"><span class="comment"> * int param_3 = obj.top();</span></span><br><span class="line"><span class="comment"> * int param_4 = obj.getMin();</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="最小栈-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MinStack</span> &#123;</span><br><span class="line">    <span class="comment">// 定义一个比较大的数，如果测试题目的测试数据又变大则增大这个最大值即可</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> Max=<span class="number">10001</span>;</span><br><span class="line"><span class="comment">// 两个数组，分别代替数据栈和最小栈</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] data;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] min;</span><br><span class="line"><span class="comment">// 记录当前的数据量</span></span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MinStack</span><span class="params">()</span>&#123;</span><br><span class="line">        data = <span class="keyword">new</span> <span class="title class_">int</span>[Max];</span><br><span class="line">        min = <span class="keyword">new</span> <span class="title class_">int</span>[Max];</span><br><span class="line">        size=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">        data[size]=val;</span><br><span class="line">        <span class="keyword">if</span>(size==<span class="number">0</span>||val&lt;=min[size-<span class="number">1</span>])</span><br><span class="line">            min[size]=val;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            min[size]=min[size-<span class="number">1</span>];</span><br><span class="line">        size++;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 直接将长度减一即可，增加数据时会直接将原始数据覆盖掉</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        size--;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">top</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data[size-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getMin</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> min[size-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MinStack object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MinStack obj = new MinStack();</span></span><br><span class="line"><span class="comment"> * obj.push(val);</span></span><br><span class="line"><span class="comment"> * obj.pop();</span></span><br><span class="line"><span class="comment"> * int param_3 = obj.top();</span></span><br><span class="line"><span class="comment"> * int param_4 = obj.getMin();</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="双端队列">双端队列</h2><ul><li>双端队列和名字一样，是一个队列，允许在两端进行插入和删除操作，即可以从头部尾部进，也可以从头部尾部出</li><li>用双链表实现只需要特殊化一下插入和删除的逻辑即可，这里主要记一下用固定数组实现双端队列</li><li>测试链接 : <a href="https://leetcode.cn/problems/design-circular-deque/">https://leetcode.cn/problems/design-circular-deque/</a></li></ul><h1>二叉树</h1><h2 id="二叉树的遍历">二叉树的遍历</h2><ul><li>二叉树的遍历，分为前序、中序、后序、层序遍历，这里主要记录二叉树的三序遍历<ul><li>前序遍历：先遍历根节点，再遍历左子树，最后遍历右子树</li><li>中序遍历：先遍历左子树，再遍历根节点，最后遍历右子树</li><li>后序遍历：先遍历左子树，再遍历右子树，最后遍历根节点</li><li>层序遍历：按照层的顺序遍历，即先遍历根节点，再遍历左右子树，最后遍历左右子树的子节点</li></ul></li><li>二叉树的三序遍历有递归和非递归两种方式，任何一种递归的方式都可以转换为非递归方式，因此这里主要记录一下递归方式</li></ul><h3 id="递归遍历">递归遍历</h3><ul><li><p>二叉树的遍历实现思路：</p><ul><li>创建一个函数，在函数中，如果当前节点为空则退出</li><li>接着先序遍历则优先打印当前结点的值，接着递归调用该函数，此时传入的值为当前节点的左子树，接着调用函数传入当前结点的右子树</li><li>中序后序的区别仅仅是打印和递归调用的顺序不同</li></ul></li><li><p>递归序：</p><ul><li>1-&gt;2-&gt;4-&gt;4-&gt;4-&gt;2-&gt;5-&gt;5-&gt;5-&gt;2-&gt;</li><li>1-&gt;3-&gt;6-&gt;6-&gt;6-&gt;3-&gt;7-&gt;7-&gt;7-&gt;3-&gt;</li><li>1</li></ul></li><li><p>递归序即为在递归过程中访问的顺序，不难发现，只要一个结点不为空结点，那么一定会访问三次，而三种遍历方式，控制的就是他是在哪次访问的时候输出当前结点的值</p></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250913184222.png"/></div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TreeNode</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> val;</span><br><span class="line">        <span class="keyword">public</span> TreeNode left;</span><br><span class="line">        <span class="keyword">public</span> TreeNode right;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">TreeNode</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.val = x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 先序遍历</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">preTraversal</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.print(head.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        preTraversal(head.left);</span><br><span class="line">        preTraversal(head.right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 中序遍历 </span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">inTraversal</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        inTraversal(head.left);</span><br><span class="line">        System.out.print(head.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        inTraversal(head.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 后序遍历</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">afterTraversal</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        afterTraversal(head.left);</span><br><span class="line">        afterTraversal(head.right);</span><br><span class="line">        System.out.print(head.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">1</span>);</span><br><span class="line">        head.left = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">2</span>);</span><br><span class="line">        head.right = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">3</span>);</span><br><span class="line">        head.left.left = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">4</span>);</span><br><span class="line">        head.left.right = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">5</span>);</span><br><span class="line">        head.right.left = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">6</span>);</span><br><span class="line">        head.right.right = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">7</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;先序遍历结果： &quot;</span>);</span><br><span class="line">        preTraversal(head);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;中序遍历结果： &quot;</span>);</span><br><span class="line">        inTraversal(head);</span><br><span class="line">        System.out.println();</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;后序遍历结果： &quot;</span>);</span><br><span class="line">        afterTraversal(head);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="非递归遍历">非递归遍历</h3><h4 id="先序遍历">先序遍历</h4><ul><li>用栈实现二叉树的先序遍历思路：</li><li>实现思路：<ul><li>判断当前节点是否为空，不为空时则将结点压入栈</li><li>接着循环遍历栈，循环条件为栈不为空，循环过程中先弹出一个结点，此时应当记录一下该结点</li><li>输出弹出的那个结点的值</li><li>因为栈是先进后出，所以应当先判断是否有右子树，有则将右子树入栈，无则判断是否有左子树，有则将左子树入栈，无则退出此次循环</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">preOrder</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line"><span class="comment">//       为空就直接返回</span></span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        将当前结点压入栈</span></span><br><span class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        stack.push(head);</span><br><span class="line">        <span class="keyword">while</span>(!stack.isEmpty())&#123;</span><br><span class="line"><span class="comment">//            栈顶元素出栈，并记录下该结点</span></span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">node</span> <span class="operator">=</span> stack.pop();</span><br><span class="line">            System.out.print(node.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line"><span class="comment">//            判断出栈的结点是否有右子树</span></span><br><span class="line">            <span class="keyword">if</span>(node.right!=<span class="literal">null</span>)&#123;</span><br><span class="line">                stack.push(node.right);</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//            判断出栈的结点是否有左子树</span></span><br><span class="line">            <span class="keyword">if</span>(node.left!=<span class="literal">null</span>)&#123;</span><br><span class="line">                stack.push(node.left);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="中序遍历">中序遍历</h4><ul><li>用栈实现二叉树的中序遍历思路：<ul><li>将树的左边界依次进栈，直到左边界全部压入栈中</li><li>接着将栈里元素弹出，打印该结点并将弹出结点的右树重复执行上一个步骤直到栈为空</li><li>测试链接：<a href="https://leetcode.cn/problems/binary-tree-inorder-traversal/">https://leetcode.cn/problems/binary-tree-inorder-traversal/</a></li></ul></li></ul><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> static <span class="literal">void</span> inOrder(TreeNode head)&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="built_in">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">Stack</span>&lt;TreeNode&gt; <span class="built_in">stack</span> = <span class="literal">new</span> <span class="built_in">Stack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span>(!<span class="built_in">stack</span>.isEmpty()||head!=<span class="built_in">null</span>)&#123;</span><br><span class="line"><span class="comment">//            将当前结点的左侧子树全部压入栈，之后head为空，但栈不为空，再执行else方法</span></span><br><span class="line">            <span class="keyword">if</span>(head!=<span class="built_in">null</span>)&#123;</span><br><span class="line">                <span class="built_in">stack</span>.push(head);</span><br><span class="line">                head = head.left;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//                将栈中元素出栈并打印，且如果该结点有右子树的话使其再次执行前一个步骤</span></span><br><span class="line">                head = <span class="built_in">stack</span>.pop();</span><br><span class="line">                System.out.print(head.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">                head = head.right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="后序遍历">后序遍历</h4><ul><li>后续遍历有两种实现方法，一种是使用两个栈来实现，另一种是使用一个栈加上哨兵记录栈内结点来实现</li><li>非递归的后序遍历事实上和先序遍历一样，只是将左右子树顺序交换一下后再倒过来输出。先序是中-&gt;左-&gt;右，交换位置后是中-&gt;右-&gt;左，再倒过来输出就是后序:左-&gt;右-&gt;中</li><li>类似两个栈实现队列的思路，通过两个栈来实现后序遍历</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">postOrder</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        Stack&lt;TreeNode&gt; in = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        Stack&lt;TreeNode&gt; out = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        in.push(head);</span><br><span class="line">        TreeNode node;</span><br><span class="line">        <span class="keyword">while</span>(!in.isEmpty())&#123;</span><br><span class="line">            node = in.pop();</span><br><span class="line">            out.push(node);</span><br><span class="line">            <span class="keyword">if</span>(node.left!=<span class="literal">null</span>)&#123;</span><br><span class="line">                in.push(node.left);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(node.right!=<span class="literal">null</span>)&#123;</span><br><span class="line">                in.push(node.right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(!out.isEmpty())&#123;</span><br><span class="line">            System.out.print(out.pop().val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="总结">总结</h4><ul><li>递归方法遍历二叉树，前面分析了每个结点都会访问三次，所以时间复杂度是O(n),非递归方法每个结点也都会进栈和出栈，时间复杂度也是O(n)</li><li>不管是递归还是非递归，空间复杂度都是O(h)，此处h为<code>树的高度</code></li><li>两个栈实现后序遍历的方法，非常好写且容易理解但不推荐，因为他要一下收集全部的结点，最后逆序输出，额外的空间复杂度为O(N)，很浪费空间。</li></ul><div class="tabs" id="遍历二叉树"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#遍历二叉树-1">代码</button></li><li class="tab"><button type="button" data-href="#遍历二叉树-2">输出</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="遍历二叉树-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Stack;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TreeNode</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> val;</span><br><span class="line">        <span class="keyword">public</span> TreeNode left;</span><br><span class="line">        <span class="keyword">public</span> TreeNode right;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">TreeNode</span><span class="params">(<span class="type">int</span> x)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.val = x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    先序遍历</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">preTraversal</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.print(head.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        preTraversal(head.left);</span><br><span class="line">        preTraversal(head.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">inTraversal</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        inTraversal(head.left);</span><br><span class="line">        System.out.print(head.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        inTraversal(head.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">afterTraversal</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        afterTraversal(head.left);</span><br><span class="line">        afterTraversal(head.right);</span><br><span class="line">        System.out.print(head.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">preOrder</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line"><span class="comment">//       为空就直接返回</span></span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        将当前结点压入栈</span></span><br><span class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        stack.push(head);</span><br><span class="line">        <span class="keyword">while</span>(!stack.isEmpty())&#123;</span><br><span class="line"><span class="comment">//            栈顶元素出栈，并记录下该结点</span></span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">node</span> <span class="operator">=</span> stack.pop();</span><br><span class="line">            System.out.print(node.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line"><span class="comment">//            判断出栈的结点是否有右子树</span></span><br><span class="line">            <span class="keyword">if</span>(node.right!=<span class="literal">null</span>)&#123;</span><br><span class="line">                stack.push(node.right);</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//            判断出栈的结点是否有左子树</span></span><br><span class="line">            <span class="keyword">if</span>(node.left!=<span class="literal">null</span>)&#123;</span><br><span class="line">                stack.push(node.left);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">inOrder</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span>(!stack.isEmpty()||head!=<span class="literal">null</span>)&#123;</span><br><span class="line"><span class="comment">//            将当前结点的左侧子树全部压入栈，之后head为空，但栈不为空，再执行else方法</span></span><br><span class="line">            <span class="keyword">if</span>(head!=<span class="literal">null</span>)&#123;</span><br><span class="line">                stack.push(head);</span><br><span class="line">                head = head.left;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//                将栈中元素出栈并打印，且如果该结点有右子树的话使其再次执行前一个步骤</span></span><br><span class="line">                head = stack.pop();</span><br><span class="line">                System.out.print(head.val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">                head = head.right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">postOrder</span><span class="params">(TreeNode head)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        Stack&lt;TreeNode&gt; in = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        Stack&lt;TreeNode&gt; out = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        in.push(head);</span><br><span class="line">        TreeNode node;</span><br><span class="line">        <span class="keyword">while</span>(!in.isEmpty())&#123;</span><br><span class="line">            node = in.pop();</span><br><span class="line">            out.push(node);</span><br><span class="line">            <span class="keyword">if</span>(node.left!=<span class="literal">null</span>)&#123;</span><br><span class="line">                in.push(node.left);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(node.right!=<span class="literal">null</span>)&#123;</span><br><span class="line">                in.push(node.right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(!out.isEmpty())&#123;</span><br><span class="line">            System.out.print(out.pop().val+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">1</span>);</span><br><span class="line">        head.left = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">2</span>);</span><br><span class="line">        head.right = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">3</span>);</span><br><span class="line">        head.left.left = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">4</span>);</span><br><span class="line">        head.left.right = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">5</span>);</span><br><span class="line">        head.right.left = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">6</span>);</span><br><span class="line">        head.right.right = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(<span class="number">7</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;递归先序遍历结果： &quot;</span>);</span><br><span class="line">        preTraversal(head);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;递归中序遍历结果： &quot;</span>);</span><br><span class="line">        inTraversal(head);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;递归后序遍历结果： &quot;</span>);</span><br><span class="line">        afterTraversal(head);</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;非递归先序遍历结果： &quot;</span>);</span><br><span class="line">        preOrder(head);</span><br><span class="line">        System.out.println(<span class="string">&quot;非递归中序遍历结果： &quot;</span>);</span><br><span class="line">        inOrder(head);</span><br><span class="line">        System.out.println(<span class="string">&quot;非递归后序遍历结果： &quot;</span>);</span><br><span class="line">        postOrder(head);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="遍历二叉树-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">先序遍历结果： </span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">4</span> <span class="number">5</span> <span class="number">3</span> <span class="number">6</span> <span class="number">7</span> </span><br><span class="line">中序遍历结果： </span><br><span class="line"><span class="number">4</span> <span class="number">2</span> <span class="number">5</span> <span class="number">1</span> <span class="number">6</span> <span class="number">3</span> <span class="number">7</span> </span><br><span class="line">后序遍历结果： </span><br><span class="line"><span class="number">4</span> <span class="number">5</span> <span class="number">2</span> <span class="number">6</span> <span class="number">7</span> <span class="number">3</span> <span class="number">1</span> </span><br><span class="line">非递归先序遍历结果： </span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">4</span> <span class="number">5</span> <span class="number">3</span> <span class="number">6</span> <span class="number">7</span> </span><br><span class="line">非递归中序遍历结果： </span><br><span class="line"><span class="number">4</span> <span class="number">2</span> <span class="number">5</span> <span class="number">1</span> <span class="number">6</span> <span class="number">3</span> <span class="number">7</span> </span><br><span class="line">非递归后序遍历结果： </span><br><span class="line"><span class="number">4</span> <span class="number">5</span> <span class="number">2</span> <span class="number">6</span> <span class="number">7</span> <span class="number">3</span> <span class="number">1</span> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>递归和master公式</h1><h2 id="递归">递归</h2><ul><li>递归的底层是利用<code>系统栈</code>实现的，<strong>递归的实现原理</strong>：每次递归调用都会将当前调用的参数保存在系统栈中，当递归调用返回时，系统栈中的参数会依次出栈，并返回给调用者。</li><li><strong>任何的递归都可以用非递归实现</strong>，但非递归实现不一定比递归快，改为非递归的好处是不用系统栈空间，系统栈空间相比内存栈空间更宝贵。</li><li>递归该非递归的必要性：<ul><li>工程上几乎一定要改，除非确定数据量再大，递归也一定不深，例如归并排序，快速排序，线段树等应用</li><li>算法题中能通过就不用改。</li></ul></li></ul><h2 id="Master公式">Master公式</h2><ul><li>所有<code>子问题规模相同</code>的递归才能用Master公式：T(n) = a*T(n/b) + O(N<sup>c</sup>)<ul><li>a：子问题的数量</li><li>n/b：每个子问题的规模</li><li>O(N<sup>c</sup>)：除了子问题调用外的时间复杂度</li></ul></li><li>如果log(b,a) &lt; c, 复杂度为O(N<sup>c</sup>)</li><li>如果log(b,a) &gt; c, 复杂度为O(n^log(b,a))</li><li>如果log(b,a) = c, 复杂度为O(n^c*log(n))</li></ul><h1>归并算法</h1><h2 id="归并排序">归并排序</h2><ul><li><p>归并排序的核心过程是：做部分排好序、右部分排好序，利用<code>merge</code>过程让左右整体有序</p></li><li><p>merge过程：谁小拷贝谁，直到两边的数字全部拷贝完，最后将排好序的数组拷贝回原数组</p></li><li><p>归并排序有递归实现和非递归实现</p></li><li><p>时间复杂度为O(n*logn)</p></li><li><p>需要辅助数组，空间复杂度为O(n)</p></li><li><p>归并排序为什么速度更快？因为比较行为没有浪费</p></li><li><p><em><strong>归并思路：</strong></em></p><ul><li>定义两个指针，分别指向两个有序数组的起始位置</li><li>定义一个辅助数组，用于保存排序后的结果</li><li>判断两个指针指向的元素大小，将较小的元素拷贝到辅助数组中，并移动指针，直到某一个数组的指针移动到末尾</li><li>将剩余的元素拷贝到辅助数组中</li><li>将辅助数组拷贝回原数组</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">merge</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> m, <span class="type">int</span> r)</span> &#123;</span><br><span class="line"><span class="comment">//        i记录当前操作了几个数</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> l;</span><br><span class="line"><span class="comment">//        a为指向左侧数组的指针</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> l;</span><br><span class="line"><span class="comment">//        b为指向右侧数组的指针</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> m + <span class="number">1</span>;</span><br><span class="line"><span class="comment">//        如果左侧数组和右侧数组都有数</span></span><br><span class="line">        <span class="keyword">while</span> (a &lt;= m &amp;&amp; b &lt;= r) &#123;</span><br><span class="line"><span class="comment">//            左右指针判断谁小拷贝谁，并单增</span></span><br><span class="line">            help[i++] = arr[a] &lt;= arr[b] ? arr[a++] : arr[b++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 左侧指针、右侧指针，必有一个越界、另一个不越界，将不越界的那个继续添加到辅助数组中</span></span><br><span class="line">        <span class="keyword">while</span> (a &lt;= m) </span><br><span class="line">            help[i++] = arr[a++];</span><br><span class="line">        <span class="keyword">while</span> (b &lt;= r) </span><br><span class="line">            help[i++] = arr[b++];</span><br><span class="line">        <span class="keyword">for</span> (i = l; i &lt;= r; i++) </span><br><span class="line">            arr[i] = help[i];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="递归实现">递归实现</h3><ul><li><em><strong>递归思路：</strong></em><ul><li>首先将数组定义在全局域中，方便递归调用</li><li>传入两个参数，分别为需要排序的数组的起始位置和结束位置</li><li>判断这两个参数是否相等，如果相等则直接返回，因为一个数天然有序</li><li>算出中间位置，将数组分为左右两个部分，分别对左右两个部分进行递归调用，进行排序</li><li>归并两个数组，使数组有序</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">mergeSort1</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> &#123;</span><br><span class="line"><span class="comment">//        说明只有一个元素，天然有序</span></span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        找到数组的中间值</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> (l + r) / <span class="number">2</span>;</span><br><span class="line"><span class="comment">//        对左侧进行排序</span></span><br><span class="line">        mergeSort1(l, m);</span><br><span class="line"><span class="comment">//        对右侧进行排序</span></span><br><span class="line">        mergeSort1(m + <span class="number">1</span>, r);</span><br><span class="line"><span class="comment">//        合并左右两侧数组（实际排序的方法）</span></span><br><span class="line">        merge(l, m, r);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="非递归实现">非递归实现</h3><ul><li><em><strong>非递归思路</strong></em><ul><li><strong>定数组长度</strong>:假设数组有 <code>n</code> 个元素。</li><li><strong>设置子数组的初始大小</strong>:从 <code>1</code> 开始（每次把相邻的两个“长度为1的数组”合并），然后依次翻倍：<ul><li>第一次合并长度为 <code>1</code> 的小段</li><li>第二次合并长度为 <code>2</code> 的小段</li><li>第三次合并长度为 <code>4</code> 的小段</li><li>…直到子数组大小 ≥ <code>n</code>，排序完成。</li></ul></li><li><strong>合并过程</strong><ul><li>每一轮从数组的起始位置开始，以当前子数组大小 <code>size</code> 为单位，把<strong>相邻的两段有序子数组</strong>进行合并。</li><li>合并时要小心边界：如果最后一段不足 <code>size</code>，就直接并到前一段；如果整个区间不足两段，保持不变。</li></ul></li></ul></li></ul><details class="folding-tag" blue><summary> 举例： </summary>              <div class='content'>              <p>​数组 <code>[5, 2, 8, 6, 3, 7, 4, 1]</code></p><p>​第一轮（<code>size = 1</code>）：把 <code>[5]</code> 和 <code>[2]</code> 合并 → <code>[2, 5]</code>，然后 <code>[8]</code> 和 <code>[6]</code> → <code>[6, 8]</code>，依次类推。</p><p>​第二轮（<code>size = 2</code>）：把 <code>[2, 5]</code> 和 <code>[6, 8]</code> 合并 → <code>[2, 5, 6, 8]</code>，再处理后面几段。</p><p>​第三轮（<code>size = 4</code>）：继续合并更大的有序段。</p><p>​最终得到完全有序的数组。</p>              </div>            </details><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">mergeSort2</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 一共发生O(logn)次</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> l, m, r, step = <span class="number">1</span>; step &lt; n; step &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="comment">// 内部分组merge，时间复杂度O(n)</span></span><br><span class="line">            l = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (l &lt; n) &#123;</span><br><span class="line">                m = l + step - <span class="number">1</span>;</span><br><span class="line">                <span class="comment">// 说明右侧数组不存在，直接跳出</span></span><br><span class="line">                <span class="keyword">if</span> (m + <span class="number">1</span> &gt;= n) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 当右侧数组不满够step时，将r设置为n-1，有多少排多少</span></span><br><span class="line">                r = Math.min(l + (step &lt;&lt; <span class="number">1</span>) - <span class="number">1</span>, n - <span class="number">1</span>);</span><br><span class="line">                merge(l, m, r);</span><br><span class="line">                l = r + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="总结-2">总结</h3><div class="note warning no-icon flat"><ul><li>递归版归并排序的思路是<code>先拆分再合并</code>，</li><li>非递归实现则是反过来——<code>从最小的子数组开始逐步合并，直到整个数组有序</code>。</li></ul></div><ul><li>递归实现：<ul><li>优点是代码简洁直观，可读性好</li><li>缺点是递归会消耗一定的栈空间，遇到特别大的数组时可能会超出栈空间限制</li></ul></li><li>非递归实现：<ul><li>优点是避免栈空间溢出的问题，不依赖系统调用栈，内存更可控</li><li>缺点是代码复杂度高，且逻辑不如递归直观，程序可读性更差</li></ul></li><li>选择建议：<ul><li>学习、普通场景、小规模排序 → 推荐 递归实现，简单直接。</li><li>工程实践、大规模数据、内存受限场景 → 推荐 非递归实现，更稳健。</li></ul></li></ul><h2 id="归并分治">归并分治</h2><h1>随机快速排序</h1><ul><li>随机快排的核心思想是<code>递归分治</code>，非递归快排能够实现但不常见<ul><li>先把数组<code>划分</code>为两部分</li><li>再分别对这两部分递归排序</li><li>最终合并</li></ul></li></ul><div class="note waring no-icon flat"><p>要排序数组 <code>[5, 2, 8, 6, 3]</code>：</p><ol><li>随机选一个枢轴，比如随机选到 <code>6</code></li><li>划分：<ul><li>小于等于 6 的放左边 → <code>[5, 2, 3]</code></li><li>大于 6 的放右边 → <code>[8]</code></li><li>枢轴 6 在中间</li><li>得到 <code>[5, 2, 3] | 6 | [8]</code></li></ul></li><li>递归排序 <code>[5, 2, 3]</code> → 得到 <code>[2, 3, 5]</code></li></ol></div><ul><li>排序思路：<ul><li>在数组中随机选择一个下标，将下标对应的数记为标准x，将数组分为两部分，小于标准数，大于标准数</li><li>划分为两部分后，记录下这两部分的边界位置，小于x的便捷位置为first，大于x的边界位置为last</li><li>使用临时变量left和right分别记录下边界位置，此时left和right分别指向小于x的边界位置和大于x的边界位置，left和right之前的数均为x，left之前的数都小于x，right之后的数都大于x</li><li>递归调用 函数，对小于x的边界位置和大于x的边界位置进行排序</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">quickSort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> &#123;</span><br><span class="line">    <span class="comment">//此时数组不需要排序，直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (l &gt;= r) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 随机生成一个下标，并保存该下标的值</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> arr[l + (<span class="type">int</span>) (Math.random() * (r - l + <span class="number">1</span>))];</span><br><span class="line"><span class="comment">//        根据x值进行对两边分治</span></span><br><span class="line">    partition(l, r, x);</span><br><span class="line">    <span class="comment">// 为了防止底层的递归过程覆盖全局变量</span></span><br><span class="line">    <span class="comment">// 这里用临时变量记录first、last</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> first;</span><br><span class="line">    <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> last;</span><br><span class="line"><span class="comment">//        不断对两部分进行细分、排序</span></span><br><span class="line">    quickSort(l, left - <span class="number">1</span>);</span><br><span class="line">    quickSort(right + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>划分思路：<ul><li>已知数组中一定有x这个数</li><li>设置两个边界，左边界为left，右边界为right，左边界作为小于x的边界值，右边界作为大于x的边界值</li><li>同时用变量i来记录当前操作的下标</li><li>设置循环，结束条件为i超出数组的边界</li><li>判断当前arr[i]与x的大小关系<ul><li>arr[i] &amp;lt x,则将arr[i]和arr[left]交换位置，left++，i++</li><li>arr[i] &amp;gt x,则将arr[i]和arr[right]交换位置，right–</li><li>arr[i] == x,则i++，继续判断下一个数</li></ul></li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 已知arr[l....r]范围上一定有x这个值</span></span><br><span class="line">    <span class="comment">// 划分数组 &lt;x放左边，==x放中间，&gt;x放右边</span></span><br><span class="line">    <span class="comment">// 把全局变量first, last，更新成==x区域的左右边界</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span> &#123;</span><br><span class="line">        first = l;</span><br><span class="line">        last = r;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> l;</span><br><span class="line">        <span class="keyword">while</span> (i &lt;= last) &#123;</span><br><span class="line"><span class="comment">//            相等则直接跳过，判断下一个</span></span><br><span class="line">            <span class="keyword">if</span> (arr[i] == x) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (arr[i] &lt; x) &#123;</span><br><span class="line"><span class="comment">//                交换位置，并扩大左侧边界</span></span><br><span class="line">                swap(first++, i++);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//                交换位置，并扩大右侧边界，因为交换后的值还没有判断他的大小，所以i不需要增加</span></span><br><span class="line">                swap(i, last--);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>测试链接 :<a href="https://www.luogu.com.cn/problem/P1177"> https://www.luogu.com.cn/problem/P1177</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Main函数中是输入输出处理效率很高的写法</span></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.StreamTokenizer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">MAXN</span> <span class="operator">=</span> <span class="number">100001</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span>[] arr = <span class="keyword">new</span> <span class="title class_">int</span>[MAXN];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line">        <span class="type">StreamTokenizer</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StreamTokenizer</span>(br);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PrintWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(System.out));</span><br><span class="line">        in.nextToken();</span><br><span class="line">        n = (<span class="type">int</span>) in.nval;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            in.nextToken();</span><br><span class="line">            arr[i] = (<span class="type">int</span>) in.nval;</span><br><span class="line">        &#125;</span><br><span class="line">        quickSort(<span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            out.print(arr[i] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        out.println(arr[n - <span class="number">1</span>]);</span><br><span class="line">        out.flush();</span><br><span class="line">        out.close();</span><br><span class="line">        br.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> arr[i];</span><br><span class="line">        arr[i] = arr[j];</span><br><span class="line">        arr[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">quickSort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> &#123;</span><br><span class="line">        <span class="comment">//此时数组不需要排序，直接返回</span></span><br><span class="line">        <span class="keyword">if</span> (l &gt;= r) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 随机生成一个下标，并保存该下标的值</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> arr[l + (<span class="type">int</span>) (Math.random() * (r - l + <span class="number">1</span>))];</span><br><span class="line"><span class="comment">//        根据x值进行对两边分治</span></span><br><span class="line">        partition(l, r, x);</span><br><span class="line">        <span class="comment">// 为了防止底层的递归过程覆盖全局变量</span></span><br><span class="line">        <span class="comment">// 这里用临时变量记录first、last</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> first;</span><br><span class="line">        <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> last;</span><br><span class="line"><span class="comment">//        不断对两部分进行细分、排序</span></span><br><span class="line">        quickSort(l, left - <span class="number">1</span>);</span><br><span class="line">        quickSort(right + <span class="number">1</span>, r);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 荷兰国旗问题</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> first, last;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 已知arr[l....r]范围上一定有x这个值</span></span><br><span class="line">    <span class="comment">// 划分数组 &lt;x放左边，==x放中间，&gt;x放右边</span></span><br><span class="line">    <span class="comment">// 把全局变量first, last，更新成==x区域的左右边界</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">partition</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span> &#123;</span><br><span class="line">        first = l;</span><br><span class="line">        last = r;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> l;</span><br><span class="line">        <span class="keyword">while</span> (i &lt;= last) &#123;</span><br><span class="line"><span class="comment">//            相等则直接跳过，判断下一个</span></span><br><span class="line">            <span class="keyword">if</span> (arr[i] == x) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (arr[i] &lt; x) &#123;</span><br><span class="line"><span class="comment">//                交换位置，并扩大左侧边界</span></span><br><span class="line">                swap(first++, i++);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//                交换位置，并扩大右侧边界，因为交换后的值还没有判断他的大小，所以i不需要增加</span></span><br><span class="line">                swap(i, last--);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>随机选择算法</h1><ul><li><p><code>随机选择算法（Randomized Select）</code>，一般是指 <code>快速选择算法（QuickSelect）</code> 的随机化版本，用来在无序数组中找第 k 大的元素。</p></li><li><p>这里的是第k大的元素，不是第k大的不同的元素，因此元素是可以重复数的</p></li><li><p>时间复杂度为O(n)</p></li><li><p>实现思路：</p><ul><li>随机选择一个数作为基准数来划分数组，根据这个基准数将数组分为3个部分，小于基准数，等于基准数，大于基准数</li><li>根据划分的结果，来决定继续在左边还是右边递归查找</li><li>只需要处理一边的子数组，所以时间复杂度相比快排更小</li></ul></li></ul><h1>堆结构和堆排序</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;从社会实验到算法&lt;/h1&gt;
&lt;div class=&quot;note no-icon flat&quot;&gt;&lt;p&gt;一开始有100个人，每个人都有100元&lt;br&gt;
在每一轮都做如下的事情 :&lt;br&gt;
每个人都必须拿出1元钱给除自己以外的其他人，给谁完全随机&lt;br&gt;
如果某个人在这一轮的钱数为</summary>
      
    
    
    
    
    <category term="数据结构" scheme="https://silvan2077.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>数据库概述</title>
    <link href="https://silvan2077.github.io/2025/09/10/Mysql-mysql/"/>
    <id>https://silvan2077.github.io/2025/09/10/Mysql-mysql/</id>
    <published>2025-09-10T08:39:43.000Z</published>
    <updated>2025-09-18T05:03:24.054Z</updated>
    
    <content type="html"><![CDATA[<h1>数据库是什么</h1><ul><li>数据库是一门独立的学科，只要是做软件开发的，都要学数据库。</li><li><strong>数据库是“按照数据结构来组织、存储和管理数据的仓库”</strong>。是一个长期存储在计算机内的、有组织的、可共享的、统一管理的大量数据的集合,数据库的英文是DataBase，简称DB。</li><li>它的存储空间很大，可以存放百万条、千万条、上亿条数据。</li><li>数据库并不是随意地将数据进行存放，数据的存放有一定的规则，否则查询的效率会很低。</li><li>当今世界是一个充满着数据的互联网世界，充斥着大量的数据。即这个互联网世界就是数据世界。数据的来源有很多，比如出行记录、消费记录、浏览的网页、发送的消息等等。除了文本类型的数据，图像、音乐、声音都是数据。</li><li><strong>数据库来帮助我们管理数据，同时数据库能够为我们提供高效的访问性能。</strong></li></ul><h1>2. 数据库类型</h1><ul><li><p>关系型数据库</p><ul><li>关系型数据库是<strong>依据关系模型</strong>来创建的数据库。所谓关系模型就是“一对一、一对多、多对多”等关系模型，关系模型就是指二维表格模型，因而一个关系型数据库就是由二维表及其之间的联系组成的一个数据组织。</li><li>关系型数据可以很好地存储一些关系模型的数据，比如一个老师对应多个学生的数据（“多对多”），一本书对应多个作者（“一对多”），一本书对应一个出版日期（“一对一”）。</li><li>关系模型包括数据结构（数据存储的问题，二维表）、操作指令集合（SQL语句）、完整性约束(表内数据约束、表与表之间的约束)。</li></ul></li><li><p>非关系型数据库（NoSQL）</p><ul><li>NoSQL，泛指非关系型的数据库。随着互联网web2.0网站的兴起，传统的关系数据库在处理web2.0网站，特别是超大规模和高并发的SNS类型的web2.0纯动态网站已经显得力不从心，出现了很多难以克服的问题，而非关系型的数据库则由于其本身的特点得到了非常迅速的发展。</li><li>NoSQL数据库的产生就是为了解决<strong>大规模数据集合多重数据种类</strong>带来的挑战，特别是大数据应用难题。NoSQL最常见的解释是“non-relational”， “Not Only SQL”也被很多人接受。</li><li>NoSQL仅仅是一个概念，泛指非关系型的数据库，区别于关系数据库，它们不保证关系数据的ACID特性。NoSQL是一项全新的数据库革命性运动，其拥护者们提倡运用非关系型的数据存储，相对于铺天盖地的关系型数据库运用，这一概念无疑是一种全新的思维的注入。</li><li>NoSQL有如下优点：<strong>易扩展</strong>，NoSQL数据库种类繁多，但是一个共同的特点都是去掉关系数据库的关系型特性。数据之间无关系，这样就非常容易扩展。无形之间也在架构的层面上带来了可扩展的能力。大数据量，高性能，NoSQL数据库都具有非常高的读写性能，尤其在大数据量下，同样表现优秀。这得益于它的无关系性，数据库的结构简单。</li></ul></li></ul><h2 id="数据库管理系统">数据库管理系统</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;数据库是什么&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;数据库是一门独立的学科，只要是做软件开发的，都要学数据库。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;数据库是“按照数据结构来组织、存储和管理数据的仓库”&lt;/strong&gt;。是一个长期存储在计算机内的、有组织的、可共享的、统一管理的大量数</summary>
      
    
    
    
    <category term="java" scheme="https://silvan2077.github.io/categories/java/"/>
    
    
    <category term="Mysql" scheme="https://silvan2077.github.io/tags/Mysql/"/>
    
    <category term="数据库" scheme="https://silvan2077.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>数据结构基础代码实现</title>
    <link href="https://silvan2077.github.io/2025/09/08/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/"/>
    <id>https://silvan2077.github.io/2025/09/08/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/</id>
    <published>2025-09-08T05:21:51.000Z</published>
    <updated>2025-09-18T05:02:37.731Z</updated>
    
    <content type="html"><![CDATA[<h1>线性表</h1><div class="note danger no-icon flat"><p><strong>线性表：零个或多个数据元素的有限序列</strong></p></div><ul><li>线性表是最基础的数据结构，它是一种线性结构，即数据元素之间是一对一的关系，线性表一般需要包含以下功<ul><li><strong>初始化线性表：</strong> 将一个线性表进行初始化，得到一个全新的线性表。</li><li><strong>获取指定位置上的元素：</strong> 直接获取线性表指定位置<code>i</code>上的元素。</li><li><strong>检查线性表是否为空表：</strong> 检查线性表是否为空表。</li><li><strong>获取元素的位置：</strong> 获取某个元素在线性表上的位置<code>i</code>。</li><li><strong>插入元素：</strong> 在指定位置<code>i</code>上插入一个元素。</li><li><strong>删除元素：</strong> 删除指定位置<code>i</code>上的一个元素。</li><li><strong>获取长度：</strong> 返回线性表的长度。</li></ul></li></ul><h2 id="顺序表">顺序表</h2><p>顺序表是利用数组实现的，采用顺序存储结构的线性表</p><h3 id="初始化顺序表">初始化顺序表</h3><p>1.首先定义一个结构体类型，将可能用到的数据保存在一起,以<code>int类型</code>为例</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> E;  <span class="comment">//这里为int类型起别名，这样可以方便随时切换元素的类型</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">List</span> &#123;</span></span><br><span class="line">    E <span class="built_in">array</span>[<span class="number">10</span>];   <span class="comment">//实现顺序表的底层数组</span></span><br><span class="line">    <span class="type">int</span> capacity;   <span class="comment">//表示底层数组的容量（可存储长度）</span></span><br><span class="line">    <span class="type">int</span> size;   <span class="comment">//表示当前线性表中的元素个数（已存储长度）</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>2.为了使用方便将List结构体的指针取别名</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这里起什么别名都可以，这里起的别名是ArrayList</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">List</span>* <span class="title">ArrayList</span>;</span> </span><br></pre></td></tr></table></figure><p>3.逐个完善线性表的功能，先完成线性表初始化操作</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//因为初始化操作是一定要改变最初线性表的容量的，所以这里传入的参数是线性表指针，结构指针已经在前面重命名过了</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">initList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">list</span>-&gt;capacity = <span class="number">10</span>;    <span class="comment">//直接将数组的容量设定为10即可</span></span><br><span class="line">    <span class="built_in">list</span>-&gt;size = <span class="number">0</span>;         <span class="comment">//初始时，表中没有元素，所以元素数量为0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.在刚才的初始化函数中，我们简单的将数组容量设为10，但线性表容量的设置应该根据实际情况来定，这里我们使用<code>动态扩容</code>，直接用一个<code>指针</code>来指向底层数组的内存区域，当装不下时，创建一个更大的内存空间来存放数据，以此来实现动态扩容。同时创建更大的内存空间也有失败的可能，所以此处应当返回一个结果告诉调用者是否扩容成功，修改前面的代码：</p><div class="tabs" id="顺序存储结构"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#顺序存储结构-1">List</button></li><li class="tab"><button type="button" data-href="#顺序存储结构-2">initList</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="顺序存储结构-1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">List</span> &#123;</span></span><br><span class="line">    E * <span class="built_in">array</span>;   <span class="comment">//指向顺序表的底层数组</span></span><br><span class="line">    <span class="type">int</span> capacity;   <span class="comment">//数组的容量</span></span><br><span class="line">    <span class="type">int</span> size;   <span class="comment">//表中的元素数量</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="顺序存储结构-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">_Bool</span> <span class="title function_">initList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//初始生成容量为10的空间</span></span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span> = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(E) * <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;<span class="built_in">array</span> == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">//需要判断如果申请的结果为NULL的话表示内存空间申请失败</span></span><br><span class="line">    <span class="built_in">list</span>-&gt;capacity = <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">list</span>-&gt;size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;   <span class="comment">//正常情况下返回true也就是1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="实现插入操作">实现插入操作</h3><ul><li>先设计好函数的参数和返回值</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//list就是待操作的表</span></span><br><span class="line"><span class="comment">//element就是需要插入的元素</span></span><br><span class="line"><span class="comment">//index就是插入的位置（注意顺序表的index是按位序计算的，从1开始，一般都是第index个元素）</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">insertList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>按照先前的思路编写代码<ul><li>先不断循环找到要插入的位置</li><li>找到后，将要插入位置以后的元素全部向后移动一位</li><li>移动后空出一位，将新元素插入</li><li>成功插入后，更新长度</li></ul></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">insertList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="comment">//size指示当前元素的最后一位，不断向前遍历，直到index位置</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="built_in">list</span>-&gt;size; i &gt; index - <span class="number">1</span>; i--)&#123; </span><br><span class="line">        <span class="comment">//将Index位置后的元素全部向后挪一位</span></span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] = <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[index - <span class="number">1</span>] = element;    <span class="comment">//挪完之后，位置就腾出来了，直接设定即可</span></span><br><span class="line">    <span class="built_in">list</span>-&gt;size++;   <span class="comment">//插入之后相当于多了一个元素，记得size + 1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="判断数据合法性">判断数据合法性</h3><ul><li>此时正常插入便能成功进行，但如果我们在非法位置插入元素依旧会有问题,比如这个位置小于0或者大于现在的元素数量，故我们应当检查插入位置是否合法</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250903180158.png"/></div></div><ul><li>转换成位序，也就是[1, size + 1]这个闭区间，所以我们在一开始的时候进行判断：</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">_Bool</span> <span class="title function_">insertList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="comment">//如果在非法位置插入，返回0表示插入操作执行失败</span></span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size + <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;   </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="built_in">list</span>-&gt;size; i &gt; index - <span class="number">1</span>; i--)</span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] = <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[index - <span class="number">1</span>] = element;</span><br><span class="line">    <span class="built_in">list</span>-&gt;size++;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;   <span class="comment">//正常情况返回1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="扩容线性表">扩容线性表</h3><ul><li>刚才只是说明了扩容的方法，现在我们来实现一下，判断size是否等于capacity，如果等于，则需要扩容。</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">_Bool</span> <span class="title function_">insertList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size + <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//如果当前元素数量等于容量，则需要扩容</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;size == <span class="built_in">list</span>-&gt;capacity) &#123; </span><br><span class="line">        <span class="comment">//这里用一个位运算，表示新容量是原先容量的1.5倍</span></span><br><span class="line">        <span class="type">int</span> newCapacity = <span class="built_in">list</span>-&gt;capacity + (<span class="built_in">list</span>-&gt;capacity &gt;&gt; <span class="number">1</span>);  </span><br><span class="line">        <span class="comment">//这里使用新的函数realloc重新申请更大的内存空间 </span></span><br><span class="line">        E * newArray = <span class="built_in">realloc</span>(<span class="built_in">list</span>-&gt;<span class="built_in">array</span>, <span class="keyword">sizeof</span>(E) * newCapacity);  </span><br><span class="line">        <span class="keyword">if</span>(newArray == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;   <span class="comment">//如果申请失败，那么就确实没办法插入了，只能返回0表示插入失败了</span></span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span> = newArray;</span><br><span class="line">        <span class="built_in">list</span>-&gt;capacity = newCapacity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//扩容成功后，线性表就能和之前一样插入元素了</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="built_in">list</span>-&gt;size; i &gt; index - <span class="number">1</span>; i--)</span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] = <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[index - <span class="number">1</span>] = element;</span><br><span class="line">    <span class="built_in">list</span>-&gt;size++;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><details class="folding-tag" yellow><summary> relloc函数 </summary>              <div class='content'>              <p>函数原型：<code>void* relloc(void* memblock, size_t size)</code></p><ul><li>relloc函数返回的是void*类型的指针，指向新开辟的内存块的起始地址。</li><li>memblock是需要扩容的内存块指针，如果原本的内存块之后又足够的空间可以追加，则直接追加，否则会开辟新的空间并返回</li><li>size是新的内存块大小，注意是新的，而不是新增加的。</li><li>如果memblock是NULL，那么就相当于malloc函数，申请一个新的内存块。</li><li>如果size是0，那么就相当于free函数，释放掉memblock指向的内存块。</li></ul>              </div>            </details><h3 id="删除元素">删除元素</h3><p>删除操作与插入操作类似，当删除元素时，需要对元素进行批量移动，但是不需要考虑扩容问题了。</p><ul><li>先设计函数的返回值和参数</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//list就是待操作的表，index是要删除的元素位序</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">deleteList</span><span class="params">(ArrayList <span class="built_in">list</span>, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure><ul><li>删除和插入一样，需要考虑位置的合法性</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250908204800.png"/></div></div><ul><li>换算成位序就是[1, size]这个闭区间内容</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">_Bool</span> <span class="title function_">deleteList</span><span class="params">(ArrayList <span class="built_in">list</span>, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="comment">//保证位置合法</span></span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//执行删除操作</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = index - <span class="number">1</span>; i &lt; <span class="built_in">list</span>-&gt;size - <span class="number">1</span>; ++i)</span><br><span class="line">    <span class="comment">//实际上只需要依次把后面的元素覆盖到前一个即可</span></span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] = <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i + <span class="number">1</span>];   </span><br><span class="line">    <span class="built_in">list</span>-&gt;size--;   <span class="comment">//最后别忘了size - 1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="获取长度">获取长度</h3><p>获取顺序表长度的操作非常简单，只需要返回当前Size即可</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sizeList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>-&gt;size;   <span class="comment">//直接返回size就完事</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="查找元素">查找元素</h3><p>查找元素在线性表中，需要遍历线性表，当出现目标元素时，返回该元素的索引，否则返回-1</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">findList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">list</span>-&gt;size; ++i) &#123;   <span class="comment">//一直遍历，如果找到那就返回位序</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] == element) <span class="keyword">return</span> i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;  <span class="comment">//如果遍历完了都没找到，那么就返回-1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>按位置获取元素，这是线性表的一个基本操作，直接返回索引值即可</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">E * <span class="title function_">getList</span><span class="params">(ArrayList <span class="built_in">list</span>, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="comment">//判断位置是否在线性表中</span></span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size) </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;   <span class="comment">//如果超出范围就返回NULL</span></span><br><span class="line">    <span class="keyword">return</span> &amp;<span class="built_in">list</span>-&gt;<span class="built_in">array</span>[index - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="顺序表完整代码">顺序表完整代码</h3><div class="tabs" id="顺序表"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#顺序表-1">基础函数</button></li><li class="tab"><button type="button" data-href="#顺序表-2">完整代码</button></li><li class="tab"><button type="button" data-href="#顺序表-3">输出结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="顺序表-1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始化顺序表</span></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">initList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span>;</span><br><span class="line"><span class="comment">// 插入元素</span></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">insertList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element, <span class="type">int</span> index)</span></span><br><span class="line"><span class="comment">// 删除元素</span></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">deleteList</span><span class="params">(ArrayList <span class="built_in">list</span>, <span class="type">int</span> index)</span></span><br><span class="line"><span class="comment">// 获取顺序表长度</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sizeList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span></span><br><span class="line"><span class="comment">// 获取指定位置的元素</span></span><br><span class="line">E * <span class="title function_">getList</span><span class="params">(ArrayList <span class="built_in">list</span>, <span class="type">int</span> index)</span></span><br><span class="line"><span class="comment">// 查找元素下标</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">findList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element)</span></span><br><span class="line"><span class="comment">// 打印当前线性表</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">printList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="顺序表-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> E;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">List</span> &#123;</span></span><br><span class="line">    E * <span class="built_in">array</span>;</span><br><span class="line">    <span class="type">int</span> capacity;</span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">List</span> * <span class="title">ArrayList</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">initList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span> = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(E) * <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;<span class="built_in">array</span> == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">list</span>-&gt;capacity = <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">list</span>-&gt;size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">insertList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size + <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;size == <span class="built_in">list</span>-&gt;capacity) &#123;</span><br><span class="line">        <span class="type">int</span> newCapacity = <span class="built_in">list</span>-&gt;capacity + (<span class="built_in">list</span>-&gt;capacity &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        E * newArray = <span class="built_in">realloc</span>(<span class="built_in">list</span>-&gt;<span class="built_in">array</span>, newCapacity * <span class="keyword">sizeof</span>(E));</span><br><span class="line">        <span class="keyword">if</span>(newArray == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span> = newArray;</span><br><span class="line">        <span class="built_in">list</span>-&gt;capacity = newCapacity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="built_in">list</span>-&gt;size; i &gt; index - <span class="number">1</span>; --i)</span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] = <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[index - <span class="number">1</span>] = element;</span><br><span class="line">    <span class="built_in">list</span>-&gt;size++;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">deleteList</span><span class="params">(ArrayList <span class="built_in">list</span>, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = index - <span class="number">1</span>; i &lt; <span class="built_in">list</span>-&gt;size - <span class="number">1</span>; ++i)</span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] = <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">list</span>-&gt;size--;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sizeList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>-&gt;size;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">E * <span class="title function_">getList</span><span class="params">(ArrayList <span class="built_in">list</span>, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[index - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">findList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">list</span>-&gt;size; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] == element) <span class="keyword">return</span> i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">printList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span>&#123;   <span class="comment">//编写一个函数用于打印表当前的数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">list</span>-&gt;size; ++i)   <span class="comment">//表里面每个元素都拿出来打印一次</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">List</span> <span class="title">list</span>;</span></span><br><span class="line">    ArrayList arraylist =&amp;<span class="built_in">list</span>;</span><br><span class="line">    <span class="keyword">if</span>(initList(arraylist))&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        //测试初始化结果</span></span><br><span class="line"><span class="comment">//        printf(arraylist-&gt;capacity);</span></span><br><span class="line"><span class="comment">//        printf(arraylist-&gt;size);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//测试插入操作</span></span><br><span class="line">        insertList(arraylist, <span class="number">666</span>, <span class="number">1</span>);  <span class="comment">//每次插入操作后都打印一下表，看看当前的情况</span></span><br><span class="line">        printList(arraylist);</span><br><span class="line">        insertList(arraylist, <span class="number">777</span>, <span class="number">1</span>);</span><br><span class="line">        printList(arraylist);</span><br><span class="line">        insertList(arraylist, <span class="number">888</span>, <span class="number">2</span>);</span><br><span class="line">        printList(arraylist);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//测试删除操作</span></span><br><span class="line">        <span class="keyword">if</span>(deleteList(arraylist,<span class="number">1</span>))</span><br><span class="line">            printList(arraylist);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;删除失败，未找到该元素&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(deleteList(arraylist,<span class="number">2</span>))</span><br><span class="line">            printList(arraylist);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;删除失败，未找到该元素&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取顺序表长度</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,sizeList(arraylist));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取指定位置的元素</span></span><br><span class="line">        <span class="type">int</span> i=<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;第%d个元素的位置为%d\n&quot;</span>,i,getList(arraylist,i));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//查找元素下标</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;666的下标为：%d\n&quot;</span>,findList(arraylist,<span class="number">666</span>));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;888的下标为：%d\n&quot;</span>,findList(arraylist,<span class="number">888</span>));</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;顺序表初始化失败，无法启动程序！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="顺序表-3"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">666</span> </span><br><span class="line"><span class="number">777</span> <span class="number">666</span> </span><br><span class="line"><span class="number">777</span> <span class="number">888</span> <span class="number">666</span> </span><br><span class="line"><span class="number">888</span> <span class="number">666</span> </span><br><span class="line"><span class="number">888</span> </span><br><span class="line"><span class="number">1</span></span><br><span class="line">第<span class="number">1</span>个元素的位置为<span class="number">888</span></span><br><span class="line"><span class="number">666</span>的下标为：<span class="number">-1</span></span><br><span class="line"><span class="number">888</span>的下标为：<span class="number">1</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note warning no-icon flat"><p>在使用printf时要严格格式化字符串，我在使用时因太长时间未用C语言，直接使用了<code>printf(arraylist-&gt;size)</code>导致一直报错而不知道原因是什么，此处是因为传过去的值，系统会将其当做地址使用，结果就是乱掉甚至崩溃，应当写成<code>printf(&quot;%d&quot;,arraylist-&gt;size)</code></p></div><p><strong>问题：</strong> 请问顺序实现的线性表，插入、删除、获取元素操作的时间复杂度为？</p><ul><li><strong>插入：</strong> 因为要将后续所有元素都向后移动，所以平均时间复杂度为 O(n)</li><li><strong>删除：</strong> 同上，因为要将所有元素向前移动，所以平均时间复杂度为 O(n)</li><li><strong>获取元素：</strong> 因为可以利用数组特性直接通过下标访问到对应元素，所以时间复杂度为 O(1)</li></ul><h2 id="单链表">单链表</h2><ul><li>尝试编写一个带头结点的链表：</li></ul><h3 id="初始化链表">初始化链表</h3><ul><li>先定义链表的节点：</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> E;   <span class="comment">//这个还是老样子</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> &#123;</span></span><br><span class="line">    E element;              <span class="comment">//数据域：保存元素数据</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">next</span>;</span> <span class="comment">//指针域：指向下一个结点的指针</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">Node</span>;</span>   <span class="comment">//这里我们直接为结点指针起别名，可以直接作为表实现</span></span><br></pre></td></tr></table></figure><ul><li>完成链表的初始化</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义初始化函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">initList</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    head-&gt;next = <span class="literal">NULL</span>;   <span class="comment">//头结点默认下一个为NULL</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//这里创建一个新的头结点，头结点不存放任何元素，只做连接，连接整个链表</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> <span class="title">head</span>;</span>   </span><br><span class="line">    initList(head);  <span class="comment">//先进行初始化</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="链表的插入和删除">链表的插入和删除</h3><ul><li>按照以下步骤进行插入<ul><li>首先先将要插入的节点的后继节点指向原本这个位置的节点</li><li>然后将插入位置的前驱结点的后继结点指向改为要插入的节点</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/07/23/ysETUJb6cgBz2Qx.png"/></div></div><ul><li>首先来设计函数</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//head是头结点</span></span><br><span class="line"><span class="comment">//element为待插入元素</span></span><br><span class="line"><span class="comment">//index是待插入下标</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">insertList</span><span class="params">(Node head, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>接着要想插入，需要先找到待插入结点的前驱结点</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//返回值来告诉调用者是否插入成功</span></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">insertList</span><span class="params">(Node head, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;   <span class="comment">//如果插入的位置小于1，那肯定是非法的</span></span><br><span class="line">    <span class="keyword">while</span> (--index) &#123;   <span class="comment">//通过--index的方式不断向后寻找前驱结点</span></span><br><span class="line">        head = head-&gt;next;   <span class="comment">//正常情况下继续向后找</span></span><br><span class="line">      <span class="keyword">if</span>(head == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">      <span class="comment">//如果在寻找的过程中发型已经没有后续结点了，那么说明index超出可插入的范围了，也是非法的，直接润</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>在循环操作完成后，如果没问题就能找到对应插入位置的前驱结点，我们只需要按照上面分析的操作来编写代码即可：</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">_Bool</span> <span class="title function_">insertList</span><span class="params">(Node head, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//直到index减为0，则为找到第index个结点，在此插入</span></span><br><span class="line">    <span class="keyword">while</span> (--index) &#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">      <span class="keyword">if</span>(head == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建一个新的结点,存储需要插入的值</span></span><br><span class="line">    Node node = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span> (<span class="keyword">struct</span> ListNode));</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;   <span class="comment">//创建一个新的结点，如果内存空间申请失败返回0</span></span><br><span class="line">    node-&gt;element = element;   <span class="comment">//将元素保存到新创建的结点中</span></span><br><span class="line">    node-&gt;next = head-&gt;next;   <span class="comment">//先让新插入的节点指向原本位置上的这个结点</span></span><br><span class="line">    head-&gt;next = node;   <span class="comment">//接着将前驱结点指向新的这个结点</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>这样便完成了链表的插入操作，删除操作同理，这里直接给出删除的完整代码</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">_Bool</span> <span class="title function_">deleteList</span><span class="params">(Node head, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (index--) &#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(head-&gt;next == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    Node tmp = head-&gt;next;   <span class="comment">//先拿到待删除结点</span></span><br><span class="line">    head-&gt;next = head-&gt;next-&gt;next;   <span class="comment">//直接让前驱结点指向下一个的下一个结点</span></span><br><span class="line">    <span class="built_in">free</span>(tmp);   <span class="comment">//最后使用free函数释放掉待删除结点的内存</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="其他函数">其他函数</h3><ul><li>查找元素位置</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">findList</span><span class="params">(Node head, E element)</span>&#123;</span><br><span class="line">    <span class="comment">//先找到头结点</span></span><br><span class="line">    head = head-&gt;next;    </span><br><span class="line">    <span class="type">int</span> i = <span class="number">1</span>;   <span class="comment">//计数器</span></span><br><span class="line">    <span class="keyword">while</span> (head) &#123;</span><br><span class="line">        <span class="keyword">if</span>(head-&gt;element == element) <span class="keyword">return</span> i;   <span class="comment">//如果找到，那么就返回i</span></span><br><span class="line">        head = head-&gt;next;   <span class="comment">//没找到就继续向后看</span></span><br><span class="line">        i++;   <span class="comment">//i记住要自增</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//全部遍历后依旧没找到，则返回-1表示未找到</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>查找链表长度<ul><li>其实就是遍历一遍，计数器挨个加1，最后返回计数器的值</li></ul></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sizeList</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;  <span class="comment">//从0开始</span></span><br><span class="line">    <span class="keyword">while</span> (head-&gt;next) &#123;   <span class="comment">//如果下一个为NULL那就停止</span></span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        i++;   <span class="comment">//每向后找一个就+1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>因为每次测试都要重新插入数据非常繁琐，所以这里写一个函数，用来随机为链表插入指定个数的数据</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">randomInsertHead</span><span class="params">(Node head,<span class="type">int</span> n)</span>&#123;</span><br><span class="line">    Node tempNode;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        tempNode=(Node)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ListNode));</span><br><span class="line">        tempNode-&gt;element=rand()%<span class="number">100</span>+<span class="number">1</span>;</span><br><span class="line">        tempNode-&gt;next=head-&gt;next;</span><br><span class="line">        head-&gt;next=tempNode;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>除了在头结点后面插入元素，还可以插在链表的末尾</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">randomInsertTail</span><span class="params">(Node node,<span class="type">int</span> n)</span>&#123;</span><br><span class="line">    Node tempNode;</span><br><span class="line">    Node tail;</span><br><span class="line">    <span class="keyword">if</span>(node==<span class="literal">NULL</span>)</span><br><span class="line">        tail=node;</span><br><span class="line">    <span class="keyword">while</span>(node)&#123;</span><br><span class="line">        <span class="keyword">if</span>(node-&gt;next==<span class="literal">NULL</span>)</span><br><span class="line">            tail=node;</span><br><span class="line">        node=node-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        tempNode=(Node)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ListNode));</span><br><span class="line">        tempNode-&gt;element=rand()%<span class="number">100</span>+<span class="number">1</span>;</span><br><span class="line">        tail-&gt;next=tempNode;</span><br><span class="line">        tail=tempNode;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="链表完整代码">链表完整代码</h3><div class="tabs" id="链表实现"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#链表实现-1">基本功能</button></li><li class="tab"><button type="button" data-href="#链表实现-2">完整代码</button></li><li class="tab"><button type="button" data-href="#链表实现-3">结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="链表实现-1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//初始化链表</span></span><br><span class="line">initList(Node): <span class="type">void</span></span><br><span class="line"><span class="comment">//插入元素</span></span><br><span class="line">insertList(Node, E, <span class="type">int</span>): <span class="type">_Bool</span></span><br><span class="line"><span class="comment">//删除元素</span></span><br><span class="line">deleteList(Node, <span class="type">int</span>): <span class="type">_Bool</span></span><br><span class="line"><span class="comment">//查找元素的下标</span></span><br><span class="line">findList(Node, E): <span class="type">int</span></span><br><span class="line"><span class="comment">//获取链表长度</span></span><br><span class="line">sizeList(Node): <span class="type">int</span></span><br><span class="line"><span class="comment">//获取元素</span></span><br><span class="line">getList(Node, <span class="type">int</span>): E</span><br><span class="line"><span class="comment">//为链表随机插入值(头插)</span></span><br><span class="line">randomInsertHead(Node, <span class="type">int</span>): <span class="type">void</span></span><br><span class="line"><span class="comment">//为链表随机插入值(尾插)</span></span><br><span class="line">randomInsertTail(Node, <span class="type">int</span>): <span class="type">void</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//打印链表</span></span><br><span class="line">PrintNode(Node): <span class="type">void</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="链表实现-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> E;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> &#123;</span></span><br><span class="line">    E element;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">Node</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">initList</span><span class="params">(Node node)</span>&#123;</span><br><span class="line">    node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">insertList</span><span class="params">(Node head, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (--index) &#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Node node = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ListNode));</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    node-&gt;element = element;</span><br><span class="line">    node-&gt;next = head-&gt;next;</span><br><span class="line">    head-&gt;next = node;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">deleteList</span><span class="params">(Node head, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;   <span class="comment">//大体和上面是一样的</span></span><br><span class="line">    <span class="keyword">while</span> (--index) &#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(head-&gt;next == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    Node tmp = head-&gt;next;</span><br><span class="line">    head-&gt;next = head-&gt;next-&gt;next;</span><br><span class="line">    <span class="built_in">free</span>(tmp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">E  <span class="title function_">getList</span><span class="params">(Node head, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">while</span> (--index);</span><br><span class="line">    <span class="keyword">return</span> head-&gt;element;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">findList</span><span class="params">(Node head, E element)</span>&#123;</span><br><span class="line">    head = head-&gt;next;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (head) &#123;</span><br><span class="line">        <span class="keyword">if</span>(head-&gt;element == element) <span class="keyword">return</span> i;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sizeList</span><span class="params">(Node head)</span>&#123;</span><br><span class="line">    <span class="comment">//因为链表包含头结点，如果不为空，计算头结点后链表依旧是从0开始计算</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> (head) &#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">randomInsertHead</span><span class="params">(Node head,<span class="type">int</span> n)</span>&#123;</span><br><span class="line">    Node tempNode;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        tempNode=(Node)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ListNode));</span><br><span class="line">        tempNode-&gt;element=rand()%<span class="number">100</span>+<span class="number">1</span>;</span><br><span class="line">        tempNode-&gt;next=head-&gt;next;</span><br><span class="line">        head-&gt;next=tempNode;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">randomInsertTail</span><span class="params">(Node node,<span class="type">int</span> n)</span>&#123;</span><br><span class="line">    Node tempNode;</span><br><span class="line">    Node tail;</span><br><span class="line">    <span class="keyword">if</span>(node==<span class="literal">NULL</span>)</span><br><span class="line">        tail=node;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//先遍历找到链表尾端</span></span><br><span class="line">    <span class="keyword">while</span>(node)&#123;</span><br><span class="line">        <span class="keyword">if</span>(node-&gt;next==<span class="literal">NULL</span>)</span><br><span class="line">            tail=node;</span><br><span class="line">        node=node-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        tempNode=(Node)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ListNode));</span><br><span class="line">        tempNode-&gt;element=rand()%<span class="number">100</span>+<span class="number">1</span>;</span><br><span class="line">        tail-&gt;next=tempNode;</span><br><span class="line">        tail=tempNode;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PrintNode</span><span class="params">(Node node)</span>&#123;</span><br><span class="line">    Node p = node-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(p != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, p-&gt;element);</span><br><span class="line">        p = p-&gt;next;  <span class="comment">// 移动到下一个节点</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//必须写在主函数中只执行一次，否则如果两次调用间隔小于 1 秒，会导致随机数种子相同，生成完全相同的随机数序列</span></span><br><span class="line">    srand(time(<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//开辟的是结构体占用的空间二不能填Node，Node是指针所占空间固定</span></span><br><span class="line">    Node head =(Node)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ListNode));</span><br><span class="line"></span><br><span class="line">    initList(head);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;头插后： &quot;</span>);</span><br><span class="line">    randomInsertHead(head,<span class="number">15</span>);</span><br><span class="line">    PrintNode(head);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;尾插后： &quot;</span>);</span><br><span class="line">    randomInsertTail(head,<span class="number">10</span>);</span><br><span class="line">    PrintNode(head);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;插入元素22后： &quot;</span>);</span><br><span class="line">    insertList(head,<span class="number">22</span>,<span class="number">1</span>);</span><br><span class="line">    PrintNode(head);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;删除第二个元素后: &quot;</span>);</span><br><span class="line">    deleteList(head,<span class="number">2</span>);</span><br><span class="line">    PrintNode(head);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;查找22这个元素的位置： %d&quot;</span>,findList(head,<span class="number">22</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;返回链表长度： %d&quot;</span>,sizeList(head));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;获取第一个元素： %d&quot;</span>, getList(head,<span class="number">1</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="链表实现-3"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250909185532.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><details class="folding-tag" yellow><summary> 最开始我遇到的错误 </summary>              <div class='content'>              <ul><li>为链表开辟内存部分，我直接使用了<code>Node head =(Node)malloc(sizeof(Node))</code>，Node是指针，所占大小是固定8个字节，所以这里应该使用<code>Node head =(Node)malloc(sizeof(struct ListNode))</code></li><li>期初我将随机数种子放到了随机数值的函数中，但这样导致了如果两次<code>调用间隔小于 1 秒</code>，会导致随机数种子相同，生成完全相同的随机数序列，所以我将随机数种子放到了主函数中</li></ul>              </div>            </details><p><strong>问题：</strong> 请问链式实现的线性表，插入、删除、获取元素操作的时间复杂度为？</p><ul><li><strong>插入：</strong> 因为要寻找对应位置的前驱结点，所以平均时间复杂度为O(n)<em>O</em>(<em>n</em>)，但是不需要做任何的移动操作，效率肯定是比顺序表要高的。</li><li><strong>删除：</strong> 同上，所以平均时间复杂度为O(n)<em>O</em>(<em>n</em>)</li><li><strong>获取元素：</strong> 由于必须要挨个向后寻找，才能找到对应的结点，所以时间复杂度为O(n)<em>O</em>(<em>n</em>)，不支持随机访问，只能顺序访问，比顺序表慢。</li></ul><div class="note warning no-icon flat"><ul><li>链表在随机访问元素时，需要通过遍历来完成，而顺序表则利用数组的特性直接访问得到<ul><li>所以读取数据多于插入或是删除数据的情况下时，使用顺序表会更好。</li></ul></li><li>顺序表在插入元素时就显得有些鸡肋了，因为需要移动后续元素，整个移动操作会浪费时间，而链表则不需要，只需要修改结点 指向即可完成插入<ul><li>所以频繁出现插入或删除的情况下，使用链表会更好。</li></ul></li></ul></div><h2 id="双向链表和循环链表">双向链表和循环链表</h2><h3 id="双向链表">双向链表</h3><ul><li>在单链表中，可以不像顺序表那样，一次申请一段连续空间，而且在插入和删除速度上也更快，但是当我们想要操作某一个结点，比如删除或是插入，那么由于单链表的性质，我们只能先去找到它的前驱结点，才能进行。</li><li>为了解决这个问题，我们让单链表不仅保存后续结点的指针，同时保存他的前驱结点的指针</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/07/24/oeXm6nyW7I9lPMf.png"/></div></div><ul><li>首先变更一下单链表的结构体和初始化方法</li></ul><div class="tabs" id="双向链表"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#双向链表-1">结构体</button></li><li class="tab"><button type="button" data-href="#双向链表-2">初始化方法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="双向链表-1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> E;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> &#123;</span></span><br><span class="line">    E element;   <span class="comment">//保存当前元素</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">next</span>;</span>   <span class="comment">//指向下一个结点的指针</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">prev</span>;</span>   <span class="comment">//指向上一个结点的指针</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">Node</span>;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="双向链表-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">initNode</span><span class="params">(Node node)</span>&#123;</span><br><span class="line">    node-&gt;next = node-&gt;prev = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="双向链表的插入和删除操作">双向链表的插入和删除操作</h3><ul><li>双向链表的插入操作，是在单链表的插入基础上,还需要连接和修改结点的前驱指针</li><li>插入操作的步骤：<ul><li>先将准备插入的结点的前驱指针和后驱指针置为NULL</li><li>将新节点的前驱指针指向插入位置的前一个结点</li><li>将新节点的后驱指针指向插入位置的结点</li><li>将插入位置的前一个结点的后驱指针指向新节点</li><li>将插入位置的结点的前驱指针指向新节点</li></ul></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 个人感觉先将要插入的结点的前驱和后继指针挂到待插入位置的结点上，再对原链表的节点进行更改更容易理解</span></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">insertDoubleList</span><span class="params">(List head,E e,<span class="type">int</span> pos)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(pos&lt;<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(--pos)&#123;</span><br><span class="line">        head=head-&gt;next;</span><br><span class="line">        <span class="comment">//代表插入的位置不合法</span></span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    List doubleList =<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> DoubleList));</span><br><span class="line">    <span class="keyword">if</span>(doubleList==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    doubleList-&gt;element=e;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    当插入位置后继结点存在时，即不是最后一个元素</span></span><br><span class="line">    <span class="keyword">if</span>(head-&gt;next)&#123;</span><br><span class="line">        doubleList-&gt;next=head-&gt;next;</span><br><span class="line">        doubleList-&gt;pre=head;</span><br><span class="line">        head-&gt;next-&gt;pre=doubleList;</span><br><span class="line">        head-&gt;next=doubleList;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        doubleList-&gt;pre=head;</span><br><span class="line">        doubleList-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">        head-&gt;next=doubleList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>删除操作相比插入操作更加简单，只需要遍历到删除的位置的前一个结点，让前一个结点与删除的后一个节点相连，最后再释放掉要删除的结点即可</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">_Bool</span> <span class="title function_">deleteList</span><span class="params">(List <span class="built_in">list</span>,<span class="type">int</span> pos)</span>&#123;</span><br><span class="line">    <span class="comment">//和插入操作一样先找到要删除的位置的前一个节点</span></span><br><span class="line">    <span class="keyword">while</span>(--pos)&#123;</span><br><span class="line">        <span class="built_in">list</span>=<span class="built_in">list</span>-&gt;next;</span><br><span class="line">        <span class="comment">//说明下标不合法</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">list</span>==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//说明删除位置没有元素</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">list</span>-&gt;next)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//记录一下要删除的节点，最后释放该节点</span></span><br><span class="line">    List temp=<span class="built_in">list</span>-&gt;next;</span><br><span class="line">    <span class="comment">//如果要删除的不是最后一个元素</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;next-&gt;next)&#123;</span><br><span class="line">        <span class="built_in">list</span>-&gt;next-&gt;next-&gt;pre=<span class="built_in">list</span>;</span><br><span class="line">        <span class="built_in">list</span>-&gt;next=<span class="built_in">list</span>-&gt;next-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">list</span>-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(temp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其他操作类似，在此不过多赘述</p><h3 id="完整实现">完整实现</h3><div class="tabs" id="双向链表"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#双向链表-1">基本功能</button></li><li class="tab"><button type="button" data-href="#双向链表-2">完整代码</button></li><li class="tab"><button type="button" data-href="#双向链表-3">结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="双向链表-1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">initDoubleList(List):<span class="type">void</span></span><br><span class="line"><span class="title function_">insertDoubleList</span><span class="params">(List,E,<span class="type">int</span>)</span>:<span class="type">bool</span></span><br><span class="line"><span class="title function_">deleteList</span><span class="params">(List,<span class="type">int</span>)</span>:<span class="type">bool</span></span><br><span class="line"><span class="title function_">printList</span><span class="params">(List)</span>:<span class="type">void</span></span><br><span class="line"><span class="title function_">randomInsertHead</span><span class="params">(List,<span class="type">int</span>)</span>:<span class="type">bool</span></span><br><span class="line"><span class="title function_">findList</span><span class="params">(List,E)</span>:<span class="type">int</span></span><br><span class="line"><span class="title function_">sizeList</span><span class="params">(List)</span>:<span class="type">int</span></span><br><span class="line"><span class="title function_">getListElement</span><span class="params">(List,<span class="type">int</span>)</span>:<span class="type">int</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="双向链表-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> E;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DoubleList</span>&#123;</span></span><br><span class="line">    E element;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">DoubleList</span>* <span class="title">pre</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">DoubleList</span>* <span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">DoubleList</span>* <span class="title">List</span>;</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">initDoubleList</span><span class="params">(List <span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">list</span>-&gt;pre=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">list</span>-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">insertDoubleList</span><span class="params">(List head,E e,<span class="type">int</span> pos)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(pos&lt;<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(--pos)&#123;</span><br><span class="line">        head=head-&gt;next;</span><br><span class="line">        <span class="comment">//代表插入的位置不合法</span></span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    List doubleList =(List)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> DoubleList));</span><br><span class="line">    <span class="keyword">if</span>(doubleList==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    doubleList-&gt;element=e;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    当插入位置后继结点存在时，即不是最后一个元素</span></span><br><span class="line">    <span class="keyword">if</span>(head-&gt;next)&#123;</span><br><span class="line">        doubleList-&gt;next=head-&gt;next;</span><br><span class="line">        doubleList-&gt;pre=head;</span><br><span class="line">        head-&gt;next-&gt;pre=doubleList;</span><br><span class="line">        head-&gt;next=doubleList;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        doubleList-&gt;pre=head;</span><br><span class="line">        doubleList-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">        head-&gt;next=doubleList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">deleteList</span><span class="params">(List <span class="built_in">list</span>,<span class="type">int</span> pos)</span>&#123;</span><br><span class="line">    <span class="comment">//和插入操作一样先找到要删除的位置的前一个节点</span></span><br><span class="line">    <span class="keyword">while</span>(--pos)&#123;</span><br><span class="line">        <span class="built_in">list</span>=<span class="built_in">list</span>-&gt;next;</span><br><span class="line">        <span class="comment">//说明下标不合法</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">list</span>==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//说明删除位置没有元素</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">list</span>-&gt;next)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//记录一下要删除的节点，最后释放该节点</span></span><br><span class="line">    List temp=<span class="built_in">list</span>-&gt;next;</span><br><span class="line">    <span class="comment">//如果要删除的不是最后一个元素</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;next-&gt;next)&#123;</span><br><span class="line">        <span class="built_in">list</span>-&gt;next-&gt;next-&gt;pre=<span class="built_in">list</span>;</span><br><span class="line">        <span class="built_in">list</span>-&gt;next=<span class="built_in">list</span>-&gt;next-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">list</span>-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(temp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">printList</span><span class="params">(List <span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">list</span>=<span class="built_in">list</span>-&gt;next;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">list</span>==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">list</span>!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,<span class="built_in">list</span>-&gt;element);</span><br><span class="line">        <span class="built_in">list</span>=<span class="built_in">list</span>-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">_Bool</span> <span class="title function_">randomInsertHead</span><span class="params">(List doubleList,<span class="type">int</span> n)</span>&#123;</span><br><span class="line">    List tempList;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        tempList=(List)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> DoubleList));</span><br><span class="line">        <span class="keyword">if</span>(tempList==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        tempList-&gt;element=rand()%<span class="number">100</span>+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(doubleList-&gt;next)&#123;</span><br><span class="line">            tempList-&gt;next=doubleList-&gt;next;</span><br><span class="line">            tempList-&gt;pre=doubleList;</span><br><span class="line">            doubleList-&gt;next-&gt;pre=tempList;</span><br><span class="line">            doubleList-&gt;next=tempList;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            tempList-&gt;next=doubleList-&gt;next;</span><br><span class="line">            tempList-&gt;pre=doubleList;</span><br><span class="line"></span><br><span class="line">            doubleList-&gt;next=tempList;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">findList</span><span class="params">(List <span class="built_in">list</span>,E e)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">list</span>==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">    <span class="comment">//第一个是头结点，所以直接跳过</span></span><br><span class="line">    <span class="built_in">list</span>=<span class="built_in">list</span>-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">list</span>)&#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;element==e)</span><br><span class="line">            <span class="keyword">return</span> count;</span><br><span class="line">        <span class="built_in">list</span>=<span class="built_in">list</span>-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">sizeList</span><span class="params">(List <span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">list</span>=<span class="built_in">list</span>-&gt;next;</span><br><span class="line">    <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">list</span>)&#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="built_in">list</span>=<span class="built_in">list</span>-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">getListElement</span><span class="params">(List <span class="built_in">list</span>,<span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="comment">//找到指定位置</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;index;i++)&#123;</span><br><span class="line">        <span class="built_in">list</span>=<span class="built_in">list</span>-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>-&gt;element;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    srand(time(<span class="number">0</span>));</span><br><span class="line">    List <span class="built_in">list</span>;</span><br><span class="line">    <span class="built_in">list</span>=(List)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> DoubleList));</span><br><span class="line">    initDoubleList(<span class="built_in">list</span>);</span><br><span class="line">    randomInsertHead(<span class="built_in">list</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;随机生成长度为10的链表:\n&quot;</span>);</span><br><span class="line">    printList(<span class="built_in">list</span>);</span><br><span class="line">    insertDoubleList(<span class="built_in">list</span>,<span class="number">10</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;添加元素10后:\n&quot;</span>);</span><br><span class="line">    printList(<span class="built_in">list</span>);</span><br><span class="line">    deleteList(<span class="built_in">list</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;删除第一个元素后:\n&quot;</span>);</span><br><span class="line">    printList(<span class="built_in">list</span>);</span><br><span class="line">    <span class="type">int</span> find = findList(<span class="built_in">list</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;10位于链表第%d位\n&quot;</span>,find);</span><br><span class="line">    <span class="type">int</span> size =sizeList(<span class="built_in">list</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;该链表的长度为：%d\n&quot;</span>,size);</span><br><span class="line">    <span class="type">int</span> elem=getListElement(<span class="built_in">list</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;链表第一位元素为：%d\n&quot;</span>,elem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="双向链表-3"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">随机生成长度为<span class="number">10</span>的链表:</span><br><span class="line"><span class="number">73</span> <span class="number">19</span> <span class="number">59</span> <span class="number">65</span> <span class="number">16</span> <span class="number">47</span> <span class="number">85</span> <span class="number">59</span> <span class="number">50</span> <span class="number">51</span> </span><br><span class="line">添加元素<span class="number">10</span>后:</span><br><span class="line"><span class="number">73</span> <span class="number">10</span> <span class="number">19</span> <span class="number">59</span> <span class="number">65</span> <span class="number">16</span> <span class="number">47</span> <span class="number">85</span> <span class="number">59</span> <span class="number">50</span> <span class="number">51</span> </span><br><span class="line"><span class="number">10</span> <span class="number">19</span> <span class="number">59</span> <span class="number">65</span> <span class="number">16</span> <span class="number">47</span> <span class="number">85</span> <span class="number">59</span> <span class="number">50</span> <span class="number">51</span> </span><br><span class="line"><span class="number">10</span>位于链表第<span class="number">1</span>位</span><br><span class="line">该链表的长度为：<span class="number">10</span></span><br><span class="line">链表第一位元素为：<span class="number">10</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="循环链表">循环链表</h3><p>循环链表，这种链表实际上和前面的链表是一样的，只是它的最后一个结点，是与头结点相连的，双向链表和单向链表都可以做成这样的环形结构</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;线性表&lt;/h1&gt;
&lt;div class=&quot;note danger no-icon flat&quot;&gt;&lt;p&gt;&lt;strong&gt;线性表：零个或多个数据元素的有限序列&lt;/strong&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;线性表是最基础的数据结构，它是一种线性结构，即数据元素之间是</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>数据结构基础理解</title>
    <link href="https://silvan2077.github.io/2025/09/02/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    <id>https://silvan2077.github.io/2025/09/02/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</id>
    <published>2025-09-02T05:21:51.000Z</published>
    <updated>2025-09-18T05:02:37.742Z</updated>
    
    <content type="html"><![CDATA[<h1>绪论</h1><h2 id="基础概念和术语">基础概念和术语</h2><h3 id="数据">数据</h3><ul><li>数据：数据是<code>描述客观事物</code>的符号，是计算机可以操作的对象。<ul><li>数据不仅仅包括整型实型等<code>数值类型</code>，还包括字符及声音、图像等<code>非数值类型</code>。</li><li>对于整型、实型等数据类型，可以进行数值计算</li><li>对于字符数据类型，就需要进行非数值的处理，而声音、图像、视频等可以通过<code>编码</code>的手段变为字符数据来处理</li></ul></li></ul><h3 id="数据元素">数据元素</h3><ul><li>数据元素：是组成数据的、有一定意义的基本单位，在计算机中通常作为一个整体处理<ul><li>在人类中，数据元素为人</li><li>在畜类中，数据元素是牛、马、羊等动物</li></ul></li></ul><h3 id="数据项">数据项</h3><ul><li>数据项：数据项是数据元素的组成部分，一个数据元素可以由多个数据项组成。<ul><li>人如果作为数据元素，那么人的眼、耳、鼻、手、等部位就可以作为数据项，姓名，年龄，联系电话等也可以作为数据项，<strong>具体哪些作为数据项应当根据所处系统来决定</strong></li><li><code>数据项是数据不可分割的最小单位</code>，但在真正讨论问题时，数据元素才是数据结构建立数据模型的着眼点。就像讨论电影角色时，是针对角色整体讨论，而不是针对角色的姓名或年龄这样的“数据项”</li></ul></li></ul><h3 id="数据对象">数据对象</h3><ul><li>数据对象：是性质相同的数据元素的<code>集合</code>，是数据的子集</li><li><code>性质相同</code>：数据元素具有相同数量和类型的数据项即为性质相同。比如，人都有名字、性别、年龄等相同的数据项</li><li>数据对象是数据的子集，在实际应用中，处理的数据元素通常有相同性质，在不产生混淆的情况下，<strong>我们习惯将数据对象简称为数据</strong></li></ul><h3 id="数据结构">数据结构</h3><ul><li>数据结构：是指数据元素之间的关系，它是数据的组织形式。数据结构可以分为<code>逻辑结构</code>和<code>物理结构</code>。</li></ul><h2 id="逻辑结构与物理结构">逻辑结构与物理结构</h2><h3 id="逻辑结构">逻辑结构</h3><ul><li>逻辑结构：是指数据对象中数据元素之间的相互关系</li><li>逻辑结构分为四类：<ul><li>集合结构<ul><li>元素之间的共同属性只有<code>同属一个集合</code></li></ul></li><li>线性结构<ul><li>元素之间关系一对一，呈线状</li></ul></li><li>树形结构<ul><li>元素之间关系一对多，比如一个上司有多位下属</li></ul></li><li>图形结构<ul><li>元素之间关系多对多，比如一个人有多个朋友</li></ul></li></ul></li></ul><h3 id="物理结构">物理结构</h3><ul><li>物理结构也称为存储结构，指数据的逻辑结构在计算机中的<code>存储形式</code></li><li>数据的存储形式有两种：<ul><li>顺序存储<ul><li>将数据元素存放在地址连续的存储单元</li></ul></li><li>链式存储<ul><li>将数据元素存放在任意的存储单元，通过指针连接起来</li></ul></li></ul></li></ul><div class="note info no-icon 物理结构 flat"><p>逻辑结构是面向问题的，而物理结构是面向计算机的，其基本目标是将数据及其逻辑关系存储到计算机内存中</p></div><h1>算法</h1><h2 id="数据结构与算法的关系">数据结构与算法的关系</h2><details class="folding-tag" ><summary> 举个栗子 </summary>              <div class='content'>              <p>今天是你女友生日，你打算请女友去看爱情音乐剧，到了戏院，抬头一看——<code>《梁山伯》</code>18：00开演。嗯，怎么会是这样？一问才知，今天饰演祝英台的演员生病，所以梁山伯唱独角戏。真是搞笑了，这还有什么看头。于是你们打算去看爱情电影。到了电影院，一看海报——<code>《罗密欧》</code>，是不是名字写错了，问了才知，原来饰演朱丽叶的演员因为嫌弃演出费用太低，中途退演了。制片方考虑到已经开拍，于是就把电影名字定为《罗密欧》，主要讲男主角的心路旅程。哎，这电影还怎么看啊？</p>              </div>            </details><ul><li><strong>数据结构是<code>存储和组织数据</code>的方式</strong><ul><li>比如数组、链表、栈、队列等</li><li>它决定了数据在计算机内存里的排布方式，以及访问、插入、删除等操作的效率</li></ul></li><li><strong>算法是<code>操作数据</code>的步骤和方法</strong><ul><li>比如排序算法(快排，归并)、查找算法(二分查找)等</li><li>它决定了数据的操作效率，是解决问题的基础</li></ul></li></ul><div class="note danger no-icon flat"><p>算法需要依赖数据结构来实现，数据结构的设计往往也是为了支撑高效的算法</p></div><h2 id="特性和要求">特性和要求</h2><ul><li>算法是描述解决问题的方法</li><li><strong>算法具有五个基本特性：</strong><ul><li><code>输入</code></li><li><code>输出</code></li><li><code>有穷性</code><ul><li>主要指算法在执行有限的步骤会自动结束，且这个时间不应很长，否则算法的意义也就不大了</li></ul></li><li><code>确定性</code><ul><li>算法每一步都有确定的含义，不会出现二义性，相同的输入应当得到唯一的输出</li></ul></li><li><code>可行性</code></li></ul></li><li><strong>算法的设计要求:</strong><ul><li><code>正确性</code><ul><li>算法应当满足问题定义的要求，即算法的输出应当是满足问题要求的</li><li>但正确也有很大区别，大致分为四个层次<ul><li>第1层：没有语法错误</li><li>第2层：对于合法的输入数据能产生满足要求的结果</li><li>第3层：对于非法的输入数据能返回规格说明的结果</li><li>第4层：即使面对精心选择的，甚至刁难的测试数据也有满足要求的输出结果</li></ul></li><li>一般情况下,以层次三作为判断算法是否正确的标准</li></ul></li><li><code>可读性</code><ul><li>算法应当是容易理解的，能够被人阅读和理解</li></ul></li><li><code>健壮性</code><ul><li>算法应当对非法输入有良好的处理能力，即当输入数据不满足问题定义的要求时，算法应当能够正确地处理，而不是崩溃或产生莫名其妙的结果</li></ul></li><li><code>时间效率高</code><ul><li>算法应当在执行时间方面尽可能地高效</li></ul></li><li><code>存储量低</code><ul><li>算法应当在存储量方面尽可能地低</li></ul></li></ul></li></ul><h2 id="算法效率的度量方法">算法效率的度量方法</h2><h3 id="事后统计方法">事后统计方法</h3><ul><li>这种方法主要是通过设计好的测试程序和数据，利用计算机计时器对不同算法编制的程序的运行时间进行比较，从而确定算法效率的高低。但这种方法显然有很大的缺陷：<ul><li>必须依据算法实现编制好测试程序</li><li>时间的比较可能会因为计算机硬件和软件等环境因素而掩盖算法本身的优劣</li><li>算法测试数据设计困难，数据规模的不同对于算法的效率也有很大的影响</li></ul></li></ul><h3 id="事前分析估算法">事前分析估算法</h3><p>事前分析估算法：在计算机程序编制前，依据统计方法对算法进行估算。</p><p>经过分析，我们发现，一个用高级程序语言编写的程序在计算机上运行时所消耗的时间取决于下列因素：</p><ol><li>算法采用的策略、方法。</li><li>编译产生的代码质量。</li><li>问题的输入规模。</li><li>机器执行指令的速度。</li></ol><p>第1条当然是算法好坏的根本，第2条要由软件来支持，第4条要看硬件性能。也就是说，抛开这些与计算机硬件、软件有关的因素，一个程序的运行时间，依赖于算法的好坏和问题的输入规模。所谓问题输入规模是指输入量的多少。</p><ul><li>分析两种求和的算法：<ul><li>第一种算法：</li></ul></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i,sum <span class="number">0</span>,n <span class="number">100</span>;</span><br><span class="line"><span class="comment">/*执行1次*/</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++) <span class="comment">/* 执行了n+1次 */</span></span><br><span class="line">&#123;</span><br><span class="line">    sum sum +i;   <span class="comment">/*执行n次*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span> (<span class="string">&quot;&amp;d&quot;</span>,sum);<span class="comment">/*执行1次*/</span></span><br></pre></td></tr></table></figure><ul><li>第二种算法：</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> sum=<span class="number">0</span>,n=<span class="number">100</span>;  <span class="comment">/*执行1次*/</span></span><br><span class="line">sum=(<span class="number">1</span>+n)*n/<span class="number">2</span>;    <span class="comment">/*执行1次*/</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, sum);<span class="comment">/*执行1次*/</span></span><br></pre></td></tr></table></figure><ul><li><p>显然第一种算法，执行了更多次才得到结果，两种算法的第一条和最后一条语句一致，我们重点关注的是算法的中间部分，故忽略头尾的开销，那么这两个算法其实就是n次与1次的差距，算法好坏显而易见。</p></li><li><p>继续延伸：</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i,j x <span class="number">0</span>,sum <span class="number">0</span>,n <span class="number">100</span>; <span class="comment">/*执行一次*/</span></span><br><span class="line"><span class="keyword">for</span> (i <span class="number">1</span>;i &lt;n;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span> (j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">        X++;            <span class="comment">/*执行n×n次*/</span></span><br><span class="line">        sum+=x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,sum);       <span class="comment">/*执行一次*/</span></span><br></pre></td></tr></table></figure><ul><li>可以看到在这个算法中，循环部分代码整体执行n²次，显然对同样的输入规模n = 100，该算法运算次数更多，执行时间随着n增加也远远多于前面两个。</li><li>我们在分析算法的运行时间时，重要的是把基本操作的数量与输入规模关联起来。</li></ul><h2 id="衡量方式">衡量方式</h2><ul><li>不同的算法面对不同规模的输入数据，执行效率也有很大的差别。我们对算法引入复杂度的概念，</li><li>衡量一个算法的复杂程度用到以下两个指标<ul><li><code>时间复杂度</code></li><li><code>空间复杂度</code></li><li>我们在描述一个算法的复杂度时，其实不需要计算精确的执行次数，算出大概次数即可，这里我们使用<code>0渐进表示法</code><ul><li><code>大O符号</code>：用于描述函数渐进行为的数学符号</li></ul></li></ul></li><li><strong>推导大O阶</strong><ol><li>用常数1取代运行时间中的所有加法常数。</li><li>在修改后的运行次数函数中，只保留最高阶项。</li><li>如果最高阶项存在且不是1，则去除与这个项相乘的常数。</li></ol></li><li>在不同的复杂度下，可能n小的时候还没什么感觉，但是当n变得非常大时，差距就不是一点半点了，我们来看看常用函数的增长曲线：</li></ul><div class="tabs" id="算法的复杂度"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#算法的复杂度-1">增长曲线</button></li><li class="tab"><button type="button" data-href="#算法的复杂度-2">常见的复杂度</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="算法的复杂度-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250903152928.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="算法的复杂度-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250903153445.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>常用的时间复杂度所耗费的时间从小到大依次是：</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250903153733.png"/></div></div><h2 id="总结回顾">总结回顾</h2><ul><li><p><strong>算法的定义</strong>：算法是解决特定问题求解步骤的描述，在计算机中为指令的有限序列，并且每条指令表示一个或多个操作。</p></li><li><p><strong>算法的特性</strong>：有穷性、确定性、可行性、输入、输出。</p></li><li><p><strong>算法的设计的要求</strong>：正确性、可读性、健壮性、高效率和低存储量需求。</p></li><li><p>算法特性与算法设计容易混，需要对比记忆。</p></li><li><p><strong>算法的度量方法</strong>：事后统计方法（不科学、不准确）、事前分析估算方法。</p></li><li><p>推导大O阶：</p><ul><li>用常数1取代运行时间中的所有加法常数。</li><li>在修改后的运行次数函数中，只保留最高阶项。</li><li>如果最高阶项存在且不是1，则去除与这个项相乘的常数。</li></ul></li></ul><details class="folding-tag" cyan open><summary> 有的人认为现在CPU越来越快，根本不用考虑算法的效率优劣，实现功能即可，用户感觉不到算法好坏造成的快慢。事实是这样的吗？ </summary>              <div class='content'>              <ul><li>答案是否定的，算法的效率是非常重要的，因为算法的效率直接影响到程序的运行时间，而程序的运行时间直接影响到用户的体验。</li><li>假设在短短几年内CPU速度提高了100倍，而我们的某个程序原本可以用时间复杂度为O(n)的算法实现，却写出了O(n<sup>2</sup><br>)的程序,仅仅是因为容易写。即在O(n<sup>2</sup>)的时间复杂度算法程序下，速度其实只是提高了10倍，但在对于O(n)时间复杂度的算法是真正的提高了100倍</li></ul>              </div>            </details><h1>线性表</h1><details class="folding-tag" ><summary> blue 举个栗子 </summary>              <div class='content'>              <p>在幼儿园放学时，经常能看到老师带着小朋友们，一个拉着另一个的衣服，依次从教室出来。而且观察几次便能发现，每次小朋友的排列次序都是一样的。比如小明排在第五个，每次他便都是第五个，前面一直是那个小女孩，后面一直是那个小男孩。为什么一定要这样？<br>老师解释道，这样可以保证小朋友的安全，避免遗漏。事先规定好了，谁在谁的前面，谁在谁的后面。这样养成习惯后，如果有谁没有到位，他前面和后面的小朋友就会主动报告老师，某人不在。即使以后如果要外出到公园或博物馆等情况下，老师也可以很快地清点人数，万一有人走丢，也能在最快时间知道，及时去寻找。<br>这种排好队的组织方式，便是<code>线性表</code>。</p>              </div>            </details><h2 id="定义">定义</h2><ul><li>线性表（List）：零个或多个数据元素的<code>有限序列</code>。从名字上就能理解到，线性表是“线性”的，即数据元素之间是线性的<ul><li><code>线性表是一个序列</code>，也就是说元素之间是有序，若元素存在多个，则第一个元素无前驱，最后一个元素无后继，其他每个元素都有且只有一个前驱和后继。</li><li>如果一个小朋友去拉两个小朋友后面的衣服，那就不可以排成一队了；同样，如果一个小朋友后面的衣服，被两个甚至多个小朋友拉扯，这其实是在打架，而不是有序排队。</li><li><code>线性表是有限的</code>,小朋友班级人数是有限的，元素个数当然也是有限的。事实上，在计算机中处理的对象都是有限的，那种无限的数列，只存在于数学的概念中。</li></ul></li></ul><details class="folding-tag" ><summary> cyan yellow 判断是否为线性表 </summary>              <div class='content'>              <ul><li><p>公司的组织架构，总经理管理几个总监，每个总监管理几个经理，每个经理都有各自的下属和员工。这样的组织架构是不是线性关系呢？</p><ul><li>不是，为什么不是呢？哦，因为每一个元素，都有不只一个后继，所以它不是线性表。那种让一个总经理只管一个总监，一个总监只管一个经理，一个经理只管一个员工的公司，俗称皮包公司，岗位设置等于就是在忽悠外人。</li></ul></li><li><p>班级同学之间的友谊关系，是不是线性关系？</p><ul><li>不是，因为每个人都可以和多个同学建立友谊，不满足线性的定义。嗯？有人说爱情关系就是了。胡扯，难道每个人都要有一个爱的人和一个爱自己的人，而且他们还都不可以重复爱同一个人这样的情况出现，最终形成一个班级情感人物串联？这怎么可能，也许网络小说里可能出现，但现实中是不可能的。</li></ul></li><li><p>班级同学的点名册，是不是线性表？</p><ul><li>是，这和刚才的友谊关系是完全不同了，因为它是有限序列，也满足类型相同的特点。这个点名册（如表3-2-1所示）中，每一个元素除学生的学号外，还可以有同学的姓名、性别、出生年月什么的，这其实就是我们之前讲的数据项。在较复杂的线性表中，一个数据元素可以由若干个数据项组成。</li></ul></li><li><p>一群同学排队买演唱会门票，每人限购一张，此时排队的人群是不是线性表？</p><ul><li>是，对的。此时来了三个同学要插当中一个同学A的队，说同学A之前拿着的三个书包就是用来占位的，书包也算是在排队。如果你是后面早已来排队的同学，你们愿不愿意？肯定不愿意，书包怎么能算排队的人呢，如果这也算，我浑身上下的衣服裤子都在排队了。于是不让这三个人进来。</li><li>这里用线性表的定义来说，是什么理由？嗯，因为要相同类型的数据，书包根本不算是人，当然排队无效，三个人想不劳而获，自然遭到大家的谴责。</li></ul></li></ul>              </div>            </details><h2 id="基础功能">基础功能</h2><ul><li><p>线性表一般需要包含以下功能：</p><ul><li><strong>初始化线性表：</strong> 将一个线性表进行初始化，得到一个全新的线性表。</li><li><strong>获取指定位置上的元素：</strong> 直接获取线性表指定位置<code>i</code>上的元素。</li><li><strong>获取元素的位置：</strong> 获取某个元素在线性表上的位置<code>i</code>。</li><li><strong>插入元素：</strong> 在指定位置<code>i</code>上插入一个元素。</li></ul><ul><li><strong>删除元素：</strong> 删除指定位置<code>i</code>上的一个元素。</li><li><strong>获取长度：</strong> 返回线性表的长度。</li></ul></li><li><p>简单来说它就是列表，比如我们的菜单，我们在点菜时就需要往菜单列表中添加菜品或是删除菜品，这时列表就很有用了，因为数组长度固定、操作简单，而我们添加菜品、删除菜品这些操作又要求长度动态变化、操作多样。</p></li><li><p>实现线性表的结构一般有两种，一种是<code>顺序存储</code>实现，还有一种是<code>链式存储</code>实现，我们先来看第一种，也是最简单的的一种。</p></li></ul><h2 id="顺序存储结构">顺序存储结构</h2><ul><li>线性表的顺序存储结构，指的是用一段地址连续的存储单元依次存储线性表的数据元素</li><li>顺序存储是在内存中找了一部分空间，通过“占位”的方式，占据一定的内存空间，然后将相同数据类型的数据元素依次放到这块空地。</li><li>因为线性表的每个数据元素类型相同，所以可以<strong>使用一维数组来实现顺序存储结构</strong>。</li></ul><h3 id="存储方式">存储方式</h3><details class="folding-tag" yellow><summary> 举个栗子 </summary>              <div class='content'>              <p>在图书馆给朋友占座时，如果图书馆里空座很多，不必一定要选择第一排第一个位子，而是可以选择风水不错、适合自己的地儿。找到后，放一个书包在第一个位置，就表示从这开始，这地方暂时归我了。为了建立一个线性表，要在内存中找一块地，于是这块地的第一个位置就非常关键，它是存储空间的起始位置。</p><p>因为一共要帮五个朋友占座，所以需要占六个座。线性表中，我们估算这个线性表的<code>最大存储容量</code>，建立一个数组，数组的长度就是这个最大存储容量。</p><p>可现实中，总有那么几个不是很好学的人，为了游戏，为了恋爱，就不去图书馆自习了。假设我们六个人，去了四个，真正被使用的座位也就只是四个，另两个是空的。同样的，我们已经有了起始的位置，也有了最大的容量，于是我们可以在里面增加数据了。随着数据的插入，我们线性表的长度开始变大，不过线性表的当前长度不能超过存储容量，即数组的长度。想想也是，如果我们有九个人，只占了六个座，自然是坐不下的。</p>              </div>            </details><p>线性表顺序存储的结构代码</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAXSIZE 20</span></span><br><span class="line"><span class="comment">/*存储空间初始分配量*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> ElemType;</span><br><span class="line"><span class="comment">/*ElemType类型根据实际情况而假设为int*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class"><span class="title">E1</span> <span class="title">emType</span> <span class="title">data</span>[<span class="title">MAXSIZE</span>];</span><span class="comment">/*数组存储数据元素，最大值为MAXSIZE*/</span></span><br><span class="line"><span class="type">int</span> length;</span><br><span class="line"><span class="comment">/*线性表当前长度*/</span></span><br></pre></td></tr></table></figure><p>顺序存储结构需要三个属性：</p><ul><li>存储空间的起始位置：数组data，它的存储位置就是存储空间的存储位置。</li><li>线性表的最大存储容量：数组长度MaxSize。</li><li>线性表的当前长度：length。</li></ul><h3 id="地址计算方式">地址计算方式</h3><ul><li>线性表的起始是1，可C语言中数组的下标是从0开始的，于是线性表的第i个元素实际是存储在数组下标为i-1的位置</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250903164832.png"/></div></div><ul><li><p>用数组存储顺序表意味着要分配固定长度的数组空间，由于线性表中可以进行插入和删除操作，因此分配的数组空间要大于等于当前线性表的长度。</p></li><li><p>内存中的地址，就和图书馆或电影院里的座位一样，都是有编号的。存储器中的每个存储单元都有自己的编号，这个编号称为地址。当我们占座后，占座的第一个位置确定后，后面的位置都是可以计算的。试想一下，我是班级成绩第五名，我后面的10名同学成绩名次是多少呢？当然是6，7，…、15，因为5+1，5+2，…，5+10。由于每个数据元素，不管它是整型、实型还是字符型，它都是需要占用一定的存储单元空间的。假设占用的是c个存储单元，那么线性表中第i+1个数据元素的存储位置和第i个数据元素的存储位置满足下列关系（LOC表示获得存储位置的函数）。</p><ul><li>LOC（i+1）=LOC（i）+c</li></ul></li><li><p>所以对于第i个数据元素，其位置为：</p><ul><li>LOC（i）=LOC（i）+（i-1）*c</li></ul></li></ul><div class="note info no-icon flat"><p>通过这个公式可以随时算出线性表中任意位置的地址，不管它是第一个还是最后一个，都是相同的时间。那么我们对每个线性表位置的存入或者取出数据，对于计算机来说都是相等的时间，也就是一个常数，因此用我们算法中学到的时间复杂度的概念来说，它的存取时间性能为O(1)。我们通常把具有这一特点的存储结构称为随机存取结构。</p></div><h3 id="顺序存储结构的插入和删除">顺序存储结构的插入和删除</h3><details class="folding-tag" yellow><summary> 插入操作的事例 </summary>              <div class='content'>              <ul><li>在春运时去买火车票，大家都排队排的好好的。这时来了一个美女，对着队伍中排在第三位的你说，“大哥，求求你帮帮忙，我家母亲有病，我得急着回去看她，这队伍这么长，你可否让我排在你的前面？”你心一软，就同意了。这时，你必须得退后一步，否则她是没法进到队伍来的。这可不得了，后面的人像蠕虫一样，全部都得退一步。骂声四起。但后面的人也不清楚这加塞是怎么回事，没什么办法。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250903170636.png"/></div></div>              </div>            </details><ul><li>插入算法的思路：<ul><li>如果插入位置不合理，抛出异常；</li><li>如果线性表长度大于等于数组长度，则抛出异常或动态增加容量；</li><li>从最后一个元素开始向前遍历到第i个位置，分别将它们都向后移动一个位置；</li><li>将要插入元素填入位置i处；</li><li>表长加1。</li></ul></li></ul><details class="folding-tag" yellow><summary> 删除操作的事例 </summary>              <div class='content'>              <ul><li>接着刚才的例子。此时后面排队的人群意见都很大，都说怎么可以这样，不管什么原因，插队就是不行，有本事，找火车站开后门去。就在这时，远处跑来一胖子，对着这美女喊，可找到你了，你这骗子，还我钱。只见这女子二话不说，突然就冲出了队伍，胖子追在其后，消失在人群中。哦，原来她是倒卖火车票的黄牛，刚才还装可怜。于是排队的人群，又像蠕虫一样，均向前移动了一步，骂声渐息，队伍又恢复了平静。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250903171043.png"/></div></div>              </div>            </details><ul><li><p>删除算法的思路：</p><ul><li>如果删除位置不合理，抛出异常；</li><li>取出删除元素；</li><li>从删除元素位置开始遍历到最后一个元素位置，分别将它们都向前移动一个位置；</li><li>表长减1。</li></ul></li><li><p>分析插入和删除的时间复杂度</p><ul><li>最好的情况：如果元素要插入到最后一个位置，或者删除最后一个元素，此时时间复杂度为O(1)，因为不需要移动元素的，就如同来了一个新人要正常排队，当然是排在最后，如果此时他又不想排了，那么他一个人离开就好了，不影响任何人。</li><li>最坏的情况：如果元素要插入到第一个位置，或者删除第一个元素，此时时间复杂度为O(n)，因为需要移动n个元素。</li><li>平均情况：如果元素要插入到中间位置，或者删除中间位置的元素，此时时间复杂度为O(n)，因为需要移动n/2个元素。</li></ul></li><li><p>顺序存储结构的优缺点：</p></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250903173241.png"/></div></div><div class="note danger no-icon flat"><p>这说明线性表的顺序存储结构，在存、读数据时，不管是哪个位置，时间复杂度都是O(1)；而插入或删除时，时间复杂度都是O(n)。这就说明，<strong>它比较适合元素个数不太变化，而更多是存取数据的应用</strong>。</p></div><h3 id="顺序存储结构的实现">顺序存储结构的实现</h3><h4 id="创建一个顺序存储结构的线性表">创建一个顺序存储结构的线性表</h4><ul><li>首先定义一个结构体类型，将用到的数据保存在一起，以<code>int类型</code>为例</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> E;  <span class="comment">//这里我们的元素类型就用int为例吧，先起个别名</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">List</span> &#123;</span></span><br><span class="line">    E <span class="built_in">array</span>[<span class="number">10</span>];   <span class="comment">//实现顺序表的底层数组</span></span><br><span class="line">    <span class="type">int</span> capacity;   <span class="comment">//表示底层数组的容量</span></span><br><span class="line">    <span class="type">int</span> size;   <span class="comment">//表示当前线性表中的元素个数</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>为了使用方便，为结构体的指针取别名</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//因为是数组实现，所以就叫ArrayList，这里直接将List的指针起别名</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">List</span>* <span class="title">ArrayList</span>;</span> </span><br></pre></td></tr></table></figure><ul><li>编写线性表的初始化操作，初始化数组容量</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">initList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">list</span>-&gt;capacity = <span class="number">10</span>;   <span class="comment">//直接将数组的容量设定为10即可</span></span><br><span class="line">    <span class="built_in">list</span>-&gt;size = <span class="number">0</span>;   <span class="comment">//初始时，表中没有元素，所以元素数量为0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>刚才是直接将顺序表长度设置为10，但顺序表的长度一般为动态的，所以我们选择直接用一个<code>指针</code>来指向底层数组的内存区域，当装不下的时候，我们可以创建一个新的更大的内存空间来存放数据，这样就可以<code>实现扩容</code>了</li><li>同时初始化顺序表还有申请内存失败的可能，应当返回一个结果告诉调用者，修改一下之前的代码</li></ul><div class="tabs" id="顺序存储结构"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#顺序存储结构-1">List</button></li><li class="tab"><button type="button" data-href="#顺序存储结构-2">initList</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="顺序存储结构-1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">List</span> &#123;</span></span><br><span class="line">    E * <span class="built_in">array</span>;   <span class="comment">//指向顺序表的底层数组</span></span><br><span class="line">    <span class="type">int</span> capacity;   <span class="comment">//数组的容量</span></span><br><span class="line">    <span class="type">int</span> size;   <span class="comment">//表中的元素数量</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="顺序存储结构-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">_Bool</span> <span class="title function_">initList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span> = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>) * <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;<span class="built_in">array</span> == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">//需要判断如果申请的结果为NULL的话表示内存空间申请失败</span></span><br><span class="line">    <span class="built_in">list</span>-&gt;capacity = <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">list</span>-&gt;size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;   <span class="comment">//正常情况下返回true也就是1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="编写插入操作">编写插入操作</h4><ul><li>先设计好对应的函数</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">insertList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="comment">//list就是待操作的表，element就是需要插入的元素，index就是插入的位置（注意顺序表的index是按位序计算的，从1开始，一般都是第index个元素）</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>按照先前的思路编写代码</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">insertList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="built_in">list</span>-&gt;size; i &gt; index - <span class="number">1</span>; i--)  <span class="comment">//先使用for循环将待插入位置后续的元素全部丢到后一位</span></span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] = <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[index - <span class="number">1</span>] = element;    <span class="comment">//挪完之后，位置就腾出来了，直接设定即可</span></span><br><span class="line">    <span class="built_in">list</span>-&gt;size++;   <span class="comment">//插入之后相当于多了一个元素，记得size + 1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>测试插入函数</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">printList</span><span class="params">(ArrayList <span class="built_in">list</span>)</span>&#123;   <span class="comment">//编写一个函数用于打印表当前的数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">list</span>-&gt;size; ++i)   <span class="comment">//表里面每个元素都拿出来打印一次</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">List</span> <span class="title">list</span>;</span></span><br><span class="line">    <span class="keyword">if</span>(initList(&amp;<span class="built_in">list</span>))&#123;</span><br><span class="line">        insertList(&amp;<span class="built_in">list</span>, <span class="number">666</span>, <span class="number">1</span>);  <span class="comment">//每次插入操作后都打印一下表，看看当前的情况 </span></span><br><span class="line">        printList(&amp;<span class="built_in">list</span>);</span><br><span class="line">        insertList(&amp;<span class="built_in">list</span>, <span class="number">777</span>, <span class="number">1</span>);</span><br><span class="line">        printList(&amp;<span class="built_in">list</span>);</span><br><span class="line">        insertList(&amp;<span class="built_in">list</span>, <span class="number">888</span>, <span class="number">2</span>);</span><br><span class="line">        printList(&amp;<span class="built_in">list</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;顺序表初始化失败，无法启动程序！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="判断数据合法性">判断数据合法性</h4><ul><li>此时正常插入便能成功进行，但如果我们在非法的位置插入元素依旧会有问题,比如这个位置小于0或者大于现在的元素数量，故我们应当检查插入位置是否合法</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250903180158.png"/></div></div><ul><li>转换成位序，也就是[1, size + 1]这个闭区间，所以我们在一开始的时候进行判断：</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">_Bool</span> <span class="title function_">insertList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size + <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;   <span class="comment">//如果在非法位置插入，返回0表示插入操作执行失败</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="built_in">list</span>-&gt;size; i &gt; index - <span class="number">1</span>; i--)</span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] = <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[index - <span class="number">1</span>] = element;</span><br><span class="line">    <span class="built_in">list</span>-&gt;size++;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;   <span class="comment">//正常情况返回1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="扩容顺序表">扩容顺序表</h4><ul><li>如果我们的表已经装满了，也就是说size已经达到申请的内存空间最大的大小了，那么此时我们就需要考虑进行扩容了，否则就没办法插入新的元素了：</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">_Bool</span> <span class="title function_">insertList</span><span class="params">(ArrayList <span class="built_in">list</span>, E element, <span class="type">int</span> index)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(index &lt; <span class="number">1</span> || index &gt; <span class="built_in">list</span>-&gt;size + <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">list</span>-&gt;size == <span class="built_in">list</span>-&gt;capacity) &#123;   <span class="comment">//如果size已经到达最大的容量了，肯定是插不进了，那么此时就需要扩容了</span></span><br><span class="line">        <span class="type">int</span> newCapacity = <span class="built_in">list</span>-&gt;capacity + (<span class="built_in">list</span>-&gt;capacity &gt;&gt; <span class="number">1</span>);   <span class="comment">//我们先计算一下新的容量大小，这里我取1.5倍原长度，当然你们也可以想扩多少扩多少</span></span><br><span class="line">        E * newArray = <span class="built_in">realloc</span>(<span class="built_in">list</span>-&gt;<span class="built_in">array</span>, <span class="keyword">sizeof</span>(E) * newCapacity);  <span class="comment">//这里我们使用新的函数realloc重新申请更大的内存空间</span></span><br><span class="line">        <span class="keyword">if</span>(newArray == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;   <span class="comment">//如果申请失败，那么就确实没办法插入了，只能返回0表示插入失败了</span></span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span> = newArray;</span><br><span class="line">        <span class="built_in">list</span>-&gt;capacity = newCapacity;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="built_in">list</span>-&gt;size; i &gt; index - <span class="number">1</span>; i--)</span><br><span class="line">        <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i] = <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">list</span>-&gt;<span class="built_in">array</span>[index - <span class="number">1</span>] = element;</span><br><span class="line">    <span class="built_in">list</span>-&gt;size++;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p><code>realloc函数</code>可以做到控制动态内存开辟的大小，重新申请的内存空间大小就是我们指定的新的大小，并且原有的数据也会放到新申请的空间中，所以非常方便。当然如果因为内存不足之类的原因导致内存空间申请失败，那么会返回NULL，所以别忘了进行判断。</p></div><h2 id="链式存储结构">链式存储结构</h2><details class="folding-tag" yellow><summary> 链式存储结构的引入 </summary>              <div class='content'>              <ul><li><p>顺序存储结构最大的缺点是插入和删除操作时需要移动大量的元素，操作的时间复杂度为O(n)，这是为什么？</p><ul><li>时间复杂度这么高的原因是在顺序存储结构中，相邻两元素的存储位置也有邻居关系，编号是1,2,3,…,n,他们在内存中的位置也是紧挨着，中间没有空隙，当然不能快速介入，删除后，留下的空隙也需要马上填补上，所以需要频繁操作。</li></ul></li><li><p>如何解决问题？</p><ul><li><strong>A 同学思路</strong>:让当中每个元素之间都留有一个空位置,这样要插入时,就不至于移动。可一个空位置如何解决多个相同位置插入数据的问题呢?所以这个想法显然不行。</li><li><strong>B 同学思路</strong>:那就让当中每个元素之间都留足够多的位置,根据实际情况制定空隙大小,比如10个,这样插入时,就不需要移动了。万一 10 个空位用完了,再考虑移动使得每个位置之间都有10个空位置。如果删除,就直接删掉,把位置留空即可。这样似乎暂时解决了插入和删除的移动数据问题。可这对于超过10个同位置数据的插入,效率上还是存在问题。对于数据的遍历,也会因为空位置太多而造成判断时间上的浪费。而且显然这里空间复杂度还增加了,因为每个元素之间都有若干个空位置。</li><li><strong>C 同学思路</strong>:我们反正也是要让相邻元素间留有足够余地,那干脆所有的元素都不要考虑相邻位置了,哪有空位就到哪里,而只是让每个元素知道它下一个元素的位置在哪里,这样,我们可以在第一个元素时,就知道第二个元素的位置(内存地址),而找到它;在第二个元素时,再找到第三个元素的位置(内存地址)。这样所有的元素我们就都可以通过遍历而找到。</li></ul></li></ul><div class="note danger flat"><p>这里C同学的思路便是链表的雏形，链式存储结构就是基于这个思路的。<br>链式存储结构中，每个结点都存储一个数据，以及一个指向下一个元素的指针。这样，我们只需要一个指针就可以找到任意一个元素，从而实现数据的遍历。</p></div>              </div>            </details><h3 id="链表结构">链表结构</h3><ul><li><p>链表中，对于数据元素a<sub>i</sub>来说，除了存储其本身的数据信息，还需要存储一个指示其直接后继的信息，我们把存储数据元素信息的域称为<code>数据域</code>，把存储直接后继位置的域称为<code>指针域</code>。指针域中存储的信息称做<code>指针</code>或<code>链</code>。这两部分信息组成数据元素a<sub>i</sub>的存储映像，称为<code>结点</code>（Node）。</p></li><li><p>对于线性表来说，总得有头有尾，链表也不例外，我们通常将链表中第一个结点的存储位置叫做<code>头指针</code>，整个链表的存取必须是从头指针开始进行。之后的每一个结点，其实就是上一个的后继指针指向的位置,知到最后一个检点指针为&quot;空&quot;(通常用NULL或“^”符号表示)</p></li><li><p>同时为了更方便的对链表进行操作，在单链表的第一个节点前还会添加一个头结点，这个头结点不存储数据，只存储一个指针域，这个指针域指向第一个结点。</p></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904142858.png"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904143305.png"/></div></div><h3 id="单链表的读取">单链表的读取</h3><ul><li>在线性表的顺序存储结构中，我们要计算任意一个元素的存储位置非常容易。但在单链表中，由于第i个元素到底在哪个位置，没办法一开始就知道，必须得从头开始找。因此，对于单链表实现获取第i个元素的数据的操作GetElem，在算法上，相对要麻烦一些。</li></ul><p>获得链表第i个数据的算法思路：</p><ol><li>声明一个指针p指向链表第一个结点，初始化j从1开始；</li><li>当j&lt;i时，就遍历链表，让p的指针向后移动，不断指向下一结点，j累加1；</li><li>若到链表末尾p为空，则说明第i个结点不存在；</li><li>否则查找成功，返回结点p的数据。</li></ol><div class="note info flat"><p>说白了，就是从头开始找，直到第i个结点为止。所以最坏情况的时间复杂度是O(n)。<br>此时就有人说，这么麻烦，这数据结构有什么用！还不如顺序存储结构呢。<br>哈，世间万物总是两面的，有好自然有不足，有差自然就有优势。下面来看一下在单链表中的如何实现“插入”和“删除”。</p></div><h3 id="单链表的插入和删除">单链表的插入和删除</h3><ul><li>此处想在节点p的后方插入一个节点s，使其成为p的后继节点，该如何操作？</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904145730.png"/></div></div><ul><li>用不着更改其他节点，只需要让s-&gt;next和p-&gt;next的指针做一点改变即可。</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s-&gt;next=p-&gt;next;</span><br><span class="line">p-&gt;next=s;</span><br></pre></td></tr></table></figure><details class="folding-tag" yellow><summary> 这两句的顺序可以交换吗？ </summary>              <div class='content'>              <ul><li>一定不能交换</li><li>交换后会将p-&gt;next的指针指向s，而s-&gt;next的指针指向p，这样p就无法找到它的后继节点了。后面的节点相当于断掉了。</li></ul>              </div>            </details><p>单链表第i个数据插入结点的算法思路：</p><ol><li>声明一指针p指向链表头结点，初始化j从1开始；</li><li>当j &lt; i时，就遍历链表，让p的指针向后移动，不断指向下一结点，j累加1；</li><li>若到链表末尾p为空，则说明第i个结点不存在；</li><li>否则查找成功，在系统中生成一个空结点s；</li><li>将数据元素e赋值给s-&gt;data；</li><li>单链表的插入标准语句s-&gt;next=p-&gt;next;p-&gt;next=s；</li><li>返回成功。</li></ol><ul><li>现在我们再来看单链表的删除。设存储元素a<sub>i</sub>的结点为q实现将结点q删除单链表的操作，其实就是将它的前继结点的指针绕过，指向它的后继结点即可</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904151034.png"/></div></div><ul><li>只需要将p的指针指向q的指针，即p-&gt;next=q-&gt;next即可</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p-&gt;next=q-&gt;next;</span><br></pre></td></tr></table></figure><p>单链表第i个数据删除结点的算法思路：</p><ol><li>声明一指针p指向链表头结点，初始化j从1开始；</li><li>当j &lt; i时，就遍历链表，让p的指针向后移动，不断指向下一个结点，j累加1；</li><li>若到链表末尾p为空，则说明第i个结点不存在；</li><li>否则查找成功，将欲删除的结点p-&gt;next赋值给q；</li><li>单链表的删除标准语句p-&gt;next=q-&gt;next；</li><li>将q结点中的数据赋值给e，作为返回；</li><li>释放q结点；</li><li>返回成功。</li></ol><h3 id="单链表整表创建">单链表整表创建</h3><ul><li>回顾一下，顺序存储结构的创建，其实就是一个数组的初始化，即声明一个类型和大小的数组并赋值的过程。而单链表和顺序存储结构就不一样，它不像顺序存储结构这么集中，它可以很散，是一种动态结构。</li><li>创建单链表的过程就是一个动态生成链表的过程。即从“空表”的初始状态起，依次建立各元素结点，并逐个插入链表。</li></ul><p>单链表整表创建的算法思路：</p><ol><li>声明一指针p和计数器变量i；</li><li>初始化一空链表L；</li><li>让L的头结点的指针指向NULL，即建立一个带头结点的单链表；</li><li>循环：<ul><li>生成一新结点赋值给p；</li><li>随机生成一数字赋值给p的数据域p-&gt;data；</li><li>将p插入到头结点与前一新结点之间。</li></ul></li></ol><div class="note no-icon danger flat"><p>这个算法思路中，其实用的是插队的方法，始终让新节点在第一的位置，这种方法也叫做<code>头插法</code></p></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904152048.png"/></div></div><ul><li>事实上，我们完全可以把新结点插入到最后，这才符号排队的正常思维，所谓的先来后到。我们把每次新结点都插在终端结点的后面，这种算法称为<code>尾插法</code>。</li></ul><p>单链表尾插法的算法思路：</p><ol><li>声明一指针p和计数器变量i；</li><li>初始化一空链表L；</li><li>让L的头结点的指针指向NULL，即建立一个带头结点的单链表；</li><li>循环：<ul><li>生成一新结点赋值给p；</li><li>随机生成一数字赋值给p的数据域p-&gt;data；</li><li>将表尾终端节点的指针指向新节点</li><li>将当前新节点定义为尾端终端节点</li></ul></li></ol><h3 id="单链表整表删除">单链表整表删除</h3><p>单链表整表删除的算法思路如下：</p><ol><li>声明一指针p和q；</li><li>将第一个结点赋值给p；</li><li>循环：<ul><li>将下一结点赋值给q；</li><li>释放p；</li><li>将q赋值给p。</li></ul></li></ol><p>有人认为q变量没有存在的意义，将q替换为p-&gt;next即可，这会带来什么问题？</p><blockquote><p>p指向一个结点，它除了有数据域，还有指针域。你在做free§时，其实是在对它整个结点进行删除和内存释放的工作,如果结点删除了，上哪还能继续使用p-&gt;next跳转到下一个节点呢</p></blockquote><h3 id="单链表结构与顺序存储结构优缺点">单链表结构与顺序存储结构优缺点</h3><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904154550.png"/></div></div><ul><li>得到一些经验性的结论：<ul><li>**线性表需要频繁查找，很少进行插入和删除操作时，宜采用顺序存储结构。若需要频繁插入和删除时，宜采用单链表结构。**比如说游戏开发中，对于用户注册的个人信息，除了注册时插入数据外，绝大多数情况都是读取，所以应该考虑用顺序存储结构。而游戏中的玩家的武器或者装备列表，随着玩家的游戏过程中，可能会随时增加或删除，此时再用顺序存储就不太合适了，单链表结构就可以大展拳脚。当然，这只是简单的类比，现实中的软件开发，要考虑的问题会复杂得多。</li><li><strong>线性表中的元素个数变化较大或者根本不知道有多大时，最好用单链表结构</strong>，这样可以不需要考虑存储空间的大小问题。而如果事先知道线性表的大致长度，比如一年12个月，一周就是星期一至星期日共七天，这种用顺序存储结构效率会高很多。</li></ul></li></ul><h2 id="静态链表">静态链表</h2><details class="folding-tag" blue><summary> 静态链表的引入 </summary>              <div class='content'>              <ul><li>C语言中的指针，使得它可以非常容易地操作内存中的地址和数据，这比其他高级语言更加灵活方便。后来的面向对象语言，如Java、C#等，虽不使用指针，但因为启用了对象引用机制，从某种角度也间接实现了指针的某些作用。</li><li>但对于一些语言，如Basic、Fortran等早期的编程高级语言，由于没有指针，链表结构按照前面我们的讲法，它就没法实现了。怎么办呢？</li><li>有人便想出用数组代替指针来描述单链表。</li></ul>              </div>            </details><ul><li>让数组的元素都是由两个数据域组成，data和cur。数据域data，用来存放数据元素，也就是通常我们要处理的数据；而cur相当于单链表中的next指针，存放该元素的后继在数组中的下标，我们把cur叫做<code>游标</code>。</li><li>我们把这种用数组描述的链表叫做<code>静态链表</code>，这种描述方法还有起名叫做游标实现法。</li></ul><div class="note info no-icon flat"><p>我们对数组第一个和最后一个元素作为特殊元素处理，不存数据。我们通常把未被使用的数组元素称为<code>备用链表</code>。而数组第一个元素，即下标为0的元素的cur就存放备用链表的第一个结点的下标；而数组的最后一个元素的cur则存放第一个有数值的元素的下标，相当于单链表中的头结点作用，当整个链表为空时，则为0。</p></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904155801.png"/></div></div><h3 id="静态链表的插入操作">静态链表的插入操作</h3><ul><li>静态链表中要解决的是：如何用静态模拟动态链表结构的存储空间的分配，<code>需要时申请，无用时释放</code>。</li><li>在静态链表中，操作的是数组，不存在像动态链表的结点申请和释放问题，所以我们需要自己实现这两个函数，才可以做插入和删除的操作。</li></ul><h3 id="静态链表的优缺点">静态链表的优缺点</h3><p>总的来说静态链表其实是为了给没有指针的高级语言设计的一种实现单链表能力的方法。尽管不一定会用得上,但这样的思考方式是非常巧妙的。</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904160157.png"/></div></div><h2 id="循环链表">循环链表</h2><ul><li>我们的单链表，如果想实现遍历功能，那么必须从头结点开始遍历，才能一次性把所有节点遍历完，一旦从中间节点开始遍历，那么就无法遍历到所有节点，需要执行第二次遍历，这个问题能解决吗？</li><li>将单链表中终端结点的指针端由空指针改为指向头结点,就使整个单链表形成一个环,通过这种操作，使得遍历完链表尾部后能继续遍历前面未遍历的部分，这种头尾相接的单链表称为单循环链表,简称<code>循环链表</code></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904161502.png"/></div></div><div class="note warning no-icon flat"><ul><li>其实循环链表和单链表的主要差异就在于循环的判断条件上</li><li>原来是判断 p-&gt;next是否为空,现在则是p -&gt; next 不等于头结点,则循环未结束。</li></ul></div><h2 id="双向链表">双向链表</h2><ul><li><p>我们在单链表中,有了 next 指针,这就使得我们要查找下一结点的时间复杂度为0(1)。可是如果我们要查找的是上一结点的话,那最坏的时间复杂度就是O(n)了,因为我们每次都要从头开始遍历查找。</p></li><li><p>为了克服单向性这一缺点,我们的老科学家们设计出了<code>双向链表</code>。双向链表(double linked list)是在单链表的每个结点中,再设置一个指向其前驱结点的指针域。所以在双向链表中的结点都有两个指针域,一个指向直接后继,另一个指向直接前驱。</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">DulNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    ElemType data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">DuLNode</span> *<span class="title">prior</span>;</span></span><br><span class="line">    <span class="comment">/*直接前驱指针*/</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">DuLNode</span> *<span class="title">next</span>;</span></span><br><span class="line">    <span class="comment">/*直接后继指针*/</span></span><br><span class="line">&#125; DulNode, *DuLinkList;</span><br></pre></td></tr></table></figure><ul><li><p>双向链表是单链表中扩展出来的结构,所以它的很多操作是和单链表相同的,比如求长度的 ListLength,查找元素的 GetElem,获得元素位置的 LocateElem 等,这些操作都只要涉及一个方向的指针即可,另一指针多了也不能提供什么帮助。</p></li><li><p>双向链表既然是比单链表多了如可以反向遍历查找等数据结构,那么也就需要付出一些小的代价:<strong>在插入和删除时,需要更改两个指针变量。</strong></p></li><li><p>插入操作时,其实并不复杂,不过顺序很重要,千万不能写反了。</p></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904161954.png"/></div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s -&gt;prior=p;        <span class="comment">/*把p赋值给s的前驱，如图中①*/</span></span><br><span class="line">s -&gt;next=p -&gt;next;  <span class="comment">/*把p-&gt;next赋值给s的后继，如图中②*/</span></span><br><span class="line">p-&gt;next-&gt;prior=s;   <span class="comment">/*把s赋值给p-&gt;next的前驱，如图中③*/</span></span><br><span class="line">p-&gt;next=s;          <span class="comment">/*把S赋值给p的后继，如图中④*/</span></span><br></pre></td></tr></table></figure><ul><li><p>关键在于它们的顺序,由于第2步和第3步都用到了 p-&gt;next。如果第4步先执行,则会使得 p-&gt;next 提前变成了s,使得插入的工作完不成。所以我们不妨把上面这张图在理解的基础上记忆,顺序是先搞定s 的前驱和后继,再搞定后结点的前驱,最后解决前结点的后继。</p></li><li><p>删除操作同理，若要删除结点p,只需要下面两步骤</p></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904162309.png"/></div></div><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p-&gt;prior-&gt;next=p-&gt;next; <span class="comment">/*把p-&gt;next 赋值给p-&gt;prior 的后继,如图中*/</span></span><br><span class="line">p-&gt;next-&gt;prior=p-&gt;prior; <span class="comment">/*把p-&gt;prior 赋值给p-&gt;next 的前驱,如图中2*/</span></span><br><span class="line"><span class="built_in">free</span> (p); <span class="comment">/*释放结点*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="note info no-icon flat"><p>双向链表相对于单链表来说,要更复杂一些,毕竟它多了prior 指针,对于插入和删除时,需要格外小心。另外它由于每个结点都需要记录两份指针,所以在空间上是要占用略多一些的。不过,由于它良好的对称性,使得对某个结点的前后结点的操作,带来了方便,可以有效提高算法的时间性能。说白了,就是<code>用空间来换时间</code>。</p></div><h1>栈与队列</h1><ul><li><p><code>栈</code>是一种特殊的线性表，栈限定仅在表尾进行插入和删除操作</p></li><li><p>我们把允许插入和删除的一端称为<code>栈顶(top)</code>,另一端称为<code>栈底(bottom)</code>,不含任何数据元素的栈称为空栈。栈又称为<code>后进先出</code>(Last In First Out)的线性表,简称 <code>LIFO 结构</code>。</p></li><li><p>首先栈是一个特殊的线性表,也就是说,栈元素具有线性关系。定义中说是在线性表的表尾进行插入和删除操作,这里表尾是指栈顶,而不是栈底。</p></li><li><p>它的特殊之处就在于限制了这个线性表的插入和删除位置,它始终只在栈顶进行。这也就使得:栈底是固定的,最先进栈的只能在栈底。</p></li></ul><div class="note default no-icon flat"><p>**栈的插入操作,叫作进栈,也称压栈、入栈。**类似子弹入弹夹。<br>**栈的删除操作,叫作出栈,也叫作弹栈。**栈的删除操作,叫作出栈,也有的叫作弹栈。如同弹夹中的子弹出夹。</p></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904163110.png"/></div></div><h2 id="栈的抽象数据类型">栈的抽象数据类型</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ADT 栈(<span class="built_in">stack</span>)</span><br><span class="line">Data</span><br><span class="line">  线性表。元素具有相同的类型,相邻元素具有前驱和后继关系。</span><br><span class="line">Operation</span><br><span class="line">  <span class="title function_">InitStack</span> <span class="params">(*S)</span>:初始化操作,建立一个空栈 S。</span><br><span class="line">  <span class="title function_">DestroyStack</span> <span class="params">(*S)</span>:若栈存在,则销毁它。</span><br><span class="line">  <span class="title function_">ClearStack</span> <span class="params">(*s)</span>:将栈清空。</span><br><span class="line">  <span class="title function_">StackEmpty</span> <span class="params">(s)</span>:若栈为空,返回<span class="literal">true</span>,否则返回 <span class="literal">false</span>.</span><br><span class="line">  <span class="title function_">GetTop</span> <span class="params">(S, *e)</span>:若栈存在且非空,用e返回S的栈顶元素。</span><br><span class="line">  <span class="title function_">Push</span> <span class="params">(*S,e)</span>:若栈S 存在,插入新元素e到栈S 中并成为栈顶元素。</span><br><span class="line">  <span class="title function_">Pop</span> <span class="params">(*S, *e)</span>:删除栈S 中栈顶元素,并用e返回其值。</span><br><span class="line">  <span class="title function_">StackLength</span> <span class="params">(S)</span>: 返回栈S 的元素个数。</span><br><span class="line">endADT</span><br></pre></td></tr></table></figure><ul><li>由于栈本身就是一个线性表,所以线性表的顺序存储和链式存储,对于栈来说,也是同样适用的。</li></ul><h2 id="栈的顺序存储结构">栈的顺序存储结构</h2><ul><li>栈是线性表的特例,所以栈的顺序存储是线性表顺序存储的简化</li><li>因为在栈中元素的插入和删除都在栈顶进行,所以我们存储在数组时，可以<strong>以下标为0的一段作为栈底</strong>，另一端为栈顶，因为栈底的裱花最小，不会频繁挪动元素。</li><li>通常定义<code>top变量</code>来指示栈顶元素的位置，以<code>StackSize变量</code>记录存储栈的长度e,则栈顶位置 top 必须小于 StackSize。当栈存在一个元素时,top 等于0,因此通常把空栈的判定条件定为top 等于-1。</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> SElemType; <span class="comment">/* SElemType 类型根据实际情况而定,这里假设为int */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  SElemType data [MAXSIZE];</span><br><span class="line">  <span class="type">int</span> top; <span class="comment">/* 用于栈顶指针 */</span></span><br><span class="line">&#125;SqStack;</span><br></pre></td></tr></table></figure><p>栈普通情况、空栈和栈满的情况示意图如图</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904164410.png"/></div></div><h3 id="进栈和出栈">进栈和出栈</h3><p>栈是特殊的线性表，且只能在栈顶进出元素，所以很好实现。</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904163110.png"/></div></div><div class="tabs" id="进栈"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#进栈-1">进栈</button></li><li class="tab"><button type="button" data-href="#进栈-2">出栈</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="进栈-1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 插入元素e为新的栈顶元素 */</span></span><br><span class="line">Status <span class="title function_">Push</span> <span class="params">(SgStack *S, SElemType e)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (S-&gt;top == MAXSIZE <span class="number">-1</span>) <span class="comment">/* 栈满 */</span></span><br><span class="line">    <span class="keyword">return</span> ERROR;</span><br><span class="line">  S-&gt;top++;           <span class="comment">/* 栈顶指针增加一 */</span></span><br><span class="line">  S-&gt;data[S-&gt;top]=e;  <span class="comment">/* 将新插入元素赋值给栈顶空间 */</span></span><br><span class="line">  <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="进栈-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 删除栈顶元素,用e返回其值 */</span></span><br><span class="line">Status <span class="title function_">Pop</span> <span class="params">(SqStack *S, SElemType *e)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (S-&gt;top == <span class="number">-1</span>) <span class="comment">/* 栈空 */</span></span><br><span class="line">    <span class="keyword">return</span> ERROR;</span><br><span class="line">  *e=S-&gt;data[S-&gt;top]; <span class="comment">/* 将栈顶元素赋值给e */</span></span><br><span class="line">  S-&gt;top--; <span class="comment">/* 栈顶指针减一 */</span></span><br><span class="line">  <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="两栈共享空间">两栈共享空间</h3><ul><li><p>栈的顺序存储非常方便,因为它只准栈顶进出元素,所以不存在线性表插入和删除时需要移动元素的问题。不过它有一个很大的缺陷,就是必须事先确定数组存储空间大小,万一不够用了,就需要编程手段来扩展数组的容量,非常麻烦。</p></li><li><p>对于一个栈,我们也只能尽量考虑周全,设计出合适大小的数组来处理,但<strong>对于两个<code>相同类型</code>的栈,我们可以做到最大限度地利用其事先开辟的存储空间来进行操作。</strong></p></li><li><p>实现共享空间的方法：数组有两个端点，两个栈有两个栈底，让一个栈栈底为数组的始端，另一个栈为栈的末端，增加元素时，栈的栈顶部分向中间延伸</p></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904165333.png"/></div></div><ul><li><p>关键思路是:它们是在数组的两端,向中间靠拢。top1 和 top2是栈1和栈2的栈顶指针,只要它们俩不见面,两个栈就可以一直使用。从这里也就可以分析出来,栈1为空时,就是 top1 等于-1时;而当top2 等于n时,即是栈2为空时,那什么时候栈满呢?</p></li><li><p>想想极端的情况,若栈2是空栈,栈1 的 top1 等于n-1时,就是栈1满了。反之,当栈1 为空栈时,top2 等于 0时,为栈2 满。但更多的情况,其实就是两个栈见面之时,也就是两个指针之间相差1时,即top1 + 1 == top2 为栈满。</p></li><li><p>两栈共享空间的结构</p></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 两栈共享空间结构 */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  SElemType data[MAXSIZE];</span><br><span class="line">  <span class="type">int</span> topl; <span class="comment">/* 栈1栈顶指针 */</span></span><br><span class="line">  <span class="type">int</span> top2; <span class="comment">/* 栈2栈顶指针 */</span></span><br><span class="line">&#125;SqDoubleStack;</span><br></pre></td></tr></table></figure><ul><li>对于栈的push方法，除了插入元素值参数外，还需要有一个判断是栈1还是栈2的栈号参数stackNumber</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 插入元素e为新的栈顶元素 */</span></span><br><span class="line">Status <span class="title function_">Push</span> <span class="params">(SqDoubleStack *S, SElemType e, <span class="type">int</span> stackNumber)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (S-&gt;top1+<span class="number">1</span>==S-&gt;top2) <span class="comment">/* 栈已满,不能再 push 新元素了 */</span></span><br><span class="line">    <span class="keyword">return</span> ERROR;</span><br><span class="line">  <span class="keyword">if</span> (stackNumber==<span class="number">1</span>) <span class="comment">/* 栈1 有元素进栈 */</span></span><br><span class="line">    S-&gt;data [++S-&gt;top1] =e; <span class="comment">/* 若栈1 则先 top1+1 后给数组元素赋值 */</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (stackNumber==<span class="number">2</span>) <span class="comment">/* 栈2 有元素进栈 */</span></span><br><span class="line">    S-&gt;data [ -- S-&gt;top2]=e; <span class="comment">/* 若栈2则先top2-1后给数组元素赋值 */</span></span><br><span class="line">  <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>pop方法也同理，不再赘述</li></ul><div class="note danger no-icon flat"><p>事实上,使用这样的数据结构,通常都是当两个栈的空间需求有相反关系时,也就是一个栈增长时另一个栈在缩短的情况。就像买卖股票一样,你买入时,一定是有一个你不知道的人在做卖出操作。有人赚钱,就一定是有人赔钱。这样使用两栈共享空间存储方法才有比较大的意义。否则两个栈都在不停地增长,那很快就会因栈满而溢出了。</p></div><h2 id="栈的链式存储">栈的链式存储</h2><ul><li><p>栈只是栈顶来做插入和删除操作,栈顶放在链表的头部还是尾部呢?由于单链表有头指针,而栈顶指针也是必须的,那干吗不让它俩合二为一呢,所以比较好的办法是<strong>把栈顶放在单链表的头部</strong>(如图 4-6-1 所示)。另外,都已经有了栈顶在头部了,单链表中比较常用的头结点也就失去了意义,通常对于链栈来说,是不需要头结点的。</p></li><li><p>对于链栈来说,基本不存在栈满的情况,除非内存已经没有可以使用的空间,如果真的发生,那此时的计算机操作系统已经面临死机崩溃的情况,而不是这个链栈是否溢出的问题。</p></li></ul><p>链栈的结构代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">StackNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  SElemType data;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">StackNode</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125; StackNode, *LinkStackPtr;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LinkStack</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  LinkStackPtr top;</span><br><span class="line">  <span class="type">int</span> count;</span><br><span class="line">&#125;LinkStack;</span><br></pre></td></tr></table></figure><h3 id="进栈与出栈">进栈与出栈</h3><ul><li>对于链栈的进栈push操作，假设元素值为e的新结点是s, top 为栈顶指针</li></ul><div class="tabs" id="链式"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#链式-1">示意图</button></li><li class="tab"><button type="button" data-href="#链式-2">代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="链式-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904171453.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="链式-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 插入元素e为新的栈顶元素 */</span></span><br><span class="line">Status <span class="title function_">Push</span> <span class="params">(LinkStack *S, SElemType e)</span></span><br><span class="line">&#123;</span><br><span class="line">  LinkStackPtr s= (LinkStackPtr) <span class="built_in">malloc</span> (<span class="keyword">sizeof</span> (StackNode) );</span><br><span class="line">  s-&gt;data=e;</span><br><span class="line">  s-&gt;next=S-&gt;top; <span class="comment">/* 把当前的栈顶元素赋值给新结点的直接后继*/</span></span><br><span class="line">  S-&gt;top=s;       <span class="comment">/* 将新的结点s 赋值给栈顶指针*/</span></span><br><span class="line">  S-&gt;count++;</span><br><span class="line">  <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>对于栈链的出栈pop操作，假设变量p用来存储要删除的栈顶结点,将栈顶指针下移一位,最后释放p即可</li></ul><div class="tabs" id="出栈"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#出栈-1">示意图</button></li><li class="tab"><button type="button" data-href="#出栈-2">代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="出栈-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904171453.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="出栈-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 若栈不空,则删除S的栈顶元素,用e返回其值,并返回 OK;否则返回 ERROR */</span></span><br><span class="line">Status <span class="title function_">Pop</span> <span class="params">(LinkStack *S, SElemType *e)</span></span><br><span class="line">&#123;</span><br><span class="line">  LinkStackPtr pi</span><br><span class="line">  <span class="title function_">if</span> <span class="params">(StackEmpty (*s))</span></span><br><span class="line">    <span class="keyword">return</span> ERROR;</span><br><span class="line">  *e=S-&gt;top-&gt;data;</span><br><span class="line">  p=S-&gt;top;           <span class="comment">/* 将栈顶结点赋值给p */</span></span><br><span class="line">  S-&gt;top=S-&gt;top-&gt;next;<span class="comment">/* 使得栈顶指针下移一位,指向后一结点,如图4*/</span></span><br><span class="line">  <span class="built_in">free</span> (p);           <span class="comment">/* 释放结点p */</span></span><br><span class="line">  S-&gt;count--;</span><br><span class="line">  <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>链栈的进栈 push 和出栈 pop 操作都很简单,没有任何循环操作,时间复杂度均为0(1)。</li><li>对比一下顺序栈与链栈<ul><li>对于时间性能，它们在时间复杂度上是一样的,均为 0(1)。</li><li>对于空间性能,顺序栈需要事先确定一个固定的长度,可能会存在内存空间浪费的问题,但它的优势是存取时定位很方便,而链栈则要求每个元素都有指针域,这同时也增加了一些内存开销,但对于栈的长度无限制。</li></ul></li></ul><div class="note default no-icon flat"><p>它们的区别和线性表中讨论的一样,如果栈的使用过程中元素变化不可预料,有时很小,有时非常大,那么最好是用链栈,反之,如果它的变化在可控范围内,建议使用顺序栈会更好一些。</p></div><h2 id="栈的作用">栈的作用</h2><ul><li>栈有啥用啊，不就是一个被限制的线性表吗？为什么要单独引入为一个数据结构呢？<ul><li>这和我们有两只脚可以走路,干吗还要乘汽车、火车、飞机一样。理论上,陆地上的任何地方,你都是可以靠双脚走到的,可那需要多少时间和精力呢?我们更关注的是到达而不是如何去的过程。</li><li><strong>栈的引入简化了程序设计的问题,划分了不同关注层次,使得思考范围缩小,更加聚焦于我们要解决的问题核心</strong>。反之,像数组等,因为要分散精力去考虑数组的下标增减等细节问题,反而掩盖了问题的本质。</li></ul></li></ul><h2 id="栈的应用-————-递归">栈的应用 ———— 递归</h2><ul><li><p>栈有一个很重要的应用:在程序设计语言中实现了递归。</p></li><li><p>递归定义：把一个直接调用自己或通过一系列的调用语句间接地调用自己的函数,称做<code>递归函数</code>。</p></li><li><p>实现斐波那契数列问题时，迭代和递归的区别是:</p><ul><li>迭代使用的是循环结构,递归使用的是选择结构。</li><li>递归能使程序的结构更清晰、更简洁、更容易让人理解,从而减少读懂代码的时间。但是大量的递归调用会建立函数的副本,会耗费大量的时间和内存。</li><li>迭代不需要反复调用函数和占用额外的内存。</li></ul></li><li><p>递归和栈有什么关系呢?这得从计算机系统的内部说起。</p><ul><li>递归过程退回的顺序是它前行顺序的逆序。在退回过程中,可能要执行某些动作,包括恢复在前行过程中存储起来的某些数据。这种存储某些数据,并在后面又以存储的逆序恢复这些数据,以提供之后使用的需求,显然很符合栈这样的数据结构,因此,编译器使用栈实现递归就没什么好惊讶的了。</li><li>简单的说,就是在前行阶段,对于每一层递归,函数的局部变量、参数值以及返回地址都被压入栈中。在退回阶段,位于栈顶的局部变量、参数值和返回地址被弹出,用于返回调用层次中执行代码的其余部分,也就是恢复了调用的状态。</li></ul></li></ul><h2 id="栈的应用————四则运算表达式求值">栈的应用————四则运算表达式求值</h2><h3 id="后缀-逆波兰-表示法定义">后缀(逆波兰)表示法定义</h3><ul><li>在计算机中，我们可以进行四则运算，但是计算机是如何实现 先计算括号 或者 先乘除后加减 的计算规则的呢<ul><li>我们可以发现，如果一个计算式中有括号，那么括号一定是成对出现的对于多重括号，最后也一定是完全嵌套匹配的。这用栈结构正好合适，不管栈内有多少括号，只要碰到左括号则将括号进栈，碰到有括号则让最接近栈顶的左括号出栈，期间对数字进行运算。</li><li>但对于四则运算，括号也只是当中的一部分，先乘除后加减依旧不好实现，该如何有效处理呢？</li></ul></li></ul><p>20世纪50年代,波兰逻辑学家 Jan Łukasiewicz,当时也困惑于如何才可以搞定这个四则运算,最终他想到了一种不需要括号的后缀表达法,我们也把它称为<code>逆波兰(Reverse Polish Notation, RPN)表示</code>。</p><ul><li>对于“9+ (3-1)×3+10÷2”,如果要用后缀表示法应该是什么样子:“931-3 * + 102/+”,这样的表达式称为<code>后缀表达式</code>,叫后缀的原因在于所有的符号都是在要运算数字的后面出现。显然,这里没有了括号。</li></ul><h3 id="后缀表达式计算结果">后缀表达式计算结果</h3><ul><li>先来看看,计算机如何应用后缀表达式计算出最终的结果20的。</li><li><code>后缀表达式: 931-3*+102/+</code></li><li>规则:从左到右遍历表达式的每个数字和符号,遇到是数字就进栈,遇到是符号,就将处于栈顶两个数字出栈,进行运算,运算结果进栈,一直到最终获得结果。</li></ul><ol>  <li>初始化一个空栈。此栈用来对要运算的数字进出使用。</li>  <li>后缀表达式中前三个都是数字,所以9、3、1 进栈</li><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904175524.png"/></div></div>  <li>接下来是“一”,所以将栈中的1 出栈作为减数,3出栈作为被减数,并运算3-1得到2,再将2进栈</li>  <li>接着是数字3进栈</li><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904175659.png"/></div></div>  <li>后面是“*”,也就意味着栈中 3 和2 出栈,2与3 相乘,得到6,并将6进栈</li>  <li>下面是“+”,所以栈中6和9出栈,9与6相加,得到15,将15 进栈</li><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904180744.png"/></div></div>  <li> 接着是10与2两数字进栈</li>  <li>接下来是符号“/”,因此,栈顶的2与10出栈,10与2 相除,得到5,将5进栈</li><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904180839.png"/></div></div>  <li>最后一个是符号“+”,所以15与5出栈并相加,得到20,将20 进栈</li>  <li>结果是20出栈,栈变为空,</li><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904180921.png"/></div></div></ol><ul><li>能够看出后缀表达式真的可以很顺利的解决计算的问题，但这个后缀表达式<code>931-3*+102/+</code>是怎么出来的呢？</li></ul><h3 id="中缀表达式转后缀表达式">中缀表达式转后缀表达式</h3><ul><li>平时所用的标准四则运算表达式,即“9+(3-1)×3+10-2”叫做<code>中缀表达式</code>。</li></ul><blockquote><p>中缀表达式转后缀表达式的规则：<br>从左到右遍历中级表达式的每个数字和符号<br>若是数字就输出,即成为后缀表达式的一部分;<br>若是符号,则判断其与栈顶符号的优先级,是右括号或优先级低于栈顶符号(乘除优先加减)则栈顶元素依次出栈并输出,并将当前符号进栈,一直到最终输出后缀表达式为止。</p></blockquote><ol>  <li>初始化一空栈,用来对符号进出栈使用</li>  <li>第一个字符是数字 9,输出 9,后面是符号“+”,进栈。</li>  <li> 第三个字符是“(”,依然是符号,因其只是左括号,还未配对,故进栈。</li>  <li>第四个字符是数字3,输出,总表达式为93,接着是“-”,进栈。</li>  <li>接下来是数字1,输出,总表达式为931,后面是符号“)”,此时,我们需要去匹配此前的“(”,所以栈顶依次出栈,并输出,直到“(”出栈为止。此时左括号上方只有“-”,因此输出“-”。总的输出表达式为931-。</li>  <li>接着是数字3,输出,总的表达式为931-3。紧接着是符号“x”,因为此时的栈顶符号为“+”号,优先级低于“x”,因此不输出,“*”进栈。</li>  <li>之后是符号“+”,此时当前栈顶元素“*”比这个“+”的优先级高,因此栈中元素出栈并输出(没有比“+”号更低的优先级,所以全部出栈),总输出表达式为931-3 * +。然后将当前这个符号“+”进栈。也就是说,前6 张图的栈底的“+”是指中级表达式中开头的9 后面那个“+”,而图 4-9-9 左图中的栈底(也是栈顶)的“+”是指“9+(3-1)×3+”中的最后一个“+”。</li>  <li>最后一个数字2,输出,总的表达式为931-3* + 102</li>  <li> 因已经到最后,所以将栈中符号全部出栈并输出。最终输出的后缀表达式结果为931-3 * + 102/+</li>  <li></li></ol><div class="note danger no-icon flat"><p>要想让计算机具有处理我们通常的标准(中缀)表达<br>式的能力,最重要的就是两步:</p><ol><li>将中级表达式转化为后缀表达式(栈用来进出运算的符号)。</li><li>将后缀表达式进行运算得出结果(栈用来进出运算的数字)。</li></ol></div><h2 id="队列的定义">队列的定义</h2><ul><li>队列如同一个倾斜的管道，队列是只允许在一端进行插入操作,而在另一端进行删除操作的线性表。</li><li>队列是<code>先进先出</code>的线性表，简称FIFO。允许插入的一端称为<code>队尾</code>，允许删除的一端称为<code>队头</code></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904185634.png"/></div></div><h2 id="循环队列">循环队列</h2><ul><li>线性表有顺序存储和链式存储,栈是线性表,所以有这两种存储方式。同样,队列作为一种特殊的线性表,也同样存在这两种存储方式。</li></ul><h3 id="队列顺序存储的不足">队列顺序存储的不足</h3><ul><li>我们假设一个队列有n 个元素,则顺序存储的队列需建立一个大于n的数组,并把队列的所有元素存储在数组的前n 个单元,数组下标为0 的一端即是队头。所谓的入队列操作,其实就是在队尾追加一个元素,不需要移动任何元素,因此时间复杂度为O(1)</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904185904.png"/></div></div><ul><li>与栈不同的是,队列元素的出列是在队头,即下标为 0 的位置,那也就意味着,出列时队列中的所有元素都得向前移动,以保证队列的队头,也就是下标为 0 的位置不为空,此时时间复杂度为0(n)</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904190104.png"/></div></div><ul><li>虽然现实中在排队时，前面的人离开之后，后面的人就全部向前一步补上空位，但有时想想，为什么非要全部移动呢，如果不去约束队列元素必须在数组前n个单元，那么出队的性能就会大大增加</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904190506.png"/></div></div><ul><li>为了避免当只有一个元素时,队头和队尾重合使处理变得麻烦,所以引入两个指针, <code>front指针</code>指向队头元素,<code>rear指针</code>指向队尾元素的下一个位置,这样当front 等于rear 时,此队列不是还剩一个元素,而是空队列。</li><li>假设长度为5 的数组,front 与rear 指针均指向下标为0 的位置。然后入队 a<sub>1</sub>、a<sub>2</sub>、a<sub>3</sub>、a<sub>4</sub>, front 指针依然指向下标为0位置,而rear 指针指向下标为4的位置</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904190855.png"/></div></div><ul><li>但是此时问题又出现了，这样前面的空位将不会再次放置元素，随着每次出队和入队，该队列的容量会不断减小，造成<code>假溢出</code>的现象</li></ul><h3 id="循环队列定义">循环队列定义</h3><p><code>循环队列</code>可以用来解决假溢出的现象</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904191305.png"/></div></div><p>当队列发生假溢出时，接着入队a<sub>6</sub>,此时将他放置于下标为0处，rear 指针指向下标为1处，。若再入队 a<sup>7</sup>,则 rear 指针就与 front 指针重合,同时指向下标为2的位置</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904191535.png"/></div></div><ul><li><p>此时问题又出来了,我们刚才说,空队列时, front 等于 rear,现在当队列满时,也是 front 等于 rear,那么如何判断此时的队列究竟是空还是满呢?</p></li><li><p>办法一 是设置一个标志变量 flag,当front == rear, 且flag = 0 时为队列空,当 front == rear, 且 flag = 1 时为队列满。</p></li><li><p>办法二 是当队列空时,条件就是 front = rear,当队列满时,我们修改其条件,<strong>保留一个元素空间</strong>。也就是说,队列满时,数组中还有一个空闲单元。</p></li><li><p>重点讨论一下第二种方法,由于rear 可能比 front 大,也可能比front 小,所以尽管它们只相差一个位置时就是满的情况,也可能是相差整整一圈。所以若队列的最大尺寸为 QueueSize,那么队列满的条件是(rear+1)%QueueSize == front</p><ul><li>取模“%”的目的就是为了整合 rear 与 front 大小为一个问题</li><li>当rear &gt; front 时，此时队列的长度为rear-front。</li><li>当rear &lt; front 时,队列长度分为两段,一段是QueueSize-front,另一段是 0 + rear,加在一起,队列长度为rearfront + QueueS</li></ul></li></ul><p>综上，通用的计算队列的长度公式为：</p><div class="note danger no-icon flat"><p><strong>(rear-front + QueueSize) %QueueSize</strong></p></div><ul><li>循环队列解决了假溢出的问题，但一旦设置为循环队列，数组的大小也就没法再扩大了，此时又出现了数组可能溢出的问题，所以我们还需要再研究一下不担心队列长度的链式存储结构</li></ul><h2 id="链式结构队列">链式结构队列</h2><ul><li>队列的链式存储结构,其实就是线性表的单链表,只不过它只能尾进头出而已。为了操作上的方便,我们将队头指针指向链队列的头结点,而队尾指针指向终端结点</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904192954.png"/></div></div><h3 id="入队和出队">入队和出队</h3><p>入队操作时,其实就是在链表尾部插入结点</p><div class="tabs" id="队列入队"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#队列入队-1">示意图</button></li><li class="tab"><button type="button" data-href="#队列入队-2">代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="队列入队-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904193314.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="队列入队-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 插入元素e为Q的新的队尾元素 */</span></span><br><span class="line">Status <span class="title function_">EnQueue</span> <span class="params">(LinkQueue *Q, QElemType e)</span></span><br><span class="line">&#123;</span><br><span class="line">  QueuePtr s= (QueuePtr) <span class="built_in">malloc</span> (<span class="keyword">sizeof</span> (QNode) ) ;</span><br><span class="line">  <span class="keyword">if</span> (!s) <span class="comment">/* 存储分配失败 */</span></span><br><span class="line">    <span class="built_in">exit</span>(OVERFLOW);</span><br><span class="line">  s-&gt;data=e;</span><br><span class="line">  s-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">  Q-&gt;rear-&gt;next=s; <span class="comment">/* 把拥有元素e新结点s赋值给原队尾结点的后继,*/</span></span><br><span class="line">  Q-&gt;rear=s; <span class="comment">/* 把当前的s设置为队尾结点,rear 指向s */</span></span><br><span class="line">  <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>出队操作时,就是头结点的后继结点出队,将头结点的后继改为它后面的结点,若链表除头结点外只剩一个元素时,则需将rear 指向头结点</p><div class="tabs" id="队列出队"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#队列出队-1">示意图</button></li><li class="tab"><button type="button" data-href="#队列出队-2">代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="队列出队-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904193551.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="队列出队-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Status <span class="title function_">DeQueue</span> <span class="params">(LinkQueue *Q, QElemType *e)</span></span><br><span class="line">&#123;</span><br><span class="line">  QueuePtr p;</span><br><span class="line">  <span class="keyword">if</span> (Q-&gt;front==Q-&gt;rear)</span><br><span class="line">    <span class="keyword">return</span> ERROR;</span><br><span class="line">  p=Q-&gt;front-&gt;next; <span class="comment">/* 将欲删除的队头结点暂存给p,*/</span></span><br><span class="line">  *e=p-&gt;data;     <span class="comment">/* 将欲删除的队头结点的值赋值给e */</span></span><br><span class="line">  Q-&gt;front-&gt;next=p-&gt;next; <span class="comment">/*将原队头结点后继p-&gt;next 赋值给头结点后继,*/</span></span><br><span class="line">  <span class="keyword">if</span> (Q-&gt;rear==p) <span class="comment">/*若队头是队尾,则删除后将 rear 指向头结点,见上图中③ */</span></span><br><span class="line">    Q-&gt;rear=Q-&gt;front;</span><br><span class="line">  <span class="built_in">free</span> (p);</span><br><span class="line">  <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>对于循环队列与链队列的比较,可以从两方面来考虑<ul><li>从时间上,其实它们的基本操作都是常数时间,即都为0(1)的,不过循环队列是事先申请好空间,使用期间不释放,而对于链队列,每次申请和释放结点也会存在一些时间开销,如果入队出队频繁,则两者还是有细微差异。</li><li>对于空间上来说,循环队列必须有一个固定的长度,所以就有了存储元素个数和空间浪费的问题。而链队列不存在这个问题,尽管它需要一个指针域,会产生一些空间上的开销,但也可以接受。所以在空间上,链队列更加灵活。</li></ul></li></ul><div class="note info no-icon flat"><p>总的来说,在可以确定队列长度最大值的情况下,建议用循环队列,如果你无法预估队列的长度时,则用链队列。</p></div><h2 id="总结回顾-2">总结回顾</h2><ul><li><p>栈和队列都是特殊的线性表，只是对插入和删除操作做了限制。</p></li><li><p>栈(stack)是限定仅在表尾进行插入和删除操作的线性表。</p></li><li><p>队列(queue)是只允许在一端进行插入操作,而在另一端进行删除操作的线性表。</p></li><li><p>它们均可以用线性表的顺序存储结构来实现,但都存在着顺序存储的一些弊端。因此它们各自有各自的技巧来解决这个问题。</p><ul><li>对于栈来说,如果是两个相同数据类型的栈,则可以用数组的两端作栈底的方法来让两个栈共享数据,这就可以最大化地利用数组的空间。</li><li>对于队列来说,为了避免数组插入和删除时需要移动数据,于是就引入了循环队列,使得队头和队尾可以在数组中循环变化。解决了移动数据的时间损耗,使得本来插入和删除是0(n)的时间复杂度变成了0(1)。</li></ul></li><li><p>它们也都可以通过链式存储结构来实现,实现原则上与线性表基本相同</p></li></ul><h1>树</h1><h2 id="树的定义">树的定义</h2><ul><li>线性表是一对一的线性结构，可现实中还有许多一对多的情况，<code>树</code>就是专门研究一对多的数据结构。</li></ul><div class="note default no-icon flat"><p>树(Tree)是n(n≥0)个结点的有限集。n=0 时称为<code>空树</code>。在任<br>意一棵非空树中:(1)有且仅有一个特定的称为<code>根( Root )</code>的结<br>点;(2)当n&gt;1 时,其余结点可分为 m(m&gt;0)个互不相交的<br>有限集 T1、T2、……、Tm,其中每一个集合本身又是一棵树,并<br>且称为<code>根的子树(SubTree)</code></p></div> <div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904194925.png"/></div></div><h3 id="结点分类">结点分类</h3><p>树的结点包含一个数据元素及若干指向其子树的分支。结点拥有的子树数称为<code>结点的度(Degree)</code>。度为0 的结点称为<code>叶结点(Leaf)</code>或终端结点;度不为0 的结点称为非终端结点或<code>分支结点</code>。除根结点之外,分支结点也称为内部结点。<code>树的度</code>是树内各结点的度的最大值。</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904195717.png"/></div></div><h3 id="其他概念">其他概念</h3><ul><li>结点的<code>层次(Level)</code>从根开始定义起,根为第一层,根的孩子为第二层。若某结点在第1层,则其子树的根就在第1+1 层。其双亲在同一层的结点互为堂兄弟。显然图中的D、E、F是堂兄弟,而G、H、I、J也是。树中结点的最大层次称为<code>树的深度(Depth)</code>或高度,当前树的深度为4。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904200036.png"/></div></div><ul><li><p><code>森林(Forest)</code> 是 m (m≥0) 棵互不相交的树的集合。对树中每个结点而言,其子树的集合即为森林。</p></li><li><p>对比线性表与树的结构,它们有很大的不同</p></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904200231.png"/></div></div><h2 id="树的存储结构">树的存储结构</h2><ul><li>前面我们学过线性表有顺序存储和链式存储两种结构，树也是这两种结构吗？</li><li>先来看看顺序存储结构,用一段地址连续的存储单元依次存储线性表的数据元素。这对于线性表来说是很自然的,但是对于树来说，树的某个节点孩子有多个，无论按照哪种顺序将树的节点存储到数组，结点的存储位置都无法直接反映逻辑关系，所以简单的顺序存储结构是不能满足树的实现要求的。</li><li>不过充分利用顺序存储和链式存储结构的特点,完全可以实现对树的存储结构的表示。</li><li>这里介绍三种不同的表示法:<ul><li>双亲表示法</li><li>孩子表示法</li><li>孩子兄弟表示法。</li></ul></li></ul><h3 id="双亲表示法">双亲表示法</h3><ul><li>每个人可能没有孩子，但是一定有双亲，树这种结构也是这样，除了根节点外,其余每个结点,它不一定有孩子,但是一定有且仅有一个双亲。</li><li>我们假设以一组连续空间存储树的结点,同时在每个结点中,附设一个指示器指示其双亲结点到链表中的位置。也就是说,每个结点除了知道自己是谁以外,还知道它的双亲在哪里。</li></ul><div class="tabs" id="双亲表示法"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#双亲表示法-1">示意图</button></li><li class="tab"><button type="button" data-href="#双亲表示法-2">结构代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="双亲表示法-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904201113.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="双亲表示法-2"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 树的双亲表示法结点结构定义 */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX TREE SIZE 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> TElemType; <span class="comment">/* 树结点的数据类型,目前暂定为整型 */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">PTNode</span> /* 结点结构 */</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  TElemType data; <span class="comment">/* 结点数据 */</span></span><br><span class="line">  <span class="type">int</span> parent; <span class="comment">/* 双亲位置 */</span></span><br><span class="line">&#125; PTNode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> /* 树结构 */</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  PTNode nodes [MAX TREE SIZE]; <span class="comment">/* 结点数组 */</span></span><br><span class="line">  <span class="type">int</span> r, n; <span class="comment">/* 根的位置和结点数 */</span></span><br><span class="line">&#125; PTree;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>根结点是没有双亲的,所以我们约定根结点的位置域设置为-1,此时，所有的节点都存有它双亲的位置</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250904201651.png"/></div></div><table><thead><tr><th style="text-align:center">下标</th><th style="text-align:center">data</th><th style="text-align:center">parent</th></tr></thead><tbody><tr><td style="text-align:center">0</td><td style="text-align:center">A</td><td style="text-align:center">-1</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">B</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">C</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">D</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">E</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">F</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">G</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">H</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">I</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">J</td><td style="text-align:center">4</td></tr></tbody></table><ul><li>这样存储，我们可以根据结点快速的找到他的双亲结点，所用时间复杂度为O(1),直到 parent 为-1时,表示找到了树结点的根。可如果想知道结点的孩子是什么,不好意思,需要遍历整个结构才行。</li><li>如何改进？<ul><li>增加一个结点最左边孩子的域,不妨叫它长子域,这样就可以很容易得到结点的孩子。如果没有孩子的结点,这个长子域就设置为-1</li></ul></li></ul><table><thead><tr><th style="text-align:center">下标</th><th style="text-align:center">data</th><th style="text-align:center">parent</th><th style="text-align:center">firstchild</th></tr></thead><tbody><tr><td style="text-align:center">0</td><td style="text-align:center">A</td><td style="text-align:center">-1</td><td style="text-align:center">-1</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">B</td><td style="text-align:center">0</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">C</td><td style="text-align:center">0</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">D</td><td style="text-align:center">1</td><td style="text-align:center">6</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">E</td><td style="text-align:center">2</td><td style="text-align:center">9</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">F</td><td style="text-align:center">2</td><td style="text-align:center">-1</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">G</td><td style="text-align:center">3</td><td style="text-align:center">-1</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">H</td><td style="text-align:center">3</td><td style="text-align:center">-1</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">I</td><td style="text-align:center">3</td><td style="text-align:center">-1</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">J</td><td style="text-align:center">4</td><td style="text-align:center">-1</td></tr></tbody></table><p>对于有0个或1个孩子结点来说,这样的结构是解决了要找结点孩子的问题了。但完全无法体现各兄弟之间的关系,所以我们需要再增加一个域,指向结点的右兄弟。也就是说,每一<br>个结点如果它存在右兄弟,则记录下右兄弟的下标。同样的,如果右兄弟不存在,赋值为-1</p><h2 id="二叉树的定义">二叉树的定义</h2><h3 id="二叉树的特点">二叉树的特点</h3><ul><li>二叉树是一种特殊的树状结构,它的每个结点最多有两个孩子结点。</li><li><strong>二叉树的特点</strong><ul><li>每个结点最多有两棵子树，所以二叉树中不存在度大于2的结点。 注意不是只有两棵子树，而是最多有。没有子树或者有一棵子树 都是可以的。</li><li>左子树和右子树是有顺序的，次序不能任意颠倒。</li><li>即使树中某结点只有一棵子树，也要区分它是左子树还是右子树</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250905142715.png"/></div></div><ul><li><strong>二叉树的基本形态</strong><ul><li>空二叉树</li><li>只有一个根结点。</li><li>根结点只有左子树。</li><li>根结点只有右子树。</li><li>根结点既有左子树又有右子树。</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250905144401.png"/></div></div><h3 id="特殊二叉树">特殊二叉树</h3><ul><li>斜树<ul><li>所有的结点都只有左子树的二叉树叫<code>左斜树</code>。所有结点都是只有右子树的二叉树叫<code>右斜树</code>。这两者统称为斜树。斜树有很明显的特点，就是每一层都只有一个结点，结点的个数与二叉树的深度相同。</li><li>有人会想，这也能叫树呀，与我们的线性表结构不是一样吗。对的，其实线性表结构就可以理解为是树的一种极其特殊的表现形式。</li></ul></li><li>满二叉树<ul><li>一棵二叉树中，如果所有分支结点都存在左子树和右子树，并且所有叶子都在同一层上，这样的二叉树称为<code>满二叉树</code>。</li><li>在满二叉树中，叶子只能出现在最下面一层，且这一层的叶子数必须达到最大。</li><li>非叶子节点的度一定是2</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250905144810.png"/></div></div><ul><li>完全二叉树<ul><li>对一棵具有n个结点的二叉树按层序编号，如果编号为i（1≤i≤n）的结点与同样深度的满二叉树中编号为i的结点在二叉树中位置完全相同，则这棵二叉树称为完全二叉树</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250905145213.png"/></div></div><ul><li>区分满二叉树和完全二叉树<ul><li>满二叉树一定是一棵完全二叉树，但完全二叉树不一定满</li><li>完全二叉树的所有结点与同样深度的满二叉树，它们<code>按层序编号</code>相同的结点，是<code>一一对应</code>的。</li><li>图中的树1，因为5结点没有左子树，却有右子树，那就使得按层序编号的第10个编号空档了。同样道理，图中的树2，由于3结点没有子树，所以使得6、7编号的位置空档了。图6中的树3又是因为5编号下没有子树造成第10和第11位置空档，所以这三棵树既不是满二叉树也不是完全二叉树</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250905145547.png"/></div></div><p>总结一下完全二叉树和满二叉树的特点：</p><ul><li><strong>满二叉树：</strong><ul><li>叶子只能出现在最下一层。</li><li>非叶子结点的度一定是2。</li><li>在同样深度的二叉树中，满二叉树的结点个数最多，叶子数最多。</li></ul></li><li><strong>完全二叉树：</strong><ul><li>叶子结点只能出现在最下两层。</li><li>最下层的叶子一定集中在左部连续位置。</li><li>倒数二层，若有叶子结点，一定都在右部连续位置。</li><li>如果结点度为1，则该结点只有左孩子，即不存在只有右子树的情况。</li><li>同样结点数的二叉树，完全二叉树的深度最小。</li></ul></li></ul><h2 id="二叉树的性质">二叉树的性质</h2><details class="folding-tag" blue><summary> 性质1：在二叉树的第i层上至多有2<sup>i-1</sup> 个结点（i≥1） </summary>              <div class='content'>              <p>这个性质很好记忆<br>第一层是根结点，只有一个，所以2<sup>1-1</sup> =2<sup>0</sup> =1。<br>第二层有两个，2<sup>2-1</sup> =2<sup>1</sup> =2。<br>第三层有四个，2<sup>3-1</sup> =2<sup>2</sup> =4。<br>第四层有八个，2<sup>4-1</sup> =2<sup>3</sup> =8。<br>通过<code>数据归纳法</code>的论证，可以很容易得出在二叉树的第i层上至多有2<sup>i-1</sup> 个结点（i≥1）的结论。</p>              </div>            </details><details class="folding-tag" yellow><summary> 性质2：深度为k的二叉树至多有2<sup>k</sup>-1个结点（k≥1） </summary>              <div class='content'>              <p>这里看清楚是2<sup>k</sup>-1个结点(K≥1)；<br>深度为k意思就是有k层的二叉树;<br>如果有一层，至多1=2<sup>1</sup> -1个结点。<br>如果有二层，至多1+2=3=2<sup>2</sup> -1个结点。<br>如果有三层，至多1+2+4=7=2<sup>3</sup> -1个结点。<br>如果有四层，至多1+2+4+8=15=2<sup>4</sup> -1个结点。<br><strong>通过数据归纳法的论证，可以得出，如果有k层，此二叉树至多有2<sup>k</sup>-1个结点。</strong></p>              </div>            </details><details class="folding-tag" green><summary> 性质3：对任何一棵二叉树T，如果其叶子结点数为n<sub>0</sub> ，度为2的结点数为n<sub>2</sub> ，则n<sub>0</sub> =n<sub>2</sub> +1。 </summary>              <div class='content'>              <p>一棵二叉树，除了叶子结点外，剩下的就是度为1或2的结点数了，我们设n<sub>1</sub> 为度是1的结点数。则树T<code>结点总数n</code>的计算方法为：<strong>n=n<sub>0</sub> +n <sub>1</sub> +n <sub>2</sub></strong>。<br>换一个角度，计算一下分支线的数量，我们可以发现，除了根节点外，每生成一个结点，他都对应着一条分支线，故<code>分支线总数为n-1</code>。<br>度为1的结点他会向外有两个分支线出去，度为2的结点会向外两个分支线出去，所以分支线总数=度为1的结点产生的分支线+度为2的结点产生的分支线，即为<strong>n-1=n<sub>1</sub> +n <sub>2</sub></strong>,联立可推导出<strong>n<sub>0</sub> =n<sub>2</sub> +1</strong>。</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906124455.png"/></div></div>              </div>            </details><details class="folding-tag" ><summary> 性质4：具有n个结点的完全二叉树的深度为|log <sub>2</sub> n+1|（|x|表示不大于x的最大整数）。 </summary>              <div class='content'>              <p>其实根据性质2就可以反推出该性质，因为该二叉树为满二叉树时结点数最多，故一个深度为k-1的满二叉树有2<sub>k-1</sub>-1个结点。所以深度为k的完全二叉树至少有2<sub>k-1</sub>个结点，最多有2<sub>k</sub>-1个结点。逆运算即可根据结点数求出深度。</p>              </div>            </details><details class="folding-tag" cyan><summary> 性质5：如果对一棵有n个结点的完全二叉树（其深度为|log <sub>2</sub> n|+1）的结点按层序编号（从第1层到第|log <sub>2</sub> n|+1层，每层从左到右），对任一结点i（1≤i≤n） 有：<br> 1．如果i=1，则结点i是二叉树的根，无双亲；如果i>1，则其双亲是结点[i/2]<br> 2．如果2i>n，则结点i无左孩子（结点i为叶子结点）；否则其左孩子是结点2i。<br> 3．如果2i+1>n，则结点i无右孩子；否则其右孩子是结点2i+1。 </summary>              <div class='content'>              <ul><li>对于第一条来说是很显然的，i=1时就是根结点。i&gt;1时，比如结点7，它的双亲就是[7/2]=3，结点9，它的双亲就是[9/2]=4。</li><li>第二条，比如结点6，因为2×6=12超过了结点总数10，所以结点6无左孩子，它是叶子结点。同样，而结点5，因为2×5=10正好是结点总数10，所以它的左孩子是结点10。</li><li>第三条，比如结点5，因为2×5+1=11，大于结点总数10，所以它无右孩子。而结点3，因为2×3+1=7小于10，所以它的右孩子是结点7。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906130158.png"/></div></div>              </div>            </details><h2 id="二叉树存储结构">二叉树存储结构</h2><h3 id="二叉树的顺序存储结构">二叉树的顺序存储结构</h3><ul><li>前面提到，对于树这种一对多的关系，顺序存储结构较难实现。但二叉树是一种特殊的树，因为他的特殊性，所以顺序存储结构也能实现。</li><li>二叉树的顺序存储结构就是用一维数组存储二叉树中的结点，并且结点的存储位置，也就是数组的下标要能体现结点之间的逻辑关系，比如双亲与孩子的关系，左右兄弟的关系等。</li></ul><div class="tabs" id="二叉树的顺序存储"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#二叉树的顺序存储-1">完全二叉树的顺序存储</button></li><li class="tab"><button type="button" data-href="#二叉树的顺序存储-2">普通二叉树的顺序存储</button></li><li class="tab"><button type="button" data-href="#二叉树的顺序存储-3">斜二叉树的顺序存储</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="二叉树的顺序存储-1"><p>完全二叉树用顺序存储的方法存储很简单，将树依按层级下排即可。</p><ul><li>一棵完全二叉树：</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906130822.png"/></div></div><ul><li>将该二叉树存入数组，结果如下：</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906130921.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="二叉树的顺序存储-2"><p>普通二叉树也可以按照其完全二叉树进行编号，只不过把不存在的节点设为&quot;^&quot;&quot;而已。</p><ul><li>一棵普通二叉树：</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906131510.png"/></div></div><ul><li>将该二叉树存入数组，结果如下：</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906131544.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="二叉树的顺序存储-3"><p>考虑一下极端情况，如果一棵二叉树为斜二叉树，它只有k个结点，却需要分配2<sup>k-1</sup>个存储单元空间，这显然是对存储空间的浪费</p><ul><li>一棵右斜二叉树:</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906132031.png"/></div></div>* 将该二叉树存入数组，结果如下：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906132153.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note warning no-icon flat"><p>所以顺序二叉树结构一般只用于完全二叉树</p></div><h3 id="链式存储结构-2">链式存储结构</h3><ul><li>继续来考虑二叉树的链式存储结构。二叉树每个结点最多有两个孩子，所以为它设计一个数据域和两个指针域是比较自然的想法，我们称这样的链表叫做<code>二叉链表</code>。</li></ul><div class="tabs" id="链式存储结构"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#链式存储结构-1">结构定义</button></li><li class="tab active"><button type="button" data-href="#链式存储结构-2">结构示意图</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="链式存储结构-1"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">BiTNode</span>&#123;</span></span><br><span class="line">  TElemType data;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">BiTNode</span> *<span class="title">lchild</span>, *<span class="title">rchild</span>;</span></span><br><span class="line">&#125;BitNode, *BiTree;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="链式存储结构-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906133054.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info no-icon flat"><p>如果有需要，还可以再增加一个指向其双亲的指针域，那样就称之为三叉链表。</p></div><h2 id="遍历二叉树">遍历二叉树</h2><h3 id="遍历原理">遍历原理</h3><details class="folding-tag" ><summary> 遍历次序 </summary>              <div class='content'>              <p>如果手头有20张100元的和2000张1元的奖券同时洒向了空中，所有人比赛谁捡的最多，相信所有人都会先捡100元的，因为这样效率更高，所以可以得到这样的结论:<strong>同样是捡奖券，在有限时间内，要达到最高效率，次序非常重要</strong>。对于二叉树的遍历来讲，次序同样显得很重要。</p>              </div>            </details><div class="note default no-icon flat"><p><code>二叉树的遍历（traversing binary tree）</code>是指从根结点出发，按照某种次序依次访问二叉树中所有结点，使得每个结点被访问一次且仅被访问一次。</p></div><p>二叉树的遍历次序不同于线性结构，最多也就是从头至尾、循环、双向等简单的遍历方式。树的结点之间不存在唯一的前驱和后继关系，在访问一个结点后，下一个被访问的结点面临着不同的选择。就像你人生的道路上，面临的不同的选择，由于选择方式的不同，遍历的次序就完全不同了。</p><h3 id="遍历方法">遍历方法</h3><ul><li>二叉树的遍历方式可以很多，如果限制了从左到右的习惯方式，那么主要就分为四种：</li></ul><details class="folding-tag" ><summary> * 前序遍历：根->左->右 </summary>              <div class='content'>              <ul><li>规则是若二叉树为空，则空操作返回，否则先访问根结点，然后前序遍历左子树，再前序遍历右子树。如图所示，遍历的顺序为：ABDGH-CEIF。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906135430.png"/></div></div>              </div>            </details><details class="folding-tag" ><summary> * 中序遍历：左->根->右 </summary>              <div class='content'>              <p>规则是若树为空，则空操作返回，否则从根结点开始（注意并不是先访问根结点），中序遍历根结点的左子树，然后是访问根结点，最后中序遍历右子树。如图所示，遍历的顺序为：GDHBAE-ICF。</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906135535.png"/></div></div>              </div>            </details><details class="folding-tag" ><summary> * 后序遍历：左->右->根 </summary>              <div class='content'>              <p>规则是若树为空，则空操作返回，否则从左到右先叶子后结点的方式遍历访问左右子树，最后是访问根结点。如图所示，遍历的顺序为：GHDBIEFCA。</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906135604.png"/></div></div>              </div>            </details><details class="folding-tag" ><summary> * 层序遍历：按层序遍历 </summary>              <div class='content'>              <p>规则是若树为空，则空操作返回，否则从树的第一层，也就是根结点开始访问，从上而下逐层遍历，在同一层中，按从左到右的顺序对结点逐个访问。如图所示，遍历的顺序为：ABCDEFGHI。</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906135652.png"/></div></div>              </div>            </details><ul><li>为什么要有这么多遍历方法呢？<ul><li>使用图形的方法能够清晰的表现出树的结构，但对计算机来说，他只会处理线性序列，而这四种方法的目的便是将树变成某种意义的线性序列，<strong>我们可以在不同的遍历过程中对结点进行各种处理</strong>。</li></ul></li></ul><h3 id="推导遍历结果">推导遍历结果</h3><div class="note info no-icon flat"><p>有一种题目为了考查对二叉树遍历的掌握程度，是这样出题的。已知一棵二叉树的<code>前序遍历序列为ABCDEF</code>，<code>中序遍历序列为CBAEDF</code>，请问这棵二叉树的后序遍历结果是多少？</p></div><ul><li>三种遍历都是从根节点开始的，只是打印的顺序不同<ul><li>如果给出了前序遍历结果，根据第一个字母能快速确定根节点</li><li>如果给出了后序遍历结果，根据最后一个字母能快速确定根节点</li><li>确定了根节点，便能根据根节点确定左右子树的边界</li></ul></li></ul><details class="folding-tag" ><summary> 示例答案 </summary>              <div class='content'>              <ul><li>根据前序遍历的结果，可以看出A是根节点，而根据中序遍历，可以知道C和B是A的左子树的结点，E、D、F是A的右子树的结点。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906140801.png"/></div></div><ul><li>然后再看左右分支，前序遍历中的C和B是，先打印B后打印C，所以能够得出以B是A的左孩子，而C就只能是B的孩子，但不能确定是左孩子还是右孩子，在中序遍历中C在B的前面打印，这就说明C是B的左孩子，否则就是右孩子。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906141524.png"/></div></div><ul><li><p>再来看右分支，根据谦虚遍历可以知道D是A的右孩子，而E是D的孩子，F可能是D的孩子也可能是E的孩子，根据中序遍历,由于E在D左侧，而F在右侧，则可以知道E是D的左孩子，而F是E的右孩子。</p></li><li><p>最终得到的二叉树：</p></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906141842.png"/></div></div>              </div>            </details><p><code>二叉树遍历的性质：</code></p><ul><li>已知前序遍历序列和中序遍历序列，可以唯一确定一棵二叉树。</li><li>已知后序遍历序列和中序遍历序列，可以唯一确定一棵二叉树。</li></ul><div class="note warning no-icon flat"><ul><li>已知前序遍历和后序遍历是无法确定一棵二叉树的，因为前序遍历和后序遍历都无法确定左右子树的位置。</li><li>比如前序序列是ABC，后序序列是CBA。我们可以确定A一定是根结点，但接下来，我们无法知道，哪个结点是左子树，哪个是右子树。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906142451.png"/></div></div></div><h2 id="树、森林与二叉树的转换">树、森林与二叉树的转换</h2><ul><li>对于树来说，在满足树的条件下可以是任意形状，一个结点可以有任意多个孩子，显然对树的处理要复杂得多，去研究关于树的性质和算法，真的不容易。</li><li>前面所学习的二叉树尽管它也是树，但由于每个结点最多只能有左孩子和右孩子，面对的变化就少很多了。因此很多性质和算法都被研究了出来。</li><li>我们可以实现树和二叉树之间的转化来简化问题吗？<ul><li>在学习树的存储结构时，用到的孩子兄弟法，可以实现将一棵树用二叉链表来存储，所以借助二叉链表，树和二叉树也可以相互进行转换。</li><li>从物理结构来看，它们的二叉链表也是相同的，只是解释不太一样而已。</li><li>因此，只要设定一定的规则，用二叉树来表示树，甚至表示森林都是可以的，森林与二叉树也可以互相进行转换。</li></ul></li></ul><h3 id="树转化为二叉树">树转化为二叉树</h3><p><code>转化步骤：</code></p><ol><li>**加线。**在所有兄弟结点之间加一条连线。</li><li>**去线。**对树中每个结点，只保留它与最左侧第一个孩子结点的连线，删除它与其他孩子结点之间的连线。</li><li>**层次调整。**以树的根结点为轴心，将整棵树顺时针旋转一定的角度，使之结构层次分明。</li></ol><div class="note warning no-icon flat"><p>层次调整时，第一个孩子(长子)是二叉树结点的左孩子，兄弟转换过来的孩子是结点的右孩子。<br>**注意：**当且仅当原树的根节点没有子节点时，二叉树根结点的度为0，其余情况转化后二叉树根节点的度均为1</p></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906144903.png"/></div></div><h3 id="森林转化为二叉树">森林转化为二叉树</h3><ul><li>森林是由若干棵树组成的，所以可以理解为:森林中的每一棵树都是兄弟，可以按照兄弟的处理办法来操作。</li></ul><p><code>转化步骤：</code></p><ol><li>把每个树转换为二叉树。</li><li>第一棵二叉树不动，从第二棵二叉树开始，依次把后一棵二叉树的根结点作为前一棵二叉树的根结点的右孩子，用线连接起来。</li><li>当所有的二叉树连接起来后就得到了由森林转换来的二叉树。</li></ol><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906145554.png"/></div></div><h3 id="二叉树转化为树">二叉树转化为树</h3><p>二叉树转换为树是树转换为二叉树的逆过程，也就是反过来做而已。</p><p><code>转化步骤：</code></p><ol><li>**加线。**若某结点的左孩子结点存在，则将这个左孩子的右孩子结点、右孩子的右孩子结点、右孩子的右孩子的右孩子结点……哈，反正就是左孩子的n个右孩子结点都作为此结点的孩子。将该结点与这些右孩子结点用线连接起来。</li><li>**去线。**删除原二叉树中所有结点与其右孩子结点的连线。</li><li>**层次调整。**使之结构层次分明。</li></ol><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906145922.png"/></div></div><h3 id="二叉树转化为森林">二叉树转化为森林</h3><p>判断一棵二叉树能够转换成一棵树还是森林的标准很简单，那就是只要看这棵二叉树的根结点有没有右孩子，有就是森林，没有就是一棵树。</p><p><code>转化步骤：</code></p><ol><li>从根结点开始，若右孩子存在，则把与右孩子结点的连线删除，再查看分离后的二叉树，若右孩子存在，则连线删除……，直到所有右孩子连线都删除为止，得到分离的二叉树。</li><li>再将每棵分离后的二叉树转换为树即可。</li></ol><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906150250.png"/></div></div><h3 id="树和森林的遍历">树和森林的遍历</h3><p>树的遍历分为两种方式:</p><ol><li><code>先根遍历</code>。即先访问树的根结点，然后依次先根遍历根的每棵子树。</li><li><code>后根遍历</code>。即先依次后根遍历每棵子树，然后再访问根结点。</li><li>下图的树的先根遍历序列为ABEFCDG，后根遍历序列为EFBCGDA。</li></ol><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906150827.png"/></div></div><p>森林的遍历也分为两种方式:</p><ol><li><code>前序遍历</code>：先访问森林中第一棵树的根结点，然后再依次先根遍历根的每棵子树，再依次用同样方式遍历除去第一棵树的剩余树构成的森林。</li><li><code>后序遍历</code>：是先访问森林中第一棵树，后根遍历的方式遍历每棵子树，然后再访问根结点，再依次同样方式遍历除去第一棵树的剩余树构成的森林。</li><li>下图的森林的前序遍历序列的结果就是ABCDEFGHJI,后序遍历序列的结果就是BCDAFEJHIG。</li></ol><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906151141.png"/></div></div><ul><li>对森林转化为的二叉树进行遍历分析即可发现，森林的前序遍历和二叉树的前序遍历结果相同，森林的后序遍历和二叉树的中序遍历结果相同。</li><li>这也就告诉我们，当以二叉链表作树的存储结构时，树的先根遍历和后根遍历完全可以借用二叉树的前序遍历和中序遍历的算法来实现。</li></ul><h2 id="哈夫曼树">哈夫曼树</h2><h3 id="哈夫曼树有什么用？">哈夫曼树有什么用？</h3><details class="folding-tag" ><summary> 数据压缩引入 </summary>              <div class='content'>              <p>“喂，兄弟，最近无聊透顶了，有没有什么书可看？”“我这有《三<br>国演义》的电子书，你要不要？”“‘既生瑜，何生亮。’《三国演<br>义》好呀，你邮件发给我！”“OK！文件1M多大小，好像大了点。我<br>打个包，稍等……哈哈，少了一半，压缩效果不错呀。”“太棒了，<br>快点传给我吧。”</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906151720.png"/></div></div>这是生活中常见的对白，在这个讲究效率的社会，什么都要求速度，在不能出错的情况下，速度越快越好。使用电脑的人几乎都会应用压缩和解压缩软件来处理文档。除了能减少文档在磁盘的空间外，更能让我们在网络上以压缩的形式传输大量数据，使保存和传递更加高效。              </div>            </details><ul><li>现在的压缩技术在编码上已经非常强大，这一切均来自曾经的技术积累。现在来学习最基本的压缩编码方法——<code>哈夫曼编码</code></li><li>在介绍哈夫曼编码前，我们必须得介绍哈夫曼树，而介绍哈夫曼树，我们不得不提这样一个人，美国数学家哈夫曼（David Huffman）。他在1952年发明了赫夫曼编码，为了纪念他的成就，于是就把他在编码中用到的特殊的二叉树称之为哈夫曼树，他的编码方法称为哈夫曼编码。</li></ul><div class="note danger no-icon flat"><p>给定N个权值作为N个叶子结点，构造一棵二叉树，若该树的<code>带权路径长度</code>达到最小，称这样的二叉树为最优二叉树，也称为<code>哈夫曼树（Huffman Tree）</code></p></div><ul><li>乍一看好像没看懂，啥叫带权路径长度达到最小？就是树中所有的叶结点的权值乘上其到根结点根结点的路径长度（若根结点为0层，叶结点到根结点的路径长度为叶结点的层数）</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250906153146.png"/></div></div><ul><li>这里分别将叶子结点ABCD都赋予一个权值，计算后左右两边的计算结果为：<ul><li>左图：WPL=5×2+7×2+2×2+13×2=54</li><li>右图：WPL=5×3+2×3+7×2+13×1=48</li></ul></li><li>通过计算结果可知，右图的带权路径长度最小，实际上右图是一棵哈夫曼树。</li></ul><h3 id="如何创建一棵哈夫曼树？">如何创建一棵哈夫曼树？</h3><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907145557.png"/></div></div><ul><li>现在我们有这些带权的叶子结点，如何将这些叶子结点连接起来，生成一棵哈夫曼树呢？<ul><li>首先将这些带权结点看成树，他们共同构成了一片森林</li><li>然后在这四个结点中，选择两个权值最小的树结合成一棵新的数，左右顺序不重要(因为哈夫曼编码不唯一)，得到的树的根节点是这两个结点的和</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907150113.png"/></div></div><ul><li>接着将这棵树放回到森林中，重复上面的步骤继续选择两个最小的组成新的树，直到森林中只有一棵树为止</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907150534.png"/></div></div><ul><li>这样就得到了一棵哈夫曼树，构造这棵树又有什么用呢？<ul><li>实际上哈夫曼树比较重要的应用就是对数据进行压缩，他是现代压缩算法的基础。</li></ul></li><li>对以下的字符串进行压缩：ABCABCD<ul><li>这里可以直接采用刚才创建的哈夫曼树，对其进行标注</li></ul></li></ul>  <div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907151342.png"/></div></div><ul><li>向左走是0，向右走是1，每个字符的哈夫曼编码即为根节点到这个字符整条路径上的值的拼接<ul><li>A:110</li><li>B:0</li><li>C:111</li><li>D:10</li></ul></li><li>经压缩后得到的编码为：ABCABCD = 110 0 111 110 0 111 10</li></ul><h1>图</h1><h2 id="图的定义">图的定义</h2><details class="folding-tag" yellow><summary> 引入 </summary>              <div class='content'>              <ul><li>旅游几乎是每个年轻人的爱好,但没有钱或没时间也是困惑年轻人不能圆梦的直接原因。假设你有了一笔不算很丰裕的闲钱,也有了约半年的时间。此时打算全国性的旅游,你将会如何安排这次行程呢?</li><li>假设旅游就是逐个省市进行,省市内的风景区不去细分,例如北京玩 7 天,天津玩 3 天,四川玩 20 天,你现在需要做的就是制订一个规划方案,如何才能用最少的成本将图中所有省市都玩遍,这里所谓最少的成本是指<code>交通成本</code>与<code>时间成本</code>。</li><li>如果你不善于规划,很有可能就会出现如玩好新疆后到海南,然后再冲向黑龙江这样的荒唐决策。但是即使是紧挨着省市游玩的方案也会存在很复杂的选择问题,比如游完湖北,周边有安徽、江西、湖南、重庆、陕西、河南等省市,你下一步怎么走最划算呢?</li><li>一时解答不了这些问题是很正常的,计算的工作本来就非人脑而应该是电脑去做的事情。在图的应用中,就有应的算法来解决这样的问题。学完这一章,即便不能马上获得最终的答案,也大概知道应该如何去做了。</li></ul>              </div>            </details><ul><li>在<code>线性表</code>中,数据元素之间仅有线性关系,每个数据元素只有一个直接前驱和一个直接后继。</li><li>在<code>树形结构</code>中,数据元素之间有着明显的层次关系,并且每一层上的数据元素可能和下一层中多个元素相关,但只能和上一层中一个元素相关。这和一对父母可以有多个孩子,但每个孩子却只能有一对父母是一个道理。</li><li>现实中,人与人之间关系就非常复杂,比如我认识的朋友,可能他们之间也互相认识,这就不是简单的一对一、一对多,而是更加复杂的多对多的情况。那就是我们今天要研究的主题——<code>图</code>。图是一种较线性表和树更加复杂的数据结构。在图形构中,结点之间的关系可以是任意的,图中任意两个数据元素之间都可能相关。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907152732.png"/></div></div><div class="note default no-icon flat"><p>图(Graph)是由顶点的<code>有穷非空集合</code>和<code>顶点之间边的集合</code>组成,通常表示为:G ( V,E ), 其中,G 表示一个图,V 是图 G 中顶点的集合,E是图G 中边的集合。</p></div><p>对于图的定义，需要明确的地方：</p><ul><li>线性表中我们把数据元素叫元素,树中将数据元素叫结点,在图中数据元素,我们则称之为<code>顶点(Vertex)</code>。</li><li>线性表中可以没有数据元素,称为空表。树中可以没有结点,叫做空树。但是在图结构中，不允许没有顶点点。在定义中,若是顶点的集合,则强调了顶点集合 V 有穷非空。</li><li>线性表中,相邻的数据元素之间具有线性关系,树结构中,相邻两层的结点具有层次关系,而图中,任意两个顶点之间都可能有关系,顶点之间的逻辑关系用边来表示,<strong>边集可以是空的。</strong></li></ul><h3 id="各种图的定义">各种图的定义</h3><ul><li><strong>无向边:若顶点到之间的边没有方向,则称这条边为无向边(Edge),用无序偶对(vi,vj)来表示</strong>。如果图中任意两个顶点之间的边都是无向边,则称该图为<code>无向图(Undirected graphs)</code>。</li><li><strong>有向边:若从顶点到v的边有方向,则称这条边为有向边,也称为弧(Arc)。,有序偶&lt;vi,vj&gt;来表示,vi称为弧尾(Tail),vj称为弧头(Head)</strong>。如果图中任意两个顶点之间的边都是有向边,则称该图为<code>有向图(Directed graphs)</code>。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907153555.png"/></div></div><ul><li>对于图中的有向图 G<sub>2</sub>来说,G<sub>2</sub>= (V<sub>2</sub>,{E<sub>2</sub>}),其中顶点集合 V<sub>2</sub>={A,B,C,D};弧集合 E<sub>2</sub>= {&lt;A,D&gt;,&lt;B,A&gt;,&lt;C,A&gt;,&lt;B,C&gt;}</li></ul><div class="note warning no-icon flat"><p><strong>无向边用小括号“()”表示,而有向边则是用尖括号“&lt;&gt;”表示。</strong></p></div><p>在图中,若不存在顶点到其自身的边,且同一条边不重复出现,则称这样的图为<code>简单图</code>。在数据结构中学习的基本都是简单图，在这里讨论的也都是简单图，显然下方图片的两张图就不属于讨论的范围</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907154317.png"/></div></div><ul><li><strong>在无向图中，如果任意两个顶点之间都存在边,则称该图为<code>无向完全图</code></strong>。含有n个顶点的无向完全图有nx(n-1)/2条边。比如</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907160343.png"/></div></div><ul><li><strong>在有向图中,如果任意两个顶点之间都存在方向互为相反的两条弧,则称该图为<code>有向完全图</code></strong>。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907160443.png"/></div></div><ul><li>有很少条边或弧的图称为<code>稀疏图</code>,反之称为<code>稠密图</code>。这里稀疏和稠密是模糊的概念,都是相对而言的。</li><li>有些图的边或弧具有与它相关的数字,这种与图的边或弧相关的数叫做<code>权(Weigh)</code>)。这些权可以表示从一个顶点到另一个顶点的距离或耗费。这种带权的图通常称为网(Network)。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907160731.png"/></div></div><ul><li>如果有两个图，其中图A’中所有点和线都能在A中找到，则称图A’是图A的<code>子图。</code></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907161022.png"/></div></div><h3 id="图的顶点与边的关系">图的顶点与边的关系</h3><ul><li>对于无向图 G=(V,{E}),如果边(v,v’)∈E,则称顶点 v 和v’互为<code>邻接点(Adjacent)</code>,即v和v’相邻接。边(v,v’)<code>依附(incident)</code>于顶点 v 和 v’,或者说(v,v’)与顶点v和v’相关联。顶点v的<code>度</code>(Degree)是和v相关联的边的数目,记为TD(v)。例如图7-2-8 左侧上方的无向图,顶点A与B互为邻接点,边(A,B) 依附于顶点 A与B上,顶点 A 的度为3。而此图的边数是5,各个顶点度的和=3+2+3+2=10,推敲后发现,边数就是各顶点度数和的一半,多出的一半是因为重复两次记数。</li><li>对于有向图 G= (V,{E}),如果弧&lt;v,v’&gt; ∈E,则称顶点v邻接到顶点v’,顶点v’邻接自顶点v。弧&lt;v,v’&gt;和顶点 v,v’相关联。以顶点 v 为头的弧的数目称为v的<code>入度(InDegree)</code>,记为ID (v); 以v 为尾的弧的数目称为v的<code>出度(OutDegree)</code>,记为OD(v);顶点v的度为 TD (v) =ID (v) +OD (v)。例如下方的有向图,顶点A的入度是2(从B到A的弧,从C到A的弧),出度是1(从A到D的弧),所以顶点 A 的度为2+1=3。此有向图的弧有4条,而各顶点的出度和=1+2+1+0=4,各顶点的入度和=2+0+1+1=4。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907162007.png"/></div></div><ul><li>路径的长度是路径上的边或弧的数目。例如上图有向图从B到C再到A的路径长度为2。</li></ul><div class="note warning no-icon flat"><p>树中根结点到任意结点的路径是唯一的,但是图中顶点与顶点之间的路径却是不唯一的。</p></div><ul><li>第一个顶点和最后一个顶点相同的路径称为<code>回路或环(Cycle)</code>。序列中顶点不重复出现的路径称为<code>简单路径</code>。除了第一个顶点和最后一个顶点之外,其余顶点不重复出现的回路,称为<code>简单回路或简单环</code>。</li><li>两个图的粗线都构成环,左侧的环因第一个顶点和最后一个顶点都是B,且C、D、A 没有重复出现,因此是一个简单环。而右侧的环,由于顶点C的重复,它就不是简单环了。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907162818.png"/></div></div><h3 id="连通图相关术语">连通图相关术语</h3><ul><li>在无向图 G中,如果从顶点v到顶点有路径,则称和是连通的。如果对于图中任意两个顶点v<sub>i</sub>,v<sub>j</sub>∈E，v<sub>i</sub>和v<sub>j</sub>都是连通的,则称 G 是<code>连通图(ConnectedGraph)</code>。</li><li>图1中它的顶点A到顶点B、C、D 都是连通的,但显然顶点A与顶点E或F就无路径,因此不能算是连通图。而图2,顶点A、B、C、D相互都是连通的,所以它本身是连通图。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907163339.png"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907163625.png"/></div></div><ul><li><strong>无向图中的极大连通子图称为连通分量。注意连通分量的概念,它强调:</strong><ul><li>要是子图;</li><li>子图要是连通的;</li><li>连通子图含有极大顶点数;</li><li>具有极大顶点数的连通子图包含依附于这些顶点的所有边。</li></ul></li><li>图1是一个无向非连通图。但是它有两个连通分量,即图2和图3.而图4,尽管是图1的子图,但是它却不满足连通子图的极大顶点数(图2满足)。因此它不是图1的无向图的连通分量。</li><li><strong>在有向图 G 中,如果对于每一对v<sub>i</sub>,v<sub>j</sub>∈V、v<sub>i</sub>≠v<sub>j</sub>,从v<sub>i</sub>到v<sub>j</sub>和从v<sub>j</sub>到v<sub>i</sub>到都存在路径,则称 G 是强连通图。有向图中的极大强连通子图称做有向图的强连通分量。</strong></li><li>图1并不是强连通图,因为顶点A到顶点D 存在路径,而D到A就在存在。图2就是强连通图,而且显然图2是图1的极大强连通子图,即是它的强连通分量。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907164137.png"/></div></div><ul><li>连通图的生成树定义：<ul><li>所谓的一个连通图的生成树是一个极小的连通子图,它含有图中全部的n 个顶点,但只有足以构成一棵树的 n-1 条边。</li><li>比如图1是一个普通图,但显然它不是生成树,当去掉两条构成环的边后,比如图 2 或图 3,就满足n 个顶点n-1条边且连通的定义了。它们都是一棵生成树。从这里也可知道,如果一个图有 n 个顶点和小于n-1条边,则是非连通图,如果它多于n-1 边条,必定构成一个环,因为这条边使得它依附的那两个顶点之间有了第二条路径。比如图 2 和图 3,随便加哪两顶点的边都将构成环。不过有n-1条边并不一定是生成树,比如图 4。</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907164508.png"/></div></div><ul><li>如果一个有向图 有一个顶点的入度为0,其余顶点的入度均为1,则是一棵<code>有向树</code>。对有向树的理解比较容易,所谓入度为0其实就相当于树中的根结点,其余顶点入度为1 就是说树的非根结点的双亲只有一个。一个有向图的生成森林由若干棵有向树组成,含有图中全部顶点,但只有足以构成若干棵不相交的有向树的弧。如图1是一棵有向图。去掉一些弧后,它可以分解为两棵有向树,如图2和图3,这两棵就是图1有向图的生成森林。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907164623.png"/></div></div><h3 id="图的定义与属于总结">图的定义与属于总结</h3><p>图的术语是真的多，看完感觉脑袋晕晕的，现在整理一下：</p><ul><li>图按照有无方向分为<code>无向图</code>和<code>有向图</code>。无向图由顶点和边构成,有向图由顶点和弧构成。弧有弧尾和弧头之分。</li><li>图按照边或弧的多少分<code>稀疏图</code>和<code>稠密图</code>。如果任意两个顶点之间都存在边叫<code>完全图</code>,有向的叫有向完全图。若无重复的边或顶点到自身的边则叫<code>简单图</code>。</li><li>图中顶点之间有<code>邻接点</code>、<code>依附</code>的概念。无向图顶点的边数叫做<code>度</code>,有向图顶点分为<code>入度</code>和<code>出度</code>。</li><li>图上的边或弧上带权则称为<code>网</code>。</li><li>图中顶点间存在路径,两顶点存在路径则说明是连通的,如果路径最终回到起始点则称为环,当中不重复叫简单路径。若任意两顶点都是连通的,则图就是<code>连通图</code>,有向则称<code>强连通图</code>。图中有子图,若子图极大连通则就是<code>连通分量</code>,有向的则称<code>强连通分量</code>。</li><li>无向图中连通且n 个顶点n-1 条边叫<code>生成树</code>。有向图中一顶点入度为0其余顶点入度为1的叫<code>有向树</code>。一个有向图由若干棵有向树构成生成森林。</li></ul><h2 id="图的存储结构">图的存储结构</h2><ul><li>图的存储结构相较线性表与树来说就更加复杂了。我们口头上说的“顶点的位置”或“邻接点的位置”只是一个相对的概念。其实从图的逻辑结构定义来看,<strong>图上任何一个顶点都可被看成是第一个顶点,任一顶点的邻接点之间也不存在次序关系</strong>，因此无法靠数据元素在内存中的物理位置来表示元素之间的关系，即不可能靠简单的顺序存储结构来表示，靠多重链表的方式和树中一样会造成很多存储单元的浪费。</li><li>我们的前辈提供了五种存储结构：<ul><li>邻接矩阵</li><li>邻接表</li><li>十字链表</li><li>邻接多重表</li><li>边集数组</li></ul></li></ul><h2 id="图的遍历">图的遍历</h2><ul><li>我们经常会面临找东西的问题，不找的东西时常见,需要的东西寻不着。找东西的策略也因人而异。有些人因为找东西没有规划,当一样东西找不到时,往往会反复地找,甚至某些抽屉找个四五遍,另一些地方却一次也没找过。</li><li>图的遍历和找东西类似，我们希望从图中某一顶点出发访遍图中其余顶点,且使每一个顶点仅被访问一次,这一过程就叫做<code>图的遍历 (Traversing Graph)</code>。</li><li>树的遍历共谈到了四种方案,应该说都还好,毕竟根结点只有一个,遍历都是从它发起,其余所有结点都只有一个双亲。可图的任一顶点都可能和其余的所有顶点相邻接,极有可能存在沿着某条路径搜索后,又回到原顶点,而有些顶点却还没有遍历到的情况。因此我们需要在遍历过程中把访问过的顶点打上标记,以避免访问多次而不自知。具体办法是设置一个访问数组 visited[n], n 是图中顶点的个数,初值为0,访问过后设置为 1。这其实在小说中常常见到,一行人在迷宫中迷了路,为了避免找寻出路时屡次重复,所以会在路口用小刀刻上标记。</li><li>对于图的遍历来说,如何避免因回路陷入死循环,就需要科学地设计遍历方案,通常有两种遍历次序方案:它们是<code>深度优先遍历</code>和<code>广度优先遍历</code>。</li></ul><h3 id="深度优先遍历">深度优先遍历</h3><ul><li><strong>深度优先遍历(Depth_First_Search),也有称为深度优先搜索,简称为 DFS。</strong></li><li>可以通俗的理解为<strong>不撞南墙不回头</strong>，一直搜索某一个方向，直到该方向所以顶点均搜索完毕，再退回来，继续搜索其他方向的顶点，直到所有顶点都搜索完毕。</li></ul><details class="folding-tag" ><summary> 搜索过程示例 </summary>              <div class='content'>              <p>比如现在我们要从A开始寻找下图中的I：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/XgN2k3Ce9VnUDaR.png"/></div></div>路线可以是这样的：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/XO93w5N6tEMIhFZ.png"/></div></div>顶点B有三个方向，我们可以先随便选一个方向看看：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/gFIJDkKEOe4bzl5.png"/></div></div>此时来到K，我们发现K已经是一个死胡同，没有其他路了，那么此时我们就需要回到上一个路口，继续去探索其他的路径：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/NSUDtQTRZfoBnuY.png"/></div></div>接着往下一个相邻的顶点G走，发现G有其他的分叉，那么我们就继续向前：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/sp39cE8yhT54F1R.png"/></div></div>此时走到F发现又是死路，那么退回到G，走其他的方向：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/a8I7smtX6PK3NVe.png"/></div></div>又到死胡同了，同样的，回到G继续走其他方向：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/o8MSFfkiHe1ptGV.png"/></div></div>走到C之后，我们有其他的路，我们继续往后走：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/v4rlfJdkaWCIcOi.png"/></div></div>此时走到顶点H，发现H只有一条路，并且H再向前是已经走过的顶点B，那么此时不能再向前了，所以说直接退回到C，走另一边：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/JCNUjlfpOgbkLIQ.png"/></div></div>此时来到E，又有两条路，那么继续随便选一条走：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/IK1AZgGjXr3LqJm.png"/></div></div>此时来到顶点J，发现又是死胡同，退回到E，继续走另一边：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/IK1AZgGjXr3LqJm.png"/></div></div>经过了这么多试错，终于是找到了I顶点，这种方式就是`深度优先搜索`。              </div>            </details><h3 id="广度优先遍历">广度优先遍历</h3><ul><li><code>广度优先遍历(Breadth_First_Search)</code>,又称为广度优先搜索,简称BFS。</li><li>以找钥匙为例，深度优先搜索是挨个房间查找，将这个房间的所有地方挨个查找后，若未找到则继续查找下一个房间，但我们一般不会把钥匙放到厨房的油烟机或者大衣柜的最顶上吧，而深度优先搜索则是，把这个房间的所有地方都查找一遍才查找下一个房间，这未必是最佳方案，所以我们可以先把家里所有房间简单看一遍，看看钥匙是不是放在显眼的位置，没有找到再找一找最常去的地方，这样一步步扩大查找的范围，直到找到为止，这就是广度优先遍历。</li><li>广度优先遍历和二叉树中的层序遍历类似，层序遍历实际上是优先将每一层进行遍历，图的搜索其实也可以采用这种方案，我们可以先探索顶点所有的分支，然后再依次去看这些分支的所有分支：</li></ul><details class="folding-tag" ><summary> 搜索过程示例 </summary>              <div class='content'>              <div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/qm3OUZbv8XzFLiJ.png"/></div></div><p>依旧还是从A来到B，此时B有三条分叉路，我们依次访问这三条路的各个顶点：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/SCeXgptNDbdFkLi.png"/></div></div><p>我们先记录一下这三个顶点，同样需要使用队列来完成：H、G、K</p><p>注意访问之后不要再继续向下了，接着我们从这三个里面的第一个顶点H开始，按照同样的方法继续：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/t8c2KVLZM6qx4ui.png"/></div></div>此时因为只有一个分支，所以说找到C，继续记录，将C也添加进去：G、K、C注意此时需要回去，继续看之前三个顶点的第二个顶点G：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/Y5qFPAbanH4VcuM.png"/></div></div>此时C已经看过了，接着就找到了F和D，也是记录一下：K、C、F、D然后，我们继续看之前三个结点的最后一个:<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/3yfDGmKzLbBhcsA.png"/></div></div>此时K已经是死胡同了，那么就结束，然后继续看下一个C：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/4aTCOYzlm3dLGbt.png"/></div></div>此时继续将E给记录进去：F、D、E，接着看D和F，也没有后续了，那么最后就只有E了：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://oss.itbaima.cn/internal/markdown/2022/08/31/lWyvMUbSdsELVNI.png"/></div></div>              </div>            </details><div class="note warning no-icon flat"><p>实际上广度优先遍历就是尽可能地扩展范围，多去探索广阔的土地，而不是死拽着一根不放</p></div><h3 id="两种遍历的区别">两种遍历的区别</h3><ul><li>对比图的深度优先遍历与广度优先遍历算法,你会发现,它们在**时间复杂度上是一样的,不同之处仅仅在于对顶点访问的顺序不同。**可见两者在全图遍历上是没有优劣之分的,只是视不同的情况选择不同的算法。</li><li>不过如果图顶点和边非常多,不能在短时间内遍历完成,遍历的目的是为了寻找合适的顶点,那么选择哪种遍历就要仔细斟酌了。<ul><li>深度优先更适合目标比较明确,以找到目标为主要目的的情况</li><li>广度优先更适合在不断扩大遍历范围时找到相对最优解的情况。</li></ul></li></ul><h2 id="最小生成树">最小生成树</h2><details class="folding-tag" yellow><summary> 引入 </summary>              <div class='content'>              <ul><li>假设你是电信的实施工程师,需要为一个镇的九个村庄架设通信网络做设计,村庄位置大致如图,其中vo~ve是村庄,之间连线的数字表示村与村间的可通达的直线距离,比如 vo 至1就是10公里(个别如vo与V6,V6与V8,V5与V7未测算距离是因为有高山或湖泊,不予考虑)。你们领导要求你必须用最小的成本完成这次任务。你说怎么办?</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907175337.png"/></div></div>* 显然这是一个带权值的图,即网结构。所谓的最小成本,就是n个顶点,用n-1条边把一个连通图连接起来,并且使得权值的和最小。在这个例子里,每多一公里就多一份成本,所以只要让线路连线的公里数最少,就是最少成本了。<ul><li>如果你加班加点,没日没夜设计出的结果是方案一(粗线为要架设线路),我想你离被炒鱿鱼应该是不远了(同学微笑)。因为这个方案比后两个方案多出60%的成本会让老板气晕过去的。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907175551.png"/></div></div>* 方案三设计得非常巧妙,但也只以极其微弱的优势对方案二胜出,应该说很是侥幸。我们有没有办法可以精确计算出这种网图的最佳方案呢?答案当然是Yes。              </div>            </details><ul><li><p>在学习图的定义和术语时,曾经提到过,一个连通图的生成树是一个极小的连通子图,它含有图中全部的顶点,但只有足以构成一棵树n-1 条边，多一条会成环，少一条则无法连通。显然图中的三个方案都是网图的生成树。那么我们把构造连通网的最小代价生成树称为<code>最小生成树(Minimum Cost Spanning Tree)</code>，最小生成树主要针对于无向图。</p></li><li><p>找连通网的最小生成树,经典的有两种算法：<code>普里姆算法</code>和<code>克鲁斯卡尔算法</code>。</p></li></ul><div class="note danger no-icon flat"><p><strong>普利姆算法和克鲁斯卡尔算法都是典型的贪心算法，其核心逻辑完全遵循贪心算法 “每一步都选择当前最优解，最终期望得到全局最优解” 的设计思想</strong></p></div><h3 id="普里姆算法">普里姆算法</h3><ul><li><code>普利姆算法(Prim Algorithm)</code>，也可以通俗的理解为<code>加点法</code></li><li>基本思路：从图中任意选择一个顶点作为起始点，然后每次选择一个与当前生成树连通的顶点中距离最小的顶点，将其加入到生成树中。重复这个过程，直到所有顶点都被加入到生成树中。</li></ul><ol><li>如图a，首先从图中任意取出一个顶点，这里取出顶点0，此时跟顶点0连接的三条边长分别为5,1,2，最小的边长为1</li><li>如图b，选择最小的边长，将两个顶点连接起来，接着寻找和顶点0以及顶点2连接的各条边，此时各边长分别为5,3,2,6,2,最小的边长为2</li><li>如图c，选择边长为2的边,因为有两条边长为2,所以可以任意选一个顶点，检查是否有顶点与该顶点连通，如果没有连通则连接该顶点，如果有连通，则换一个顶点。</li><li>如图d，重复上面的步骤，此时可选的边长共有5,3,2,3(没有6是因为2和3是连通的所以不作考虑)接着选择另一个边长为2的边，将其连接</li><li>如图e，重复上面的步骤，此时可选的边长共有5,3,3,4,最小的边长为3，此时所有顶点都已经并入生成树，求得最小生成树</li></ol><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907192315.png"/></div></div><div class="note danger no-icon flat"><p>普利姆算法是以找点为核心，边是根据距离顺带加入的，所以<strong>普利姆算法更适用于稠密图</strong></p></div><h3 id="克鲁斯卡尔算法">克鲁斯卡尔算法</h3><ul><li><code>克鲁斯卡尔算法(Kruskal Algorithm)</code>，可以通俗的理解为加边法</li><li>基本思路：每次找出候选边中权值最小的边，并将该边并入生成树中，重复此过程直到所有边都被检测完为止</li></ul><ol><li>如图a，搜索所有边，将所有边按照权值从小到大排序，得到1&lt;2=2&lt;3=3&lt;4&lt;5&lt;6</li><li>如图b，选择权值最小的边，将其加入到生成树中，此时生成树只有一个顶点，所以不会成环</li><li>如图c，重复上面的步骤，选择权值为2的边，因为有两条边权值为2，随机选一条将其加入到生成树中，此时生成树有两个顶点，所以不会成环</li><li>如图d，重复上面的步骤，选择另一条权值为2的边，将其加入到生成树中，此时生成树有三个顶点，所以不会成环</li><li>如图e，重复上面的步骤，选择权值为3的边，有两条，但发现其中一条3和4是连通的所以跳过这条边，而另一条是不连通的，将其加入到生成树中</li><li>可以继续检测下面的边，但此时所有顶点都已经连通，故无论增加哪条边都会成环，故现在已经求得最小生成树</li></ol><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250907194237.png"/></div></div><div class="note danger no-icon flat"><p>克鲁斯卡尔算法是以找边为核心，所以<strong>克鲁斯卡尔算法更适用于稀疏图</strong></p></div><h3 id="总结">总结</h3><ul><li>对比两个算法，克鲁斯卡尔算法主要是针对边来展开，边数少时效率会非常高，所以对于稀疏图有很大的优势；而普里姆算法对于稠密<br>图，即边数非常多的情况会更好一些。</li><li>无论是普利姆算法还是克鲁斯卡尔算法，所求得的无向图最小生成树都不一定是唯一的，但他们的边权和一定是唯一的</li></ul><h2 id="最短路径">最短路径</h2><ul><li>在网图和非网图中，最短路径的含义是不同的。<ul><li>非网图它没有边上的权值，所谓的最短路径，其实就是指两顶点之间经过的边数最少的路径；</li><li>对于网图来说，最短路径，是指两顶点之间经过的边上权值之和最少的路径，并且我们称路径上的第一个顶点是源点，最后一个顶点是终点。</li></ul></li><li>显然，研究网图的最短路径更有意义，有两种算法求最短路径的算法，分别是<code>迪杰斯特拉算法</code>和<code>弗洛伊德算法</code></li></ul><h3 id="迪杰斯特拉算法">迪杰斯特拉算法</h3><ul><li>算法思想：<ul><li>假设有两个顶点集合S和T，集合S中存放图中已找到最短路径的顶点，集合T存放图中剩余顶点。</li><li>初始状态集合S只包含源点a,然后不断从集合T中选取到顶点a路径最短的顶点a’并加入到集合S中</li><li><strong>集合S每次并入一个新顶点a’，都要修改顶点a到集合T中顶点的最短路径的长度</strong></li><li>不断重复该过程，直到集合T中的顶点全部并入到S为止</li></ul></li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/7900420009e17da01dbace0e4ecb4b52.jpg"/></div></div><p>寻找a到各顶点的最短路径：</p><ol><li>初始化先将a到b,c,d,e,f的路径全部设为∞，每当有路径先找寻距离a最近的顶点，a到b的权值为2，a到c的权值为5，故a到b此时为最短路径，将b添加到终点集</li><li></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;绪论&lt;/h1&gt;
&lt;h2 id=&quot;基础概念和术语&quot;&gt;基础概念和术语&lt;/h2&gt;
&lt;h3 id=&quot;数据&quot;&gt;数据&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;数据：数据是&lt;code&gt;描述客观事物&lt;/code&gt;的符号，是计算机可以操作的对象。
&lt;ul&gt;
&lt;li&gt;数据不仅仅包括整型实型等&lt;code&gt;</summary>
      
    
    
    
    <category term="java" scheme="https://silvan2077.github.io/categories/java/"/>
    
    
    <category term="数据结构" scheme="https://silvan2077.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    <category term="算法" scheme="https://silvan2077.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>Python基础</title>
    <link href="https://silvan2077.github.io/2025/08/30/python-python/"/>
    <id>https://silvan2077.github.io/2025/08/30/python-python/</id>
    <published>2025-08-30T08:39:43.000Z</published>
    <updated>2025-09-27T13:26:21.533Z</updated>
    
    <content type="html"><![CDATA[<h1>第一章</h1><h2 id="字面量">字面量</h2><ul><li>定义：在代码中，被写下来的固定的值，称之为字面量。</li><li>Python有六种常用的数据类型</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250830165514.png"/></div></div><h2 id="注释">注释</h2><ul><li>定义：对代码进行解释说明的文字</li><li>作用：对代码进行解释说明，注释不会被执行，只是用来增强程序的可读性</li><li>语法：<ul><li>单行注释：以#开头，#右边的所有文字都会当作说明</li><li>多行注释：以一对三个双引号引起来</li></ul></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 我是单行注释</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">我是多行注释</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>注意：#号和注释内容一般建议以一个空格隔开。</p></div><h2 id="变量">变量</h2><ul><li>定义：程序运行时用来储存计算结果或表示值的抽象概念。简单来说变量是<code>存储数据</code>用的</li><li>变量的定义格式：<code>变量名</code> = <code>值</code></li><li>在Python中，一个变量名可以定义多次，定义的值会覆盖掉之前定义的值</li></ul><h2 id="数据类型">数据类型</h2><p>可以通过type(变量)，查看变量的数据类型，type(变量)的返回值就是该数据的数据类型</p><div class="note warning no-icon flat"><p>注意：变量是无类型的，变量存储的数据是有类型的。</p></div><h2 id="数据类型转换">数据类型转换</h2><ul><li>数据类型之间，在特定的场景下，是可以相互转换的，如字符串转数字，数字转字符串等。</li><li>常见的转换语句</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">这三个语句都是带有结果的（返回值）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">int</span>(x) <span class="comment">#将x转换为一个整数</span></span><br><span class="line"><span class="built_in">float</span>(x) <span class="comment">#将x转换为一个浮点数</span></span><br><span class="line"><span class="built_in">str</span>(x) <span class="comment">#将x转换为一个字符串</span></span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>浮点数转整数会丢失精度，因为整数是没有小数点的</p></div><h2 id="标识符">标识符</h2><ul><li>定义：在编程的时候所使用的一系列名字，用于给变量、类、方法等命名。</li><li>命名规则：<ul><li><code>内容限定</code>：只允许出现：英文、中文(不推荐使用)、数字(不可以用在开头)、下划线（__）</li><li><code>​大小写敏感</code>：大小写可以完全区分</li><li><code>​不可使用关键字</code>：如int、float、str等</li></ul></li><li>命名规范：见名知意、下划线命名法(多个单词组合变量名，需使用下划线做分隔)、英文字母全小写。</li></ul><h2 id="运算符">运算符</h2><ul><li>算术运算符</li></ul><div class="note no-icon flat"><p>以下实例中a=10,b=20</p></div><table><thead><tr><th style="text-align:center">运算符</th><th style="text-align:center">描述</th><th style="text-align:center">实例</th></tr></thead><tbody><tr><td style="text-align:center">+</td><td style="text-align:center">加</td><td style="text-align:center">a+b=30</td></tr><tr><td style="text-align:center">—</td><td style="text-align:center">减</td><td style="text-align:center">a-b=-10</td></tr><tr><td style="text-align:center">*</td><td style="text-align:center">乘</td><td style="text-align:center">a*b=200</td></tr><tr><td style="text-align:center">/</td><td style="text-align:center">除（含小数）</td><td style="text-align:center">a/b=0.5</td></tr><tr><td style="text-align:center">//</td><td style="text-align:center">取整数</td><td style="text-align:center">a//b=0</td></tr><tr><td style="text-align:center">%</td><td style="text-align:center">取余</td><td style="text-align:center">a%b=10</td></tr><tr><td style="text-align:center">**</td><td style="text-align:center">指数</td><td style="text-align:center">a**b输出结果为10的20次方</td></tr></tbody></table><ul><li>赋值运算符</li></ul><table><thead><tr><th style="text-align:center">运算符</th><th style="text-align:center">描述</th><th style="text-align:center">实例</th></tr></thead><tbody><tr><td style="text-align:center">=</td><td style="text-align:center">赋值</td><td style="text-align:center">a=10</td></tr><tr><td style="text-align:center">+=</td><td style="text-align:center">加法赋值</td><td style="text-align:center">a+=10等效于a=a+10</td></tr><tr><td style="text-align:center">-=</td><td style="text-align:center">减法赋值</td><td style="text-align:center">a-=10等效于a=a-10</td></tr><tr><td style="text-align:center">*=</td><td style="text-align:center">乘法赋值</td><td style="text-align:center">a*=10等效于a=a*10</td></tr><tr><td style="text-align:center">/=</td><td style="text-align:center">除法赋值</td><td style="text-align:center">a/=10等效于a=a/10</td></tr><tr><td style="text-align:center">//=</td><td style="text-align:center">取整除赋值</td><td style="text-align:center">a//=10等效于a=a//10</td></tr><tr><td style="text-align:center">%=</td><td style="text-align:center">取余赋值</td><td style="text-align:center">a%=10等效于a=a%10</td></tr><tr><td style="text-align:center">**=</td><td style="text-align:center">指数赋值</td><td style="text-align:center">a**=10等效于a=a**10</td></tr></tbody></table><h2 id="字符串">字符串</h2><h3 id="定义方法">定义方法</h3><ol><li>单引号定义法</li></ol>   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">str1=<span class="string">&#x27;hello world&#x27;</span></span><br><span class="line">str2 = <span class="string">&#x27;It\&#x27;s a cat&#x27;</span>     <span class="comment"># 内部包含单引号时，需用反斜杠 \ 转义</span></span><br><span class="line">str3 = <span class="string">&#x27;He said: &quot;Hello&quot;&#x27;</span><span class="comment"># 内部包含双引号时，无需转义</span></span><br></pre></td></tr></table></figure><ol start="2"><li>双引号定义法</li></ol>   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">str4=<span class="string">&quot;hello world&quot;</span></span><br><span class="line">str5 = <span class="string">&quot;It&#x27;s a cat&quot;</span>     <span class="comment"># 内部包含单引号时，无需转义</span></span><br><span class="line">str6 = <span class="string">&quot;He said: \&quot;Hello\&quot;&quot;</span><span class="comment"># 内部包含双引号时，需用反斜杠 \ 转义</span></span><br></pre></td></tr></table></figure><ol start="3"><li>三引号定义法</li></ol>   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">三引号的特点是：</span></span><br><span class="line"><span class="string"> 1. 支持直接换行（无需用 \n 转义），保留文本的原始格式</span></span><br><span class="line"><span class="string"> 2. 内部可以自由包含单引号和双引号，无需额外转义</span></span><br><span class="line"><span class="string"> 3. 常用来定义多行文本（如文档字符串、SQL 语句、HTML 代码等）</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>p</span><br><span class="line">str7=<span class="string">&#x27;&#x27;&#x27;hello world&#x27;&#x27;&#x27;</span></span><br><span class="line">str8 = <span class="string">&quot;&quot;&quot;It&#x27;s a cat&quot;&quot;&quot;</span>  <span class="comment"># 内部包含单引号时，无需转义</span></span><br><span class="line">str9 = <span class="string">&#x27;&#x27;&#x27;It&#x27;s a cat&#x27;&#x27;&#x27;</span>  <span class="comment"># 内部包含双引号时，无需转义</span></span><br><span class="line"></span><br><span class="line">str10 = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">         He said: </span></span><br><span class="line"><span class="string">         &quot;Hello world!&quot; </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="拼接">拼接</h3><ul><li>字符串支架可以通过+号进行拼接</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">str11 = <span class="string">&quot;hello&quot;</span> + <span class="string">&quot; &quot;</span> + <span class="string">&quot;world&quot;</span></span><br><span class="line"><span class="built_in">print</span>(str11)</span><br></pre></td></tr></table></figure><h3 id="格式化">格式化</h3><ul><li>格式化语法： &quot;%占位符 &quot; %(变量1,变量2,变量3)</li><li>常用占位符<br>|格式符号|转化|<br>|:-----:|:—:|<br>|%s|将内容转换为字符串，放入占位位置|<br>|%d|将内容转换为整数，放入占位位置|<br>|%f|将内容转换为浮点数，放入占位位置|</li><li>快速格式化<ul><li>语法：f&quot;字符串{变量1}字符串{变量2}字符串&quot;</li><li>快速格式化不关注类型，也不能精度控制，只适合没有其他要求时快速使用</li></ul></li></ul><h3 id="字符串格式化的精度控制">字符串格式化的精度控制</h3><ul><li>可以通过使用辅助符号&quot;m,n&quot;来控制数据的<code>宽度</code>和<code>精度</code><ul><li>m表示数据的最小宽度,要求必须是数字，设置的宽度小于数字自身时不生效</li><li>n表示小数点的精度，要求是数字，会进行<code>四舍五入</code></li></ul></li></ul><div class="tabs" id="字符串格式化"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#字符串格式化-1">精度控制示例</button></li><li class="tab"><button type="button" data-href="#字符串格式化-2">示例代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="字符串格式化-1"><blockquote><p>这是一个设置宽度为2位的数字：123<br>这是一个宽度为五位的数字：  123<br>这是一个有两位小数的数字：111.11<br>这是一个宽度为五位,且有两位小数的数字：123.46<br>a=123<br>b=123.456<br>c=111.111</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="字符串格式化-2"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="number">123</span></span><br><span class="line">b=<span class="number">123.456</span></span><br><span class="line">c=<span class="number">111.111</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;这是一个设置宽度为2位的数字：%2d&quot;</span> %a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;这是一个宽度为五位的数字：%5d&quot;</span> %a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;这是一个有两位小数的数字：%0.2f&quot;</span> %c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;这是一个宽度为五位,且有两位小数的数字：%5.2f&quot;</span> %b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot; a=<span class="subst">&#123;a&#125;</span> \n b=<span class="subst">&#123;b&#125;</span> \n c=<span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="输入函数">输入函数</h2><ul><li>语法：input(“提示信息”)</li><li>功能：用于接收用户输入的信息</li><li>返回值：无论用户输入哪种类型的信息，默认都是字符串型</li><li>示例：</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name=<span class="built_in">input</span>(<span class="string">&quot;请输入您的姓名：&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;您的姓名是：<span class="subst">&#123;name&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h1>第二章</h1><h2 id="布尔类型和比较运算符">布尔类型和比较运算符</h2><ul><li>布尔类型：只有两个值True和False</li><li>布尔值可以和数字进行运算，True等价于1，False等价于0</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">t=<span class="literal">True</span></span><br><span class="line">f=<span class="literal">False</span></span><br><span class="line"><span class="built_in">print</span>(t+<span class="number">1</span>)  <span class="comment">#输出结果为2</span></span><br><span class="line"><span class="built_in">print</span>(f+<span class="number">1</span>)  <span class="comment">#输出结果为1</span></span><br></pre></td></tr></table></figure><ul><li>比较运算符</li></ul><table><thead><tr><th>运算符</th><th>描述</th><th>实例</th></tr></thead><tbody><tr><td>==</td><td>判断内容是否<code>相等</code>，满足为True，不满足为False</td><td>如a=5,b=3,则（a==b)为False</td></tr><tr><td>!=</td><td>判断内容是否<code>不相等</code>，满足为True，不满足为False</td><td>如a=5,b=3,则（a!=b)为True</td></tr><tr><td>&gt;</td><td>判断运算符左侧内容是否<code>大于</code>右侧，满足为True，不满足为False</td><td>如a=5,b=3,则（a &gt; b)为True</td></tr><tr><td>&lt;</td><td>判断运算符左侧内容是否<code>小于</code>右侧，满足为True，不满足为False</td><td>如a=5,b=3,则（a &lt; b)为False</td></tr><tr><td>&gt;=</td><td>判断运算符左侧内容是否<code>大于等于</code>右侧，满足为True，不满足为False</td><td>如a=5,b=3,则（a&gt;=b)为True</td></tr><tr><td>&lt;=</td><td>判断运算符左侧内容是否<code>小于等于</code>右侧，满足为True，不满足为False</td><td>如a=5,b=3,则（a&lt;=b)为False</td></tr></tbody></table><h2 id="if语句">if语句</h2><ul><li>语法格式</li></ul><div class="note warning no-icon 注意 flat"><p>判断条件的结果必须是<code>布尔类型</code>；不要忘记判断条件后的:冒号；<br>python根据缩进层级来判断语句的归属，必须严格要求缩进</p></div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">当满足if或elif语句的条件时，会执行if语句下的代码块；</span></span><br><span class="line"><span class="string">执行结束后会直接跳出该if块，不会执行其他的if语句或elif语句</span></span><br><span class="line"><span class="string">当所有if和elif的条件均不满足时，会执行else语句下的代码块；</span></span><br><span class="line"><span class="string">如果没有else语句，且所有条件均不满足时，程序会直接跳过if语句，继续执行后续代码。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">if</span> 条件表达式<span class="number">1</span>:</span><br><span class="line">    语句块<span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> 条件表达式<span class="number">2</span>:</span><br><span class="line">    语句块<span class="number">2</span></span><br><span class="line"><span class="keyword">elif</span> 条件表达式<span class="number">3</span>：</span><br><span class="line">    语句块<span class="number">3</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    语句块<span class="number">4</span></span><br></pre></td></tr></table></figure><h2 id="嵌套if语句">嵌套if语句</h2><ul><li>定义：在一个if语句块中，再嵌套一个if语句</li><li>语法格式</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 满足条件1，再判断条件表达式2，若满足，执行语句块2，若不满足，执行语句块3</span></span><br><span class="line"><span class="comment"># 不满足条件1，直接执行语句块4</span></span><br><span class="line"><span class="keyword">if</span> 条件表达式<span class="number">1</span>:</span><br><span class="line">    语句块<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> 条件表达式<span class="number">2</span>:</span><br><span class="line">        语句块<span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        语句块<span class="number">3</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    语句块<span class="number">4</span></span><br></pre></td></tr></table></figure><div class="note warning no-icon if嵌套 flat"><p>嵌套判断语句可以用于多条件、多层次的逻辑判断；<br>嵌套判断语句可以根据需求，自由组合if elif else来构建多层次判断；<br>嵌套判断语句，一定要注意空格缩进，Python通过空格缩进来决定层次关系。</p></div><h1>第三章</h1><h2 id="while循环">while循环</h2><h3 id="语法格式">语法格式</h3><ul><li>定义：在满足条件的情况下，重复执行某段代码</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> 条件表达式:</span><br><span class="line">    执行语句<span class="number">1</span></span><br><span class="line">    执行语句<span class="number">2</span></span><br><span class="line">    执行语句<span class="number">3</span></span><br><span class="line">    执行语句<span class="number">4</span></span><br><span class="line">    ……</span><br></pre></td></tr></table></figure><div class="note warning no-icon 注意 flat"><p>条件需提供布尔类型结果，True则执行，False则跳过；空格缩进需严格执行；设置好循环终止条件﹐否则将无限循环。</p></div><h3 id="嵌套循环">嵌套循环</h3><ul><li>定义：在一个while循环体内，再嵌套一个while循环</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> 条件表达式<span class="number">1</span>:</span><br><span class="line">    执行语句<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> 条件表达式<span class="number">2</span>:</span><br><span class="line">        执行语句<span class="number">2</span></span><br><span class="line">    执行语句<span class="number">3</span></span><br></pre></td></tr></table></figure><div class="tabs" id="嵌套循环"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#嵌套循环-1">示例代码</button></li><li class="tab"><button type="button" data-href="#嵌套循环-2">输出结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="嵌套循环-1"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> a&lt;<span class="number">5</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;上部while循环，此时a的值为：&quot;</span>,a)</span><br><span class="line">    a+=<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> a&lt;<span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;内部while循环，此时a的值为：&quot;</span>,a)</span><br><span class="line">        a+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;底部while循环，此时a的值为：&quot;</span>,a)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;循环结束，此时a的值为：&quot;</span>,a)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="嵌套循环-2"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">上部<span class="keyword">while</span>循环，此时a的值为： <span class="number">1</span></span><br><span class="line">内部<span class="keyword">while</span>循环，此时a的值为： <span class="number">2</span></span><br><span class="line">底部<span class="keyword">while</span>循环，此时a的值为： <span class="number">3</span></span><br><span class="line">上部<span class="keyword">while</span>循环，此时a的值为： <span class="number">3</span></span><br><span class="line">底部<span class="keyword">while</span>循环，此时a的值为： <span class="number">4</span></span><br><span class="line">上部<span class="keyword">while</span>循环，此时a的值为： <span class="number">4</span></span><br><span class="line">底部<span class="keyword">while</span>循环，此时a的值为： <span class="number">5</span></span><br><span class="line">循环结束，此时a的值为： <span class="number">5</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="补充知识点">补充知识点</h3><ul><li>在python中使用<code>print</code>函数默认换行，该如何实现输出不换行呢？</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>（<span class="string">&quot;hello&quot;</span>,end=<span class="string">&#x27;&#x27;</span>）</span><br><span class="line"><span class="built_in">print</span>（<span class="string">&quot;world&quot;</span>,end=<span class="string">&#x27;&#x27;</span>）</span><br></pre></td></tr></table></figure><ul><li>制表符:<code>\t</code></li><li>实现九九乘法表</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> i &lt;= <span class="number">9</span> :</span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> j &lt;= i:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;j&#125;</span>*<span class="subst">&#123;i&#125;</span>=<span class="subst">&#123;i*j&#125;</span>&quot;</span>,end=<span class="string">&quot;\t&quot;</span>)</span><br><span class="line">        j+=<span class="number">1</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="for循环">for循环</h2><h3 id="使用方法">使用方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 变量 <span class="keyword">in</span> 序列:</span><br><span class="line">    循环体</span><br></pre></td></tr></table></figure><ul><li>实现内容统计</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">name1 = <span class="string">&quot;itheima is a brand of itcast&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> name1:</span><br><span class="line">    <span class="keyword">if</span> x == <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;一共有%d个a&quot;</span>%i)</span><br></pre></td></tr></table></figure><div class="note warning no-icon 注意 flat"><p>for循环中的变量，只在for循环中生效，循环结束后，变量就会被销毁</p></div><div class="note default no-icon 注意 flat"><p>但这种限定是编程规范的限定，在Python中非强制限定；不遵守也能正常运行，但是不建议这样做；如需访问临时变量，可以预先在循环外定义它</p></div><h3 id="range函数">range函数</h3><ul><li><strong>定义</strong>：用于生成一个整数序列</li><li><strong>语法格式</strong><ul><li>语法一：range(num)</li><li>语法二：range(start,stop)</li><li>语法三：range(start,stop,step)</li></ul></li><li><strong>解释</strong><ul><li>语法一表示从0开始，到num结束，不包含num</li><li>语法二表示从start开始，到stop结束，不包含stop</li><li>语法三表示从start开始，到stop结束，不包含stop，步长为step</li></ul></li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#range语法1 range(num)</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="comment"># 输出0-9,不包含10</span></span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment">#range语法2 range(num1,num2)</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="comment"># 输出5-9的一个数字序列,不包含10</span></span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment">#range语法3 range(num1,num2,step)</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="number">10</span>,<span class="number">2</span>):</span><br><span class="line">    <span class="comment"># 输出5,7,9的一个数字序列,数字间隔为2,不包含10</span></span><br><span class="line">    <span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure><h3 id="for循环嵌套">for循环嵌套</h3><ul><li>定义：在一个for循环体内，再嵌套一个for循环</li><li>语法格式</li></ul><blockquote><p>for循环和while循环可以相互嵌套使用</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 变量<span class="number">1</span> <span class="keyword">in</span> 序列<span class="number">1</span>:</span><br><span class="line">    循环体<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> 变量<span class="number">2</span> <span class="keyword">in</span> 序列<span class="number">2</span>:</span><br><span class="line">        循环体<span class="number">2</span></span><br></pre></td></tr></table></figure><h2 id="continue和break">continue和break</h2><ul><li><p><code>continue</code>:中断所在循环的当次执行，直接进入下一次</p></li><li><p><code>break</code>:直接结束所在循环</p></li></ul><div class="note warning no-icon 注意 flat"><p>continue和break在for和while循环中作用一致；<br>并且在嵌套循环中，只能作用在所在的循环上，无法对上层循环起作用</p></div><h1>第四章</h1><h2 id="函数是什么">函数是什么</h2><ul><li>函数是<code>组织好的</code>，<code>可重复使用的</code>，用来<code>实现特定功能</code>的代码块</li><li>函数的好处<ul><li>实现特定功能</li><li>可供随时随地重复利用</li><li>提高代码的复用性，减少重复代码，提高代码的可维护性</li><li>提高开发效率。</li></ul></li></ul><h2 id="定义语法">定义语法</h2><ul><li>当没有参数时，参数列表可以省略，但是括号不能省略</li><li>当函数有返回值时，return语句必须写，且必须返回一个值</li><li>当函数没有返回值时，return语句可以省略</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">函数名</span>(<span class="params">参数<span class="number">1</span>,参数<span class="number">2</span>,参数<span class="number">3</span></span>):</span><br><span class="line">    函数体</span><br><span class="line">    <span class="keyword">return</span> 返回值</span><br></pre></td></tr></table></figure><div class="note warning no-icon 函数 flat"><p>函数必须先定义再使用</p></div><h2 id="传入参数">传入参数</h2><ul><li>传入参数的定义<ul><li><code>形式参数</code>：定义函数时，括号中的参数，称为形式参数</li><li><code>实际参数</code>：调用函数时，括号中的参数，称为实际参数</li></ul></li><li>传入参数的类型<ul><li>位置参数<ul><li>最常见的参数类型，必须按照定义的顺序传递</li><li>例如：def func(a, b): … 调用时 func(1, 2)</li></ul></li><li>关键字参数<ul><li>通过参数名指定值，不依赖顺序</li><li>例如：func(a=1, b=2) 或 func(b=2, a=1)</li></ul></li><li>默认参数<ul><li>定义函数时指定默认值，调用时可省略</li><li>默认参数以后的参数必须定义为默认参数</li><li>例如：def func(a, b=2): … 调用时 func(1) 等效于 func(1, 2)</li></ul></li><li>可变参数<ul><li>接收任意数量的位置参数，用 *args 表示</li><li>例如：def func(*args): … 调用时 func(1, 2, 3)，args 会成为元组 (1, 2, 3)</li></ul></li></ul></li></ul><div class="tabs" id="传入参数"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#传入参数-1">位置参数</button></li><li class="tab"><button type="button" data-href="#传入参数-2">关键字参数</button></li><li class="tab"><button type="button" data-href="#传入参数-3">默认参数</button></li><li class="tab"><button type="button" data-href="#传入参数-4">可变参数</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="传入参数-1"><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line"><span class="built_in">print</span>(add(<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">输出结果：</span></span><br><span class="line"><span class="string">    3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="传入参数-2"><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">MyPrint</span>(<span class="params">a,b</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;a= %d&quot;</span> %a)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;b= %d&quot;</span> %b)</span><br><span class="line"></span><br><span class="line">MyPrint(b=<span class="number">1</span>,a=<span class="number">2</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">输出结果：</span></span><br><span class="line"><span class="string">    a= 2</span></span><br><span class="line"><span class="string">    b= 1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="传入参数-3"><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">MyPrint</span>(<span class="params">a=<span class="number">1</span>,b=<span class="number">2</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;a= %d&quot;</span> %a)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;b= %d&quot;</span> %b)</span><br><span class="line"></span><br><span class="line">MyPrint(<span class="number">1</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">输出结果：</span></span><br><span class="line"><span class="string">    a= 1</span></span><br><span class="line"><span class="string">    b= 2</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250901170006.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="传入参数-4"><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">MyPrint</span>(<span class="params">* args</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> args:</span><br><span class="line">        <span class="built_in">print</span>(x)</span><br><span class="line">    <span class="built_in">print</span>(args)</span><br><span class="line"></span><br><span class="line">MyPrint(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">输出结果：</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    2</span></span><br><span class="line"><span class="string">    3</span></span><br><span class="line"><span class="string">    9</span></span><br><span class="line"><span class="string">    8</span></span><br><span class="line"><span class="string">    7</span></span><br><span class="line"><span class="string">    (1, 2, 3, 9, 8, 7)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="返回值">返回值</h2><ul><li>函数的返回值，通过<code>return</code>关键字返回</li><li>当函数没有返回值时，默认返回<code>None</code></li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">MyAdd</span>(<span class="params">a,b</span>):</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">    <span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line">a=MyAdd(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">输出结果：</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    2</span></span><br><span class="line"><span class="string">    None</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h2 id="None类型">None类型</h2><ul><li><code>None</code>是Python的一个特殊类型，用于表示<code>空值</code>或<code>不存在</code>的情况</li><li>它是一个<code>唯一的对象</code>，在内存中只有一个实例</li><li>可以将<code>None</code>赋值给变量，用于表示变量当前没有值</li><li>不使用return语句返回时，函数默认返回<code>None</code></li><li>使用场景：<ul><li>函数返回值</li><li>if判断</li><li>变量定义</li></ul></li></ul><h2 id="函数说明文档">函数说明文档</h2><ul><li>作用：对函数的参数，作用返回类型等进行说明</li><li>语法格式</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">函数名</span>(<span class="params">参数x,参数y</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    函数说明文档</span></span><br><span class="line"><span class="string">    :param 参数x: 参数x的说明</span></span><br><span class="line"><span class="string">    :param 参数y: 参数y的说明</span></span><br><span class="line"><span class="string">    :return: 返回x+y的值</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    函数体</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br></pre></td></tr></table></figure><h2 id="函数嵌套调用">函数嵌套调用</h2><ul><li>定义：在一个函数中调用另一个函数</li><li>执行流程: 函数A中执行到调用函数B的语句，会将函数B全部执行完成后，继续执行函数A的剩余内容。</li></ul><h2 id="变量在函数中的作用域">变量在函数中的作用域</h2><ul><li><p><code>局部变量</code>：作用范围在函数内部，在函数外部无法使用。</p></li><li><p><code>全局变量</code>：在函数内部和外部均可使用。</p></li><li><p>如何将函数内定义的变量声明为全局变量</p><ul><li>使用global关键字</li></ul></li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">myfunction</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">global</span> c </span><br><span class="line">    c = x+y</span><br><span class="line"></span><br><span class="line">myfunction(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure><h1>第五章</h1><h2 id="数据容器">数据容器</h2><ul><li>定义：一种可以容纳多份数据的数据类型，容纳的每一份数据称之为元素，可以是任意类型的数据，如字符串、数字、布尔等。</li><li>容器的种类：<ul><li>list（列表）</li><li>tuple（元组）</li><li>str（字符串）</li><li>dict（字典）</li><li>set（集合）</li></ul></li></ul><h2 id="列表">列表</h2><h3 id="基本语法：">基本语法：</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一个列表</span></span><br><span class="line">a = [元素<span class="number">1</span>,元素<span class="number">2</span>,元素<span class="number">3</span>, ... ]</span><br><span class="line"><span class="comment"># 创建一个空列表</span></span><br><span class="line">b = []</span><br><span class="line">c = <span class="built_in">list</span>()</span><br></pre></td></tr></table></figure><ul><li>列表中的元素可以是任意类型，如字符串、数字、布尔，甚至元素也可以是列表。</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span> = [<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,[<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;y&#x27;</span>],<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(<span class="built_in">list</span>))</span><br></pre></td></tr></table></figure><h3 id="特点">特点</h3><ul><li>列表的特点：<ul><li>列表是<code>有序的</code>，<code>可变</code>的数据类型</li><li>列表中的元素可以重复</li><li>列表的元素可以改变</li><li>列表能容纳多个元素(上限为2**63-1)</li><li>列表的元素可以进行排序</li><li>列表中能够容纳不同的数据类型</li></ul></li></ul><h3 id="下标索引">下标索引</h3><ul><li>列表的索引从0开始，索引可以使用正数和负数。<ul><li><code>正数索引</code>：从左往右，第一个元素的索引为0，第二个元素的索引为1，以此类推。</li><li><code>负数索引</code>：从右往左，最后一个元素的索引为-1，倒数第二个元素的索引为-2，以此类推。</li></ul></li></ul><h3 id="常用操作">常用操作</h3><table><thead><tr><th style="text-align:center">编号</th><th style="text-align:center">使用方式</th><th style="text-align:center">作用</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">列表.append(元素)</td><td style="text-align:center">向列表追加一个元素</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">列表.extend(元素)</td><td style="text-align:center">将数据内容依次取出，再追加到列表尾部</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">列表.insert(下标，元素)</td><td style="text-align:center">在指定下标处，插入指定的元素</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">del 列表(下标)</td><td style="text-align:center">删除列表指定下标元素</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">列表.pop(下标)</td><td style="text-align:center">删除列表制定下标元素</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">列表.remove(元素)</td><td style="text-align:center">从前往后，删除此元素第一个匹配项</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">列表.clear()</td><td style="text-align:center">清空列表</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">列表.count(元素)</td><td style="text-align:center">统计此元素在列表中出现的次数</td></tr><tr><td style="text-align:center">9</td><td style="text-align:center">列表.index(元素)</td><td style="text-align:center">查找指定元素在列表的下标，找不到报错</td></tr><tr><td style="text-align:center">10</td><td style="text-align:center">len(列表)</td><td style="text-align:center">统计容器内有多少元素</td></tr></tbody></table><p>在Python中，如果将函数定义为class(<code>类</code>）的成员，那么函数会称之为:方法；方法和函数功能一样，有传入参数，有返回值，只是方法的使用格式不同。</p><details class="folding-tag" ><summary> 1. 查找元素下标 </summary>              <div class='content'>              <ul><li>功能:查找指定元素在列表的下标，如果找不到则报错ValueError</li><li>语法:列表.index(元素)；<ul><li>index是列表对象内置的方法（函数)</li></ul></li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>.index(<span class="string">&#x27;h&#x27;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 2. 修改元素 </summary>              <div class='content'>              <p>语法: 列表[下标]=值</p><ul><li>可以直接对指定下标（正向、反向下标均可）的值进行重新赋值（修改)</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span> = [<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,[<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;y&#x27;</span>],<span class="number">1</span>]</span><br><span class="line"><span class="built_in">list</span>[<span class="number">0</span>] = <span class="string">&#x27;a&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 3. 删除元素 </summary>              <div class='content'>              <ul><li>语法1: del列表[下标]</li><li>语法2: 列表.pop(下标)</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> <span class="built_in">list</span>[<span class="number">3</span>]</span><br><span class="line"><span class="built_in">list</span>.pop(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 4. 插入元素 </summary>              <div class='content'>              <ul><li>功能: 在指定位置插入元素</li><li>语法: 列表.insert(下标,元素)</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>.insert(<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details>    <details class="folding-tag" ><summary> 5. 追加元素 </summary>              <div class='content'>              <ul><li>语法1: 列表.append(元素)，将指定元素，追加到列表的尾部</li><li>语法2: 列表.extend(其它数据容器)，将其它数据容器的内容取出，依次追加到列表尾部</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>.append(<span class="string">&#x27;多啦A萌&#x27;</span>)</span><br><span class="line"><span class="built_in">list</span>.extend([<span class="string">&#x27;很&#x27;</span>,<span class="string">&#x27;可&#x27;</span>,<span class="string">&#x27;爱&#x27;</span>])</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 6. 删除出现的第一个元素 </summary>              <div class='content'>              <ul><li>语法:列表.remove(元素)</li><li>删除某元素在列表中的第一个匹配项</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>.remove(<span class="string">&#x27;s&#x27;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 7. 清空列表 </summary>              <div class='content'>              <ul><li>语法:列表.clear()</li><li>清空列表所有元素</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>.clear()</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 8. 统计元素数量 </summary>              <div class='content'>              <ul><li>统计某元素在列表内的数量</li><li>语法:列表.count(元素)</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>.count(<span class="string">&#x27;多啦A萌&#x27;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 9. 统计元素总数量 </summary>              <div class='content'>              <p>语法: len(列表)<br>可以得到一个int数字，表示列表内的元素数量</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(<span class="built_in">list</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><div class="note warning no-icon flat"><p>以上代码块中的list均代指数据类型为列表的变量名。</p></div><h3 id="遍历列表">遍历列表</h3><ul><li>遍历指的是将容器内人元素依次取出后进行操作。</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  while循环遍历</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_while</span>():</span><br><span class="line">    <span class="built_in">list</span> = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>]</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> num&lt; <span class="built_in">len</span>(<span class="built_in">list</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">list</span>[num])</span><br><span class="line">        num+=<span class="number">1</span></span><br><span class="line">list_while()</span><br><span class="line"><span class="comment">#  for循环遍历</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_for</span>():</span><br><span class="line">    <span class="built_in">list</span> = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(x))</span><br><span class="line">list_for()</span><br></pre></td></tr></table></figure><h2 id="元组">元组</h2><ul><li>定义：一种有序的数据类型，元素<code>不可修改</code>，元素可以重复的数据容器。</li><li>与列表的主要区别是：元组中的元素不能修改（可以修改内部list的内部元素）。</li><li>元组的操作</li></ul><table><thead><tr><th style="text-align:center">编号</th><th style="text-align:center">使用方式</th><th style="text-align:center">作用</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">元组.index(元素)</td><td style="text-align:center">查找指定元素在元组的下标，找不到报错</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">元组.count(元素)</td><td style="text-align:center">统计此元素在元组中出现的次数</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">len(元组)</td><td style="text-align:center">统计容器内有多少元素</td></tr></tbody></table><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tuple</span>.index(<span class="string">&#x27;h&#x27;</span>)</span><br><span class="line"><span class="built_in">tuple</span>.count(<span class="string">&#x27;h&#x27;</span>)</span><br><span class="line"><span class="built_in">len</span>(<span class="built_in">tuple</span>)</span><br></pre></td></tr></table></figure><ul><li>元组的遍历</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#元组的遍历: while</span></span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> index &lt; <span class="built_in">len</span>(t1):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;while:元组的元素有: <span class="subst">&#123;t1[index]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="comment">#至关重要</span></span><br><span class="line">    index += <span class="number">1</span></span><br><span class="line"><span class="comment">#元组的遍历:for</span></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> t1:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;for:元组的元素有: <span class="subst">&#123;element&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="字符串-2">字符串</h2><h3 id="下标索引-2">下标索引</h3><ul><li>与列表一样，索引可以使用正数和负数，整数从0开始，负数从-1开始。</li></ul><h3 id="特点-2">特点</h3><ul><li>字符串的特点：<ul><li>字符串是只读的，不能修改</li><li>字符串的每一部分都是一个字符</li><li>字符串是有序的，每个字符都有一个下标</li><li>字符串是可以拼接的，拼接的结果是一个新的字符串</li><li>字符串是可以比较的，比较的结果是一个布尔值</li></ul></li></ul><h3 id="比较">比较</h3><ul><li>字符串之间比较大小是<code>按位比较</code>，也就是一位位的进行对比，只要一位不相同，则不会继续比较下去。</li></ul><h3 id="常用操作-2">常用操作</h3><table><thead><tr><th style="text-align:center">编号</th><th style="text-align:center">操作</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">字符串[下标]</td><td style="text-align:center">根据下标索引取出特定位置的字符</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">字符串.index(字符串)</td><td style="text-align:center">查找给定字符的第一个匹配项的下标</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">字符串.replace(字符串1,字符串2)</td><td style="text-align:center">将所以字符串1替换为字符串2，并不会修改原字符串，是返回一个新的字符串</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">字符串.split(字符串)</td><td style="text-align:center">根据给定的字符分隔字符串，不会修改原字符串，是返回一个新的字符串</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">字符串.strip()或字符串.strip(字符串)</td><td style="text-align:center">移除首尾的空格和换行符或者指定字符串</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">字符串.count(字符串)</td><td style="text-align:center">统计字符串内某字符串的出现次数</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">len(字符串)</td><td style="text-align:center">统计字符串的字符个数</td></tr></tbody></table><details class="folding-tag" ><summary> 1.查找下标 </summary>              <div class='content'>              <p>根据下标索引取出特定位置的字符<br>str.index(‘h’)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#index方法：</span></span><br><span class="line">value = my_str.index( <span class="string">&quot;and&quot;</span> )</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;在字符串<span class="subst">&#123;my_str&#125;</span>中查找and，其起始下标是: <span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 2.字符串替换 </summary>              <div class='content'>              <p>将所以字符串1替换为字符串2，并不会修改原字符串，是返回一个新的字符串<br>用法：str.replace(‘h’,‘a’)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">my_str = <span class="string">&quot;hello and hello&quot;</span></span><br><span class="line">new_str = my_str.replace(<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;world&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(new_str)</span><br><span class="line"><span class="built_in">print</span>(my_str)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 3.字符串分隔 </summary>              <div class='content'>              <p>根据给定的字符分隔字符串，不会修改原字符串，是返回一个新的字符串<br>用法：str.split(‘h’)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">my_str = <span class="string">&quot;hello and hello&quot;</span></span><br><span class="line">new_str = my_str.split(<span class="string">&#x27;and&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(new_str)</span><br><span class="line"><span class="built_in">print</span>(my_str)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 4.字符串移除 </summary>              <div class='content'>              <p>移除首尾的空格和换行符或者指定字符串<br>用法：str.strip()或str.strip(‘指定字符串’)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">my_str = <span class="string">&quot;  hello and hello  &quot;</span></span><br><span class="line">new_str = my_str.strip()</span><br><span class="line"><span class="built_in">print</span>(new_str)</span><br><span class="line"><span class="built_in">print</span>(my_str)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 5.字符串统计 </summary>              <div class='content'>              <p>统计字符串内某字符串的出现次数<br>用法：str.count(‘h’)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">my_str = <span class="string">&quot;hello and hello&quot;</span></span><br><span class="line">new_str = my_str.count(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(new_str)</span><br><span class="line"><span class="built_in">print</span>(my_str)</span><br></pre></td></tr></table></figure>              </div>            </details><div class="note warning no-icon flat"><p>以上代码块中的str均代指数据类型为字符串的变量名。</p></div><h3 id="遍历字符串">遍历字符串</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;itheima itcast boxuegu&quot;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;for循环遍历字符串<span class="subst">&#123;x&#125;</span>&quot;</span>)</span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> index&lt;<span class="built_in">len</span>(<span class="built_in">str</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;while循环遍历字符串<span class="subst">&#123;<span class="built_in">str</span>[index]&#125;</span>&quot;</span>)</span><br><span class="line">    index+=<span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="序列">序列</h2><ul><li><p>定义：指<code>内容连续</code>，<code>有序</code>，<code>元素可以重复</code>且<code>可以使用下标索引</code>的一类数据容器</p></li><li><p>序列是一类数据容器，列表、元组、字符串都是序列</p></li><li><p>切片意思是从一个序列中，取出一个子序列</p><ul><li>语法：<code>[开始索引:结束索引:步长]</code></li><li>表示从序列中，从指定位置开始，依次取出元素，到指定位置结束，得到一个新序列</li><li>说明：<ul><li>开始索引：表示从哪个位置开始取，默认是0</li><li>结束索引：表示到哪个位置结束取，默认是序列的长度</li><li>步长：表示每次取的间隔，默认是1</li></ul></li></ul></li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#对list进行切片，从1开始，4结束，步长</span></span><br><span class="line"><span class="built_in">list</span> = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>[<span class="number">1</span>:<span class="number">4</span>:<span class="number">1</span>])</span><br><span class="line"><span class="comment">#对tuple进行切片，从头开始，到最后结束，步长1</span></span><br><span class="line"><span class="built_in">tuple</span> = (<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">tuple</span>[::])</span><br><span class="line"><span class="comment">#对str进行切片，从头开始，到最后结束，步长2</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;0123456&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>[::<span class="number">2</span>])</span><br><span class="line"><span class="comment">#对str进行切片，从头开始，到最后结束，步长-1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment">#对列表进行切片，从3开始，到1结束，步长-1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>[<span class="number">3</span>:<span class="number">1</span>:-<span class="number">1</span>])</span><br><span class="line"><span class="comment">#对元组进行切片，从头开始，到尾结束，步长-2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">tuple</span>[::-<span class="number">2</span>])</span><br></pre></td></tr></table></figure><h2 id="集合">集合</h2><ul><li>定义：指<code>内容不连续</code>，<code>无序</code>，<code>元素不可以重复</code>的一类数据容器</li><li>集合是无序的，故集合<code>不支持下标索引</code>访问</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义集合字面量</span></span><br><span class="line">&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</span><br><span class="line"><span class="comment"># 定义集合变量</span></span><br><span class="line"><span class="built_in">set</span> = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</span><br><span class="line"><span class="comment"># 创建空集合</span></span><br><span class="line">Set1 = <span class="built_in">set</span>()</span><br></pre></td></tr></table></figure><h3 id="特点-3">特点</h3><ul><li>集合是无序的，故<code>不支持索引</code>访问</li><li>集合不允许重复元素</li><li>集合可以容纳不同类型的数据</li><li>集合可以修改元素</li><li>集合支持for循环，不支持while循环</li></ul><h3 id="常用操作-3">常用操作</h3><table><thead><tr><th style="text-align:center">编号</th><th style="text-align:center">操作</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">集合.add(元素)</td><td style="text-align:center">集合内添加一个元素</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">集合.remove(元素)</td><td style="text-align:center">移除集合内指定的元素</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">集合.pop()</td><td style="text-align:center">从集合中随机取出一个元素</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">集合.clear()</td><td style="text-align:center">将集合清空</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">集合1.difference(集合2)</td><td style="text-align:center">得到一个新集合，内含2个集合的差集 原有的2个集合内容不变</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">集合1.difference_update(集合2)</td><td style="text-align:center">在集合1中，删除集合2中存在的元素 集合1被修改，集合2不变</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">集合1.union(集合2)</td><td style="text-align:center">得到1个新集合，内含2个集合的全部元素 原有的2个集合内容不变</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">len(集合)</td><td style="text-align:center">得到一个记录集合元素数量的数字</td></tr></tbody></table><ul><li>集合不属于序列类，故常用操作与前面的列表等数据容器差异较大</li></ul><details class="folding-tag" ><summary> 1.添加元素 </summary>              <div class='content'>              <ul><li>语法:集合.add(元素)。将指定元素，添加到集合内。</li><li>结果:集合本身被修改，添加了新元素。</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>.add(<span class="string">&#x27;hello&#x27;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 2.删除元素 </summary>              <div class='content'>              <ul><li>语法:集合.remove(元素)，将指定元素，从集合内移除。</li><li>结果:集合本身被修改，移除了元素。</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>.remove(<span class="string">&#x27;hello&#x27;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 3.随机取出元素 </summary>              <div class='content'>              <ul><li>语法∶集合.pop()功能，从集合中随机取出一个元素。​</li><li>结果:会得到一个元素的结果。同时集合本身被修改，元素被移除。</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 实际上pop的随机是伪随机，重复执行以下代码会发现，删除的第一个一直是1，第二次删除一定是2</span></span><br><span class="line"><span class="built_in">set</span> = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">5</span> &#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">set</span>)</span><br><span class="line">a=<span class="built_in">set</span>.pop()</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">set</span>.add(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">set</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">set</span>.pop())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">set</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 4. 清空集合 </summary>              <div class='content'>              <ul><li>用于清空集合元素。</li><li>结果:集合清空为空集合。</li></ul>              </div>            </details><details class="folding-tag" ><summary> 5. 获取集合的差集 </summary>              <div class='content'>              <ul><li>语法∶集合1.difference(集合2)</li><li>功能:取出集合1和集合2的差集（集合1有而集合2没有的)</li><li>结果:得到一个新集合，集合1和集合2不变。</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set1 = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</span><br><span class="line">set2 = &#123;<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>&#125;</span><br><span class="line">set3 = set1.difference(set2)</span><br><span class="line"><span class="built_in">print</span>(set3)</span><br><span class="line"><span class="built_in">print</span>(set1)</span><br><span class="line"><span class="built_in">print</span>(set2)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 6.消除两个集合的差集 </summary>              <div class='content'>              <ul><li>语法:集合1.difference_update(集合2)</li><li>功能:对比集合1和集合2，在集合1内，删除和集合2相同的元素。</li><li>结果:集合1被修改，集合2不变</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set1 = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</span><br><span class="line">set2 = &#123;<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>&#125;</span><br><span class="line">set1.difference_update(set2)</span><br><span class="line"><span class="built_in">print</span>(set1)</span><br><span class="line"><span class="built_in">print</span>(set2)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 7.合并两个集合 </summary>              <div class='content'>              <ul><li>语法:集合1.union(集合2)</li><li>功能:将集合1和集合2的全部元素，合并到一个新集合内。</li><li>结果:得到一个新集合，集合1和集合2不变。</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set1 = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</span><br><span class="line">set2 = &#123;<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>&#125;</span><br><span class="line">set3 = set1.union(set2)</span><br><span class="line"><span class="built_in">print</span>(set3)</span><br><span class="line"><span class="built_in">print</span>(set1)</span><br><span class="line"><span class="built_in">print</span>(set2)</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="遍历集合">遍历集合</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 集合遍历</span></span><br><span class="line"><span class="comment">#集合不支持下标索引，不能用while循环，可以用于or循环</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> set1:</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure><h2 id="字典">字典</h2><p>定义字典同样是使用{},不过存储的元素是一个个键值对</p><div class="tabs" id="字典"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#字典-1">定义字典</button></li><li class="tab"><button type="button" data-href="#字典-2">创建字典</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="字典-1"><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义字典字面量</span></span><br><span class="line">&#123;key:vaule,key:value,......,key:value&#125;</span><br><span class="line"><span class="comment"># 定义字典变量</span></span><br><span class="line">my_dicty = &#123;key:value,key:value,......,key:value&#125;</span><br><span class="line"><span class="comment"># 定义空字典</span></span><br><span class="line">my_dicty = &#123;&#125;       <span class="comment"># 方式一</span></span><br><span class="line">my_dicty = <span class="built_in">dict</span>()   <span class="comment"># 方式二</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="字典-2"><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义字典</span></span><br><span class="line">my_dict1 = &#123;<span class="string">&#x27;王&#x27;</span>:<span class="number">99</span>,<span class="string">&#x27;林&#x27;</span>:<span class="number">88</span>,<span class="string">&#x27;周&#x27;</span>:<span class="number">99</span>&#125;</span><br><span class="line"><span class="comment">#定义空字典</span></span><br><span class="line">my_dict2 = &#123;&#125;</span><br><span class="line">my_dict3 = <span class="built_in">dict</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;字典1的内容是:<span class="subst">&#123;my_dict1&#125;</span>，类型:<span class="subst">&#123;<span class="built_in">type</span>(my_dict1)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;字典2的内容是:<span class="subst">&#123;my_dict2&#125;</span>，类型:<span class="subst">&#123;<span class="built_in">type</span>(my_dict2)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;字典3的内容是:<span class="subst">&#123;my_dict3&#125;</span>，类型:<span class="subst">&#123;<span class="built_in">type</span>(my_dict3)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment">#定义重复Key的字典</span></span><br><span class="line">my_dict4 = &#123;<span class="string">&#x27;王&#x27;</span>:<span class="number">99</span>,<span class="string">&#x27;王&#x27;</span>:<span class="number">88</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;字典4重复key的内容是：<span class="subst">&#123;my_dict4&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment">#从字典中基于Key获取Value</span></span><br><span class="line"><span class="built_in">print</span>(my_dict1[<span class="string">&#x27;王&#x27;</span>])</span><br><span class="line"><span class="comment">#定义嵌套字典</span></span><br><span class="line">subject = &#123;</span><br><span class="line">    <span class="string">&#x27;王&#x27;</span>:&#123;</span><br><span class="line">        <span class="string">&#x27;语文&#x27;</span>:<span class="number">77</span>,</span><br><span class="line">        <span class="string">&#x27;数学&#x27;</span>:<span class="number">66</span>,</span><br><span class="line">        <span class="string">&#x27;英语&#x27;</span>:<span class="number">33</span></span><br><span class="line">    &#125;,<span class="string">&#x27;周&#x27;</span>:&#123;</span><br><span class="line">        <span class="string">&#x27;语文&#x27;</span>: <span class="number">88</span>,</span><br><span class="line">        <span class="string">&#x27;数学&#x27;</span>: <span class="number">86</span>,</span><br><span class="line">        <span class="string">&#x27;英语&#x27;</span>: <span class="number">55</span></span><br><span class="line">    &#125;,<span class="string">&#x27;林&#x27;</span>:&#123;</span><br><span class="line">        <span class="string">&#x27;语文&#x27;</span>: <span class="number">99</span>,</span><br><span class="line">        <span class="string">&#x27;数学&#x27;</span>: <span class="number">96</span>,</span><br><span class="line">        <span class="string">&#x27;英语&#x27;</span>: <span class="number">66</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 从嵌套字典中获取数据</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;学生的考试信息：<span class="subst">&#123;subject&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(subject[<span class="string">&#x27;王&#x27;</span>][<span class="string">&#x27;语文&#x27;</span>])</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note warning no-icon 字典 flat"><ul><li>键值对的Key和Value可以是任意类型(Key不可为字典)</li><li>字典内Key不允许重复，重复添加等同于覆盖原有数据</li><li>字典不可用下标索引，而是通过Key检索Value</li></ul></div><h3 id="操作">操作</h3><table><thead><tr><th style="text-align:center">编号</th><th style="text-align:center">操作</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">字符串[下标]</td><td style="text-align:center">根据下标索引取出特定位置字符</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">字符串.index(字符串)</td><td style="text-align:center">查找给定字符的第一个匹配项的下标</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">字符串.replace(字符串1,字符串2)</td><td style="text-align:center">将字符串内的全部字符串1，替换为字 符串2 不会修改原字符串，而是得到一个新的</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">字符串.split(字符串)</td><td style="text-align:center">按照给定字符串，对字符串进行分隔 不会修改原字符串，而是得到一个新的 列表</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">字符串.strip() 字符串.strip(字符串)</td><td style="text-align:center">移除首尾的空格和换行符或指定字符串</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">字符串.count(字符串)</td><td style="text-align:center">统计字符串内某字符串的出现次数</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">len(字符串)</td><td style="text-align:center">统计字符串的字符个数</td></tr></tbody></table><details class="folding-tag" ><summary> 新增元素 </summary>              <div class='content'>              <ul><li>语法:字典[Key]= Value，</li><li>结果:字典被修改，新增了元素</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#新增元素</span></span><br><span class="line">my_dict1[<span class="string">&#x27;张&#x27;</span>]=<span class="number">100</span></span><br><span class="line"><span class="built_in">print</span>(my_dict1)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 更新元素 </summary>              <div class='content'>              <ul><li>语法:字典[Key] = value</li><li>结果:字典被修改，元素被更新</li><li>注意:字典Key不可以重复，所以对已存在的Key执行上述操作，就是更新Value值</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#更新元素</span></span><br><span class="line">my_dict1[<span class="string">&#x27;林&#x27;</span>]=<span class="number">33</span></span><br><span class="line"><span class="built_in">print</span>(my_dict1)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 删除元素 </summary>              <div class='content'>              <ul><li>语法:字典pop(Key)</li><li>结果:获得指定Key的Value，同时字典被修改，指定Key的数据被删除</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#删除元素</span></span><br><span class="line">score = my_dict1.pop(<span class="string">&#x27;周&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;周的分数<span class="subst">&#123;score&#125;</span>，字典中的内容<span class="subst">&#123;my_dict1&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 清空元素 </summary>              <div class='content'>              <ul><li>语法:字典.clear()</li><li>结果:字典被修改，元素被清空</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#清空元素</span></span><br><span class="line">my_dict1.clear()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;字典被清空了<span class="subst">&#123;my_dict1&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 获取全部的key </summary>              <div class='content'>              <ul><li>语法:字典.keys</li><li>结果:得到字典中的全部Key</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取全部的key</span></span><br><span class="line">my_dict1 = &#123;<span class="string">&#x27;王&#x27;</span>:<span class="number">99</span>,<span class="string">&#x27;林&#x27;</span>:<span class="number">88</span>,<span class="string">&#x27;周&#x27;</span>:<span class="number">99</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(my_dict1.keys())</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 统计字典元素数量 </summary>              <div class='content'>              <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#统计字典内的元素数量</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(my_dict1))</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="遍历字典">遍历字典</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#遍历字典</span></span><br><span class="line"><span class="comment"># 方式一</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> my_dict1.keys():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;字典的key是<span class="subst">&#123;key&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;字典的value是<span class="subst">&#123;my_dict1[key]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 方式二</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> my_dict1:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;字典的key是<span class="subst">&#123;key&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;字典的value是<span class="subst">&#123;my_dict1[key]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="数据容器的对比">数据容器的对比</h2><p><em><strong>对比</strong></em></p><p>|          | 列表                               | 元组                                 | 字符串              | 集合                    | 字典                                             |<br>| :--------: | :----------------------------------: | :----------------------------------: | :-------------------: | :-----------------------: | :------------------------------------------------:s |<br>| 元素数量 | 支持多个                           | 支持多个                             | 支持多个            | 支持多个                | 支持多个                                         |<br>| 元素类型 | 任意                               | 任意                                 | 仅字符              | 任意                    | Key: Value Key：除字典外任意类型 Value：任意类型 |<br>| 下标索引 | 支持                               | 支持                                 | 支持                | 不支持                  | 不支持                                           |<br>| 重复元素 | 支持                               | 支持                                 | 支持                | 不支持                  | 不支持                                           |<br>| 可修改性 | 支持                               | 不支持                               | 不支持              | 支持                    | 支持                                             |<br>| 数据有序 | 是                                 | 是                                   | 是                  | 否                      | 否                                               |<br>| 使用场景 | 可修改、可重 复的一批数据 记录场景 | 不可修改、可重 复的一批数据记 录场景 | 一串字符的记录 场景 | 不可重复的数据 记录场景 | 以Key检索Value 的数据记录场景             |</p><p><em><strong>通用操作</strong></em></p><table><thead><tr><th style="text-align:center">功能</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">通用for循环</td><td style="text-align:center">遍历容器（字典是遍历key)</td></tr><tr><td style="text-align:center">max</td><td style="text-align:center">容器内最大元素</td></tr><tr><td style="text-align:center">min()</td><td style="text-align:center">容器内最小元素</td></tr><tr><td style="text-align:center">len()</td><td style="text-align:center">容器元素个数</td></tr><tr><td style="text-align:center">list()</td><td style="text-align:center">转换为列表</td></tr><tr><td style="text-align:center">tuple()</td><td style="text-align:center">转换为元组</td></tr><tr><td style="text-align:center">str()</td><td style="text-align:center">转换为字符串</td></tr><tr><td style="text-align:center">set()</td><td style="text-align:center">转换为集合</td></tr><tr><td style="text-align:center">sorted(序列, [reverse=True])</td><td style="text-align:center">排序，reverse=True表示降序 得到一个排好序的列表</td></tr></tbody></table><h1>第六章</h1><h2 id="函数的多返回值">函数的多返回值</h2><ul><li>在函数中，执行返回操作后，函数会自动结束，后续代码不再执行，故不能连续书写两条return语句，但在Python中，却能够支持函数有多返回值</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">a,b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    无法实现多返回</span></span><br><span class="line"><span class="string">    return a+b</span></span><br><span class="line"><span class="string">    return a-b</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 正确实现多返回的操作：</span></span><br><span class="line">    <span class="keyword">return</span> a+b,a-b</span><br><span class="line"><span class="comment"># 调用函数</span></span><br><span class="line">result1,result2 = func(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(result1)</span><br><span class="line"><span class="built_in">print</span>(result2)</span><br></pre></td></tr></table></figure><h2 id="函数的多种传参">函数的多种传参</h2><ul><li>函数常见的四种传参方式：<ul><li>位置参数</li><li>关键字参数</li><li>默认参数</li><li>不定长参数</li></ul></li></ul><details class="folding-tag" ><summary> 位置参数 </summary>              <div class='content'>              <p>定义：调用函数时根据函数定义的参数位置来传递参数。</p><div class="note warning no-icon 注意 flat"><p>传递的参数和定义的参数的顺序徐及个数必须一致</p></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">user_info</span>(<span class="params">name ,age,gender</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;名字是<span class="subst">&#123;name&#125;</span>，年龄是<span class="subst">&#123;age&#125;</span>，性别是<span class="subst">&#123;gender&#125;</span>&quot;</span>)</span><br><span class="line">user_info(<span class="string">&#x27;韩一&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;男&#x27;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 关键字参数 </summary>              <div class='content'>              <p>定义：函数调用时通过“键=值”形式传递参数.<br>作用: 让函数更加清晰、容易使用，同时也清除了参数的顺序需求.</p><div class="note warning no-icon 注意 flat"><p>函数调用时，如果有位置参数时，位置参数必须在关键字参数的前面，但关键字参数之间不存在先后顺序</p></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">user_info</span>(<span class="params">name ,age,gender</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;名字是<span class="subst">&#123;name&#125;</span>，年龄是<span class="subst">&#123;age&#125;</span>，性别是<span class="subst">&#123;gender&#125;</span>&quot;</span>)</span><br><span class="line">user_info(<span class="string">&#x27;韩一&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;男&#x27;</span>)</span><br><span class="line">user_info(age=<span class="number">18</span>,name=<span class="string">&#x27;韩一&#x27;</span>,gender=<span class="string">&#x27;男&#x27;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 缺省参数 </summary>              <div class='content'>              <p>定义：在定义函数时，给参数指定一个默认值，具有默认值的参数就叫做缺省参数。</p><div class="note warning no-icon 注意 flat"><p>所有位置参数必须出现在默认参数前，包括函数定义和调用，默认值参数在最后。</p></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">user_info</span>(<span class="params">name ,age,gender=<span class="string">&#x27;男&#x27;</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;名字是<span class="subst">&#123;name&#125;</span>，年龄是<span class="subst">&#123;age&#125;</span>，性别是<span class="subst">&#123;gender&#125;</span>&quot;</span>)</span><br><span class="line">user_info(<span class="string">&#x27;韩一&#x27;</span>,<span class="number">18</span>)</span><br><span class="line">user_info(<span class="string">&#x27;韩二&#x27;</span>,<span class="number">19</span>,<span class="string">&#x27;女&#x27;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" ><summary> 不定长参数 </summary>              <div class='content'>              <p>定义：在定义函数时，不确定调用时会传递多少个参数，就可以使用不定长参数。<br>不定长参数的类型：位置传递；关键字传递</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#不定长-位置不定长，*号</span></span><br><span class="line"><span class="comment">#传进的所有参数都会被args变量收集，它会根据传进参数的位置合并为一个元组(tuple)，</span></span><br><span class="line"><span class="comment"># args是元组类型，这就是位置传递</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_info</span>(<span class="params">*args</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;args参数的类型是<span class="subst">&#123;<span class="built_in">type</span>(args)&#125;</span>,内容是<span class="subst">&#123;args&#125;</span>&quot;</span>)</span><br><span class="line">user_info(<span class="string">&#x27;小李&#x27;</span>,<span class="number">18</span>)</span><br><span class="line"><span class="comment">#不定长-关键字不定长，**号</span></span><br><span class="line"><span class="comment"># 参数是“键=值”形式的形式的情况下，所有的“键=值”都会被kwargs接受，</span></span><br><span class="line"><span class="comment"># 同时会根据“键=值”组成字典.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_info</span>(<span class="params">**kwargs</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;args参数的类型是<span class="subst">&#123;<span class="built_in">type</span>(kwargs)&#125;</span>,内容是<span class="subst">&#123;kwargs&#125;</span>&quot;</span>)</span><br><span class="line">user_info(name=<span class="string">&#x27;小李&#x27;</span>,age = <span class="number">18</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="函数作为参数">函数作为参数</h2><ul><li>可以将函数本身作为参数，传入到另一个函数中使用。</li><li>作用:传入计算逻辑，而非传入数据。</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义一个函数，接收另一个函数作为传入参数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fun_test</span>(<span class="params">computer</span>):</span><br><span class="line">    result =computer (<span class="number">1</span>,<span class="number">2</span>)<span class="comment">#确定computer是函数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;computer的类型是<span class="subst">&#123;<span class="built_in">type</span>(computer)&#125;</span>,结果是<span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment">#定义一个函数，准备作为参数传入另一个函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> x+y</span><br><span class="line">fun_test(add)</span><br></pre></td></tr></table></figure><h2 id="Lambda匿名函数">Lambda匿名函数</h2><ul><li>语法：lambda 传入参数: 函数体(一行代码)<ul><li>lambda是关键字，表示定义匿名函数；</li><li>传入参数表示匿名函数的形式参数，如:x, y表示接收2个形式参数；</li><li>函数体，就是函数的执行逻辑</li></ul></li></ul><div class="note warning no-icon 注意 flat"><p>Lambda匿名函数，只能写一行代码，不能写多行代码</p></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义一个函数，接受其它函数输入</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_function</span>(<span class="params">compute</span>):</span><br><span class="line">    result = compute(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;结果是<span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment">#通过lambda匿名函数的形式，将匿名函数作为参数传入</span></span><br><span class="line">test_function(<span class="keyword">lambda</span> x,y: x*y)</span><br></pre></td></tr></table></figure><h1>第七章</h1><h2 id="文件编码">文件编码</h2><p><strong>1.什么是编码？</strong><br>编码就是一种规则集合，记录了内容和二进制间进行相互转换的逻辑。编码有许多中，我们最常用的是UTF-8编码。<br><strong>2.为什么要编码？</strong><br>因为计算机只能识别二进制，而我们人类只能识别文字，所以我们需要编码将文字转换为二进制，才能让计算机识别。<br><strong>3.编码的作用？</strong><br>编码的作用就是将文字转换为二进制，也可以将二进制转换为文字。<br><strong>4.编码的分类？</strong><br>编码的分类有很多种，我们最常用的是UTF-8编码，其他的编码有GBK编码、ISO-8859-1编码等。</p><h2 id="文件的读写操作">文件的读写操作</h2><ul><li>文件可以分为文本文件、视频文件、图像文件、可执行文件等多种类别。</li><li>文件的操作<ul><li>创建文件</li><li>打开文件</li><li>关闭文件</li><li>读写文件</li></ul></li></ul><h3 id="打开文件">打开文件</h3><ul><li>通常使用<code>open</code>函数来打开文件<ul><li><code>open(name,mode,encoding)</code></li><li>name是要打开的目标文件名的字符串（可以包括文件所在的具体路径）</li><li>mode是打开文件的模式，即读取、写入、追加等</li><li>encoding是指定文件的编码方式(推荐使用UTF-8)</li></ul></li><li>常用的三种基础访问模式:</li></ul><table><thead><tr><th>模式</th><th>描述</th></tr></thead><tbody><tr><td>r</td><td>以只读方式打开文件。文件的指针将会放在文件的开头。这是默认模式。</td></tr><tr><td>W</td><td>打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，原有内容会被删除。 如果该文件不存在，创建新文件。</td></tr><tr><td>a</td><td>打开一个文件用于追加。如果该文件已存在，新的内容将会被写入到已有内容之后。 如果该文件不存在，创建新文件进行写入。</td></tr></tbody></table><h3 id="读取文件">读取文件</h3><ul><li>使用<code>read()</code>方法读取文件内容<ul><li>file.read(num)<ul><li>file是文件对象</li><li>num表示读取的数据长度（单位是字节），如果没有传入num，那么就是读取所以的数据</li></ul></li></ul></li><li>使用<code>readline()</code>方法读取文件内容<ul><li>file.readline()</li><li>readline()方法读取文件的一行内容</li></ul></li><li>使用<code>readlines()</code>方法读取文件内容<ul><li>file.readlines()</li><li>readlines()方法读取文件的所有内容，返回一个列表，列表的每个元素是文件的一行内容</li></ul></li><li>for循环逐行读取</li><li>读取后关闭文件<ul><li>file.<code>close()</code></li><li><code>with open</code></li></ul></li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#打开文件</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;D:Silvan.txt&quot;</span>,<span class="string">&quot;r&quot;</span>,encoding=<span class="string">&quot;UTF-8&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(f))</span><br><span class="line"><span class="comment">#读取文件- read()</span></span><br><span class="line"><span class="built_in">print</span>(f.read(<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(f.read())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;------&quot;</span>)</span><br><span class="line"><span class="comment">#读取文件- readLines()</span></span><br><span class="line">lines = f.readlines()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;lines对象的类型是<span class="subst">&#123;<span class="built_in">type</span>(lines)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(lines)</span><br><span class="line"><span class="comment">#读取文件- readline()</span></span><br><span class="line">line1 = f.readline()</span><br><span class="line">line2 = f.readline()</span><br><span class="line">line3 = f.readline()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;第一行的内容<span class="subst">&#123;line1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;第二行的内容<span class="subst">&#123;line2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;第三行的内容<span class="subst">&#123;line3&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># for循环读取文件行</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;每一行的内容是<span class="subst">&#123;line&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment">#文件的关闭</span></span><br><span class="line">f.close()</span><br><span class="line"><span class="comment">#with open语法操作文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span> <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;每一行的内容是<span class="subst">&#123;line&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">操作</th><th style="text-align:center">功能</th></tr></thead><tbody><tr><td style="text-align:center">文件对象 = open(file, mode, encoding)</td><td style="text-align:center">打开文件获得文件对象</td></tr><tr><td style="text-align:center">文件对象.read(num)</td><td style="text-align:center">读取指定长度字节 不指定num读取文件全部</td></tr><tr><td style="text-align:center">文件对象.readline()</td><td style="text-align:center">读取一行</td></tr><tr><td style="text-align:center">文件对象.readlines()</td><td style="text-align:center">读取全部行，得到列表</td></tr><tr><td style="text-align:center">for line in 文件对象</td><td style="text-align:center">for循环文件行，一次循环得到一行数据</td></tr><tr><td style="text-align:center">文件对象.close()</td><td style="text-align:center">关闭文件对象</td></tr><tr><td style="text-align:center">with open() as f</td><td style="text-align:center">通过with open语法打开文件，可以自动关闭</td></tr></tbody></table><h3 id="写入文件">写入文件</h3><ul><li>可以通过<code>write()</code>方法将数据写入文件</li></ul><div class="note warning no-icon flat"><p>需要注意的是，直接调用write，内容并未真正写入文件，而是会积攒在程序的内存中，称之为<code>缓冲区</code>；当调用flush的时候+内容会真正写入文件；这样做是避免频繁的操作硬盘，导致效率下降（攒一堆，一次性写磁盘)</p></div><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">演示文件的写入</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#打开文件，（不存在的文件，会自动创建）</span></span><br><span class="line">f= <span class="built_in">open</span>(<span class="string">&quot;E:/word.txt&quot;</span>,<span class="string">&quot;w&quot;</span>,encoding=<span class="string">&quot;UTF-8&quot;</span>)</span><br><span class="line"><span class="comment"># write写入</span></span><br><span class="line">f.write(<span class="string">&quot;hello&quot;</span>) <span class="comment">#内容写到内存中</span></span><br><span class="line"><span class="comment">#flush刷新</span></span><br><span class="line">f.flush()<span class="comment">#将内存积攒的内容写到硬盘的文件中</span></span><br><span class="line"><span class="comment">#close关闭，close方法内置了flush功能 </span></span><br><span class="line">f.close()</span><br><span class="line"><span class="comment">#打开一个存在的文件</span></span><br><span class="line"><span class="comment">#write写入、flush刷新</span></span><br><span class="line"><span class="comment">#close关闭</span></span><br></pre></td></tr></table></figure><h3 id="追加写入">追加写入</h3><ul><li>追加写入即通过open函数的&quot;a”模式打开文件后，再调用write方法写入内容，追加写入的内容会追加到文件末尾。</li><li>a模式，文件不存在时，会创建新文件；文件存在时，会在原有内容后面继续写入；可以使用”\n”来写出换行符</li></ul><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">演示文件的追加</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#打开文件，（不存在的文件，会自动创建）</span></span><br><span class="line">f= <span class="built_in">open</span>(<span class="string">&quot;E:/word.txt&quot;</span>,<span class="string">&quot;a&quot;</span>,encoding=<span class="string">&quot;UTF-8&quot;</span>)</span><br><span class="line"><span class="comment"># write写入</span></span><br><span class="line">f.write(<span class="string">&quot;hsz&quot;</span>) <span class="comment">#内容写到内存中</span></span><br><span class="line"><span class="comment">#flush刷新</span></span><br><span class="line">f.flush()<span class="comment">#将内存积攒的内容写到硬盘的文件中</span></span><br><span class="line"><span class="comment">#close关闭，close方法内置了flush功能</span></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;第一章&lt;/h1&gt;
&lt;h2 id=&quot;字面量&quot;&gt;字面量&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;定义：在代码中，被写下来的固定的值，称之为字面量。&lt;/li&gt;
&lt;li&gt;Python有六种常用的数据类型&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;img-wrap&quot;&gt;&lt;div class=</summary>
      
    
    
    
    <category term="python" scheme="https://silvan2077.github.io/categories/python/"/>
    
    
    <category term="Python" scheme="https://silvan2077.github.io/tags/Python/"/>
    
    <category term="编程语言" scheme="https://silvan2077.github.io/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>JaveWeb---HTML、CSS</title>
    <link href="https://silvan2077.github.io/2025/08/29/JaveWeb-HTML-CSS/"/>
    <id>https://silvan2077.github.io/2025/08/29/JaveWeb-HTML-CSS/</id>
    <published>2025-08-29T06:28:57.000Z</published>
    <updated>2025-09-27T09:37:00.564Z</updated>
    
    <content type="html"><![CDATA[<h1>HTML</h1><h2 id="介绍">介绍</h2><p>HTML是用来编写网页的一门语言，像京东，12306等网站都是用HTML编写的。</p><p>HTML(HyperText Markup Language)：<code>超文本标记语言</code></p><ul><li><p>超文本：超越了文本的限制，比普通文本更强大。除了文字信息，还可以定义图片、音频、视频等内容</p><p>在网页中除了能看到一些文字，同时也有大量的图片展示；有些网页也有视频，音频等。这种展示效果超越了文本展示的限制。</p></li><li><p>标记语言：由标签构成的语言</p><p>之前学习的XML就是标记语言，由一个一个的标签组成，HTML 也是由标签组成 。我们在浏览器页面右键可以查看页面的源代码。</p></li></ul><p>HTML标签不像XML那样可以自定义，<code>HTML中的标签都是预定义好的</code>，运行在浏览器上并由浏览器解析，然后展示出对应的效果。例如我们想在浏览器上展示出图片就需要使用预定义的 <code>img</code> 标签；想展示可以点击的链接的效果就可以使用预定义的 <code>a</code> 标签等。</p><p>W3C标准：</p><ul><li>W3C是<code>万维网联盟</code>，这个组成是用来定义标准的。他们规定了一个网页是由三部分组成，分别是：<ul><li><code>结构</code>：对应的是 HTML 语言</li><li><code>表现</code>：对应的是 CSS 语言</li><li><code>行为</code>：对应的是 JavaScript 语言</li></ul></li></ul><ul><li>HTML定义页面的整体结构；</li><li>CSS是用来美化页面，让页面看起来更加美观；</li><li>JavaScript可以使网页动起来，比如轮播图也就是多张图片自动的进行切换等效果。</li></ul><h2 id="快速入门">快速入门</h2><p>在IDEA中新建一个HTML文件，会默认为我们生成几个标签</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--HTML5的标识--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设定字符集--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>html标签是根标签，下面有 <code>head</code> 标签和 <code>body</code> 标签这两个子标签。而 <code>head</code> 标签的 <code>title</code> 子标签是用来定义页面标题名称的，它定义的内容会展示在浏览器的标题位置</p><p><code>body</code> 标签的内容会被展示在内容区中</p><p>使用<code>font</code>标签可以改变文字颜色、大小、字体</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--HTML5的标识--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设定字符集--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>我的第一个网页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span> <span class="attr">size</span>=<span class="string">&quot;5&quot;</span> <span class="attr">face</span>=<span class="string">&quot;楷体&quot;</span>&gt;</span>HELLO WORLD!!<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>HTML 结构标签</p></li><li><p>HTML 标签不区分大小写</p><p>如上案例中的 <code>font</code> 写成 <code>Font</code> 也是一样可以展示出对应的效果的。</p></li><li><p>HTML 标签属性值 单双引皆可</p><p>如上案例中的color属性值使用双引号也是可以的。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>HTML 语法松散</p><p>比如 font 标签不加结束标签也是可以展示出效果的。但不建议，最好严格按照要求去写。</p></li></ul><table><thead><tr><th style="text-align:center">标签</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><code>&lt;HTML&gt;</code></td><td style="text-align:center">定义HTML文档</td></tr><tr><td style="text-align:center"><code>&lt;head&gt;</code></td><td style="text-align:center">定义关于文档的信息</td></tr><tr><td style="text-align:center"><code>&lt;title&gt;</code></td><td style="text-align:center">定义文档的标题</td></tr><tr><td style="text-align:center"><code>&lt;body&gt;</code></td><td style="text-align:center">定义文档的主体</td></tr></tbody></table><h2 id="基础标签">基础标签</h2><p>基础标签就是一些和文字相关的标签，如下：</p><table><thead><tr><th style="text-align:center">标签</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><code>&lt;h1&gt; ~ &lt;h6&gt;</code></td><td style="text-align:center">定义标题，h1最大，h6最小</td></tr><tr><td style="text-align:center"><code>&lt;font&gt;</code></td><td style="text-align:center">定义文本的字体、字体尺寸、字体颜色</td></tr><tr><td style="text-align:center"><code>&lt;b&gt;</code></td><td style="text-align:center">定义粗体文本</td></tr><tr><td style="text-align:center"><code>&lt;i&gt;</code></td><td style="text-align:center">定义斜体文本</td></tr><tr><td style="text-align:center"><code>&lt;u&gt; </code></td><td style="text-align:center">定义文本下划线</td></tr><tr><td style="text-align:center"><code>&lt;center&gt;</code></td><td style="text-align:center">定义文本居中</td></tr><tr><td style="text-align:center"><code>&lt;p&gt;</code></td><td style="text-align:center">定义段落</td></tr><tr><td style="text-align:center"><code>&lt;br&gt;</code></td><td style="text-align:center">定义折行</td></tr><tr><td style="text-align:center"><code>&lt;hr&gt;</code></td><td style="text-align:center">定义水平线</td></tr></tbody></table><h3 id="标题标签">标题标签</h3><p>书写标题标签</p><p>标题标签中 h1最大，h6最小。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="selector-tag">h1</span>&gt;我是标题 <span class="selector-tag">h1</span>&lt;/<span class="selector-tag">h1</span>&gt;</span><br><span class="line">&lt;<span class="selector-tag">h2</span>&gt;我是标题 <span class="selector-tag">h2</span>&lt;/<span class="selector-tag">h2</span>&gt;</span><br><span class="line">&lt;<span class="selector-tag">h3</span>&gt;我是标题 <span class="selector-tag">h3</span>&lt;/<span class="selector-tag">h3</span>&gt;</span><br><span class="line">&lt;<span class="selector-tag">h4</span>&gt;我是标题 <span class="selector-tag">h4</span>&lt;/<span class="selector-tag">h4</span>&gt;</span><br><span class="line">&lt;<span class="selector-tag">h5</span>&gt;我是标题 <span class="selector-tag">h5</span>&lt;/<span class="selector-tag">h5</span>&gt;</span><br><span class="line">&lt;<span class="selector-tag">h6</span>&gt;我是标题 <span class="selector-tag">h6</span>&lt;/<span class="selector-tag">h6</span>&gt;</span><br></pre></td></tr></table></figure><h3 id="hr标签">hr标签</h3><p><code>hr</code> 标签在浏览器中呈现出 <code>水平线</code> 的效果。</p><p>在页面文件中书写 hr 标签</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;hr&gt;</span></span><br></pre></td></tr></table></figure><h3 id="字体标签">字体标签</h3><p>font：字体标签</p><ul><li><p>**face 属性：**用来设置字体。如 “楷体”、&quot;宋体&quot;等</p></li><li><p>**color 属性：**设置文字颜色。颜色有三种表示方式</p><ul><li><p><strong>英文单词</strong>：red,pink,blue…</p><p>这种方式表示的颜色特别有限，所以一般不用。</p></li><li><p><strong>rgb(值1,值2,值3)</strong>：值的取值范围：0~255</p><p>此种方式也就是三原色（红绿蓝）设置方式。 例如： rgb(255,0,0)。</p><p>这种书写起来比较麻烦，一般不用。</p></li><li><p><strong>#值1值2值3</strong>：值的范围：00~FF</p><p>这种方式是rgb方式的简化写法，以后基本都用此方式。</p><p>值1表示红色的范围，值2表示绿色的范围，值3表示蓝色范围。例如： #ff0000</p></li></ul></li><li><p>**size 属性：**设置文字大小</p></li></ul><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">font</span> <span class="built_in">color</span>=<span class="string">&quot;red&quot;</span> <span class="built_in">size</span>=<span class="string">&quot;5&quot;</span> face=<span class="string">&quot;楷体&quot;</span>&gt;测试文本&lt;/<span class="built_in">font</span>&gt;  </span><br></pre></td></tr></table></figure><blockquote><p>**注意：**font 标签已经不建议使用了，以后如果要改变文字字体，大小，颜色可以使用 CSS 进行设置。</p></blockquote><h3 id="换行标签">换行标签</h3><p>如果直接在body标签中使用回车，是不会自动换行的，如果要实现换行效果，需要使用 换行标签（br标签）。</p><h3 id="段落标签">段落标签</h3><p>上面文字展示的效果还是不太好，我们想让每一段上下都加空行。此时就需要使用段落标签（p标签）</p><p>在页面文件中书写如下内容：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>刚察草原绿草如茵，沙柳河水流淌入湖。藏族牧民索南才让家中，茶几上摆着馓子、麻花和水果，炉子上刚煮开的奶茶香气四溢……<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>6月8日下午，习近平总书记来到青海省海北藏族自治州刚察县沙柳河镇果洛藏贡麻村，走进牧民索南才让家中，看望慰问藏族群众。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这种效果就会比之前的效果好一些，呈现出段落的效果。</p><h3 id="加粗、斜体、下划线标签">加粗、斜体、下划线标签</h3><ul><li>b：加粗标签</li><li>i：斜体标签</li><li>u：下划线标签，在文字的下方有一条横线</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>沙柳河水流淌<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">i</span>&gt;</span>沙柳河水流淌<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">u</span>&gt;</span>沙柳河水流淌<span class="tag">&lt;/<span class="name">u</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure><p>展示的效果如下：</p><blockquote><p><strong>沙柳河水流淌</strong></p><p><em>沙柳河水流淌</em></p><p><u>沙柳河水流淌</u></p></blockquote><h3 id="居中标签">居中标签</h3><p>center ：文本居中</p><p>代码如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span></span><br><span class="line">    我是文章标题</span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果如下</p><center>    我是文章标题</center><h3 id="图片、音频、视频标签">图片、音频、视频标签</h3><table><thead><tr><th style="text-align:center">标签</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><code>&lt;img&gt;</code></td><td style="text-align:center">定义图片</td></tr><tr><td style="text-align:center"><code>&lt;audio&gt;</code></td><td style="text-align:center">定义音频</td></tr><tr><td style="text-align:center"><code>&lt;video&gt;</code></td><td style="text-align:center">定义视频</td></tr></tbody></table><ul><li>img：定义图片<ul><li>src：规定显示图像的 URL（统一资源定位符）</li><li>height：定义图像的高度</li><li>width：定义图像的宽度</li></ul></li><li>audio：定义音频。支持的音频格式：MP3、WAV、OGG<ul><li>src：规定音频的 URL</li><li>controls：显示播放控件</li></ul></li><li>video：定义视频。支持的音频格式：MP4, WebM、OGG<ul><li>src：规定视频的 URL</li><li>controls：显示播放控件</li></ul></li></ul><p><strong>尺寸单位：</strong></p><p>height属性和width属性有两种设置方式：</p><ul><li>像素：单位是px</li><li>百分比。占父标签的百分比。例如宽度设置为 50%，意思就是占它的父标签宽度一半（50%）</li><li>不设置宽度，默认宽度是图片的宽度</li></ul><p><strong>资源路径：</strong></p><p>图片，音频，视频标签都有src属性，而src是用来指定对应的图片，音频，视频文件的路径。此处的图片，音频，视频就称为资源。资源路径有<code>绝对路径</code>和<code>相对路径</code>两种方式</p><h3 id="超链接标签">超链接标签</h3><p>在网页中可以看到很多超链接标签，当我们点击这些超链接时会跳转到其他的页面或者资源。</p><p><code>a</code> 标签属性：</p><ul><li>href：指定访问资源的URL</li><li>target：指定打开资源的方式<ul><li>_self：默认值，在当前页面打开</li><li>_blank：在空白页面打开</li></ul></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--HTML5的标识--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设定字符集--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>我的第一个网页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://silvan2077.github.io/&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>点我跳转至博客主页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="列表标签">列表标签</h2><p><code>HTML</code> 中列表分为</p><ul><li><p>有序列表</p><ol><li>咖啡</li><li>牛奶</li><li>可乐</li></ol></li><li><p>无序列表</p><ul><li>Apex</li><li>Deadcells</li><li>Terraria</li></ul></li></ul><p><strong>标签说明：</strong></p><table><thead><tr><th style="text-align:center">标签</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><code>&lt;ol&gt;</code></td><td style="text-align:center">定义有序列表</td></tr><tr><td style="text-align:center"><code>&lt;ul&gt;</code></td><td style="text-align:center">定义无序列表</td></tr><tr><td style="text-align:center"><code>&lt;li&gt;</code></td><td style="text-align:center">定义列表项</td></tr></tbody></table><p>有序列表中的 <code>type</code> 属性用来指定标记的标号的类型（数字、字母、罗马数字等）</p><p>无序列表中的 <code>type</code> 属性用来指定标记的形状</p><p>代码演示：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--HTML5的标识--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设定字符集--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>我的第一个网页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>咖啡<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>牛奶<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>可乐<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ol</span> <span class="attr">type</span>=<span class="string">&quot;A&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Apex<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Deadcells<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Terraria<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="表格标签">表格标签</h2><ul><li><code>table</code> ：定义表格<ul><li>border：规定表格边框的宽度</li><li>width ：规定表格的宽度</li><li>cellspacing：规定单元格之间的空白</li></ul></li><li><code>tr</code> ：定义行<ul><li>align：定义表格行的内容对齐方式</li></ul></li><li><code>td</code> ：定义单元格<ul><li>rowspan:规定单元格可横跨的行数(横向合并单元格)</li><li>colspan:规定单元格可横跨的列数(纵向合并单元格)</li></ul></li><li><code>th</code> ：定义表头单元格</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span> <span class="attr">cellspacing</span>=<span class="string">&quot;0&quot;</span> <span class="attr">width</span>=<span class="string">&quot;500&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>序号<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>品牌logo<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>品牌名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>企业名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>010<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://t8.baidu.com/it/u=3082494854,3782081507&amp;fm=85&amp;app=131&amp;size=f242,150&amp;n=0&amp;f=JPEG&amp;fmt=auto?s=84165C97CFA40C8000A1E5EB0300E063&amp;sec=1660496400&amp;t=c8906529b7d9dfc5354b293d180b2ce1&quot;</span> <span class="attr">height</span>=<span class="string">&quot;20&quot;</span> <span class="attr">width</span>=<span class="string">&quot;30&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>三只松鼠<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>三只松鼠<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>009<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://files.codelife.cc/website/5f2a578265bf280ee60a165a.png?x-oss-process=image/resize,limit_0,m_fill,w_100,h_100/quality,q_100&quot;</span> <span class="attr">height</span>=<span class="string">&quot;20&quot;</span> <span class="attr">width</span>=<span class="string">&quot;30&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>优衣库<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>优衣库<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>008<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://files.codelife.cc/website/mi.svg&quot;</span> <span class="attr">height</span>=<span class="string">&quot;20&quot;</span> <span class="attr">width</span>=<span class="string">&quot;30&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>小米<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>小米科技有限公司<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="布局标签">布局标签</h2><table><thead><tr><th style="text-align:center">标签</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><code>&lt;div&gt;</code></td><td style="text-align:center">定义HTML文档中的一个区域部分，经常与CSS一起使用，用来布局网页</td></tr><tr><td style="text-align:center"><code>&lt;span&gt;</code></td><td style="text-align:center">用于组合行内元素。</td></tr></tbody></table><p>这两个标签，一般都是和css结合到一块使用来实现页面的布局。</p><p><code>div</code>标签 在浏览器上会有换行的效果，而 <code>span</code> 标签在浏览器上没有换行效果。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>我是div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>我是div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>我是span<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>我是span<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="表单标签">表单标签</h2><p>表单标签效果大家其实都不陌生，像登陆页面、注册页面等都是表单。</p><p>表单就是用来<code>采集用户输入的数据</code>，然后将数据发送到服务端，服务端会对数据库进行操作，比如注册就是将数据保存到数据库中，而登陆就是根据用户名和密码进行数据库的查询操作。</p><h3 id="表单标签概述">表单标签概述</h3><p>表单：在网页中主要负责数据采集功能，使用<code>&lt;form&gt;</code>标签定义表单</p><p>表单项(元素)：不同类型的 input 元素、下拉列表、文本域等</p><table><thead><tr><th style="text-align:center">标签</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center"><code>&lt;form&gt;</code></td><td style="text-align:center">定义表单</td></tr><tr><td style="text-align:center"><code>&lt;input&gt;</code></td><td style="text-align:center">定义表单项，通过type属性控制输入形式</td></tr><tr><td style="text-align:center"><code>&lt;label&gt;</code></td><td style="text-align:center">为表单项定义标注</td></tr><tr><td style="text-align:center"><code>&lt;select&gt;</code></td><td style="text-align:center">定义下拉列表</td></tr><tr><td style="text-align:center"><code>&lt;option&gt;</code></td><td style="text-align:center">定义下拉列表的列表项</td></tr><tr><td style="text-align:center"><code>&lt;textarea&gt;</code></td><td style="text-align:center">定义文本域</td></tr></tbody></table><p><code>form</code> 是表单标签，它在页面上没有任何展示的效果。需要借助于表单项标签来展示不同的效果。</p><h3 id="form标签属性">form标签属性</h3><ul><li><p><strong>action：规定当提交表单时向何处发送表单数据，该属性值就是URL</strong></p><p>以后会将数据提交到服务端，该属性需要书写服务端的URL。而今天我们可以书写 <code>#</code> ，表示提交到当前页面来看效果。</p></li><li><p><strong>method ：规定用于发送表单数据的方式</strong></p><p>method取值有如下两种：</p><ul><li>get：默认值。如果不设置method属性则默认就是该值<ul><li>请求参数会拼接在URL后边</li><li>url的长度有限制 4KB</li></ul></li><li>post：<ul><li>浏览器会将数据放到http<code>请求消息体</code>中</li><li>请求参数无限制的</li></ul></li></ul></li></ul><h3 id="代码演示">代码演示</h3><p>由于表单标签在页面上没有任何展示的效果，所以在演示的过程是会先使用 <code>input</code> 这个表单项标签展示输入框效果。</p><p>代码如下：</p><div class="tabs" id="input"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#input-1">输入框展示</button></li><li class="tab"><button type="button" data-href="#input-2">样例代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="input-1"><form>    <input type="text">    <input type="submit"></form><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="input-2"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>从效果可以看到页面有一个输入框，用户可以在数据框中输入自己想输入的内容，点击提交按钮以后会将数据发送到服务端，当然现在肯定不能实现。现在我们可以将 <code>form</code> 标签的 <code>action</code> 属性值设置为 <code>#</code> ，将其将数据提交到当前页面。还需要注意一点，要想提交数据，<code>input</code> 输入框必须设置 <code>name</code> 属性。代码如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;#&quot;</span>&gt;</span></span><br><span class="line">    用户名<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    密码<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>接下来我们来聊 <code>method</code> 属性，默认是 <code>method = 'get'</code>，所以该取值就会将数据拼接到URL的后面。新建html文件，输入用户名为<code>silvan</code>，密码为<code>123321</code>，点击提交，效果如下：<code>file:///D:/Desktop/111.html?username=silvan&amp;password=123321#</code></p><h3 id="表单项标签">表单项标签</h3><p>表单项标签有很多，不同的表单项标签有不同的展示效果。表单项标签可以分为以下三个：</p><ul><li><code>&lt;input&gt;</code>：表单项，通过type属性控制输入形式<br><code>input</code> 标签有个 <code>type</code> 属性。 <code>type</code> 属性的取值不同，展示的效果也不一样。</li></ul><table><thead><tr><th style="text-align:center">type取值</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">text</td><td style="text-align:center">默认值。定义单行的输入字段</td></tr><tr><td style="text-align:center">password</td><td style="text-align:center">定义密码字段</td></tr><tr><td style="text-align:center">radio</td><td style="text-align:center">定义单选按钮 男 女</td></tr><tr><td style="text-align:center">checkbox</td><td style="text-align:center">定义复选框 Apex Deadcells Terraria</td></tr><tr><td style="text-align:center">file</td><td style="text-align:center">定义文件上传按钮</td></tr><tr><td style="text-align:center">hidden</td><td style="text-align:center">定义隐藏的输入字段</td></tr><tr><td style="text-align:center">submit</td><td style="text-align:center">定义提交按钮，提交按钮会把表单数据发送到服务器</td></tr><tr><td style="text-align:center">reset</td><td style="text-align:center">定义重置按钮，重置按钮会清除表单中的所有数据</td></tr><tr><td style="text-align:center">button</td><td style="text-align:center">定义可点击按钮</td></tr></tbody></table><ul><li><p><code>&lt;select&gt;</code>：定义下拉列表，<code>&lt;option&gt;</code> 定义列表项</p><div class="tabs" id="select"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#select-1">下拉列表</button></li><li class="tab"><button type="button" data-href="#select-2">样例代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="select-1"><select>    <option>北京</option>    <option>上海</option>    <option>广州</option>    <option>深圳</option></select><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="select-2"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>广州<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>深圳<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></li><li><p><code>&lt;textarea&gt;</code>：文本域，它可以输入多行文本，而 <code>input</code> 数据框只能输入一行文本。</p></li></ul><div class="tabs" id="textarea"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#textarea-1">文本域</button></li><li class="tab"><button type="button" data-href="#textarea-2">样例代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="textarea-1"><textarea></textarea><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="textarea-2"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><blockquote><ul><li>以上标签项的内容要想提交，必须得定义 <code>name</code> 属性。</li><li>每一个标签都有id属性，id属性值是唯一的标识。</li><li>单选框、复选框、下拉列表需要使用 <code>value</code> 属性指定提交的值。</li></ul></blockquote><ul><li>练习：实现以下表单样式</li></ul><div class="tabs" id="form"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#form-1">表单</button></li><li class="tab"><button type="button" data-href="#form-2">代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="form-1"><html lang="en"><head>    <meta charset="UTF-8">    <title>Title</title></head><body><form action="#">    用户名：    <input type="text" name="username"><br>    密码：    <input type="password" name="password"><br>    性别：    <input type="radio" name="gender" value="1">男    <input type="radio" name="gender" value="2">女<br>    爱好：    <input type="checkbox" name="hobbby" value="1">Apex    <input type="checkbox" name="hobbby" value="2">Deadcells    <input type="checkbox" name="hobbby" value="3">Terraria<br>    头像：    <input type="file"><br>    城市：    <select>        <option>北京</option>        <option>上海</option>        <option>广州</option>        <option>深圳</option>    </select><br>    个人描述：    <textarea cols="20" rows="5" name="desc"></textarea><br>    <input type="submit" value="免费注册">    <input type="reset" value="重置">    <input type="button" value="一个按钮"></form></body></html><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="form-2"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;#&quot;</span>&gt;</span></span><br><span class="line">    用户名：</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    密码：</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    性别：</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>男</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span>女<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    爱好：</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobbby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>Apex</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobbby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span>Deadcells</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobbby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>&gt;</span>Terraria<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    头像：</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    城市：</span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>广州<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span>&gt;</span>深圳<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    个人描述：</span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">cols</span>=<span class="string">&quot;20&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;5&quot;</span> <span class="attr">name</span>=<span class="string">&quot;desc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;免费注册&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span> <span class="attr">value</span>=<span class="string">&quot;重置&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;一个按钮&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>CSS</h1><h2 id="概述">概述</h2><p>CSS 是一门语言，用于控制网页表现。我们之前介绍过W3C标准。W3C标准规定了网页是由以下组成：</p><blockquote><ul><li>结构：HTML</li><li>表现：CSS</li><li>行为：JavaScript</li></ul></blockquote><p>CSS也有一个专业的名字：<code>Cascading Style Sheet</code>（层叠样式表）。</p><p>如下面的代码， <code>style</code> 标签中定义的就是css代码。该代码描述了将 div 标签的内容的字体颜色设置为 红色。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">div</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello CSS~<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="CSS导入方式">CSS导入方式</h2><p>CSS 导入方式其实就是 CSS 代码和 html 代码的结合方式。CSS 导入 HTML有三种方式：</p><ol><li>内联样式：在标签内部使用style属性，属性值是CSS属性键值对</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;color: red&quot;</span>&gt;</span>Hello CSS~<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>给方式只能作用在这一个标签上，如果其他的标签也想使用同样的样式，那就需要在其他标签上写上相同的样式。复用性太差。</p><ol start="2"><li>内部样式：定义<code>&lt;style&gt;</code>标签，在标签内部定义CSS样式</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">span</span>&#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这种方式可以做到在该页面中复用，被span标签包裹的字体会变为红色</p><ol start="3"><li>外部样式：定义link标签，引入外部的CSS文件</li></ol><ul><li>编写一个CSS文件。名为：demo.css，内容如下:</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line"><span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>在html中引入 CSS 文件。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>  <span class="attr">href</span>=<span class="string">&quot;demo.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这种方式可以在多个页面进行复用。其他的页面想使用同样的样式，只需要使用 <code>link</code> 标签引入该CSS文件。</p><h2 id="CSS选择器">CSS选择器</h2><p>CSS 选择器就是选取需设置样式的元素（标签），比如如下CSS代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line"><span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如上代码中的 <code>div</code> 就是 css 中的选择器。这里只讲下面三种选择器：</p><ul><li>元素选择器<br>格式：</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元素名称&#123;<span class="attribute">color</span>: red;&#125;</span><br></pre></td></tr></table></figure><p>举例：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;<span class="attribute">color</span>:red&#125;  <span class="comment">/*该代码表示将页面中所有的div标签的内容的颜色设置为红色*/</span></span><br></pre></td></tr></table></figure><ul><li>id选择器<br>格式：</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#id</span>属性值&#123;<span class="attribute">color</span>: red;&#125;</span><br></pre></td></tr></table></figure><p>举例：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#name</span>&#123;<span class="attribute">color</span>: red;&#125;<span class="comment">/*该代码表示将页面中所有的id属性值是 name 的标签的内容的颜色设置为红色*/</span></span><br></pre></td></tr></table></figure><p>在HTML中调用</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;name&quot;</span>&gt;</span>hello css2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>类选择器<br>格式：</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.class</span>属性值&#123;<span class="attribute">color</span>: red;&#125;</span><br></pre></td></tr></table></figure><p>举例：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.cls</span>&#123;<span class="attribute">color</span>: red;&#125; <span class="comment">/*该代码表示将页面中所有的class属性值是 cls 的标签的内容的颜色设置为红色*/</span></span><br></pre></td></tr></table></figure><p>在HTML中调用</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cls&quot;</span>&gt;</span>hello css3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="CSS属性">CSS属性</h2><p>css有很多css属性，想把它们都学会，需要花费很长的时间。而作为java程序员，不需要重点掌握这部分内容。对于网页三剑客中css是对我们要求最低的。了解一些简单的CSS属性就可以，剩下的可以去W3School查。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;HTML&lt;/h1&gt;
&lt;h2 id=&quot;介绍&quot;&gt;介绍&lt;/h2&gt;
&lt;p&gt;HTML是用来编写网页的一门语言，像京东，12306等网站都是用HTML编写的。&lt;/p&gt;
&lt;p&gt;HTML(HyperText Markup Language)：&lt;code&gt;超文本标记语言&lt;/code&gt;&lt;/p</summary>
      
    
    
    
    <category term="java" scheme="https://silvan2077.github.io/categories/java/"/>
    
    
    <category term="JavaWeb" scheme="https://silvan2077.github.io/tags/JavaWeb/"/>
    
    <category term="HTML" scheme="https://silvan2077.github.io/tags/HTML/"/>
    
    <category term="CSS" scheme="https://silvan2077.github.io/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>JaveWeb---HTML、CSS、JavaScript</title>
    <link href="https://silvan2077.github.io/2025/08/29/JaveWeb-JS/"/>
    <id>https://silvan2077.github.io/2025/08/29/JaveWeb-JS/</id>
    <published>2025-08-29T06:28:57.000Z</published>
    <updated>2025-09-16T12:52:44.245Z</updated>
    
    <content type="html"><![CDATA[<h2 id="JavaScript简介">JavaScript简介</h2><p>JavaScript 是一门<code>跨平台</code>、<code>面向对象</code>的脚本语言，而Java语言也是跨平台的、面向对象的语言，只不过Java是编译语言，是需要编译成字节码文件才能运行的；JavaScript是脚本语言，不需要编译，由浏览器直接解析并执行。</p><p>JavaScript能用来<code>控制网页行为</code>，使得网页可交互；</p><p>JavaScript（简称：JS） 在 1995 年由 Brendan Eich 发明，并于 1997 年成为一部 ECMA 标准。ECMA 规定了一套标准 就叫 <code>ECMAScript</code> ，所有的客户端校验语言必须遵守这个标准，当然 JavaScript 也遵守了这个标准。</p><h2 id="JavaScript引入方式">JavaScript引入方式</h2><p>JavaScript 引入方式就是 HTML 和 JavaScript 的结合方式。JavaScript引入方式有两种：</p><ul><li>内部脚本：将 JS代码定义在HTML页面中</li><li>外部脚本：将 JS代码定义在外部 JS文件中，然后引入到 HTML页面中</li></ul><h3 id="内部脚本">内部脚本</h3><p>在 HTML 中，JavaScript 代码必须位于 <code>&lt;script&gt;</code> 与 <code>&lt;/script&gt;</code> 标签之间</p><p><strong>代码如下：</strong></p><p><code>alert(数据)</code> 是 JavaScript 的一个方法，作用是将参数数据以浏览器弹框的形式输出出来。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&quot;Hello JavaScript&quot;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><ul><li>在 HTML 文档中可以在任意地方，可以放置任意数量的<code>&lt;script&gt;</code>标签。</li><li>不过一般把脚本放置在<code>&lt;body&gt;</code>元素的底部，可以改善显示速度</li><li>因为浏览器在加载页面的时候会从上往下进行加载并解析。 我们应该先让用户看到页面内容，然后再展示动态的效果。</li></ul></blockquote><h3 id="外部脚本">外部脚本</h3><p>外部脚本即为定义外部 js 文件，将js代码写在文件中</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;hello js&quot;</span>);</span><br></pre></td></tr></table></figure><p>在页面使用 <code>script</code> 标签中使用 <code>src</code> 属性指定 js 文件的 URL 路径。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/demo.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span> </span><br></pre></td></tr></table></figure><blockquote><ul><li>在js文件中直接写 js 代码即可，不要在 js文件 中写 <code>script</code> 标签</li><li><code>&lt;script&gt;</code> 标签不能自闭合</li></ul></blockquote><h2 id="JavaScript基础语法">JavaScript基础语法</h2><h3 id="书写语法">书写语法</h3><ul><li><p>区分大小写：与 Java 一样，变量名、函数名以及其他一切东西都是区分大小写的</p></li><li><p>每行结尾的分号可有可无（建议还是加上）</p><p>如果一行上写多个语句时，必须加分号用来区分多个语句。</p></li><li><p>注释</p><ul><li>单行注释：// 注释内容</li><li>多行注释：/* 注释内容 */</li></ul></li></ul><p>注意：JavaScript 没有文档注释</p><ul><li>大括号表示代码块</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (count == <span class="number">3</span>) &#123; </span><br><span class="line">   <span class="title function_">alert</span>(count); </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h3 id="输出语句">输出语句</h3><p>js 可以通过以下方式进行内容输出，只不过不同的语句输出到的位置不同</p><div class="tabs" id="输出语句"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#输出语句-1">window.alert()</button></li><li class="tab"><button type="button" data-href="#输出语句-2">document.write()</button></li><li class="tab"><button type="button" data-href="#输出语句-3">console.log()</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="输出语句-1"><ul><li>使用 window.alert() 写入警告框</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="string">&quot;HELLO JS&quot;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="输出语句-2"><ul><li>使用 document.write() 写入 HTML 输出</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;HELLO JS&quot;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="输出语句-3"><ul><li>使用 console.log() 写入浏览器控制台</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;HELLO JS&quot;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="变量">变量</h3><p>JavaScript中使用var关键字（variable的缩写）来声明变量，格式<code>var 变量名 = 数据值;</code>。<br>JavaScript是一门<code>弱类型语言</code>，变量可以存放不同类型的值</p><p>js 中的变量名命名也有如下规则，和java语言基本都相同</p><ul><li>组成字符可以是任何字母、数字、下划线（_）或美元符号（$）</li><li>数字不能开头</li><li>建议使用驼峰命名</li></ul><p>JavaScript 中 <code>var</code> 关键字有点特殊，有以下地方和其他语言不一样</p><ul><li><code>作用域：全局变量</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> age = <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(age); <span class="comment">//在代码块中定义age，在代码块外依然能使用</span></span><br></pre></td></tr></table></figure><ul><li><code>变量可以重复定义</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> age = <span class="number">18</span>;</span><br><span class="line">    <span class="keyword">var</span> age = <span class="number">14</span>; <span class="comment">//JavaScript会用14替换之前的18</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(age); <span class="comment">//最后输出的是14</span></span><br></pre></td></tr></table></figure><blockquote><p>针对如上的问题，ECMAScript 6 新增了 <code>let </code>关键字来定义变量。它的用法类似于 <code>var</code>，但是<code>let</code>声明的变量，只在 <code>let</code> 关键字所在的代码块内有效，且不允许重复声明。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> age = <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(age);  <span class="comment">//试图在代码块外部输出age</span></span><br></pre></td></tr></table></figure><p>浏览器不会弹窗输出结果，F12打开控制台会出现<code>Uncaught ReferenceError: age is not defined</code>错误，age未定义。</p><p>ECMAScript 6 新增了 const关键字，用来声明一个只读的常量。一旦声明，常量的值就不能改变。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">PI</span> = <span class="number">3.14159</span>;</span><br><span class="line">    <span class="variable constant_">PI</span> = <span class="number">3.14</span>;  <span class="comment">//IDEA会直接报错</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="数据类型">数据类型</h3><p>JavaScript 中提供了两类数据类型：<code>原始类型</code> 和 <code>引用类型</code>。</p><p>使用 <code>typeof</code> 运算符可以获取数据类型</p><p>例如<code>alert(typeof age);</code> 以弹框的形式将 age 变量的数据类型输出</p><p>原始数据类型：</p><ul><li>number：数字（整数，小数，NaN(Not a Number)）</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> age = <span class="number">3.14</span>;</span><br><span class="line"><span class="keyword">var</span> price = <span class="number">521</span>;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="keyword">typeof</span> age);   <span class="comment">//结果为number</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="keyword">typeof</span> price); <span class="comment">//结果为number  </span></span><br></pre></td></tr></table></figure><blockquote><p>注意： NaN是一个特殊的number类型的值，后面用到再说</p></blockquote><ul><li>string：字符、字符串，单引号和双引号都行</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ch = <span class="string">&#x27;X&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> name = <span class="string">&#x27;Tom&#x27;</span>; </span><br><span class="line"><span class="keyword">var</span> addr = <span class="string">&quot;US&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(<span class="keyword">typeof</span> ch);   <span class="comment">//结果是  string</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="keyword">typeof</span> name); <span class="comment">//结果是  string</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="keyword">typeof</span> addr); <span class="comment">//结果是  string</span></span><br></pre></td></tr></table></figure><p>注意：==在 js 中 双引号和单引号都表示字符串类型的数据</p><ul><li>boolean：布尔。true，false</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> flag1 = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> flag2 = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(<span class="keyword">typeof</span> flag1);  <span class="comment">//结果是 boolean</span></span><br><span class="line"><span class="title function_">alert</span>(<span class="keyword">typeof</span> flag2); <span class="comment">//结果是 boolean</span></span><br></pre></td></tr></table></figure><ul><li>null：对象为空</li></ul><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">alert(<span class="keyword">typeof</span> obj); <span class="comment">//结果是 object</span></span><br></pre></td></tr></table></figure><p>为什么结果是object，官方给出了这个解释</p><blockquote><p>注释:您也许会问，为什么typeof 运算符对于null值会返回“Object&quot;。这实际上是JavaScript最初实现中的一个错误，然后被ECMAScript沿用了。现在，null被认为是对象的占位符，从而解释了这一矛盾，但从技术上来说，它仍然是原始值。</p></blockquote><ul><li>undefined：当声明的变量未初始化时，该变量的默认值是 undefined</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a ;</span><br><span class="line"><span class="title function_">alert</span>(<span class="keyword">typeof</span> a); <span class="comment">//结果是 undefined</span></span><br></pre></td></tr></table></figure><h3 id="运算符">运算符</h3><p>JavaScript 提供了如下的运算符。大部分和 Java语言 都是一样的，不同的是 JS 关系运算符中的 <code>==</code> 和 <code>===</code>，只演示一下这两个的区别，其他运算符将不做演示</p><ul><li>一元运算符：++，–</li><li>算术运算符：+，-，*，/，%</li><li>赋值运算符：=，+=，-=…</li><li>关系运算符：&gt;，&lt;，&gt;=，&lt;=，!=，==，===…</li><li>逻辑运算符：&amp;&amp;，||，!</li><li>三元运算符：条件表达式 ? true_value : false_value</li></ul><h4 id="和-区别">==和===区别</h4><ul><li>==：<ol><li>判断类型是否一样，如果不一样，则进行类型转换</li><li>再去比较其值</li></ol></li><li>===：js 中的全等于<ol><li>判断类型是否一样，如果不一样，直接返回false</li><li>再去比较其值</li></ol></li><li>验证</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tmp1 = <span class="number">18</span>;</span><br><span class="line"><span class="keyword">var</span> tmp2 = <span class="string">&quot;18&quot;</span>;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(tmp1 == tmp2);     <span class="comment">//ture</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(tmp1 === tmp2);    <span class="comment">//false</span></span><br></pre></td></tr></table></figure><h4 id="类型转换">类型转换</h4><p>上述讲解 <code>==</code> 运算符时，发现会进行类型转换，这里就来详细说说JavaScript中的类型转换</p><ul><li><p>其他类型转为number</p><ul><li><p>string 转换为 number 类型：按照字符串的字面值，转为数字。如果字面值不是数字，则转为<code>NaN</code></p><p>将 string 转换为 number 有两种方式：</p><ul><li>使用 <code>+</code> 正号运算符：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tmp1 = <span class="string">&quot;18&quot;</span>;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(+tmp1 + <span class="number">1</span>);    <span class="comment">//19</span></span><br></pre></td></tr></table></figure><ul><li>使用 <code>parseInt()</code> 函数：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tmp1 = <span class="string">&quot;18&quot;</span>;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="built_in">parseInt</span>(tmp1) + <span class="number">1</span>);   <span class="comment">//19</span></span><br></pre></td></tr></table></figure></li></ul><div class="note warning no-icon flat"><p>建议使用 <code>parseInt()</code> 函数进行转换。</p></div><ul><li>boolean 转换为 number 类型：true 转为1，false转为0</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> flag = +<span class="literal">false</span>;</span><br><span class="line"><span class="title function_">alert</span>(flag); <span class="comment">// 0</span></span><br></pre></td></tr></table></figure></li><li><p>其他类型转为boolean</p></li></ul><div class="note no-icon flat"><ul><li>number 类型转换为 boolean 类型：0和NaN转为false，其他的数字转为true</li><li>string 类型转换为 boolean 类型：空字符串转为false，其他的字符串转为true</li><li>null类型转换为 boolean 类型是 false</li><li>undefined 转换为 boolean 类型是 false</li></ul></div><p><strong>使用场景：</strong></p><p>在 Java 中使用字符串前，一般都会先判断字符串不是null，并且不是空字符才会做其他的一些操作，JavaScript也有类型的操作，代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;abc&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//健壮性判断</span></span><br><span class="line"><span class="keyword">if</span>(str != <span class="literal">null</span> &amp;&amp; str.<span class="property">length</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;转为true&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;转为false&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但是由于 JavaScript 会自动进行类型转换，所以上述的判断可以进行简化，代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;abc&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//健壮性判断</span></span><br><span class="line"><span class="keyword">if</span>(str)&#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;转为true&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;转为false&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="流程控制语句">流程控制语句</h3><p>JavaScript 中提供了和 Java 一样的流程控制语句，如下</p><ul><li>if</li><li>switch</li><li>for</li><li>while</li><li>dowhile</li></ul><h4 id="if-语句">if 语句</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(num = <span class="number">1</span>)&#123;</span><br><span class="line">    <span class="title function_">alert</span>(num)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="switch-语句">switch 语句</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">switch</span> (num) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;星期一&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;星期二&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;星期三&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;星期四&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;星期无&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;星期六&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;星期日&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;输入有误&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="for-语句">for 语句</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(num++ + <span class="string">&quot; &quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="while-语句">while 语句</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (num &lt; <span class="number">10</span>)&#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(num++ + <span class="string">&quot; &quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="dowhile-语句">dowhile 语句</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(num++ + <span class="string">&quot; &quot;</span>);</span><br><span class="line">&#125; <span class="keyword">while</span> (num &lt; <span class="number">20</span>);</span><br></pre></td></tr></table></figure><h3 id="函数">函数</h3><p>函数（就是Java中的方法）是被设计为执行特定任务的代码块；JavaScript 函数通过 function 关键词进行定义。</p><h4 id="定义格式">定义格式</h4><p>函数定义格式有两种：</p><ul><li><strong>方式一：</strong></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> 函数名(参数列表)&#123;</span><br><span class="line">    要执行的代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>方式二：</strong></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 函数名 = <span class="keyword">function</span>(<span class="params">参数列表</span>)&#123;</span><br><span class="line">    要执行的代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>注意：形式参数不需要类型。因为JavaScript是弱类型语言</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a, b</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上述函数的参数 a 和 b 不需要定义数据类型，因为在每个参数前加上 var 也没有任何意义。</p><p>返回值也不需要定义类型，可以在函数内部直接使用return返回即可</p></div><h3 id="函数调用">函数调用</h3><p>函数调用函数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">函数名称(实际参数列表);</span><br></pre></td></tr></table></figure><p>举例</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> res = <span class="title function_">add</span>(<span class="number">3.14</span>, <span class="number">10</span>);</span><br><span class="line"><span class="title function_">alert</span>(res);</span><br></pre></td></tr></table></figure><div class="note warning no-icon flat"><p>JS中，函数调用可以传递任意个数参数<br>例如 <code>let result = add(1,2,3);</code><br>它是将数据 1 传递给了变量a，将数据 2 传递给了变量 b，而数据 3 没有变量接收。</p></div><h2 id="JavaScript常用对象">JavaScript常用对象</h2><p>JavaScript 提供了很多对象供使用者来使用。这些对象总共分类三类</p><ul><li><code>基本对象</code></li><li><code>BOM对象</code></li><li><code>DOM对象</code></li></ul><p>先学习基本对象，主要学习 <code>Array</code> 数组对象和 <code>String</code> 字符串对象。</p><h2 id="Array对象">Array对象</h2><p>JavaScript Array对象用于定义数组</p><h3 id="定义格式-2">定义格式</h3><p>数组的定义格式有两种：</p><div class="tabs" id="array对象"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#array对象-1">方式一</button></li><li class="tab"><button type="button" data-href="#array对象-2">方式二</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="array对象-1"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>); <span class="comment">//1,2,3 是存储在数组中的数据（元素）</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="array对象-2"><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]; <span class="comment">//1,2,3 是存储在数组中的数据（元素）</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note warning no-icon flat"><p>注意：Java中的数组静态初始化使用的是{}定义，而 JavaScript 中使用的是 [] 定义</p></div><h4 id="元素访问">元素访问</h4><p>访问数组中的元素和 Java 语言的一样，格式如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr[索引] = 值;</span><br></pre></td></tr></table></figure><p>代码演示：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr[<span class="number">0</span>] = <span class="number">10</span>;</span><br><span class="line"><span class="title function_">alert</span>(arr);</span><br></pre></td></tr></table></figure><h4 id="特点">特点</h4><p>JavaScript 中的数组相当于 Java 中的<code>集合</code>。数组的长度是可以变化的，而 JavaScript 是弱类型，所以可以存储任意的类型的数据。</p><p>例如如下代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">arr[<span class="number">7</span>] = <span class="literal">true</span>;</span><br><span class="line">arr[<span class="number">8</span>] = <span class="string">&quot;张三&quot;</span>;</span><br><span class="line">arr[<span class="number">10</span>] = <span class="number">10</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(arr);    <span class="comment">//1,2,3,,,,,true,张三,,10</span></span><br></pre></td></tr></table></figure><h4 id="属性">属性</h4><table><thead><tr><th style="text-align:center">属性</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">constructor</td><td style="text-align:center">返回创建 Array 对象原型的函数。</td></tr><tr><td style="text-align:center">length</td><td style="text-align:center">设置或返回数组中元素的数量。</td></tr><tr><td style="text-align:center">prototype</td><td style="text-align:center">允许您向数组添加属性和方法。</td></tr></tbody></table><p>这里只说一下 <code>length</code> 属性，该数组可以动态的获取数组的长度。而有这个属性，我们就可以遍历数组了</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">arr[<span class="number">7</span>] = <span class="literal">true</span>;</span><br><span class="line">arr[<span class="number">8</span>] = <span class="string">&quot;张三&quot;</span>;</span><br><span class="line">arr[<span class="number">10</span>] = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(arr[i] + <span class="string">&quot;,&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//1,2,3,undefined,undefined,undefined,undefined,true,张三,undefined,10,</span></span><br></pre></td></tr></table></figure><h4 id="方法">方法</h4><p>Array 对象同样也提供了很多方法</p><table><thead><tr><th style="text-align:center">方法</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">concat()</td><td style="text-align:center">连接两个或多个数组，并返回已连接数组的副本。</td></tr><tr><td style="text-align:center">copyWithin()</td><td style="text-align:center">将数组中的数组元素复制到指定位置或从指定位置复制。</td></tr><tr><td style="text-align:center">entries()</td><td style="text-align:center">返回键/值对数组迭代对象。</td></tr><tr><td style="text-align:center">every()</td><td style="text-align:center">检查数组中的每个元素是否通过测试。</td></tr><tr><td style="text-align:center">fill()</td><td style="text-align:center">用静态值填充数组中的元素。</td></tr><tr><td style="text-align:center">filter()</td><td style="text-align:center">使用数组中通过测试的每个元素创建新数组。</td></tr><tr><td style="text-align:center">find()</td><td style="text-align:center">返回数组中第一个通过测试的元素的值。</td></tr><tr><td style="text-align:center">findIndex()</td><td style="text-align:center">返回数组中通过测试的第一个元素的索引。</td></tr><tr><td style="text-align:center">forEach()</td><td style="text-align:center">为每个数组元素调用函数。</td></tr><tr><td style="text-align:center">from()</td><td style="text-align:center">从对象创建数组。</td></tr><tr><td style="text-align:center">includes()</td><td style="text-align:center">检查数组是否包含指定的元素。</td></tr><tr><td style="text-align:center">indexOf()</td><td style="text-align:center">在数组中搜索元素并返回其位置。</td></tr><tr><td style="text-align:center">isArray()</td><td style="text-align:center">检查对象是否为数组。</td></tr><tr><td style="text-align:center">join()</td><td style="text-align:center">将数组的所有元素连接成一个字符串。</td></tr><tr><td style="text-align:center">keys()</td><td style="text-align:center">返回 Array Iteration 对象，包含原始数组的键.</td></tr><tr><td style="text-align:center">lastIndexOf()</td><td style="text-align:center">在数组中搜索元素，从末尾开始，并返回其位置。</td></tr><tr><td style="text-align:center">map()</td><td style="text-align:center">使用为每个数组元素调用函数的结果创建新数组。</td></tr><tr><td style="text-align:center">pop()</td><td style="text-align:center">删除数组的最后一个元素，并返回该元素。</td></tr><tr><td style="text-align:center">push()</td><td style="text-align:center">将新元素添加到数组的末尾，并返回新的长度。</td></tr><tr><td style="text-align:center">reduce()</td><td style="text-align:center">将数组的值减为单个值（从左到右）。</td></tr><tr><td style="text-align:center">reduceRight()</td><td style="text-align:center">将数组的值减为单个值（从右到左）。</td></tr><tr><td style="text-align:center">reverse()</td><td style="text-align:center">反转数组中元素的顺序。</td></tr><tr><td style="text-align:center">shift()</td><td style="text-align:center">删除数组的第一个元素，并返回该元素。</td></tr><tr><td style="text-align:center">slice()</td><td style="text-align:center">选择数组的一部分，并返回新数组。</td></tr><tr><td style="text-align:center">some()</td><td style="text-align:center">检查数组中的任何元素是否通过测试。</td></tr><tr><td style="text-align:center">sort()</td><td style="text-align:center">对数组的元素进行排序。</td></tr><tr><td style="text-align:center">splice()</td><td style="text-align:center">从数组中添加/删除元素。</td></tr><tr><td style="text-align:center">toString()</td><td style="text-align:center">将数组转换为字符串，并返回结果。</td></tr><tr><td style="text-align:center">unshift()</td><td style="text-align:center">将新元素添加到数组的开头，并返回新的长度。</td></tr><tr><td style="text-align:center">valueOf()</td><td style="text-align:center">返回数组的原始值。</td></tr></tbody></table><p>只演示一下 <code>push</code> 函数和 <code>splice</code> 函数。</p><ul><li>push 函数：给数组添加元素，也就是在数组的末尾添加元素<ul><li>参数表示要添加的元素</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">push</span>(<span class="number">4</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(arr); <span class="comment">//1,2,3,4</span></span><br></pre></td></tr></table></figure><ul><li>splice 函数：删除元素<ul><li>参数1：索引。表示从哪个索引位置删除</li><li>参数2：个数。表示删除几个元素</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">push</span>(<span class="number">4</span>);</span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(arr);    <span class="comment">//1,4</span></span><br></pre></td></tr></table></figure><h3 id="String对象">String对象</h3><p>String对象的创建方式有两种</p><ul><li>方式1：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 变量名 = <span class="keyword">new</span> <span class="title class_">String</span>(s); </span><br></pre></td></tr></table></figure><ul><li>方式二</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 变量名 = <span class="string">&quot;数组&quot;</span>; </span><br></pre></td></tr></table></figure><p>String对象的与Java中String的方法大多数都一致，这里讲一个常用的方法<code>trim()</code>，它是用来去掉字符串两端的空格。<br>用户在输入用户名和密码时，可能会习惯的输入一些空格，这样在我们后端程序中判断用户名和密码是否正确，结果肯定是失败。所以我们一般都会对用户输入的字符串数据进行去除前后空格的操作。</p><h3 id="自定义对象">自定义对象</h3><p>在 JavaScript 中自定义对象特别简单，下面就是自定义对象的格式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 对象名称 = &#123;</span><br><span class="line">    属性名称<span class="number">1</span>:属性值<span class="number">1</span>,</span><br><span class="line">    属性名称<span class="number">2</span>:属性值<span class="number">2</span>,</span><br><span class="line">    ...,</span><br><span class="line">    函数名称:<span class="keyword">function</span> (<span class="params">形参列表</span>)&#123;&#125;,</span><br><span class="line">...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>调用属性的格式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">对象名.属性名</span><br></pre></td></tr></table></figure><p>调用函数的格式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">对象名.函数名()</span><br></pre></td></tr></table></figure><p>代码演示：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;张三&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">18</span>,</span><br><span class="line">    <span class="attr">hobby</span>:<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;干饭&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(person.<span class="property">name</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(person.<span class="property">age</span>);</span><br><span class="line">person.<span class="title function_">hobby</span>();</span><br></pre></td></tr></table></figure><h2 id="BOM">BOM</h2><h3 id="Window对象">Window对象</h3><p>window 对象是 JavaScript 对浏览器的窗口进行封装的对象。</p><h4 id="获取window对象">获取window对象</h4><p>该对象不需要创建直接使用 <code>window</code>，其中 <code>window. </code>可以省略。比如我们之前使用的 <code>alert()</code> 函数，其实就是 <code>window</code> 对象的函数，在调用是可以写成如下两种</p><ul><li>显式使用 <code>window</code> 对象调用</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="string">&quot;abc&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>隐式调用</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;abc&quot;</span>);</span><br></pre></td></tr></table></figure><h4 id="window对象属性">window对象属性</h4><p><code>window</code> 对象提供了用于获取其他 BOM 组成对象的属性</p><table><thead><tr><th style="text-align:center">方法</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">history</td><td style="text-align:center">对 History 对象的只读引用。请参数 。<a href="https://www.w3school.com.cn/jsref/dom_obj_history.asp">History 对象</a></td></tr><tr><td style="text-align:center">location</td><td style="text-align:center">用于窗口或框架的 Location 对象。请参阅 <a href="https://www.w3school.com.cn/jsref/dom_obj_location.asp">Location 对象</a>。</td></tr><tr><td style="text-align:center">Navigator</td><td style="text-align:center">对 Navigator 对象的只读引用。请参数 <a href="https://www.w3school.com.cn/jsref/dom_obj_navigator.asp">Navigator 对象</a>。</td></tr><tr><td style="text-align:center">Screen</td><td style="text-align:center">对 Screen 对象的只读引用。请参数 <a href="https://www.w3school.com.cn/jsref/dom_obj_screen.asp">Screen 对象</a>。</td></tr></tbody></table><p>也就是说，我们想使用 <code>Location</code> 对象的话，就可以使用 <code>window</code> 对象获取；写成 <code>window.location</code>，而 <code>window.</code> 可以省略，简化写成 <code>location</code> 来获取 <code>Location</code> 对象。</p><h4 id="window对象方法">window对象方法</h4><p><code>window</code> 对象提供了很多函数供我们使用，而很多都不常用；下面给列举了一些比较常用的函数</p><table><thead><tr><th style="text-align:center">方法</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">alert()</td><td style="text-align:center">显示带有一段消息和一个确认按钮的警告框。</td></tr><tr><td style="text-align:center">confirm()</td><td style="text-align:center">显示带有一段消息以及确认按钮和取消按钮的对话框。</td></tr><tr><td style="text-align:center">setInterval()</td><td style="text-align:center">按照指定的周期（以毫秒计）来调用函数或计算表达式。</td></tr><tr><td style="text-align:center">setTimeout()</td><td style="text-align:center">在指定的毫秒数后调用函数或计算表达式。</td></tr></tbody></table><p><code>setTimeout(function,毫秒值)</code> : 在一定的时间间隔后执行一个function，只执行一次<br><code>setInterval(function,毫秒值)</code> :在一定的时间间隔后执行一个function，循环执行</p><p><strong>confirm代码演示：</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> flag =  <span class="title function_">confirm</span>(<span class="string">&quot;确认删除？&quot;</span>);</span><br><span class="line"><span class="title function_">alert</span>(flag);</span><br></pre></td></tr></table></figure><p><code>confirm()</code> 函数一般用于防止用户的误操作，当用户想删除一条数据时，需要点击确定，当我们点击 <code>确定</code> 按钮，<code>flag</code> 变量值记录的就是 <code>true</code> ；当我们点击 <code>取消</code> 按钮，<code>flag</code> 变量值记录的就是 <code>false</code>。</p><p><strong>定时器代码演示：</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;你好&quot;</span>)</span><br><span class="line">&#125;,<span class="number">3000</span>);</span><br></pre></td></tr></table></figure><p>当我们打开浏览器，3秒后才会弹框输出 <code>你好</code>，并且只会弹出一次。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setInterval</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;你好&quot;</span>)</span><br><span class="line">&#125;,<span class="number">1000</span>);</span><br></pre></td></tr></table></figure><p>当我们打开浏览器，每隔1秒都会弹框输出 <code>你好</code>。</p><h4 id="案例">案例</h4><ul><li>需求：每隔1秒，灯泡切换一次状态</li></ul><p><a href="https://s2.loli.net/2022/08/15/ZigwbChy1W9P7qH.gif"><img src="https://s2.loli.net/2022/08/15/RmyvTZrGcYEHj1i.gif" alt="img"></a></p><ul><li>代码</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--将开关灯的按钮打开，把循环定时器的代码注释掉，可以实现手动点击按钮开关灯的效果--&gt;</span><br><span class="line">&lt;!--&lt;input type=&quot;button&quot; onclick=&quot;on()&quot; value=&quot;开灯&quot;&gt;--&gt;</span><br><span class="line">&lt;img id=&quot;myImage&quot; src=&quot;https://s2.loli.net/2022/08/15/ZigwbChy1W9P7qH.gif&quot; alt=&quot;&quot;&gt;</span><br><span class="line">&lt;!--&lt;input type=&quot;button&quot; onclick=&quot;off()&quot; value=&quot;关灯&quot;&gt;--&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    function on()&#123;</span><br><span class="line">        document.getElementById(&quot;myImage&quot;).src=&quot;https://s2.loli.net/2022/08/15/RmyvTZrGcYEHj1i.gif&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    function off()&#123;</span><br><span class="line">        document.getElementById(&quot;myImage&quot;).src=&quot;https://s2.loli.net/2022/08/15/ZigwbChy1W9P7qH.gif&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    let tmp = 0;</span><br><span class="line">    setInterval(function () &#123;</span><br><span class="line">        if (tmp % 2 == 0) &#123;</span><br><span class="line">            on();</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            off();</span><br><span class="line">        &#125;</span><br><span class="line">        tmp++;</span><br><span class="line">    &#125;, 1000);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="History对象">History对象</h3><p>History 对象是 JavaScript 对历史记录进行封装的对象。</p><ul><li><p>History 对象的获取</p><p>使用 window.history获取，其中window. 可以省略</p></li><li><p>History 对象的函数</p></li></ul><table><thead><tr><th style="text-align:center">方法</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">back()</td><td style="text-align:center">加载history 列表中的前一个URL。</td></tr><tr><td style="text-align:center">forward()</td><td style="text-align:center">加载history 列表中的下一个URL。</td></tr></tbody></table><p>当我们点击浏览器的向左箭头，就跳转到前一个访问的页面，这就是 <code>back()</code> 函数的作用；当我们点击向右的箭头，就跳转到下一个访问的页面，这就是 <code>forward()</code> 函数的作用。</p><h3 id="Location对象">Location对象</h3><p>Location 对象是 JavaScript 对地址栏封装的对象。可以通过操作该对象，跳转到任意页面。</p><h4 id="获取Location对象">获取Location对象</h4><p>使用 window.location获取，其中window. 可以省略</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">location</span>.方法();</span><br><span class="line">location.方法();</span><br></pre></td></tr></table></figure><h4 id="Location对象属性">Location对象属性</h4><p>Location对象提供了很对属性。以后常用的只有一个属性 <code>href</code></p><table><thead><tr><th style="text-align:center">属性</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">href</td><td style="text-align:center">设置或返回完整的URL。</td></tr></tbody></table><p>代码演示</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;要跳转了&quot;</span>);</span><br><span class="line">location.<span class="property">href</span> = <span class="string">&quot;https://www.baidu.com&quot;</span>;</span><br></pre></td></tr></table></figure><p>在浏览器首先会弹框显示 <code>要跳转了</code>，当我们点击了 <code>确定</code> 就会跳转到 百度 的首页。</p><h4 id="案例-2">案例</h4><p>需求：3秒跳转到百度首页</p><ul><li>分析：<ol><li>3秒跳转，由此可以确定需要使用到定时器，而只跳转一次，所以使用 <code>setTimeOut()</code></li><li>要进行页面跳转，所以需要用到 <code>location</code> 对象的 <code>href</code> 属性实现</li></ol></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;三秒后跳转至主页...&quot;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">    location.<span class="property">href</span> = <span class="string">&quot;https://www.baidu.com&quot;</span>;</span><br><span class="line">&#125;,<span class="number">3000</span>);</span><br></pre></td></tr></table></figure><h2 id="DOM">DOM</h2><h3 id="概述">概述</h3><p>DOM：Document Object Model 文档对象模型。也就是 JavaScript 将 HTML 文档的各个组成部分封装为对象。</p><p><strong>作用：</strong></p><p>JavaScript 通过 DOM， 就能够对 HTML进行操作了</p><ul><li>改变 HTML 元素的内容</li><li>改变 HTML 元素的样式（CSS）</li><li>对 HTML DOM 事件作出反应</li><li>添加和删除 HTML 元素</li></ul><p><strong>DOM相关概念：</strong></p><p>DOM 是 W3C（万维网联盟）定义了访问 HTML 和 XML 文档的标准。该标准被分为 3 个不同的部分：</p><ol><li><p>核心 DOM：针对任何结构化文档的标准模型。 XML 和 HTML 通用的标准</p><ul><li>Document：整个文档对象</li><li>Element：元素对象</li><li>Attribute：属性对象</li><li>Text：文本对象</li><li>Comment：注释对象</li></ul></li><li><p>XML DOM： 针对 XML 文档的标准模型</p></li><li><p>HTML DOM： 针对 HTML 文档的标准模型</p><p>该标准是在核心 DOM 基础上，对 HTML 中的每个标签都封装成了不同的对象</p><ul><li>例如：<code>&lt;img&gt;</code> 标签在浏览器加载到内存中时会被封装成 <code>Image</code> 对象，同时该对象也是 <code>Element</code> 对象。</li><li>例如：<code>&lt;input type='button'&gt;</code> 标签在浏览器加载到内存中时会被封装成 <code>Button</code> 对象，同时该对象也是 <code>Element</code> 对象。</li></ul></li></ol><h3 id="获取-Element对象">获取 Element对象</h3><p>HTML 中的 Element 对象可以通过 <code>Document</code> 对象获取，而 <code>Document</code> 对象是通过 <code>window</code> 对象获取。</p><p><code>Document</code> 对象中提供了以下获取 <code>Element</code> 元素对象的函数</p><ul><li><code>getElementById()</code>：根据id属性值获取，返回单个Element对象</li><li><code>getElementsByTagName()</code>：根据标签名称获取，返回Element对象数组</li><li><code>getElementsByName()</code>：根据name属性值获取，返回Element对象数组</li><li><code>getElementsByClassName()</code>：根据class属性值获取，返回Element对象数组</li></ul><h3 id="HTML-Element对象使用">HTML Element对象使用</h3><p>HTML 中的 <code>Element</code> 元素对象有很多，不可能全部记住，以后是根据具体的需求<a href="https://www.w3school.com.cn/">查阅文档</a>使用。<br>例如上面的开关灯泡，就是根据id属性值获取了Image对象，然后修改Image对象的src属性，从而达到切换图片，实现灯泡开关的效果</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;button&quot;</span> onclick=<span class="string">&quot;on()&quot;</span> value=<span class="string">&quot;开灯&quot;</span>&gt;</span><br><span class="line">&lt;img id=&quot;myImage&quot; src=&quot;../imgs/off.gif&quot; alt=&quot;&quot;&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; onclick=&quot;off()&quot; value=&quot;关灯&quot;&gt;  </span><br><span class="line">&lt;script&gt;</span><br><span class="line">    function on() &#123;</span><br><span class="line">        document.getElementById(&quot;myImage&quot;).src = &quot;../imgs/on.gif&quot;;  //获取Image对象，并将src属性修改为关灯图片地址</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function off() &#123;</span><br><span class="line">        document.getElementById(&quot;myImage&quot;).src = &quot;../imgs/off.gif&quot;; //获取Image对象，并将src属性修改为开灯图片地址</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="事件监听">事件监听</h2><p>要想知道什么是事件监听，首先先聊聊什么是事件？</p><p>HTML 事件是发生在 HTML 元素上的“事情”。比如：页面上的 <code>按钮被点击</code>、<code>鼠标移动到元素之上</code>、<code>按下键盘按键</code> 等都是事件。</p><p>事件监听是JavaScript 可以在事件被侦测到时执行一段逻辑代码。之前的开关灯操作，当我们点击 <code>开灯</code> 按钮，就需要通过 js 代码实现替换图片</p><p>又例如当我们在注册一些网站时，我们输入用户名之后， <code>光标离开</code> 输入框，就是通过 js 代码对输入的内容进行校验，没通过校验就在输入框后提示 <code>用户名格式有误!</code></p><h3 id="事件绑定">事件绑定</h3><p>JavaScript 提供了两种事件绑定方式：</p><ul><li>方式一：通过 HTML标签中的事件属性进行绑定<br>如下面代码，有一个按钮元素，我们是在该标签上定义 <code>事件属性</code>，在事件属性中绑定函数。<code>onclick</code> 就是 <code>单击事件</code> 的事件属性。<code>onclick='on（）'</code> 表示该点击事件绑定了一个名为 <code>on()</code> 的函数</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;button&quot;</span> onclick=<span class="string">&#x27;on()’&gt;</span></span><br></pre></td></tr></table></figure><p>下面是点击事件绑定的 <code>on()</code> 函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">on</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;我被点了&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>方式二：通过 DOM 元素属性绑定</p><p>如下面代码是按钮标签，在该标签上我们并没有使用 <code>事件属性</code>，绑定事件的操作需要在 js 代码中实现</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">&quot;button&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span><br></pre></td></tr></table></figure><p>下面 js 代码是获取了 <code>id='btn'</code> 的元素对象，然后将 <code>onclick</code> 作为该对象的属性，并且绑定匿名函数。该函数是在事件触发后自动执行</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;btn&quot;</span>).<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">  <span class="title class_">Salert</span>(<span class="string">&quot;我被点了&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="常见事件">常见事件</h3><table><thead><tr><th style="text-align:center">事件属性名</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">onclick</td><td style="text-align:center">鼠标单击事件</td></tr><tr><td style="text-align:center">onblur</td><td style="text-align:center">元素失去焦点</td></tr><tr><td style="text-align:center">onfocus</td><td style="text-align:center">元素获得焦点</td></tr><tr><td style="text-align:center">onload</td><td style="text-align:center">某个页面或图像被完成加载</td></tr><tr><td style="text-align:center">onsubmit</td><td style="text-align:center">当表单提交时触发该事件</td></tr><tr><td style="text-align:center">onmouseover</td><td style="text-align:center">鼠标被移到某元素之上</td></tr><tr><td style="text-align:center">onmouseout</td><td style="text-align:center">鼠标从某元素移开</td></tr></tbody></table><h2 id="表单验证案例">表单验证案例</h2><h3 id="需求">需求</h3><p>对表单进行校验，如果输入的用户名、密码、手机号符合规则，则允许提交；如果不符合规则，则不允许提交。</p><p>完成以下需求：</p><ol><li>当输入框失去焦点时，验证输入内容是否符合要求</li><li>当点击注册按钮时，判断所有输入框的内容是否都符合要求，如果不合符则阻止表单提交</li></ol><table><thead><tr><th>用户名</th><th></th></tr></thead><tbody><tr><td>密码</td><td></td></tr><tr><td>手机号</td><td></td></tr></tbody></table><h3 id="环境准备">环境准备</h3><p>先创建一个表单</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;form id=<span class="string">&quot;reg_form&quot;</span> action=<span class="string">&quot;#&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;table&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;用户名&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;username&quot;&gt;</span><br><span class="line">                &lt;br&gt;</span><br><span class="line">                &lt;!--设置display为none会隐藏字段--&gt;</span><br><span class="line">                &lt;span id=&quot;username_err&quot; style=&quot;display: none&quot;&gt;用户名应为6~12位&lt;/span&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;密码&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot;&gt;</span><br><span class="line">                &lt;br&gt;</span><br><span class="line">                &lt;span id=&quot;password_err&quot; style=&quot;display: none&quot;&gt;密码应为6~12位&lt;/span&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;手机号&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;input type=&quot;text&quot; name=&quot;phone&quot; id=&quot;phone&quot;&gt;</span><br><span class="line">                &lt;br&gt;</span><br><span class="line">                &lt;span id=&quot;phone_err&quot; style=&quot;display: none&quot;&gt;手机号应为11位&lt;/span&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;注册&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><h3 id="验证输入框">验证输入框</h3><ul><li><p>校验用户名。当用户名输入框失去焦点时，判断输入的内容是否符合 <code>长度是 6-12 位</code> 规则，不符合使 <code>id='username_err'</code> 的span标签显示出来，给出用户提示。</p></li><li><p>校验密码。当密码输入框失去焦点时，判断输入的内容是否符合 <code>长度是 6-12 位</code> 规则，不符合使 <code>id='password_err'</code> 的span标签显示出来，给出用户提示。</p></li><li><p>校验手机号。当手机号输入框失去焦点时，判断输入的内容是否符合 <code>长度是 11 位</code> 规则，不符合使 <code>id='phone_err'</code> 的span标签显示出来，给出用户提示。</p></li><li><p>代码如下</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. 验证用户名是否符合规则</span></span><br><span class="line"><span class="comment">//1.1 获取用户名的输入框</span></span><br><span class="line"><span class="keyword">let</span> usernameInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;username&quot;</span>);</span><br><span class="line"><span class="comment">//1.2 绑定onblur事件 失去焦点检查用户名输入</span></span><br><span class="line">usernameInput.<span class="property">onblur</span> = checkUsername;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkUsername</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//1.3 获取用户输入的用户名</span></span><br><span class="line">    <span class="keyword">let</span> username = usernameInput.<span class="property">value</span>.<span class="title function_">trim</span>();</span><br><span class="line">    <span class="comment">//1.4 判断用户名是否符合规则：长度 6~12</span></span><br><span class="line">    <span class="keyword">let</span> flag = username.<span class="property">length</span> &gt;= <span class="number">6</span> &amp;&amp; username.<span class="property">length</span> &lt;= <span class="number">12</span>;</span><br><span class="line">    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">        <span class="comment">//符合条件就把错误信息隐藏</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;username_err&quot;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//不符合条件就展示错误信息</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;username_err&quot;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//验证密码与手机号也是异曲同工</span></span><br><span class="line"><span class="keyword">let</span> passwordInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">passwordInput.<span class="property">onblur</span> = checkPassword;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkPassword</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> password = passwordInput.<span class="property">value</span>.<span class="title function_">trim</span>();</span><br><span class="line">    <span class="keyword">let</span> flag = password.<span class="property">length</span> &gt;= <span class="number">6</span> &amp;&amp; password.<span class="property">length</span> &lt;= <span class="number">12</span>;</span><br><span class="line">    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;password_err&quot;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;password_err&quot;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> phoneInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;phone&quot;</span>);</span><br><span class="line">phoneInput.<span class="property">onblur</span> = checkPhone;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkPhone</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> phone = phoneInput.<span class="property">value</span>.<span class="title function_">trim</span>();</span><br><span class="line">    <span class="keyword">let</span> flag = phone.<span class="property">length</span> === <span class="number">11</span>;</span><br><span class="line">    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;phone_err&quot;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;phone_err&quot;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> regForm = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;reg_form&quot;</span>);</span><br><span class="line"><span class="comment">//onsubmit 事件绑定的函数需要对输入的 `用户名`、`密码`、`手机号` 进行校验</span></span><br><span class="line">regForm.<span class="property">onsubmit</span> = checkAll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkAll</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//只有当符合所有检查条件的时候，才返回true，正常提交</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">checkUsername</span>() &amp;&amp; <span class="title function_">checkPassword</span>() &amp;&amp; <span class="title function_">checkPhone</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="RegExp对象">RegExp对象</h2><p>RegExp 是正则对象。正则对象是判断指定字符串是否符合规则。</p><p>我们可以通过爬虫技术去爬取该页面源代码，然后获取页面中所有的邮箱，后期我们可以给这些邮箱地址发送推广的邮件。那么问题来了，如何才能知道页面内容中哪些事邮箱地址呢？这里就可以使用正则表达式来匹配邮箱。</p><p>在 js 中对正则表达式封装的对象就是正则对象。</p><h3 id="正则对象使用">正则对象使用</h3><h4 id="创建对象">创建对象</h4><p>正则对象有两种创建方式：</p><ul><li><p>直接量方式：注意不要加引号</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/正则表达式/</span>;</span><br></pre></td></tr></table></figure></li><li><p>创建 RegExp 对象</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&quot;正则表达式&quot;</span>);</span><br></pre></td></tr></table></figure></li></ul><h4 id="函数-2">函数</h4><p><code>test(str)</code> ：判断指定字符串是否符合规则，返回 true或 false</p><h3 id="正则表达式">正则表达式</h3><p>从上面创建正则对象的格式中可以看出不管哪种方式都需要正则表达式，那么什么是正则表达式呢？</p><p>正则表达式定义了字符串组成的规则。也就是判断指定的字符串是否符合指定的规则，如果符合返回true，如果不符合返回false。</p><p>正则表达式是和语言无关的。很多语言都支持正则表达式，Java语言也支持，只不过正则表达式在不同的语言中的使用方式不同，js 中需要使用正则对象来使用正则表达式。</p><p>正则表达式常用的规则如下：</p><ul><li>^：表示开始</li><li>$：表示结束</li><li>[ ]：代表某个范围内的单个字符，比如： [0-9] 单个数字字符</li><li>.：代表任意单个字符，除了换行和行结束符</li><li>\w：代表单词字符：字母、数字、下划线(<em>)，相当于 [A-Za-z0-9</em>]</li><li>\d：代表数字字符： 相当于 [0-9]</li></ul><p>量词：</p><ul><li>+：至少一个</li><li>*：零个或多个</li><li>？：零个或一个</li><li>{x}：x个</li><li>{m,}：至少m个</li><li>{m,n}：至少m个，最多n个</li></ul><h3 id="改进表单校验案例">改进表单校验案例</h3><p>表单校验案例中的规则是我们进行一系列的判断来实现的，现在学习了正则对象后，就可以使用正则对象来改进这个案例。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;JavaScript简介&quot;&gt;JavaScript简介&lt;/h2&gt;
&lt;p&gt;JavaScript 是一门&lt;code&gt;跨平台&lt;/code&gt;、&lt;code&gt;面向对象&lt;/code&gt;的脚本语言，而Java语言也是跨平台的、面向对象的语言，只不过Java是编译语言，是需要编译成字节</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>黑马点评</title>
    <link href="https://silvan2077.github.io/2025/08/26/%E9%BB%91%E9%A9%AC%E7%82%B9%E8%AF%84-%E9%BB%91%E9%A9%AC%E7%82%B9%E8%AF%84/"/>
    <id>https://silvan2077.github.io/2025/08/26/%E9%BB%91%E9%A9%AC%E7%82%B9%E8%AF%84-%E9%BB%91%E9%A9%AC%E7%82%B9%E8%AF%84/</id>
    <published>2025-08-26T12:00:23.000Z</published>
    <updated>2025-09-18T05:02:00.581Z</updated>
    
    <content type="html"><![CDATA[<h1>导入项目</h1><h2 id="项目介绍">项目介绍</h2><ul><li>此次项目采用前后端分离开发模式</li><li>手机或者app发起请求，请求Nginx服务器，Nginx基于七层模型走HTTP协议，实现基于Lua绕开Tomcat访问Redis，也可以作为静态资源服务器，轻松抗下上万并发请求。</li></ul><h2 id="导入SQL">导入SQL</h2><p>黑马以及提供好了需要导入的SQL文件，以下是SQL文件中提供的表</p><table><thead><tr><th style="text-align:center">表</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">tb_user</td><td style="text-align:center">用户表</td></tr><tr><td style="text-align:center">tb_user_info</td><td style="text-align:center">用户详情表</td></tr><tr><td style="text-align:center">tb_shop</td><td style="text-align:center">商户信息表</td></tr><tr><td style="text-align:center">tb_shop_type</td><td style="text-align:center">商户类型表</td></tr><tr><td style="text-align:center">tb_blog</td><td style="text-align:center">用户日记表（达人探店日记）</td></tr><tr><td style="text-align:center">tb_follow</td><td style="text-align:center">用户关注表</td></tr><tr><td style="text-align:center">tb_voucher</td><td style="text-align:center">优惠券表</td></tr><tr><td style="text-align:center">tb_voucher_order</td><td style="text-align:center">优惠券的订单表</td></tr></tbody></table><h2 id="导入后端项目">导入后端项目</h2><p>黑马已经提供好了后端项目源码压缩包，我们将其解压之后，放到自己的工作目录里</p><div class="tabs" id="导入后端"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#导入后端-1">更改配置文件</button></li><li class="tab"><button type="button" data-href="#导入后端-2">启动项目</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="导入后端-1"><p>使用IDEA打开项目，修改application.yml文件，将数据库连接信息修改为自己的连接信息</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250826201316.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="导入后端-2"><p>启动项目，访问<a href="http://localhost:8081/shop-type/list">http://localhost:8081/shop-type/list</a>，如果可以看到JSON数据，说明项目启动成功</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250826203646.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="导入前端项目">导入前端项目</h2><p>前端项目黑马也以及提供了源码压缩包，我们解压之后，在Nginx所在目录打开cmd窗口直接输入命令即可启动程序</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start nginx</span><br></pre></td></tr></table></figure><p>访问https://localhost:8080/,如果能够访问到登录页面，说明项目启动成功。</p><details class="folding-tag" ><summary> 访问失败 </summary>              <div class='content'>              <p>访问失败的原因可能有很多，记录一下我遇到的localhost拒绝访问的原因：</p><ol><li>Nginx文件夹所处目录含有中文或空格等字符，导致Nginx启动失败</li><li>Nginx端口被占用，导致Nginx启动失败</li></ol><p><strong>如何查看端口被哪个进程占用？</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这里的port替换成需要查找的端口号</span></span><br><span class="line">netstat -ano | findstr port</span><br></pre></td></tr></table></figure><p><strong>查看对应端口的应用是什么</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist | findstr pid</span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250826203020.png"/></div></div><p>如何杀死进程？</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这里的pid替换成需要杀死的进程号</span></span><br><span class="line">taskkill /f /pid xxx </span><br></pre></td></tr></table></figure><div class="tabs" id="是否成功启动"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#是否成功启动-1">执行命令</button></li><li class="tab"><button type="button" data-href="#是否成功启动-2">输出结果</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="是否成功启动-1"><p>在命令提示符窗口中输入命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist /fi <span class="string">&quot;imagename eq nginx.exe&quot;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="是否成功启动-2"><p>启动成功：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250826203244.png"/></div></div>启动失败：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250826203317.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>              </div>            </details><h1>短信登录</h1><h2 id="基于Session实现登录流程">基于Session实现登录流程</h2><ol><li>发送验证码<br>用户在提交手机号后，会<code>校验手机号</code>是否合法，如果不合法，则要求用户重新输入手机号<br>如果手机号合法，后台此时生成对应的验证码，同时将验证码进行保存，然后再通过短信的方式将验证码发送给用户</li><li>短信验证码登录、注册<br>用户将验证码和手机号进行输入，后台从session中拿到当前验证码，然后和用户输入的验证码进行校验，如果不一致，则无法通过校验，如果一致，则后台根据手机号查询用户，如果用户不存在，则为用户创建账号信息，保存到数据库，无论是否存在，都会将用户信息保存到session中，方便后续获得当前登录信息</li><li>校验登录状态<br>用户在请求的时候，会从cookie中携带<code>JsessionId</code>到后台，后台通过JsessionId从session中拿到用户信息，如果没有session信息，则进行拦截，如果有session信息，则将用户信息保存到threadLocal中，并放行</li></ol><h2 id="模拟发送短信验证码功能">模拟发送短信验证码功能</h2><ul><li>输入手机号，点击发送验证码按钮，查看发送的请求</li></ul><blockquote><p>请求网址: <a href="http://localhost:8080/api/user/code?phone=15832165478">http://localhost:8080/api/user/code?phone=15832165478</a><br>请求方法: POST</p></blockquote><ul><li>调用UserController中的code方法，携带参数是phone</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送手机验证码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;code&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">sendCode</span><span class="params">(<span class="meta">@RequestParam(&quot;phone&quot;)</span> String phone, HttpSession session)</span> &#123;</span><br><span class="line">        <span class="comment">// TODO 发送短信验证码并保存验证码</span></span><br><span class="line">        <span class="keyword">return</span> userService.sendCode(phone,session);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>此处黑马没有使用真的短信服务发送验证码，只是随机生成了一个验证码来作校验使用,后期自己想实现此功能可以用邮箱验证（免费），也可以用阿里云短信服务（有一定费用）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt; <span class="keyword">implements</span> <span class="title class_">IUserService</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">sendCode</span><span class="params">(String phone, HttpSession session)</span> &#123;</span><br><span class="line">        <span class="comment">//1.校验手机号(一般使用正则表达式，验证手机号是否符合正常规范，如是否为11位，是否是1开头)</span></span><br><span class="line">        <span class="keyword">if</span> (RegexUtils.isPhoneInvalid(phone)) &#123;</span><br><span class="line">            <span class="comment">//2.如果不符合，返回错误信息</span></span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;手机号格式错误！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//3.符合则生成验证码(6是指定验证码为6位)</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> RandomUtil.randomNumbers(<span class="number">6</span>);</span><br><span class="line">        <span class="comment">//4.保存验证码导session中</span></span><br><span class="line">        session.setAttribute(<span class="string">&quot;code&quot;</span>, code);</span><br><span class="line">        <span class="comment">//5.发送验证码</span></span><br><span class="line">        <span class="comment">//这里采用记录日志来简单模拟(记得加上Slf4j注解)</span></span><br><span class="line">        log.debug(<span class="string">&quot;发送短信验证码成功,验证码：&#123;&#125;&quot;</span>, code);</span><br><span class="line">        <span class="comment">//返回OK</span></span><br><span class="line">        <span class="keyword">return</span> Result.ok();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="根据验证码登录">根据验证码登录</h2><p>login为实现登录的函数，LoginFormDTO为实体类</p><div class="tabs" id="根据验证码登录"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#根据验证码登录-1">login</button></li><li class="tab"><button type="button" data-href="#根据验证码登录-2">LoginFormDTO</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="根据验证码登录-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="comment">//前端提交的是Json数据，所以需要用@RequestBody注解，来为实体类赋值</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">(<span class="meta">@RequestBody</span> LoginFormDTO loginForm, HttpSession session)</span>&#123;</span><br><span class="line">        <span class="comment">// TODO 实现登录功能</span></span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;功能未完成&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="根据验证码登录-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginFormDTO</span> &#123;</span><br><span class="line">    <span class="comment">//手机号码登录</span></span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">    <span class="keyword">private</span> String code;</span><br><span class="line">    <span class="comment">//密码登录（暂不使用）</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>登录方法中不需要返回登录的凭证，因为是将用户的信息保存在session中，访问Tomcat时，sessionId早已自动写在Cookie中，每次请求都会写到Cookie，能直接在Cookie中找到用户信息</p><div class="tabs" id="login"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#login-1">登录方法</button></li><li class="tab"><button type="button" data-href="#login-2">创建用户</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="login-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">(LoginFormDTO loginForm, HttpSession session)</span> &#123;</span><br><span class="line">       <span class="comment">// 1.校验手机号</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">phone</span> <span class="operator">=</span> loginForm.getPhone();</span><br><span class="line">       <span class="keyword">if</span> (RegexUtils.isPhoneInvalid(phone)) &#123;</span><br><span class="line">           <span class="comment">// 2.如果不符合，返回错误信息</span></span><br><span class="line">           <span class="keyword">return</span> Result.fail(<span class="string">&quot;手机号格式错误！&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">// 3.校验验证码</span></span><br><span class="line">        <span class="comment">//从session中取出生成的随机验证码</span></span><br><span class="line">       <span class="type">Object</span> <span class="variable">cacheCode</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;code&quot;</span>);</span><br><span class="line">        <span class="comment">//取出用户输入的验证码</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> loginForm.getCode();</span><br><span class="line">       <span class="keyword">if</span>(cacheCode == <span class="literal">null</span> || !cacheCode.toString().equals(code))&#123;</span><br><span class="line">            <span class="comment">//4.不一致，报错</span></span><br><span class="line">           <span class="keyword">return</span> Result.fail(<span class="string">&quot;验证码错误&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//4.一致，根据手机号查询用户(MybatisPlus提供的快捷单表增删改查)</span></span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> query().eq(<span class="string">&quot;phone&quot;</span>, phone).one();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//5.判断用户是否存在</span></span><br><span class="line">       <span class="keyword">if</span>(user == <span class="literal">null</span>)&#123;</span><br><span class="line">           <span class="comment">//不存在，则创建(暂时还未实现，提前先把创建的方法写上,</span></span><br><span class="line">           <span class="comment">//将创建的值返回保存在user，确保下面保存用户信息时user一定有值</span></span><br><span class="line">           user =  createUserWithPhone(phone);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//7.保存用户信息到session中</span></span><br><span class="line">       session.setAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> Result.ok();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="login-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> User <span class="title function_">createUserWithPhone</span><span class="params">(String phone)</span> &#123;</span><br><span class="line">    <span class="comment">//1.创建用户</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setPhone(phone);</span><br><span class="line">    user.setNickName(<span class="string">&quot;user_&quot;</span> + RandomUtil.randomString(<span class="number">10</span>));</span><br><span class="line">    <span class="comment">//2.保存用户</span></span><br><span class="line">    save(user);</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="实现登录拦截功能">实现登录拦截功能</h2><ul><li>登录拦截功能，就是用户如果没有登录，访问其他页面的时候，会自动跳转到登录页面。</li><li>首先需要我们先创建一个拦截器，并实现HandlerInterceptor接口，重写前置拦截器和完成处理方法。<ul><li>前置拦截器：在控制器方法执行之前执行，如果返回true，则继续执行控制器方法，如果返回false，则取消执行控制器方法。</li><li>完成处理方法：在控制器方法执行完成之后执行，无论控制器方法是否执行成功，都会执行完成处理方法。</li></ul></li></ul><p><strong>注意：</strong> 此处黑马视频中与提供的资料略有不同，视频中全部为User类，此处为UserDTO类，下一节说明为什么换为UserDTO类。</p><div class="tabs" id="登录拦截器"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#登录拦截器-1">LoginInterceptor</button></li><li class="tab"><button type="button" data-href="#登录拦截器-2">UserHolder</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="登录拦截器-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line">    <span class="comment">//登录校验</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//1.获取Session</span></span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line">        <span class="comment">//2.获取Session中的用户</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">user</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="comment">//3.判断用户是否存在</span></span><br><span class="line">        <span class="keyword">if</span>(user == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//4.不存在，拦截,返回401状态码</span></span><br><span class="line">            response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//5.存在，保存用户信息到ThreadLocal</span></span><br><span class="line">        UserHolder.saveUser((UserDTO)user);</span><br><span class="line">        <span class="comment">//6.放行</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//销毁对应的登录信息</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//移除用户</span></span><br><span class="line">        UserHolder.removeUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="登录拦截器-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserHolder</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;UserDTO&gt; tl = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">(UserDTO user)</span>&#123;</span><br><span class="line">        tl.set(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> UserDTO <span class="title function_">getUser</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> tl.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">removeUser</span><span class="params">()</span>&#123;</span><br><span class="line">        tl.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>创建完拦截器之后，需要将拦截器添加到SpringMVC的拦截器链中，再从Config目录下创建MvcConfig类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//不要忘记添加@Configuration注解，注册为配置类</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MvcConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="comment">//添加拦截注册器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        <span class="comment">//设置拦截器，除了以下界面其余都拦截</span></span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">LoginInterceptor</span>())</span><br><span class="line">                .excludePathPatterns(</span><br><span class="line">                        <span class="string">&quot;/login&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;/blog/hot&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;/shop/**&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;/voucher/**&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;/shop-type/**&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;/upload/**&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;/user/code&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;/user/login&quot;</span></span><br><span class="line">                );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>再修改一下UserController中的me方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/me&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> Result <span class="title function_">me</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="comment">// 获取当前登录的用户并返回</span></span><br><span class="line">       <span class="comment">//直接获取之前保存在Threadlocal里的User信息</span></span><br><span class="line">       <span class="type">UserDTO</span> <span class="variable">user</span> <span class="operator">=</span> UserHolder.getUser();</span><br><span class="line">       <span class="keyword">return</span> Result.ok(user);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="隐藏用户敏感信息">隐藏用户敏感信息</h2><p>如何在之前使用的全是User类，而非UserDTO类，此时查看浏览器返回的信息中，用户包括密码等所有信息都会被返回，这是非常危险的,因此通过创建一个UserDTO类，并只返回需要的信息，从而隐藏用户敏感信息</p><div class="tabs" id="隐藏信息"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#隐藏信息-1">返回的信息</button></li><li class="tab"><button type="button" data-href="#隐藏信息-2">UserDTO</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="隐藏信息-1"><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;success&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">1010</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;phone&quot;</span><span class="punctuation">:</span><span class="string">&quot;1586385296@qq.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;nickName&quot;</span><span class="punctuation">:</span><span class="string">&quot;user_i1b3ir09&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;icon&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;createTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;2022-10-22T14:20:33&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;updateTime&quot;</span><span class="punctuation">:</span><span class="string">&quot;2022-10-22T14:20:33&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="隐藏信息-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDTO</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String nickName;</span><br><span class="line">    <span class="keyword">private</span> String icon;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>如果前面将黑马提供的资料中的UserDTO类改为了User，则此处还需再改回来，如果没有更改，则只需要改变login方法中第七步保存用户信息的代码即可。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//5.判断用户是否存在</span><br><span class="line">        if(user == null)&#123;</span><br><span class="line">            //6.不存在，则创建(暂时还未实现，提前先把创建的方法写上)</span><br><span class="line">            //将创建的值返回保存在user，确保下面保存用户信息时user一定有值</span><br><span class="line">            user =  createUserWithPhone(phone);</span><br><span class="line">        &#125;</span><br><span class="line">        //7.保存用户信息到session中</span><br><span class="line"><span class="deletion">-        session.setAttribute(&quot;user&quot;, user);</span></span><br><span class="line"><span class="addition">+        session.setAttribute(&quot;user&quot;, BeanUtil.copyProperties(user, UserDTO.class));</span></span><br></pre></td></tr></table></figure><h2 id="session共享问题">session共享问题</h2><ul><li><p>每个tomcat中都有一份属于自己的session,假设用户第一次访问第一台tomcat，并且把自己的信息存放到第一台服务器的session中，但是第二次这个用户访问到了第二台tomcat，那么在第二台服务器上，肯定没有第一台服务器存放的session，所以此时 整个登录拦截功能就会出现问题，我们能如何解决这个问题呢？</p><ul><li>早期的方案是session拷贝，就是说虽然每个tomcat上都有不同的session，但是每当任意一台服务器的session修改时，都会同步给其他的Tomcat服务器的session，这样的话，就可以实现session的共享了</li></ul></li><li><p>但是这种方案具有两个大问题</p><ul><li>每台服务器中都有完整的一份session数据，<code>服务器压力过大</code>。</li><li>session拷贝数据时，可能会出现<code>延迟</code></li></ul></li><li><p>所以我们后面都是基于Redis来完成，我们把session换成Redis，Redis数据本身就是<code>共享</code>的，就可以避免session共享的问题了。</p></li></ul><h2 id="Redis替代session的业务流程">Redis替代session的业务流程</h2><h3 id="设计key结构">设计key结构</h3><ul><li>首先我们来思考一下该用什么数据结构来存储数据</li><li>由于存入的数据比较简单，我们可以使用<code>String</code>或者<code>Hash</code><ul><li>如果使用String，以JSON字符串来保存数据，会额外占用部分空间</li><li>如果使用Hash，他会将对象中的每个字段独立存储，可以针对单个字段做CRUD，并且内存占用更少</li></ul></li></ul><div class="tabs" id="key结构"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#key结构-1">String</button></li><li class="tab"><button type="button" data-href="#key结构-2">Hash</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="key结构-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250827161153.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="key结构-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250827161347.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>如果不是特别在意内存且数据量不大，可以直接使用String</li><li>如果考虑到优化等问题，可以选择Hash，此处选择Hash</li></ul><h3 id="设计key的具体细节">设计key的具体细节</h3><ul><li>我们这里就采用的是简单的<code>K-V键值对</code>方式</li><li>对于key的处理，不能像session一样用code来当做key</li><li>因为Redis的key是共享的，code可能会重复，也不建议使用手机号，因为phone这种<code>敏感字段</code>不适合存储到Redis中</li><li>在设计key的时候，我们需要满足两点<ol><li>key要有唯一性</li><li>key要方便携带</li></ol></li><li>所以我们在后台随机生成一个token，然后让前端带着这个token就能完成我们的业务逻辑了</li></ul><h3 id="整体访问流程">整体访问流程</h3><ul><li>当注册完成后，用户去登录，然后校验用户提交的手机号/邮箱和验证码是否一致<ul><li>如果一致，则根据手机号查询用户信息，不存在则新建，最后将用户数据保存到Redis，并生成一个token作为Redis的key</li></ul></li><li>当我们校验用户是否登录时，会携带着token进行访问，从Redis中获取token对应的value，判断是否存在这个数据<ul><li>如果不存在，则拦截</li><li>如果存在，则将其用户信息(userDto)保存到threadLocal中，并放行</li></ul></li></ul><h2 id="基于Redis实现短信登录">基于Redis实现短信登录</h2><p>Redis的相关配置在最开始已经配置好了，直接编写代码注入<code>StringRedisTemplate</code>即可</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br></pre></td></tr></table></figure><ul><li>修改SendCode方法</li><li><div class="tabs" id="修改sendcode方法"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#修改sendcode方法-1">修改SendCode方法</button></li><li class="tab"><button type="button" data-href="#修改sendcode方法-2">修改后代码</button></li><li class="tab"><button type="button" data-href="#修改sendcode方法-3">RedisConstants</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="修改sendcode方法-1"><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">        //3.符合则生成验证码(6是指定验证码为6位)</span><br><span class="line">        String code = RandomUtil.randomNumbers(6);</span><br><span class="line"><span class="deletion">-        //4.保存验证码到session中</span></span><br><span class="line"><span class="deletion">-        session.setAttribute(&quot;code&quot;, code);</span></span><br><span class="line"><span class="addition">+        //4.保存验证码到Redis,</span></span><br><span class="line"><span class="addition">+        //直接将手机号存入，可能别的功能也会直接存入手机号，造成冲突，故最好加上前缀</span></span><br><span class="line"><span class="addition">+        //给验证码数据设置有效期，防止Redis长期存储失效的数据,这些不会变化的数据最好设为常量</span></span><br><span class="line"><span class="addition">+        stringRedisTemplate.opsForValue().set(LOGIN_CODE_KEY+phone,code,LOGIN_CODE_TTL, TimeUnit.MINUTES);</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="修改sendcode方法-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">sendCode</span><span class="params">(String phone, HttpSession session)</span> &#123;</span><br><span class="line">    <span class="comment">//1.校验手机号(一般使用正则表达式，验证手机号是否符合正常规范，如是否为11位，是否是1开头)</span></span><br><span class="line">    <span class="keyword">if</span> (RegexUtils.isPhoneInvalid(phone)) &#123;</span><br><span class="line">        <span class="comment">//2.如果不符合，返回错误信息</span></span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;手机号格式错误！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3.符合则生成验证码(6是指定验证码为6位)</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> RandomUtil.randomNumbers(<span class="number">6</span>);</span><br><span class="line">    <span class="comment">//4.保存验证码到Redis,</span></span><br><span class="line">    <span class="comment">//直接将手机号存入，可能别的功能也会直接存入手机号，造成冲突，故最好加上前缀</span></span><br><span class="line">    <span class="comment">//给验证码数据设置有效期，防止Redis长期存储失效的数据</span></span><br><span class="line">    stringRedisTemplate.opsForValue().set(LOGIN_CODE_KEY+phone,code,LOGIN_CODE_TTL, TimeUnit.MINUTES);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//5.发送验证码</span></span><br><span class="line">    <span class="comment">//可以使用第三方平台如阿里云，容联运等实现，用也可以尝试使用qq邮箱实现，这里采用记录日志来简单模拟(记得加上Slf4j注解)</span></span><br><span class="line">    log.debug(<span class="string">&quot;发送短信验证码成功,验证码：&#123;&#125;&quot;</span>, code);</span><br><span class="line">    <span class="comment">//返回OK</span></span><br><span class="line">    <span class="keyword">return</span> Result.ok();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="修改sendcode方法-3"><p>key使用用<code>login:code:email</code>的形式，并设置<code>有效期2分钟</code>，我们可以定义一个常量类来替换这里的login:code:和2，让代码显得更专业一点</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisConstants</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LOGIN_CODE_KEY</span> <span class="operator">=</span> <span class="string">&quot;login:code:&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Long</span> <span class="variable">LOGIN_CODE_TTL</span> <span class="operator">=</span> <span class="number">2L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></li></ul><div class="tabs" id="修改登录功能"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#修改登录功能-1">login</button></li><li class="tab"><button type="button" data-href="#修改登录功能-2">修改后的代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="修改登录功能-1"><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">    @Override</span><br><span class="line">    public Result login(LoginFormDTO loginForm, HttpSession session) &#123;</span><br><span class="line">        // 1.校验手机号(每次独立的请求都应当校验一下)</span><br><span class="line">        String phone = loginForm.getPhone();</span><br><span class="line">        if (RegexUtils.isPhoneInvalid(phone)) &#123;</span><br><span class="line">            // 2.如果不符合，返回错误信息</span><br><span class="line">            return Result.fail(&quot;手机号格式错误！&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        // 3.校验验证码</span><br><span class="line"><span class="deletion">-        //从session中取出生成的随机验证码</span></span><br><span class="line"><span class="deletion">-        Object cacheCode = session.getAttribute(&quot;code&quot;);</span></span><br><span class="line"><span class="addition">+        String cacheCode = stringRedisTemplate.opsForValue().get(LOGIN_CODE_KEY + phone);</span></span><br><span class="line">        //取出用户输入的验证码</span><br><span class="line">        String code = loginForm.getCode();</span><br><span class="line">        if(cacheCode == null || !cacheCode.toString().equals(code))&#123;</span><br><span class="line">            //4.不一致，报错</span><br><span class="line">            return Result.fail(&quot;验证码错误&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        //4.一致，根据手机号查询用户(MybatisPlus提供的快捷单表增删改查)</span><br><span class="line">        User user = query().eq(&quot;phone&quot;, phone).one();</span><br><span class="line"></span><br><span class="line">        //5.判断用户是否存在</span><br><span class="line">        if(user == null)&#123;</span><br><span class="line">            //6.不存在，则创建(暂时还未实现，提前先把创建的方法写上)</span><br><span class="line">            //将创建的值返回保存在user，确保下面保存用户信息时user一定有值</span><br><span class="line">            user =  createUserWithPhone(phone);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="deletion">-        //7.保存用户信息到session中</span></span><br><span class="line"><span class="deletion">-        session.setAttribute(&quot;user&quot;, BeanUtil.copyProperties(user, UserDTO.class));</span></span><br><span class="line">        </span><br><span class="line"><span class="addition">+        //7.保存用户信息到redis中</span></span><br><span class="line"><span class="addition">+        //7.1 随机生成token，作为登录令牌</span></span><br><span class="line"><span class="addition">+        //UUID java和Hutools都有，此处使用的是Hutools的</span></span><br><span class="line"><span class="addition">+        String token = UUID.randomUUID().toString(true);</span></span><br><span class="line"><span class="addition">+        //7.2 将User对象转为Hash存储</span></span><br><span class="line"><span class="addition">+        UserDTO userDTO = BeanUtil.copyProperties(user, UserDTO.class);</span></span><br><span class="line"><span class="addition">+        Map&lt;String, Object&gt; userMap = BeanUtil.beanToMap(userDTO);</span></span><br><span class="line"><span class="addition">+        //7.3 存储    </span></span><br><span class="line"><span class="addition">+        //使用put(String key,Object hashKey,Object value)的话，每个字段都要执行一次，需要与服务器进行多次交互</span></span><br><span class="line"><span class="addition">+        stringRedisTemplate.opsForHash().putAll(LOGIN_USER_KEY+token, userMap);</span></span><br><span class="line"><span class="addition">+        //7.4 设置token有效期</span></span><br><span class="line"><span class="addition">+        stringRedisTemplate.expire(LOGIN_USER_KEY,30, TimeUnit.MINUTES);</span></span><br><span class="line"><span class="addition">+        //8.返回token</span></span><br><span class="line"><span class="deletion">-        return Result.ok();</span></span><br><span class="line"><span class="addition">+        return Result.ok(token); </span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="修改登录功能-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">(LoginFormDTO loginForm, HttpSession session)</span> &#123;</span><br><span class="line">        <span class="comment">// 1.校验手机号(每次独立的请求都应当校验一下)</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">phone</span> <span class="operator">=</span> loginForm.getPhone();</span><br><span class="line">        <span class="keyword">if</span> (RegexUtils.isPhoneInvalid(phone)) &#123;</span><br><span class="line">            <span class="comment">// 2.如果不符合，返回错误信息</span></span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;手机号格式错误！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 3.校验验证码</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">cacheCode</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(LOGIN_CODE_KEY + phone);</span><br><span class="line">        <span class="comment">//取出用户输入的验证码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> loginForm.getCode();</span><br><span class="line">        <span class="keyword">if</span>(cacheCode == <span class="literal">null</span> || !cacheCode.toString().equals(code))&#123;</span><br><span class="line">            <span class="comment">//4.不一致，报错</span></span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;验证码错误&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//4.一致，根据手机号查询用户(MybatisPlus提供的快捷单表增删改查)</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> query().eq(<span class="string">&quot;phone&quot;</span>, phone).one();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.判断用户是否存在</span></span><br><span class="line">        <span class="keyword">if</span>(user == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//6.不存在，则创建(暂时还未实现，提前先把创建的方法写上)</span></span><br><span class="line">            <span class="comment">//将创建的值返回保存在user，确保下面保存用户信息时user一定有值</span></span><br><span class="line">            user =  createUserWithPhone(phone);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//7.保存用户信息到redis中</span></span><br><span class="line">        <span class="comment">//7.1 随机生成token，作为登录令牌</span></span><br><span class="line">        <span class="comment">//UUID java和Hutools都有，此处使用的是Hutools的</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> UUID.randomUUID().toString(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">//7.2 将User对象转为Hash存储</span></span><br><span class="line">        <span class="type">UserDTO</span> <span class="variable">userDTO</span> <span class="operator">=</span> BeanUtil.copyProperties(user, UserDTO.class);</span><br><span class="line">        Map&lt;String, Object&gt; userMap = BeanUtil.beanToMap(userDTO);</span><br><span class="line">        <span class="comment">//7.3 存储</span></span><br><span class="line">        <span class="comment">//使用put(String key,Object hashKey,Object value)的话，每个字段都要执行一次，需要与服务器进行多次交互</span></span><br><span class="line">        stringRedisTemplate.opsForHash().putAll(LOGIN_USER_KEY+token, userMap);</span><br><span class="line">        <span class="comment">//7.4 设置token有效期</span></span><br><span class="line">        stringRedisTemplate.expire(LOGIN_USER_KEY,<span class="number">30</span>, TimeUnit.MINUTES);</span><br><span class="line">        <span class="comment">//8.返回token</span></span><br><span class="line">        <span class="keyword">return</span> Result.ok(token);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="解决登录状态刷新问题">解决登录状态刷新问题</h2><h3 id="初始方案：">初始方案：</h3><ul><li>查看请求，发现我们存的token在请求头中。</li></ul><blockquote><p>authorization: 6867061d-a8d0-4e60-b92f-97f7d698a1ca</p></blockquote><ul><li>通过拦截器拦截到请求，来证明用户正在操作，每次拦截时刷新用户登录状态，如果用户在30分钟没有任何操作，则token消失。</li></ul><div class="tabs" id="修改拦截器功能"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#修改拦截器功能-1">拦截器功能修改</button></li><li class="tab"><button type="button" data-href="#修改拦截器功能-2">修改后代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="修改拦截器功能-1"><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">    @Override</span><br><span class="line">    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123;</span><br><span class="line"><span class="deletion">-        //1.获取Session</span></span><br><span class="line"><span class="deletion">-        HttpSession session = request.getSession();</span></span><br><span class="line"><span class="deletion">-        //2.获取Session中的用户</span></span><br><span class="line"><span class="deletion">-        Object user = session.getAttribute(&quot;user&quot;);</span></span><br><span class="line">        //1.获取请求头上的token,authorization为课程中展示的前端代码</span><br><span class="line"><span class="addition">+        String token = request.getHeader(&quot;authorization&quot;);</span></span><br><span class="line"><span class="addition">+        if(StrUtil.isBlank(token))&#123;</span></span><br><span class="line"><span class="addition">+            //如果token为空，则直接拦截并返回状态码</span></span><br><span class="line"><span class="addition">+            response.setStatus(401);</span></span><br><span class="line"><span class="addition">+            return false;</span></span><br><span class="line"><span class="addition">+        &#125;</span></span><br><span class="line"><span class="addition">+        //2.根据token获取redis中的用户</span></span><br><span class="line"><span class="addition">+        //使用get返回的仅仅是某一个key的某一字段,这里使用entries</span></span><br><span class="line"><span class="addition">+        Map&lt;Object, Object&gt; usermap = stringRedisTemplate.opsForHash()</span></span><br><span class="line"><span class="addition">+                .entries(LOGIN_USER_KEY + token);</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        //3.判断用户是否存在</span><br><span class="line"><span class="deletion">-        if(user==null)</span></span><br><span class="line"><span class="addition">+        if(usermap.isEmpty())&#123;</span></span><br><span class="line">            //4.不存在，拦截,返回401状态码</span><br><span class="line">            response.setStatus(401);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="addition">+        //5.将查询的Hash数据转为UserDTO对象</span></span><br><span class="line"><span class="addition">+        UserDTO userDTO = BeanUtil.fillBeanWithMap(usermap, new UserDTO(), false);</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-        //5.存在，保存用户信息到ThreadLocal</span></span><br><span class="line"><span class="deletion">-        UserHolder.saveUser((UserDTO)user);</span></span><br><span class="line"><span class="addition">+        //6.存在，保存用户信息到ThreadLocal</span></span><br><span class="line"><span class="addition">+        UserHolder.saveUser(userDTO);</span></span><br><span class="line"><span class="addition">+        //7.刷新token有效期</span></span><br><span class="line"><span class="addition">+        stringRedisTemplate.expire(LOGIN_USER_KEY+token,30, TimeUnit.MINUTES);</span></span><br><span class="line"><span class="addition">+        //8.放行</span></span><br><span class="line"><span class="deletion">-        //6.放行</span></span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="修改拦截器功能-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.获取请求头上的token,authorization为课程中展示的前端代码</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;authorization&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(StrUtil.isBlank(token))&#123;</span><br><span class="line">        <span class="comment">//如果token为空，则直接拦截并返回状态码</span></span><br><span class="line">        response.setStatus(<span class="number">401</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2.根据token获取redis中的用户</span></span><br><span class="line">    <span class="comment">//使用get返回的仅仅是某一个key的某一字段,这里使用entries</span></span><br><span class="line">    Map&lt;Object, Object&gt; usermap = stringRedisTemplate.opsForHash()</span><br><span class="line">            .entries(LOGIN_USER_KEY + token);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.判断用户是否存在</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(usermap.isEmpty())&#123;</span><br><span class="line">        <span class="comment">//4.不存在，拦截,返回401状态码</span></span><br><span class="line">        response.setStatus(<span class="number">401</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//5.将查询的Hash数据转为UserDTO对象</span></span><br><span class="line">    <span class="type">UserDTO</span> <span class="variable">userDTO</span> <span class="operator">=</span> BeanUtil.fillBeanWithMap(usermap, <span class="keyword">new</span> <span class="title class_">UserDTO</span>(), <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.存在，保存用户信息到ThreadLocal</span></span><br><span class="line">    UserHolder.saveUser(userDTO);</span><br><span class="line">    <span class="comment">//7.刷新token有效期</span></span><br><span class="line">    stringRedisTemplate.expire(LOGIN_USER_KEY+token,<span class="number">30</span>, TimeUnit.MINUTES);</span><br><span class="line">    <span class="comment">//8.放行</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>在这个方案中，用户在访问需要拦截的路径时，会触发拦截器的执行，同时刷新登录token令牌的存活时间，但是如果当前用户只访问了一些不需要拦截的路径，那么这个拦截器就不会生效，此时令牌刷新的动作实际上就不会执行，所以这个方案他是存在问题的。</p><h1>商户查询缓存</h1><h2 id="什么是缓存">什么是缓存</h2><p><code>缓存</code>是数据交换的<code>缓冲区</code>，用来临时存储数据，一般<code>读写性能较高</code></p><ul><li>缓存就像自行车、越野车的<code>避震器</code>，不但能防止车体在移动过程中因震动而摇晃，从而<code>提高车辆性能</code>，还能避免车体在地面上飞跃硬着陆导致<code>损坏</code>。</li><li>在实际开发中，系统也需要“避震器”来防止过高的访问量导致数据库压力过大，导致操作线程无法及时处理信息而瘫痪。</li></ul><h3 id="哪里用到了缓存">哪里用到了缓存</h3><ul><li>实际开发中，会构筑多级缓存来对系统运行速度进一步提升，例如：本地缓存与Redis中的缓存并发使用</li><li><code>浏览器缓存：</code>主要是存在于浏览器端的缓存</li><li><code>应用层缓存：</code>可以分为toncat本地缓存，例如之前提到的map或者是使用Redis作为缓存</li><li><code>数据库缓存：</code>在数据库中有一片空间是buffer pool，增改查数据都会先加载到mysql的缓存中</li><li><code>CPU缓存：</code>当代计算机最大的问题就是CPU性能提升了，但是内存读写速度没有跟上，所以为了适应当下的情况，增加了CPU的L1，L2，L3级的缓存</li></ul><h3 id="为什么要用缓存">为什么要用缓存</h3><ul><li><p><strong>言简意赅：`速度快，好用</strong></p></li><li><p>缓存数据存储于代码中，而代码运行在<code>内存</code>中，内存的读写性能远高于磁盘，缓存可以大大<code>降低用户访问并发量带来的服务器读写压力</code></p></li><li><p>缓存可以<code>减少数据库的访问次数</code>，从而<code>提高系统的性能</code></p></li><li><p>缓存可以<code>减少数据库的压力</code>，从而<code>提高系统的稳定性</code></p></li><li><p>实际开发中，企业的数据量，少则几十万，多则几千万，这么大的数据量，如果没有缓存来作为<code>避震器</code>系统是几乎撑不住的，所以企业会大量运用缓存技术</p></li><li><p>但是缓存也会增加代码复杂度和运营成本</p></li><li><p><em><strong>缓存的作用</strong></em></p></li></ul><blockquote><ol><li>降低后端负载</li></ol></blockquote><ol start="2"><li>提高读写效率，降低响应时间</li></ol><ul><li><em><strong>缓存的成本</strong></em></li></ul><blockquote><ol><li>数据一致性成本</li></ol></blockquote><ol start="2"><li>代码维护成本</li><li>运维成本（一般采用服务器集群，需要多加机器，机器就是钱）</li></ol><h2 id="添加商户缓存">添加商户缓存</h2><p>启动项目后，随便访问一个商户，查看浏览器发送的请求</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/PicGo.lnk"/></div></div><blockquote><p>请求网址: <a href="http://localhost:8080/api/shop/10">http://localhost:8080/api/shop/10</a><br>请求方法: GET</p></blockquote><ul><li>此时浏览器发送的是Restful风格的请求，请求路径中包含了商户id</li><li>再找到ShopController层调用的方法，发现是调用的ShopService的getById方法，直接在数据库中查询</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 根据id查询商铺信息</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> id 商铺id</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> 商铺详情数据</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">queryShopById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Result.ok(shopService.getById(id));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>我们可以通过在客户端与数据库之间加上一个Redis缓存，先从Redis中查询，如果没有查到，再去MySQL中查询，同时查询完毕之后，将查询到的数据也存入Redis，这样当下一个用户来进行查询的时候，就可以直接从Redis中获取到数据</li></ul><h3 id="代码实现">代码实现</h3><p>代码思路：</p><ol><li>从Redis中查询商户缓存</li><li>如果缓存存在，直接返回</li><li>如果缓存不存在，从MySQL中查询</li><li>如果MySQL中也不存在，返回错误</li><li>如果MySQL中存在，将查询到的数据存入Redis缓存</li><li>返回数据</li></ol><div class="tabs" id="商户查询代码实现"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#商户查询代码实现-1">Controller层</button></li><li class="tab"><button type="button" data-href="#商户查询代码实现-2">Service层</button></li><li class="tab"><button type="button" data-href="#商户查询代码实现-3">ServiceImpl层</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="商户查询代码实现-1"><p>Controller层只负责调用方法，将业务逻辑写到Service，然后去ServiceImpl层实现</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@GetMapping</span>(<span class="string">&quot;/&#123;id&#125;&quot;</span>)</span><br><span class="line">public Result <span class="built_in">queryShopById</span>(<span class="variable">@PathVariable</span>(<span class="string">&quot;id&quot;</span>) Long id) &#123;</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-tag">shopService</span><span class="selector-class">.queryById</span>(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="商户查询代码实现-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IShopService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;Shop&gt; &#123;</span><br><span class="line">    Result <span class="title function_">queryById</span><span class="params">(Long id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="商户查询代码实现-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShopServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;ShopMapper, Shop&gt; <span class="keyword">implements</span> <span class="title class_">IShopService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">queryById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line"><span class="comment">//        1. 从Redis中查询商户缓存</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">shopJson</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(CACHE_SHOP_KEY + id.toString());</span><br><span class="line"><span class="comment">//        2. 判断是否存在</span></span><br><span class="line">        <span class="keyword">if</span>(StrUtil.isNotBlank(shopJson))&#123;</span><br><span class="line"><span class="comment">//        3. 如果缓存存在，直接返回</span></span><br><span class="line">            <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> JSONUtil.toBean(shopJson, Shop.class);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(shopJson);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        4. 如果缓存不存在，从MySQL中查询</span></span><br><span class="line">        <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> baseMapper.selectById(id);</span><br><span class="line"><span class="comment">//        5. 如果MySQL中也不存在，返回错误</span></span><br><span class="line">        <span class="keyword">if</span>(shop == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;店铺不存在&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        6. 如果MySQL中存在，将查询到的数据存入Redis缓存</span></span><br><span class="line">        stringRedisTemplate.opsForValue().set(CACHE_SHOP_KEY + id.toString(),JSONUtil.toJsonStr(shop));</span><br><span class="line"><span class="comment">//        7. 返回数据</span></span><br><span class="line">        <span class="keyword">return</span> Result.ok(shop);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="课后练习">课后练习</h3><p>学习商户数据缓存后，尝试做一下商户类型数据缓存<br>在首页可以观察到发送的请求为<code>http://localhost:8080/api/shop-type/list</code></p><div class="tabs" id="商户类型"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#商户类型-1">商户类型</button></li><li class="tab"><button type="button" data-href="#商户类型-2">发送请求</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="商户类型-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250828140741.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="商户类型-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250828135328.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>故仿照商户缓存的思路，编写商户类型缓存，注意此处的商户类型=数据不仅仅是一个商户，而是多个商户的类型</p><div class="tabs" id="商户类型缓存"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#商户类型缓存-1">Controller层</button></li><li class="tab"><button type="button" data-href="#商户类型缓存-2">Service层</button></li><li class="tab"><button type="button" data-href="#商户类型缓存-3">ServiceImpl层</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="商户类型缓存-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/shop-type&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShopTypeController</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> IShopTypeService typeService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;list&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">queryTypeList</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//        List&lt;ShopType&gt; typeList = typeService</span></span><br><span class="line"><span class="comment">//                .query().orderByAsc(&quot;sort&quot;).list();</span></span><br><span class="line">        List&lt;ShopType&gt; typeList = typeService.queryTypeList();</span><br><span class="line">        <span class="keyword">return</span> Result.ok(typeList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="商户类型缓存-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IShopTypeService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;ShopType&gt; &#123;</span><br><span class="line">    List&lt;ShopType&gt; <span class="title function_">queryTypeList</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="商户类型缓存-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShopTypeServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;ShopTypeMapper, ShopType&gt; <span class="keyword">implements</span> <span class="title class_">IShopTypeService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;ShopType&gt; <span class="title function_">queryTypeList</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;login:type&quot;</span>;</span><br><span class="line"><span class="comment">//        SetOperations&lt;String, String&gt; setOps = redisTemplate.opsForSet();</span></span><br><span class="line">        <span class="comment">// 1. 从redis查询商铺缓存</span></span><br><span class="line"><span class="comment">//        String shopTypeJson = setOps.members(key).toString();</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">shopTypeJson</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(key);</span><br><span class="line">        <span class="comment">// 2. 判断是否存在</span></span><br><span class="line">        <span class="keyword">if</span> (StrUtil.isNotBlank(shopTypeJson)) &#123;</span><br><span class="line">            <span class="comment">// 3. 存在，转化为List返回</span></span><br><span class="line"><span class="comment">//            return objectMapper.readValue(shopTypeJson, new TypeReference&lt;List&lt;ShopType&gt;&gt;()&#123;&#125;);</span></span><br><span class="line">            <span class="keyword">return</span> JSONUtil.toList(shopTypeJson, ShopType.class);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 4. 不存在，查询数据库</span></span><br><span class="line">        List&lt;ShopType&gt; typeList = <span class="built_in">this</span>.query().orderByAsc(<span class="string">&quot;sort&quot;</span>).list();</span><br><span class="line">        <span class="comment">// 5. 不存在，返回空列表</span></span><br><span class="line">        <span class="keyword">if</span> (typeList.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 6. 存在，写入redis</span></span><br><span class="line">        stringRedisTemplate.opsForValue().set(key, JSONUtil.toJsonStr(typeList));</span><br><span class="line">        <span class="comment">// 7. 返回</span></span><br><span class="line">        <span class="keyword">return</span> typeList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="缓存更新策略">缓存更新策略</h2><ul><li>缓存更新是Redis为了节约内存而设计出来的一个东西，主要是因为内存数据宝贵，当我们想Redis插入太多数据，此时就可能会导致缓存中数据过多，所以Redis会对部分数据进行更新，或者把它成为淘汰更合适</li><li><code>内存淘汰</code>：Redis自动进行，当Redis内存大道我们设定的<code>max-memery</code>时，会自动触发淘汰机制，淘汰掉一些不重要的数据（可以自己设置策略方式）</li><li><code>超时剔除</code>：当我们给Redis设置了过期时间TTL之后，Redis会将超时的数据进行删除，方便我们继续使用缓存</li><li><code>主动更新</code>：我们可以手动调用方法把缓存删除掉，通常用于解决缓存和数据库不一致问题</li></ul><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">内存淘汰</th><th style="text-align:center">超时剔除</th><th style="text-align:center">主动更新</th></tr></thead><tbody><tr><td style="text-align:center">说明</td><td style="text-align:center">不用自己维护， 利用Redis的内存淘汰机制， 当内存不足时自动淘汰部分数据。 下次查询时更新缓存。</td><td style="text-align:center">给缓存数据添加TTL时间， 到期后自动删除缓存。 下次查询时更新缓存。</td><td style="text-align:center">编写业务逻辑， 在修改数据库的同时， 更新缓存。</td></tr><tr><td style="text-align:center">一致性</td><td style="text-align:center">差</td><td style="text-align:center">一般</td><td style="text-align:center">好</td></tr><tr><td style="text-align:center">维护成本</td><td style="text-align:center">无</td><td style="text-align:center">低</td><td style="text-align:center">高</td></tr></tbody></table><ul><li>业务场景<ul><li>低一致性需求：使用内存淘汰机制，例如店铺类型的查询缓存（因为这个很长一段时间都不需要更新）</li><li>高一致性需求：主动更新，并以超时剔除作为兜底方案，例如店铺详情查询的缓存</li></ul></li></ul><h3 id="数据库和缓存不一致解决方案">数据库和缓存不一致解决方案</h3><ul><li>由于我们的缓存数据源来自数据库，而数据库的数据是会发生变化的，因此，如果当数据库中数据发生变化，而缓存却没有同步，此时就会有一致性问题存在，其后果是<ul><li>用户使用缓存中的过时数据，就会产生类似多线程数据安全问题，从而影响业务，产品口碑等</li></ul></li><li>那么如何解决这个问题呢？有如下三种方式<ol><li>Cache Aside Pattern 人工编码方式：缓存调用者在更新完数据库之后再去更新缓存，也称之为双写方案</li><li>Read/Write Through Pattern：缓存与数据库整合为一个服务，由服务来维护一致性。调用者调用该服务，无需关心缓存一致性问题。但是维护这样一个服务很复杂，市面上也不容易找到这样的一个现成的服务，开发成本高</li><li>Write Behind Caching Pattern：调用者只操作缓存，其他线程去<code>异步处理</code>数据库，最终实现一致性。但是维护这样的一个异步的任务很复杂，需要<code>实时监控</code>缓存中的数据更新，其他线程去异步更新数据库也可能不太及时，而且缓存服务器如果宕机，那么缓存的数据也就丢失了</li></ol></li></ul><h3 id="数据库和缓存不一致采用什么方案">数据库和缓存不一致采用什么方案</h3><ul><li>综上所述，在企业的实际应用中，还是方案一最可靠，但是方案一的调用者该如何处理呢？</li><li>如果采用方案一，假设我们每次操作完数据库之后，都去更新一下缓存，但是如果中间并没有人查询数据，那么这个更新动作只有最后一次是有效的，中间的更新动作意义不大，所以我们可以把缓存直接删除，等到有人再次查询时，再将缓存中的数据加载出来</li><li>对比删除缓存与更新缓存<ul><li><code>更新缓存：</code>每次更新数据库都需要更新缓存，无效写操作较多</li><li><code>删除缓存：</code>更新数据库时让缓存失效，再次查询时更新缓存</li></ul></li><li>如何保证缓存与数据库的操作同时成功/同时失败<ul><li><code>单体系统：</code>将缓存与数据库操作放在同一个事务</li><li><code>分布式系统：</code>利用TCC等分布式事务方案</li></ul></li><li>先操作缓存还是先操作数据库？我们来仔细分析一下这两种方式的线程安全问题</li></ul><div class="tabs" id="两种操作"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#两种操作-1">删除缓存，再操作数据库</button></li><li class="tab"><button type="button" data-href="#两种操作-2">操作数据库，再删除缓存</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="两种操作-1"><ul><li><strong>先删除缓存，再操作数据库</strong><br>删除缓存的操作很快，但是更新数据库的操作相对较慢，如果此时有一个线程2刚好进来查询缓存，由于我们刚刚才删除缓存，所以线程2需要查询数据库，并写入缓存，但是我们更新数据库的操作还未完成，所以线程2查询到的数据是脏数据，出现线程安全问题</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://pic1.imgdb.cn/item/6354be3e16f2c2beb1d11bd0.jpg"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="两种操作-2"><ul><li><strong>先操作数据库，再删除缓存</strong><br>线程1在查询缓存的时候 ，缓存TTL刚好失效，需要查询数据库并写入缓存，这个操作耗时相对较短（相比较于上图来说），但是就在这么短的时间内，线程2进来了，更新数据库，删除缓存，但是线程1虽然查询完了数据（更新前的旧数据），但是还没来得及写入缓存，所以线程2的更新数据库与删除缓存，并没有影响到线程1的查询旧数据，写入缓存，造成线程安全问题</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://pic1.imgdb.cn/item/6354be5316f2c2beb1d130c0.jpg"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><ul><li>虽然这二者都存在线程安全问题，但是相对来说，后者出现线程安全问题的概率相对较低，所以我们最终采用后者<code>先操作数据库，再删除缓存</code>的方案</li></ul><p>缓存更新策略的最佳实践方案：</p><ol><li>低一致性需求：使用Redis自带的内存淘汰机制</li><li>高一致性需求：主动更新，并以超时剔除作为兜底方案<ul><li><strong>读操作：</strong><ul><li>缓存命中则直接返回</li><li>缓存未命中则查询数据库并写入缓存，设定超时时间</li></ul></li><li><strong>写操作：</strong><ul><li>先写数据库，然后删除缓存</li><li>确保数据库与缓存操作的原子性</li></ul></li></ul></li></ol><h3 id="实现缓存与数据库双写一致">实现缓存与数据库双写一致</h3><ul><li><p>修改ShopController中的业务逻辑，满足以下要求</p><ol><li>根据id查询店铺时，如果缓存未命中，则查询数据库，并将数据库结果写入缓存，并设置TTL</li><li>根据id修改店铺时，先修改数据库，再删除缓存</li></ol></li><li><p>修改ShopService的queryById方法，写入缓存时设置一下TTL</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">queryById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="comment">//先从Redis中查，这里的常量值是固定的前缀 + 店铺id</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">shopJson</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(CACHE_SHOP_KEY + id);</span><br><span class="line">    <span class="comment">//如果不为空（查询到了），则转为Shop类型直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (StrUtil.isNotBlank(shopJson)) &#123;</span><br><span class="line">        <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> JSONUtil.toBean(shopJson, Shop.class);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(shop);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//否则去数据库中查</span></span><br><span class="line">    <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> getById(id);</span><br><span class="line">    <span class="comment">//查不到返回一个错误信息或者返回空都可以，根据自己的需求来</span></span><br><span class="line">    <span class="keyword">if</span> (shop == <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;店铺不存在！！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//查到了则转为json字符串</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">jsonStr</span> <span class="operator">=</span> JSONUtil.toJsonStr(shop);</span><br><span class="line">    <span class="comment">//并存入redis，设置TTL</span></span><br><span class="line">    stringRedisTemplate.opsForValue().set(CACHE_SHOP_KEY + id, jsonStr,CACHE_SHOP_TTL, TimeUnit.MINUTES);</span><br><span class="line">    <span class="comment">//最终把查询到的商户信息返回给前端</span></span><br><span class="line">    <span class="keyword">return</span> Result.ok(shop);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>修改ShopController中的update方法</li><li><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">更新前</button></li><li class="tab"><button type="button" data-href="#-2">更新后</button></li><li class="tab"><button type="button" data-href="#-3">Service层</button></li><li class="tab"><button type="button" data-href="#-4">Serviceimpl层</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 更新商铺信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> shop 商铺数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 无</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PutMapping</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">updateShop</span><span class="params">(<span class="meta">@RequestBody</span> Shop shop)</span> &#123;</span><br><span class="line">    <span class="comment">// 写入数据库</span></span><br><span class="line">    shopService.updateById(shop);</span><br><span class="line">    <span class="keyword">return</span> Result.ok();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新商铺信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> shop 商铺数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 无</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PutMapping</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">updateShop</span><span class="params">(<span class="meta">@RequestBody</span> Shop shop)</span> &#123;</span><br><span class="line">        <span class="comment">// 写入数据库</span></span><br><span class="line">        <span class="keyword">return</span> shopService.update(shop);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IShopService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;Shop&gt; &#123;</span><br><span class="line">    Result <span class="title function_">queryById</span><span class="params">(Long id)</span>;</span><br><span class="line">    Result <span class="title function_">update</span><span class="params">(Shop shop)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-4"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="comment">//如果id为空发生异常，应该为异常回滚事务</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(Shop shop)</span> &#123;</span><br><span class="line">    <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> shop.getId();</span><br><span class="line">    <span class="keyword">if</span>(id == <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;店铺ID不能为空&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//    1.更新数据库</span></span><br><span class="line">    updateById(shop);</span><br><span class="line"><span class="comment">//    2.删除缓存</span></span><br><span class="line">    stringRedisTemplate.delete(CACHE_SHOP_KEY + shop.getId().toString());</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div></li></ul><h2 id="缓存穿透">缓存穿透</h2><ul><li><code>缓存穿透</code>：缓存穿透是指客户端请求的数据在缓存中和数据库中都不存在，这样缓存永远都不会生效（只有数据库查到了，才会让redis缓存，但现在的问题是查不到），会频繁的去访问数据库。</li></ul><h3 id="解决方案">解决方案</h3><ul><li>常见的结局方案有两种<ol><li>缓存空对象<ul><li>优点：实现简单，维护方便</li><li>缺点：额外的内存消耗，可能造成短期的不一致</li></ul></li><li>布隆过滤<ul><li>优点：内存占用小，没有多余的key</li><li>缺点：实现复杂，可能存在误判</li></ul></li></ol></li><li><code>缓存空对象</code>思路分析：当我们客户端访问不存在的数据时，会先请求redis，但是此时redis中也没有数据，就会直接访问数据库，但是数据库里也没有数据，那么这个数据就穿透了缓存，直击数据库。但是数据库能承载的并发不如redis这么高，所以如果大量的请求同时都来访问这个不存在的数据，那么这些请求就会访问到数据库，简单的解决方案就是哪怕这个数据在数据库里不存在，我们也把这个这个数据存在redis中去（这就是为啥说会有<code>额外的内存消耗</code>），这样下次用户过来访问这个不存在的数据时，redis缓存中也能找到这个数据，不用去查数据库。可能造成的<code>短期不一致</code>是指在空对象的存活期间，我们更新了数据库，把这个空对象变成了正常的可以访问的数据，但由于空对象的TTL还没过，所以当用户来查询的时候，查询到的还是空对象，等TTL过了之后，才能访问到正确的数据，不过这种情况很少见罢了</li><li><code>布隆过滤</code>思路分析：布隆过滤器其实采用的是<code>哈希思想</code>来解决这个问题，通过一个庞大的二进制数组，根据哈希思想去判断当前这个要查询的数据是否存在，如果布隆过滤器判断存在，则放行，这个请求会去访问redis，哪怕此时redis中的数据过期了，但是数据库里一定会存在这个数据，从数据库中查询到数据之后，再将其放到redis中。如果布隆过滤器判断这个数据不存在，则直接返回。这种思想的优点在于节约内存空间，但存在误判，误判的原因在于：布隆过滤器使用的是哈希思想，只要是哈希思想，都可能存在<code>哈希冲突</code></li></ul><h3 id="代码实现-2">代码实现</h3><p>原来的逻辑中，我们如果发现这个数据在MySQL中不存在，就直接返回一个错误信息了，但是这样存在缓存穿透问题</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">queryById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="comment">//先从Redis中查，这里的常量值是固定的前缀 + 店铺id</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">shopJson</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(CACHE_SHOP_KEY + id);</span><br><span class="line">    <span class="comment">//如果不为空（查询到了），则转为Shop类型直接返回</span></span><br><span class="line">    <span class="keyword">if</span> (StrUtil.isNotBlank(shopJson)) &#123;</span><br><span class="line">        <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> JSONUtil.toBean(shopJson, Shop.class);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(shop);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//否则去数据库中查</span></span><br><span class="line">    <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> getById(id);</span><br><span class="line">    <span class="comment">//查不到返回一个错误信息或者返回空都可以，根据自己的需求来</span></span><br><span class="line">    <span class="keyword">if</span> (shop == <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;店铺不存在！！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//查到了则转为json字符串</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">jsonStr</span> <span class="operator">=</span> JSONUtil.toJsonStr(shop);</span><br><span class="line">    <span class="comment">//并存入redis，设置TTL</span></span><br><span class="line">    stringRedisTemplate.opsForValue().set(CACHE_SHOP_KEY + id, jsonStr,CACHE_SHOP_TTL, TimeUnit.MINUTES);</span><br><span class="line">    <span class="comment">//最终把查询到的商户信息返回给前端</span></span><br><span class="line">    <span class="keyword">return</span> Result.ok(shop);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>现在的逻辑是：如果这个数据不存在，将这个数据写入到Redis中，并且将value设置为空字符串，然后设置一个较短的TTL，返回错误信息。当再次发起查询时，先去Redis中判断value是否为空字符串，如果是空字符串，则说明是刚刚我们存的不存在的数据，直接返回错误信息</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">queryById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line"><span class="comment">//        1. 从Redis中查询商户缓存</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">shopJson</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(CACHE_SHOP_KEY + id.toString());</span><br><span class="line"><span class="comment">//        2. 判断是否存在,isNotBlank在空字符串，转义字符和null时都为false</span></span><br><span class="line">        <span class="keyword">if</span>(StrUtil.isNotBlank(shopJson))&#123;</span><br><span class="line"><span class="comment">//        3. 如果缓存存在，直接返回</span></span><br><span class="line">            <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> JSONUtil.toBean(shopJson, Shop.class);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(shopJson);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//判断命中的是否是空值</span></span><br><span class="line">        <span class="keyword">if</span>(shopJson!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;店铺信息不存在&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="comment">//        4. 如果缓存不存在，从MySQL中查询</span></span><br><span class="line">        <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> baseMapper.selectById(id);</span><br><span class="line"><span class="comment">//        5. 如果MySQL中也不存在，返回错误</span></span><br><span class="line">        <span class="keyword">if</span>(shop == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//将空值写入到Redis中</span></span><br><span class="line">            stringRedisTemplate.opsForValue().set(CACHE_SHOP_KEY + id.toString(), <span class="string">&quot;&quot;</span>, CACHE_NULL_TTL, TimeUnit.MINUTES);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;店铺不存在&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        6. 如果MySQL中存在，将查询到的数据存入Redis缓存</span></span><br><span class="line">        stringRedisTemplate.opsForValue().set(CACHE_SHOP_KEY + id.toString(),JSONUtil.toJsonStr(shop),CACHE_SHOP_TTL, TimeUnit.MINUTES);</span><br><span class="line"><span class="comment">//        7. 返回数据</span></span><br><span class="line">        <span class="keyword">return</span> Result.ok(shop);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>小结：</p><ul><li>缓存穿透产生的原因是什么？</li></ul></blockquote><ul><li>用户请求的数据在缓存中和在数据库中都不存在，不断发起这样的请求，会给数据库带来巨大压力</li><li>缓存穿透的解决方案有哪些？</li></ul><ol><li>缓存null值</li><li>布隆过滤</li><li>增强id复杂度，避免被猜测id规律（可以采用雪花算法）</li><li>做好数据的基础格式校验</li><li>加强用户权限校验</li><li>做好热点参数的限流</li></ol><h2 id="缓存雪崩">缓存雪崩</h2><ul><li><code>缓存雪崩</code>是指在同一时间段，<code>大量缓存的key同时失效</code>，或者<code>Redis服务宕机</code>，导致大量请求到达数据库，带来巨大压力</li><li>解决方案<ul><li>给不同的Key的TTL添加随机值，让其在不同时间段分批失效</li><li>利用<code>Redis集群</code>提高服务的可用性（使用一个或者多个哨兵<code>(Sentinel)</code>实例组成的系统，对redis节点进行监控，在主节点出现故障的情况下，能将从节点中的一个升级为主节点，进行故障转义，保证系统的可用性。）</li><li>给缓存业务添加<code>降级限流策略</code></li><li>给业务添加<code>多级缓存</code>（浏览器访问静态资源时，优先读取浏览器本地缓存；访问非静态资源（ajax查询数据）时，访问服务端；请求到达Nginx后，优先读取Nginx本地缓存；如果Nginx本地缓存未命中，则去直接查询Redis（不经过Tomcat）；如果Redis查询未命中，则查询Tomcat；请求进入Tomcat后，优先查询JVM进程缓存；如果JVM进程缓存未命中，则查询数据库）</li></ul></li></ul><h2 id="缓存击穿">缓存击穿</h2><ul><li><code>缓存击穿</code>是指在同一时间，<code>某个key非常热点</code>，同时<code>大量请求同时到达</code>，而<code>这个key正好失效</code>，导致大量请求到达数据库，带来巨大压力</li><li>举个不太恰当的例子：一件秒杀中的商品的key突然失效了，大家都在疯狂抢购，那么这个瞬间就会有无数的请求访问去直接抵达数据库，从而造成缓存击穿</li><li><em><strong>解决方案</strong></em><ul><li>给热点数据添加<code>互斥锁</code>（互斥锁可以用<code>Redis的setnx</code>命令实现），当多个线程同时查询同一个数据时，只有一个线程能查询到数据，其他线程都阻塞等待，等第一个线程查询到数据后，将数据写入到Redis中，其他线程再从Redis中查询数据</li><li>给热点数据添加<code>逻辑过期时间</code>（逻辑过期时间是指在数据过期时，不立即删除数据，而是给数据添加一个过期时间，当过期时间到了之后，再去查询数据，如果数据存在，则返回数据，如果数据不存在，则返回空值）</li></ul></li></ul><ul><li><code>逻辑分析</code>：假设线程1在查询缓存之后未命中，本来应该去查询数据库，重建缓存数据，完成这些之后，其他线程也就能从缓存中加载这些数据了。但是在线程1还未执行完毕时，又进来了线程2、3、4同时来访问当前方法，那么这些线程都不能从缓存中查询到数据，那么他们就会在同一时刻访问数据库，执行SQL语句查询，对数据库访问压力过大<br><a href="https://pic1.imgdb.cn/item/6354f77716f2c2beb1225032.jpg"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"></a></li><li><code>解决方案一</code>：互斥锁</li><li>利用锁的互斥性，假设线程过来，只能一个人一个人的访问数据库，从而避免对数据库频繁访问产生过大压力，但这也会影响查询的性能，将查询的性能从并行变成了串行，我们可以采用tryLock方法+double check来解决这个问题</li><li>线程1在操作的时候，拿着锁把房门锁上了，那么线程2、3、4就不能都进来操作数据库，只有1操作完了，把房门打开了，此时缓存数据也重建好了，线程2、3、4直接从redis中就可以查询到数据。</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://pic1.imgdb.cn/item/6354f76816f2c2beb1223b47.jpg"/></div></div><ul><li><code>解决方案二</code>：逻辑过期方案</li><li>方案分析：我们之所以会出现缓存击穿问题，主要原因是在于我们对key设置了TTL，如果我们不设置TTL，那么就不会有缓存击穿问题，但是不设置TTL，数据又会一直占用我们的内存，所以我们可以采用逻辑过期方案</li><li>我们之前是TTL设置在redis的value中，注意：这个过期时间并不会直接作用于Redis，而是我们后续通过逻辑去处理。假设线程1去查询缓存，然后从value中判断当前数据已经过期了，此时线程1去获得互斥锁，那么其他线程会进行阻塞，获得了锁的进程他会开启一个新线程去进行之前的重建缓存数据的逻辑，直到新开的线程完成逻辑之后，才会释放锁，而线程1直接进行返回，假设现在线程3过来访问，由于线程2拿着锁，所以线程3无法获得锁，线程3也直接返回数据（但只能<code>返回旧数据，牺牲了数据一致性，换取性能上的提高</code>），只有等待线程2重建缓存数据之后，其他线程才能返回正确的数据</li><li>这种方案巧妙在于，异步构建缓存数据，缺点是在重建完缓存数据之前，返回的都是脏数据，但是能提升性能</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://pic1.imgdb.cn/item/6354f97716f2c2beb124e950.jpg"/></div></div><h3 id="对比互斥锁与逻辑删除">对比互斥锁与逻辑删除</h3><ul><li><code>互斥锁方案</code>：由于保证了互斥性，所以数据一致，且实现简单，只是加了一把锁而已，也没有其他的事情需要操心，所以没有额外的内存消耗，缺点在于有锁的情况，就可能死锁，所以只能串行执行，性能会受到影响</li><li><code>逻辑过期方案</code>：线程读取过程中不需要等待，性能好，有一个额外的线程持有锁去进行重构缓存数据，但是在重构数据完成之前，其他线程只能返回脏数据，且实现起来比较麻烦</li></ul><table><thead><tr><th style="text-align:center">解决方案</th><th style="text-align:center">优点</th><th style="text-align:center">缺点</th></tr></thead><tbody><tr><td style="text-align:center">互斥锁</td><td style="text-align:center">没有额外的内存消耗 保证一致性 实现简单</td><td style="text-align:center">线程需要等待，性能受影响 可能有死锁风险</td></tr><tr><td style="text-align:center">逻辑过期</td><td style="text-align:center">线程无需等待，性能较好</td><td style="text-align:center">不保证一致性 有额外内存消耗 实现复杂</td></tr></tbody></table><h3 id="利用互斥锁解决缓存击穿问题">利用互斥锁解决缓存击穿问题</h3><ul><li><strong><code>核心思路</code></strong>：相较于原来从缓存中查询不到数据后直接查询数据库而言，现在的方案是，进行查询之后，如果没有从缓存中查询到数据，则进行互斥锁的获取，获取互斥锁之后，判断是否获取到了锁，如果没获取到，则休眠一段时间，过一会儿再去尝试，知道获取到锁为止，才能进行查询</li><li>如果获取到了锁的线程，则进行查询，将查询到的数据写入Redis，再释放锁，返回数据，利用互斥锁就能保证只有一个线程去执行数据库的逻辑，防止缓存击穿<div class="img-wrap"><div class="img-bg"><img class="img" src="https://pic1.imgdb.cn/item/6354fb8116f2c2beb127ac8b.jpg"/></div></div></li><li><strong><code>操作锁的代码</code></strong></li><li>核心思路就是利用redis的setnx方法来表示获取锁，因为Redis是单线程的，如果redis没有这个key，则插入成功，返回1，如果已经存在这个key，则插入失败，返回0。在StringRedisTemplate中返回true/false，我们可以根据返回值来判断是否有线程成功获取到了锁</li></ul><div class="tabs" id="互斥锁"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#互斥锁-1">trylock</button></li><li class="tab"><button type="button" data-href="#互斥锁-2">unlock</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="互斥锁-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    尝试获取锁</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">trylock</span><span class="params">(String key)</span>&#123;</span><br><span class="line">        <span class="type">Boolean</span> <span class="variable">flag</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().setIfAbsent(key, <span class="string">&quot;1&quot;</span>, <span class="number">10</span>, TimeUnit.SECONDS);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> BooleanUtil.isTrue(flag);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="互斥锁-2"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    尝试删除锁</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">unlock</span><span class="params">(String key)</span>&#123;</span><br><span class="line">        stringRedisTemplate.delete(key);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>解决缓存击穿和解决缓存穿透代码很相近，所以对之前的querybyId方法进行整合</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//缓存穿透逻辑</span></span><br><span class="line">    <span class="keyword">public</span> Shop <span class="title function_">queryWithPassThrough</span><span class="params">(Long id)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> CACHE_SHOP_KEY + id.toString();</span><br><span class="line"><span class="comment">//        1. 从Redis中查询商户缓存</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">shopJson</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(key);</span><br><span class="line"><span class="comment">//        2. 判断是否存在,isNotBlank在空字符串，转义字符和null时都为false</span></span><br><span class="line">        <span class="keyword">if</span>(StrUtil.isNotBlank(shopJson))&#123;</span><br><span class="line"><span class="comment">//        3. 如果缓存存在，直接返回</span></span><br><span class="line">            <span class="keyword">return</span> JSONUtil.toBean(shopJson, Shop.class);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断命中的是否是空值</span></span><br><span class="line">        <span class="keyword">if</span>(shopJson!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        4. 如果缓存不存在，从MySQL中查询</span></span><br><span class="line">        <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> baseMapper.selectById(id);</span><br><span class="line"><span class="comment">//        5. 如果MySQL中也不存在，返回错误</span></span><br><span class="line">        <span class="keyword">if</span>(shop == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//将空值写入到Redis中</span></span><br><span class="line">            stringRedisTemplate.opsForValue().set(CACHE_SHOP_KEY + id.toString(), <span class="string">&quot;&quot;</span>, CACHE_NULL_TTL, TimeUnit.MINUTES);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        6. 如果MySQL中存在，将查询到的数据存入Redis缓存</span></span><br><span class="line">        stringRedisTemplate.opsForValue().set(CACHE_SHOP_KEY + id.toString(),JSONUtil.toJsonStr(shop),CACHE_SHOP_TTL, TimeUnit.MINUTES);</span><br><span class="line"><span class="comment">//        7. 返回数据</span></span><br><span class="line">        <span class="keyword">return</span> shop;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>在编写我们的互斥锁代码，与缓存穿透类似，稍加修改即可</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> Shop <span class="title function_">queryWithMutex</span><span class="params">(Long id)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> CACHE_SHOP_KEY + id.toString();</span><br><span class="line"><span class="comment">//        1. 从Redis中查询商户缓存</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">shopJson</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(key);</span><br><span class="line"><span class="comment">//        2. 判断是否存在,isNotBlank在空字符串，转义字符和null时都为false</span></span><br><span class="line">        <span class="keyword">if</span>(StrUtil.isNotBlank(shopJson))&#123;</span><br><span class="line"><span class="comment">//        3. 如果缓存存在，直接返回</span></span><br><span class="line">            <span class="keyword">return</span> JSONUtil.toBean(shopJson, Shop.class);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断命中的是否是空值</span></span><br><span class="line">        <span class="keyword">if</span>(shopJson!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        4.  实现缓存重建</span></span><br><span class="line"><span class="comment">//        4.1 获取互斥锁</span></span><br><span class="line">        String lockKey=<span class="string">&quot;lock:shop:&quot;</span>+id.toString();</span><br><span class="line">        <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">isLock</span> <span class="operator">=</span> trylock(lockKey);</span><br><span class="line"><span class="comment">//        4.2 判断互斥锁是否获取成功</span></span><br><span class="line">            <span class="keyword">if</span>(!isLock)&#123;</span><br><span class="line">    <span class="comment">//        4.3 失败，则休眠并重试</span></span><br><span class="line">                Thread.sleep(<span class="number">50</span>);</span><br><span class="line">                <span class="keyword">return</span> queryWithMutex(id);</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        4.4 成功，则查询数据库并写入缓存</span></span><br><span class="line">            shop = getById(id);</span><br><span class="line">            Thread.sleep(<span class="number">500</span>);</span><br><span class="line"><span class="comment">//        5. 如果MySQL中也不存在，返回错误</span></span><br><span class="line">            <span class="keyword">if</span>(shop == <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="comment">//将空值写入到Redis中</span></span><br><span class="line">                stringRedisTemplate.opsForValue().set(CACHE_SHOP_KEY + id.toString(), <span class="string">&quot;&quot;</span>, CACHE_NULL_TTL, TimeUnit.MINUTES);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//        6. 如果MySQL中存在，将查询到的数据存入Redis缓存</span></span><br><span class="line">            stringRedisTemplate.opsForValue().set(CACHE_SHOP_KEY + id.toString(),JSONUtil.toJsonStr(shop),CACHE_SHOP_TTL, TimeUnit.MINUTES);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="comment">//        7. 释放互斥锁</span></span><br><span class="line">            unlock(lockKey);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//        8. 返回数据</span></span><br><span class="line">        <span class="keyword">return</span> shop;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>最终修改<code>queryById</code>方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">queryById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//      缓存穿透</span></span><br><span class="line"><span class="comment">//        Shop shop = queryWithPassThrough(id);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//      缓存击穿</span></span><br><span class="line">        <span class="type">Shop</span> <span class="variable">shop</span> <span class="operator">=</span> queryWithMutex(id);</span><br><span class="line">        <span class="keyword">if</span>(shop == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;商铺不存在&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Result.ok(shop);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ul><li>使用Jmeter进行测试<ul><li>我们先来模拟一下缓存击穿的情景，缓存击穿是指在某时刻，一个热点数据的TTL到期了，此时用户不能从Redis中获取热点商品数据，然后就都得去数据库里查询，造成数据库压力过大。</li><li>那么我们首先将Redis中的热点商品数据删除，模拟TTL到期，然后用Jmeter进行压力测试，开100个线程来访问这个没有缓存的热点数据</li></ul></li><li>配置Jmeter相关属性</li></ul><div class="tabs" id="jmeter"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#jmeter-1">线程配置</button></li><li class="tab"><button type="button" data-href="#jmeter-2">目标配置</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="jmeter-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250828213708.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="jmeter-2"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://raw.githubusercontent.com/silvan2077/markdown_pic/main/Picgo/20250828213755.png"/></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>每次启动Jmeter前别忘了清空Redis缓存哦。</p><h2 id="缓存总结">缓存总结</h2><h3 id="认识缓存">认识缓存</h3><ul><li>缓存是一种具备<code>高效读写能力</code>的数据暂存区域</li><li><strong>缓存的作用</strong><ul><li>降低后端负载</li><li>提高服务读写响应速度</li></ul></li><li><strong>缓存的成本</strong><ul><li>开发成本</li><li>运维成本</li><li>一致性问题</li></ul></li></ul><h3 id="缓存更新策略-2">缓存更新策略</h3><ul><li>缓存更新策略大致分为三种</li></ul><blockquote><ol><li>内存淘汰 ———— Redis自带的内存淘汰机制</li></ol></blockquote><ol start="2"><li>过期淘汰 ———— 利用expire命令给数据设置过期时间</li><li>主动更新 ———— 主动完成数据库与缓存的同步更新</li></ol><ul><li><p>可根据业务的一致性需求来选择不同的策略</p><ul><li>低一致性需求 ———— 内存淘汰或过期淘汰</li><li>高一致性需求 ———— 主动更新为主，过期淘汰兜底</li></ul></li><li><p>主动更新的方案</p><ul><li><code>Cache Aside</code> ———— 缓存调用者更新数据库的同时完成对缓存的更新<ul><li>一致性良好</li><li>实现难度一般</li></ul></li><li><code>Read/Write Through</code> ———— 缓存与数据库集成为一个服务，服务保证两者的一致性，对外暴露API接口。调用者调用API，无需知道自己操作的是数据库还是缓存，不关心一致性<ul><li>一致性优秀</li><li>实现复杂</li><li>性能一般</li></ul></li><li><code>Write Back</code> ———— 缓存调用者的CRUD都针对缓存完成。独立线程异步的将缓存数据写到数据库，实现最终数据的一致<ul><li>一致性差</li><li>性能好</li><li>实现复杂</li></ul></li></ul></li><li><p>Cache Aside的模式选择</p><ul><li>更新缓存还是删除缓存？<ul><li>更新缓存会产生许多无效更新，并且在较大的线程会有安全问题</li><li>删除缓存本质是延迟更新，没有无效更新，安全问题相对较低</li></ul></li><li>先操作数据库还是缓存？<ul><li>先更新数据，再删除缓存 ———— 在满足原子性的情况下，安全问题的概率较低</li><li>先删除换粗，再更新数据 ———— 安全问题概率较高</li></ul></li><li>如何确保数据库与缓存操作原子性<ul><li>单体系统 ———— 事务机制</li><li>分布式系统 ———— 分布式事务机制</li></ul></li></ul></li><li><p>最佳实践</p><ul><li><p>查询数据时</p><ol><li>先查询缓存</li><li>如果缓存命中，直接返回</li><li>缓存未命中，查询数据库</li><li>将数据库数据写入缓存</li><li>返回结果</li></ol></li><li><p>更新数据时</p><ol><li>先更新数据库</li><li>删除缓存</li></ol><ul><li>必须确保两者的原子性</li></ul></li></ul></li></ul><h3 id="缓存穿透-2">缓存穿透</h3><ul><li>产生原因<ul><li>用户请求的数据在缓存和数据库都不存在，这样也不会写入缓存，这些请求会全部打到数据库</li></ul></li><li>解决方案<ul><li><code>缓存空对象</code><ul><li>思路：不存在的数据也在Redis建立缓存，把值设为空，并设置较短的过期时间</li><li>优点：实现简单，维护方便</li><li>缺点：会额外消耗内存，且可能有短期数据不一致问题</li></ul></li><li><code>布隆过滤器</code><ul><li>思路：利用布隆过滤算法，在请求进入Redis之前先判断是否存在，如果不存在则直接拒绝请求</li><li>优点：内存占用少</li><li>缺点：实现复杂，且存在误判的可能</li></ul></li><li><code>其他</code><ul><li>做好数据格式校验</li><li>加强用户权限校验</li><li>做好热点参数限流</li></ul></li></ul></li></ul><h3 id="缓存雪崩-2">缓存雪崩</h3><ul><li>产生原因<ul><li>同一时段大量<code>key失效</code>或<code>Redis服务宕机</code>，导致大量请求直接到达数据库</li></ul></li><li>解决方案<ul><li>不同的key设置不同的失效时间</li><li>利用Redis集群提高服务的可用性</li><li>添加多级缓存</li><li>给缓存业务添加限流策略</li></ul></li></ul><h3 id="缓存击穿-2">缓存击穿</h3><ul><li>产生原因<ul><li>热点Key在一段时间内被高并发访问，而缓存重建耗时较长</li><li>热点key突然过期，因为重建耗时长，大量数据直接到达数据库</li></ul></li><li>解决方案<ul><li>互斥锁<ul><li>思路：给缓存重建过程加锁，一个线程在缓存重建时，其他线程等待</li><li>优点：实现简单且一致性好</li><li>缺点：性能下降且有死锁风险</li></ul></li><li>逻辑过期<ul><li>思路：<ul><li>热点key缓存永不过期，设置一个逻辑过期时间，查询数据时判断逻辑过期时间，如果过期则重建缓存</li><li>重建缓存也通过互斥锁来避免并发重建</li><li>重建缓存利用独立线程异步执行</li><li>其他线程无需等待，查询则返回旧的数据</li></ul></li><li>优点：性能好，不会阻塞线程</li><li>缺点：一致性差，且有额外内存消耗</li></ul></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;导入项目&lt;/h1&gt;
&lt;h2 id=&quot;项目介绍&quot;&gt;项目介绍&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;此次项目采用前后端分离开发模式&lt;/li&gt;
&lt;li&gt;手机或者app发起请求，请求Nginx服务器，Nginx基于七层模型走HTTP协议，实现基于Lua绕开Tomcat访问Redis，也可以</summary>
      
    
    
    
    <category term="java" scheme="https://silvan2077.github.io/categories/java/"/>
    
    
    <category term="项目实战" scheme="https://silvan2077.github.io/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/"/>
    
    <category term="黑马点评" scheme="https://silvan2077.github.io/tags/%E9%BB%91%E9%A9%AC%E7%82%B9%E8%AF%84/"/>
    
  </entry>
  
</feed>
